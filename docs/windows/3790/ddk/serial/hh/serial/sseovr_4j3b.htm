<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Plug and Play Serial Device Connected to an RS-232 Port</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Plug and Play Serial Device Connected to an RS-232 Port">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Serial&nbsp;Ports&nbsp;and&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="ddk_plug_and_play_serial_device_connected_to_an_rs_232_port_kg"></A>Plug and Play Serial Device Connected to an RS-232 Port</H2>

<P>This section describes the typical configuration of hardware, drivers, and device stacks for Plug and Play serial devices and legacy pointer devices that are connected to an RS-232 port. This configuration can be used to support serial devices such as: mouse devices, pointing devices, graphic tablets, modems, and digital cameras.</P>

<P>The following figure shows the typical configuration for a Toaster device.</P>

<P><IMG SRC="images/ser2.gif" ALT="" BORDER=0></P>

<P><B>Left Figure: Hardware Configuration for a Plug and Play Toaster Device Connected to an RS-232 Port</B></P>

<P><B>Right Figure: Configuration of Drivers and Device Stacks for a Plug and Play Toaster Device Connected to an RS-232 Port</B></P>

<P>Serial and Serenum are used in this configuration. Serial creates and attaches a function device object (FDO) to the RS-232 port stack. Serenum creates and attaches an upper-level filter DO to the RS-232 port stack. Serenum enumerates the device attached to the RS-232 port after the Plug and Play Manager sends an IRP_MN_QUERY_RELATIONS request of type <B>BusRelations</B> to the RS-232 device stack.</P>

<P>After Serenum detects a supported device, it creates a physical device object (PDO) for the device and reports the device to the Plug and Play Manager. The Configuration Manager uses the INF file and installers for the Toaster device to complete the installation of the Toaster device. A Toaster driver creates an FDO and attaches it to the Toaster device stack. Filter DOs can also be added to the Toaster device stack.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Plug%20and%20Play%20Serial%20Device%20Connected%20to%20an%20RS-232%20Port"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
