<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Summary</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Summary">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Other&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_summary"></A>Summary</H1>

<P>VDDs provide a translation layer between 16-bit MS-DOS applications and special-purpose hardware devices in the NT-based system. A VDD turns an application’s attempt to write directly to a device into a Win32 API call that makes a request to a kernel-mode device driver. The key characteristic of every VDD is the original MS-DOS application does not need to be modified to work on 32-bit NT-based machines. By adding a VDD and a kernel-mode device driver, an application developer can move an existing MS-DOS application and its dedicated hardware device to 32-bit NT-based systems.</P>

<P>For improved performance, the MS-DOS application can be modified to directly call its companion VDD. Otherwise, the unmodified application can rely on the VDM to intercept disallowed device accesses and route them to the VDD.</P>

<P>The three main areas in which the VDM intercepts an application’s attempts to interact directly with device hardware are:

<OL>
	<LI>I/O ports</LI>

	<LI>Memory mapped I/O</LI>

	<LI>DMA</LI>
</OL>

<P>The VDD can install callback functions to handle I/O port access and memory-mapped I/O. The VDD can also make calls to functions provided by the NT-based environment to support DMA transfers between an application and a hardware device. In addition, NT-based systems supply functions that allow a VDD to query and set processor registers and simulate interrupts. These services allow the VDD to fully support the functionality of the original MS-DOS application and its accompanying hardware device.</P>

<P></P>

<P></P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Summary"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
