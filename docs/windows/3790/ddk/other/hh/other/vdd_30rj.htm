<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Registering the Driver (Not Required for Application-Based Intercepts)</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Registering the Driver (Not Required for Application-Based Intercepts)">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Other&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="ddk_registering_the_driver__not_required_for_application_based_intercepts_"></A>Registering the Driver (Not Required for Application-Based Intercepts)</H2>

<P>If you are writing application-based intercepts, <B>RegisterModule</B> loads and installs the 32-bit VDD. In this case, you do not need to follow the installation procedures described in this section.</P>

<P>The registry contains information for loading and configuring your driver. Each VDD for VDM-based intercepts must be identified under the key <B>HKEY_LOCAL_MACHINE\SYSTEM \CurrentControlSet \Control \VirtualDeviceDrivers</B>. The value entry of the key is an array of zero-terminated strings terminated by two null characters (REG_MULTI_SZ format). Each substring specifies a full path name to a VDD the system loads when the VDM process is initialized. The format of the registry entry is shown as follows:</P>

<P><B>[VirtualDeviceDrivers]</B></P>

<P><B>VDD</B> <B>=</B> <I>&lt;full-path of the VDD1.DLL&gt;</I><B>\0</B><I>&lt;full-path of the VDD2.DLL&gt;</I><B>\0\0</B></P>

<P>Your application installation program can use the registry API functions, such as <B>RegSetValue</B>, to modify the required registry entry to enable your VDD, or you can require the user or system administrator to modify the entry with <I>regedit.exe.</I></P>

<P>The <B>RegSetValue </B>function and REG_MULTI_SZ format are described in the Win32 SDK.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Registering%20the%20Driver%20(Not%20Required%20for%20Application-Based%20Intercepts)"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
