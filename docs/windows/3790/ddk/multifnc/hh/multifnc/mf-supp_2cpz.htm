<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Supporting Multifunction PCI Devices</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Supporting Multifunction PCI Devices">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Multifunction&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_supporting_multifunction_pci_devices_dg"></A>Supporting Multifunction PCI Devices</H1>

<P>If a multifunction PCI device conforms completely to the PCI multifunction standard, the PCI bus driver enumerates the individual functions. The PCI bus driver manages the fact that there is more than one function residing at a single device location. To the rest of the system, the individual functions operate like independent devices. </P>

<P>Vendors of a PCI multifunction device on an NT-based platfrom must do the following:

<UL>
	<LI>Ensure that the device conforms to the PCI multifunction specification.</LI>

	<LI>Provide a PnP function driver for each function of the device.
<P>Since the system-supplied bus driver handles the multifunction semantics, the function drivers can be the same drivers that would be used if the functions were packaged as individual devices.
</LI>

	<LI>Provide an INF file for each function of the device.
<P>The INF files can be the same files that would be used if the functions were packaged as a individual devices. The INF files do not need any special multifunction semantics.
</LI>
</UL>

<P>For example, the following figure shows the sample device stacks that might be created for a multifunction PCI device with ISDN and modem functions. </P>

<P><IMG SRC="images/mf-indep.gif" ALT="" BORDER=0></P>

<P><B>Sample Device Stacks for a Multifunction Device Whose Parent Enumerates Each Function</B></P>

<P>As shown in the previous figure, rather than enumerating one multifunction device, the PCI driver enumerates two child devices. The PnP Manager treats each child device like a typical device, locating INF files, loading the appropriate drivers, calling their AddDevice routines, and so forth until a device stack is created for each device. The PCI driver arbitrates the resources for the child devices and manages any other multifunction aspects of the device. The vendor of the multifunction card provides function drivers and INFs for the ISDN and modem devices, just as if they were separate devices.</P>

<P>The illustration focuses on the function driver and bus driver for each function and their associated FDO and PDO. Any filter drivers (and filter DOs) are omitted for simplicity.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Supporting%20Multifunction%20PCI%20Devices"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
