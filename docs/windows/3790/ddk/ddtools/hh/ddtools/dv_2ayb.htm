<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Memory Pool Tracking</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Driver Verifier options, Memory Pool Tracking">
<META NAME="MS-HKWD" CONTENT="Memory Pool Tracking">
<META NAME="MS-HKWD" CONTENT="Pool Tracking">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Driver&nbsp;Development&nbsp;Tools:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="ddk_memory_pool_tracking_tools"></A>Memory Pool Tracking</H3>

<P>Memory Pool Tracking monitors the memory allocations made by the driver. At the time that the driver is unloaded, Driver Verifier ensures that all allocations made by the driver have been freed.</P>

<P>Unfreed memory allocations (also called <I>memory leaks</I>) are a common cause of lowered operating system performance. These can fragment the system pools and eventually cause system crashes.</P>

<P>When this option is active, Driver Verifier will issue bug check 0xC4 (with Parameter&nbsp;1 equal to 0x60) if a driver unloads without freeing all its allocations.</P>

<P>If Driver Verifier issues this bug check with Parameter&nbsp;1 equal to 0x51, 0x52, 0x53, 0x54, or 0x59, the driver has written to memory outside of its allocations. In this case, you should enable Special Memory Pool to locate the source of the error.</P>

<P>See <A HREF="bccodes_7r1j.htm#ddk_bug_check_0xc4_verifier_mpt_bug">Bug Check 0xC4</A> (DRIVER_VERIFIER_DETECTED_VIOLATION) for a list of the bug check parameters.</P>

<H4>Monitoring Memory Pool Tracking</H4>

<P>Memory pool allocation statistics can be monitored separately for each driver being verified. These statistics can be displayed by the Driver Verifier Manager graphical interface, the <I>verifier.exe</I> command line, or in a log file. See <A HREF="dv_26pf.htm">Monitoring Individual Counters</A> for details.</P>

<P>The kernel debugger extension <B>!verifier&nbsp;0x3</B> can be used to locate outstanding memory allocations after the driver is unloaded, or to track the current allocations while the driver is running. This extension also shows the pool tag, the size of the pool, and the address of the allocator for each allocation. For information about debugger extensions, see <A HREF="dbgblurb_25bn.htm">Debugging Tools for NT-Based Operating Systems</A>.</P>

<H4>Activating This Option</H4>

<P>The Memory Pool Tracking option can be activated by using the Driver Verifier Manager graphical interface or the <I>verifier.exe</I> command line. This activation will take effect after the next boot. See <A HREF="dv_5q43.htm">Selecting Driver Verifier Options</A> for details.</P>

<H4>Graphics Drivers</H4>

<P>The Memory Pool Tracking option is not used for graphics drivers. If selected, it has no effect.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Memory%20Pool%20Tracking"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
