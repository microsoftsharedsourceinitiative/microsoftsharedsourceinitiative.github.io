<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>UPS\Status Registry Entries</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="UPS\Status Registry Entries">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Battery&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="ddk_ups_status_registry_entries_kg"></A>UPS\Status Registry Entries</H3>

<P>The following registry entries, under the <B>UPS\Status</B> key, must be set by UPS minidrivers.</P>

<H4>BatteryCapacity</H4>

<DL>
<DT>Value Name:</DT>

<DD><B>BatteryCapacity</B></DD>

<DT>Value Type:</DT>

<DD>REG_DWORD</DD>

<DT>Value:</DT>

<DD>The percent of battery capacity remaining in the UPS, represented as a value in the range of 0 through 100. (The displayed value is rounded to the nearest integer.)</DD>

<DT>Default Value:</DT>

<DD>0</DD>
</DL>

<H4>BatteryStatus</H4>

<DL>
<DT>Value Name:</DT>

<DD><B>BatteryStatus</B></DD>

<DT>Value Type:</DT>

<DD>REG_DWORD</DD>

<DT>Value:</DT>

<DD>The current status of the UPS batteries. Values are listed in the following table.

<TABLE>

<TR VALIGN="top">
<TH align=left width=15%>Value</TH>
<TH align=left width=85%>Meaning</TH>
</TR>

<TR VALIGN="top">
<TD width=15%>0</TD>
<TD width=85%>The battery status is unknown.</TD>
</TR>

<TR VALIGN="top">
<TD width=15%>1</TD>
<TD width=85%>The batteries are OK.</TD>
</TR>

<TR VALIGN="top">
<TD width=15%>2</TD>
<TD width=85%>The batteries need to be replaced.</TD>
</TR>
</TABLE><BR>

</DD>

<DT>Default Value:</DT>

<DD>0</DD>
</DL>

<H4>CommStatus</H4>

<DL>
<DT>Value Name:</DT>

<DD><B>CommStatus</B></DD>

<DT>Value Type:</DT>

<DD>REG_DWORD</DD>

<DT>Value:</DT>

<DD>The status of the communication path to the UPS. Values are listed in the following table.

<TABLE>

<TR VALIGN="top">
<TH align=left width=15%>Value</TH>
<TH align=left width=85%>Meaning</TH>
</TR>

<TR VALIGN="top">
<TD width=15%>0</TD>
<TD width=85%>The communication path to the UPS has failed.</TD>
</TR>

<TR VALIGN="top">
<TD width=15%>1</TD>
<TD width=85%>The communication path to the UPS is OK.</TD>
</TR>
</TABLE><BR>

</DD>

<DT>Default Value:</DT>

<DD>1</DD>
</DL>

<H4>FirmwareRev</H4>

<DL>
<DT>Value Name:</DT>

<DD><B>FirmwareRev</B></DD>

<DT>Value Type:</DT>

<DD>REG_SZ</DD>

<DT>Value:</DT>

<DD>Reports the UPS firmware revision as a displayable string. </DD>

<DT>Default Value:</DT>

<DD>""</DD>
</DL>

<H4>SerialNumber</H4>

<DL>
<DT>Value Name:</DT>

<DD><B>SerialNumber</B></DD>

<DT>Value Type:</DT>

<DD>REG_SZ</DD>

<DT>Value:</DT>

<DD>Reports the UPS serial number as a displayable string. </DD>

<DT>Default Value:</DT>

<DD>""</DD>
</DL>

<H4>TotalUPSRuntime</H4>

<DL>
<DT>Value Name:</DT>

<DD><B>TotalUPSRuntime</B></DD>

<DT>Value Type:</DT>

<DD>REG_DWORD</DD>

<DT>Value:</DT>

<DD>The amount of remaining UPS run time, in minutes.</DD>

<DT>Default Value:</DT>

<DD>0</DD>
</DL>

<H4>UtilityPowerStatus </H4>

<DL>
<DT>Value Name:</DT>

<DD><B>UtilityPowerStatus</B></DD>

<DT>Value Type:</DT>

<DD>REG_DWORD</DD>

<DT>Value:</DT>

<DD>Reports the status of utility-supplied power into the UPS. Values are listed in the following table.

<TABLE>

<TR VALIGN="top">
<TH align=left width=15%>Value</TH>
<TH align=left width=85%>Meaning</TH>
</TR>

<TR VALIGN="top">
<TD width=15%>0</TD>
<TD width=85%>The status of utility-supplied power is unknown.</TD>
</TR>

<TR VALIGN="top">
<TD width=15%>1</TD>
<TD width=85%>Utility-supplied power is OK.</TD>
</TR>

<TR VALIGN="top">
<TD width=15%>2</TD>
<TD width=85%>A power failure has occurred.</TD>
</TR>
</TABLE><BR>

</DD>

<DT>Default Value:</DT>

<DD>0
</DD>
</DL>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: UPS%5CStatus%20Registry%20Entries"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
