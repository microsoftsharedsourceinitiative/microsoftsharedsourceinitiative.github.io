<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Responding to the Basic MCI_STATUS Message</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="_pss_2541"></A>Responding to the Basic MCI_STATUS Message</H2>

<P>Applications use the basic flags of the MCI_STATUS message to determine the statistics for the device media. An application will supply a pointer to a <B>MCI_STATUS_PARMS</B> structure. The <B>MCI_STATUS_PARMS</B> structure was introduced with the required command messages. The following constants are defined for the <B>dwItem</B> member of the <B>MCI_STATUS_PARMS</B> structure in addition to the constants defined previously: </P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=41%>MCI Constant </TH>
<TH align=left width=59%>Description </TH>
</TR>

<TR VALIGN="top">
<TD width=41%>MCI_STATUS_CURRENT_TRACK </TD>
<TD width=59%>Requests the current track number. MCI uses continuous track numbers. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>MCI_STATUS_LENGTH </TD>
<TD width=59%>Requests the total media or track length. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>MCI_STATUS_NUMBER_OF_TRACKS </TD>
<TD width=59%>Requests the total number of playable tracks. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>MCI_STATUS_POSITION </TD>
<TD width=59%>Requests the current position in the media or track. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>MCI_STATUS_READY </TD>
<TD width=59%>Requests if the device is ready. Returns TRUE if the device is ready. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>MCI_STATUS_TIME_FORMAT </TD>
<TD width=59%>Requests the current time format of the device. The time formats your driver can return include: 
<P>MCI_FORMAT_BYTES </P>

<P>MCI_FORMAT_FRAMES </P>

<P>MCI_FORMAT_HMS </P>

<P>MCI_FORMAT_MILLISECONDS </P>

<P>MCI_FORMAT_MSF </P>

<P>MCI_FORMAT_SAMPLES </P>

<P>MCI_FORMAT_TMSF </P>
</TD>
</TR>
</TABLE><BR>

<P>The MCI_STATUS_START flag requests that the position of the start of the media should be returned. This flag will be accompanied by the MCI_STATUS_ITEM flag and the <B>dwItem</B> member will contain MCI_STATUS_POSITION. </P>

<P>The MCI_TRACK flag validates the <B>dwTrack</B> member of the structure. This flag modifies the meaning of the MCI_STATUS_POSITION or MCI_STATUS_LENGTH constants. When used with MCI_STATUS_POSITION, the application is requesting the starting position of the specified track. When used with MCI_STATUS_LENGTH, the application is requesting the length of the specified track. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Responding%20to%20the%20Basic%20MCI_STATUS%20Message"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
