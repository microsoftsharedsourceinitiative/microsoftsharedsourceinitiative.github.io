<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>SHELL_Resolve_Contention</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_2094"></A>SHELL_Resolve_Contention</H1>

<PRE>include shell.inc
mov eax, OwnerHandle  ; virtual machine handle of device owner
mov ebx, OtherHandle  ; virtual machine handle of contender
mov esi, OFFSET32 DeviceName  ; address of device name 
VxDcall SHELL_Resolve_Contention

jc  cannot_resolve
mov [WinnerHandle], ebx  ; virtual machine handle of new owner
 </PRE>

<P>Resolves contention for the MS-DOS shell. Uses EBX and Flags. 

<UL>
	<LI>Clears the carry flag and copies the virtual machine handle of contention winner to the EBX register if successful. Otherwise, sets the carry flag to indicate that contention could not be resolved. </LI>
</UL>

<DL>
<DT><I>OwnerHandle</I> </DT>

<DD>Handle of virtual machine of the current device owner. </DD>

<DT><I>OtherHandle</I> </DT>

<DD>Handle of the contending virtual machine. This parameter must identify the current virtual machine. </DD>

<DT><I>DeviceName</I> </DT>

<DD>Address of an 8-byte string identifying the name of the device in contention. The name must be in uppercase letters, and be padded with spaces if necessary. This string must remain valid until <B>SHELL_Resolve_Contention</B> returns. 
</DD>
</DL>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: SHELL_Resolve_Contention"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
