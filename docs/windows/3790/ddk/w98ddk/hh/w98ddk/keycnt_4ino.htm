<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>VKD_API_Force_Key</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="_pss_2234"></A>VKD_API_Force_Key</H3>

<PRE>include vkd.inc
mov     ebx, VMHandle
mov     ch, ScanCode
mov     cl, RepeatCount
mov     edx, ShiftState
VxDCall VKD_API_Force_Key
jc      errorhandler
</PRE>

<P>Forces a key into a virtual machine as if it were typed on the keyboard. Because the VKD scans these forced keys for hot keys, forcing VKD hot keys is allowed. Uses Flags. Clears the carry flag upon success, sets it upon failure. 

<UL>
	<LI>No return value. </LI>
</UL>

<DL>
<DT><I>VMHandle</I> </DT>

<DD>Handle of the virtual machine, or 0 for the virtual machine that currently has the focus. </DD>

<DT><I>ScanCode</I> </DT>

<DD>Scan code. </DD>

<DT><I>RepeatCount</I> </DT>

<DD>Repeat count (1 or more). </DD>

<DT><I>ShiftState</I> </DT>

<DD>Shift state (1 means no change). 
</DD>
</DL>

<P>This service is currently limited to the focus virtual machine, so the service fails if <I>VMHandle</I> is not zero or not the focus virtual machine handle. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: VKD_API_Force_Key"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
