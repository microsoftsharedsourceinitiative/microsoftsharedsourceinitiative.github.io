<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>NPCancelConnection</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_3298"></A>NPCancelConnection</H1>

<P>Breaks a network connection. </P>

<PRE>DWORD NPCancelConnection(
  LPTSTR lpName,
  BOOL fForce
  DWORD dwFlags
  );
 </PRE>

<DL>
<DT><I>lpName</I> </DT>

<DD>The name of either the redirected local device or the remote network resource to disconnect from. In the former case, only the redirection specified is broken. In the latter case, only the deviceless connection to the remote network resource is broken. </DD>

<DT><I>fForce</I> </DT>

<DD>Used to indicate if the disconnect should be done forcefully in the event of open files or jobs on the connection. If FALSE is specified, the call will fail if there are open files or jobs. If set, CONNECT_REFCOUNT will not be set. </DD>

<DT><I>dwFlags</I> </DT>

<DD>Additional information about the connection. Currently has the following bit value: 

<TABLE>

<TR VALIGN="top">
<TD width=43%>CONNECT_REFCOUNT </TD>
<TD width=57%>The connection has a reference count on the session and, if set, the caller is requesting that the reference count be decremented. Otherwise the caller is requesting that the session be removed entirely for all users. </TD>
</TR>
</TABLE><BR>

</DD>
</DL>

<UL>
	<LI>WN_SUCCESS if the call is successful. Otherwise, an error code is returned, which may include: </LI>
</UL>

<TABLE>

<TR VALIGN="top">
<TD width=43%>WN_NOT_CONNECTED </TD>
<TD width=57%><I>lpName</I> not a redirected device, or not currently connected to <I>lpName</I>. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WN_OPEN_FILES </TD>
<TD width=57%>There are open files, and <I>fForce</I> was FALSE. </TD>
</TR>
</TABLE><BR>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: NPCancelConnection"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
