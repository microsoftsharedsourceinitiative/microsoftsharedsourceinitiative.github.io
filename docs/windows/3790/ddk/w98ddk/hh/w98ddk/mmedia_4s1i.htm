<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>MCI Driver Entry Point</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="_pss_2516"></A>MCI Driver Entry Point</H2>

<P>MCI uses the <B>DriverProc</B> entry point to handle its messages for MCI services. MCI augments the messages needed by the system to install, initialize, and configure the driver with MCI specific messages. This section contains a description of the messages added by MCI. While this section will reference the messages used by the system, it will only reference them in relation to the MCI messages. The Microsoft Windows Software Development Kit provides the complete definition and use of the messages used by the system. </P>

<P>The <B>DriverProc</B> entry point has the following syntax: </P>

<PRE>LRESULT WINAPI DriverProc(DWORD dwDriverID, 
    HDRVR hDriver, 
    UINT uMsg,
    LPARAM lParam1,
    LPARAM lParam2)
 </PRE>

<P>MCI drivers use the following definitions for the parameters of this entry point: </P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=19%>Parameter </TH>
<TH align=left width=81%>Definition </TH>
</TR>

<TR VALIGN="top">
<TD width=19%><I>dwDriverID</I> </TD>
<TD width=81%>Contains the driver ID created by the device driver in the low-order word. </TD>
</TR>

<TR VALIGN="top">
<TD width=19%><I>hDriver</I> </TD>
<TD width=81%>Contains a handle to the device driver </TD>
</TR>

<TR VALIGN="top">
<TD width=19%><I>uMsg</I> </TD>
<TD width=81%>Contains the joystick message </TD>
</TR>

<TR VALIGN="top">
<TD width=19%><I>lParam1</I> </TD>
<TD width=81%>Contains message-dependent data. Most messages define flags for this parameter. </TD>
</TR>

<TR VALIGN="top">
<TD width=19%><I>lParam2</I> </TD>
<TD width=81%>Contains message-dependent data. Most messages define structures for this parameter </TD>
</TR>
</TABLE><BR>

<P>When you add this entry point to your device driver, remember that you must export it. For more information on the <B>DriverProc</B> entry point and the system messages it handles, see the description of installable device drivers in the <I>Microsoft Windows Software Development Kit</I>. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: MCI%20Driver%20Entry%20Point"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
