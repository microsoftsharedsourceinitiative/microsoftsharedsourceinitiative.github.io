<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Installer Function</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="_pss_146"></A>Installer Function</H2>

<P>Every installer exports an installer function named <B>ClassInstall</B>. The Device Manager dynamically links to and calls this function whenever it needs the installer to carry out a specific installation task. </P>

<P><B>ClassInstall</B> receives two arguments: an integer that identifies the installation task to carry out, and the address of a <B>DEVICE_INFO</B> structure that contains information about the device to install. The function either carries out the requested task, using the information in the structure, or directs the Device Manager to carry out the task for it. </P>

<P>To direct the Device Manager to carry out the task, the function must return the ERR_DI_DO_DEFAULT value. The Device Manager has default actions for each request. </P>

<P>If the function carries out its own tasks, it must return the value OK to notify the Device Manager that the task completed successfully. If an error occurs while carrying out a task, the function must return one of the RETERR values given in <I>Constants</I>. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Installer%20Function"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
