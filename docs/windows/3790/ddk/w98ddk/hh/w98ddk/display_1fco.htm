<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Enabling Refresh Rate Support</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="_pss_518"></A>Enabling Refresh Rate Support</H2>

<P>The VDD returns monitor values in the <B>DISPLAYINFO</B> structure only if the <I>RefreshRate</I> value is present in the display driver's software registry key. If your display driver supports setting refresh rate based on <B>DISPLAYINFO</B> or <B>EDID</B>, the driver's INF file should include the following lines in its AddReg section: </P>

<PRE>HKR,DEFAULT,RefreshRate,,-1
HKR,DEFAULT,DDC,,1
 </PRE>

<P>The first line sets the RefreshRate value for the driver to -1, which tells the VDD to return a pre-computed refresh rate based on the <B>EDID</B> or registry timing ranges for the current monitor. If RefreshRate is set to a positive integer value, the VDD will return this override value instead (intended for future use with a refresh rate user interface). </P>

<P>The second line tells VDD to make the VESA DDC BIOS function call at boot time to attempt to detect the monitor and store the <B>EDID</B> returned by it, if any, in the registry. If DDC=1 is not present, VDD will not attempt to read the monitor <B>EDID</B> structure. </P>

<P>For more information about the INF file format, see the "Display Driver Install Disk" section. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Enabling%20Refresh%20Rate%20Support"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
