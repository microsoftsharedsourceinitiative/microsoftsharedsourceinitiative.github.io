<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Text File Processing</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="_pss_326"></A>Text File Processing</H3>

<P>NETDI has the ability to search text files such as Autoexec.bat and Config.sys and insert or remove lines from them. It does this by using the following registry values in the registration section of your INF. The key name under the <B>Ndi</B> key is the name of the file to process. Each line to insert in this file is given a name (specified in the KeyOrder) value. For each line, you can insert or replace text in the file. Replacing a line with a null string effectively deletes the line. </P>

<P>NETDI executes these operations when it is committing changes to the disk. </P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=29%>Driver Sub Key </TH>
<TH align=left width=26%>Value Name </TH>
<TH align=left width=25%>Value </TH>
<TH align=left width=20%>Description </TH>
</TR>

<TR VALIGN="top">
<TD width=29%>Ndi\<I>filename</I>\Order </TD>
<TD width=26%>KeyOrder </TD>
<TD width=25%><I>list of line names</I> </TD>
<TD width=20%>This is a list of names (subkeys under Ndi\<I>filename</I>) to process and the order to process the lines in. </TD>
</TR>

<TR VALIGN="top">
<TD width=29%>Ndi\<I>filename</I>\<I>name</I> </TD>
<TD width=26%>Line </TD>
<TD width=25%><I>line to insert</I> </TD>
<TD width=20%>This string is the line to insert according to the specified search rules. </TD>
</TR>

<TR VALIGN="top">
<TD width=29%>Ndi\<I>filename</I>\<I>name</I> </TD>
<TD width=26%>Search </TD>
<TD width=25%><I>search pattern</I> </TD>
<TD width=20%>The pattern to search in the file. <B>Line</B> will be placed before or after this line (determined by <B>Position</B>) For example, *ndis* searches for any line with ndis in it. </TD>
</TR>

<TR VALIGN="top">
<TD width=29%>Ndi\<I>filename</I>\<I>name</I> </TD>
<TD width=26%>Replace </TD>
<TD width=25%><I>replace string</I> </TD>
<TD width=20%>Text to replace in the found line. For example, to replace net start with net stop, set <B>Search</B> to *net start* and <B>Replace</B> to *net stop*. </TD>
</TR>

<TR VALIGN="top">
<TD width=29%>Ndi\<I>filename</I>\<I>name</I> </TD>
<TD width=26%>Skip </TD>
<TD width=25%><I>search pattern</I> </TD>
<TD width=20%>Do not process lines that match this pattern. </TD>
</TR>

<TR VALIGN="top">
<TD width=29%>Ndi\<I>filename</I>\<I>name</I> </TD>
<TD width=26%>Position </TD>
<TD width=25%><B>DWORD</B>:<I>position</I> </TD>
<TD width=20%>Where to place the string in <B>Line</B> relative to the line found by the <B>Search</B> parameter: </TD>
</TR>

<TR VALIGN="top">
<TD width=29%>&nbsp;</TD>
<TD width=26%>&nbsp;</TD>
<TD width=25%>&nbsp;</TD>
<TD width=20%>0 - insert at top of file or before the line </TD>
</TR>

<TR VALIGN="top">
<TD width=29%>&nbsp;</TD>
<TD width=26%>&nbsp;</TD>
<TD width=25%>&nbsp;</TD>
<TD width=20%>1 - insert at end of file or after the line </TD>
</TR>
</TABLE><BR>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Text%20File%20Processing"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
