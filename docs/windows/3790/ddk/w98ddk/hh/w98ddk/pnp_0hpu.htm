<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Processing System Broadcasts from a VxD</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="_pss_3662"></A>Processing System Broadcasts from a VxD</H2>

<P>Virtual device drivers can send and receive system broadcast messages under Windows 95. The notification services are provided by the shell VxD. To receive system broadcast messages, VxDs must call the <B>SHELL_HookSystemBroadcast</B> function. </P>

<P>Between the sending of <B>Sys_Critial_Init</B> and when a VxD receives the WM_STARTSESSION notification, application time events are not processed. Also, during this time, broadcasts are sent only to VxDs (since other Windows system components are not loaded). This rule also applies to the time between a successful WM_ENDSESSION notification and <B>Sys_Critical_Exit</B>. During these phases of system operations, VxDs must send notifications only during times when other VxDs can safely respond to them. </P>

<P>During all other times, <B>SHELL_BroadcastSystemMessage</B> must only be called at application time. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Processing%20System%20Broadcasts%20from%20a%20VxD"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
