<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>DISCDLGSTRUCT Structure</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_3245"></A>DISCDLGSTRUCT Structure</H1>

<PRE>typedef struct _DISCDLGSTRUCT{
    DWORD cbStructure;
    HWND hwndOwner;
    LPSTR lpLocalName;
    LPSTR lpRemoteName;
    DWORD dwFlags;
} DISCDLGSTRUCT, *LPDISCDLGSTRUCT;
 </PRE>

<DL>
<DT><I>cbStructure</I> </DT>

<DD>The size of the <B>DISCDLGSTRUCT </B>structure in bytes. This is filled in by the caller to indicate the size of the structure passed in. 

<TABLE>

<TR VALIGN="top">
<TD width=43%><I>hwndOwner</I> </TD>
<TD width=57%>This specifies the HWND of the owning window. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%><I>lpRemoteName</I> </TD>
<TD width=57%>Specifies the network resource to disconnect. This field may be set to NULL is <I>lpLocalName</I> is specified in which case the connection to the resource redirected from <I>lpLocalName </I>is disconnected. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%><I>lpLocalName</I> </TD>
<TD width=57%>The local device name that is redirected to the network resource, such as "F:" or "LPT1". </TD>
</TR>
</TABLE><BR>

</DD>

<DT><I>dwFlags</I> </DT>

<DD>Any combination of the following values: 

<TABLE>

<TR VALIGN="top">
<TD width=43%>DISC_UPDATE_PROFILE </TD>
<TD width=57%>If set, the connection will no longer be persistent (automatically restored every time the user logs on to the network). This flag is only valid if <I>lpLocalName</I> specifies a local device. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>DISC_NO_FORCE </TD>
<TD width=57%>If not set, force will be applied when attempting the disconnect if this is required (typically because the user has open files). The user will be informed if there are open files to the connection and asked if he still wants to disconnect. If so, the disconnect will be reattempted with additional force. </TD>
</TR>
</TABLE><BR>

</DD>
</DL>

<UL>
	<LI>WN_SUCCESS if the connection is successfully disconnected. Other error codes include the following. </LI>
</UL>

<TABLE>

<TR VALIGN="top">
<TD width=43%>WN_CANCEL </TD>
<TD width=57%>the user was asked if he really wanted to disconnect and elected not to disconnect. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WN_OPEN_FILES </TD>
<TD width=57%>unable to disconnect because the user is actively using the connection. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WN_FUNCTION_BUSY </TD>
<TD width=57%>The MPR or NP is busy (possibly initializing). The caller should retry. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WN_NO_NETWORK </TD>
<TD width=57%>network is not present. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WN_OUT_OF_MEMORY </TD>
<TD width=57%>insufficient memory to bring up the dialog. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WN_EXTENDED_ERROR </TD>
<TD width=57%>a network specific error occurred. <B>WNetGetLastError</B> should be called to obtain a description of the error. </TD>
</TR>
</TABLE><BR>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: DISCDLGSTRUCT%20Structure"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
