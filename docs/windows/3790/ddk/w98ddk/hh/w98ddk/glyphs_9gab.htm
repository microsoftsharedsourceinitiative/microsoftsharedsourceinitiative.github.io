<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Introduction to USB Printing with Microsoft Windows</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="_glyphs_introduction_to_usb_printing_with_microsoft_windows"></A>Introduction to USB Printing with Microsoft Windows</H2>

<P>Microsoft&reg;&nbsp;Windows&reg;&nbsp;2000 and Windows&nbsp;Millennium&nbsp;Edition (Windows&nbsp;Me) supply a general kernel-mode USB print driver, <I>usbprint.sys</I>, which works with the system-supplied port monitor <I>usbmon.dll</I> to provide end-to-end connectivity between USB printers and high-level printer drivers. Together these components make up the Microsoft USB printing solution.</P>

<P>Vendors are encouraged to write high-level printer drivers that rely on <I>usbprint.sys</I> rather than writing their own kernel-mode USB print drivers. Printer vendors can now redistribute <I>usbprint.sys</I> and <I>usbmon.dll</I> for installation on Windows&nbsp;98 and Windows&nbsp;98&nbsp;Second&nbsp;Edition, making their Windows&nbsp;Me printing solutions backward-compatible with Windows&nbsp;98. For information, contact Microsoft at <I>USBWinPrint@microsoft.com</I>.</P>

<P><I>Usbprint.sys</I> greatly simplifies the task of writing a high-level printer driver:

<UL>
	<LI><I>Usbprint.sys</I> handles kernel-mode operations such as power management on behalf of the high-level printer driver. </LI>

	<LI><I>Usbprint.sys</I> provides an interface very similar to that used by parallel printers, so it is possible for a single printer driver to work correctly on both USB and parallel port printers, without modification.</LI>

	<LI><I>Usbprint.sys</I> has been extensively tested with numerous printers, dongles, PCs, and mobile systems on the Windows&nbsp;2000 operating system. </LI>
</UL>

<P>For maximum cross-platform compatibility, vendor-supplied printer drivers should not depend on proprietary device-control commands or any parallel port IOCTLs except for IOCTL_PAR_QUERY_DEVICE_ID. A printer driver that follows these guidelines can drive printers over both USB and a parallel port on Microsoft&nbsp;Windows&nbsp;2000, Windows&nbsp;98, Windows&nbsp;98&nbsp;Second&nbsp;Edition, and Windows&nbsp;Me operating systems.</P>

<P>Procedures for writing a printer driver are described in the Windows&nbsp;2000 DDK documentation and in the Windows&nbsp;98 DDK documentation. If such a driver is correctly implemented as described in the DDK documentation, the driver should “just work,” because the printer driver installation mechanisms are the same on all three operating systems, over any bus.</P>

<P class=note><B>Note</B>&nbsp;&nbsp;<I>usbprint.sys</I> and <I>usbmon.dll</I> work together to simplify the task of writing a vendor-supplied language monitor. If a language monitor uses only the <B>WritePort</B>, <B>ReadPort</B> functions, and the IOCTL_PAR_QUERY_DEVICE_ID interface, it will be portable between USB and parallel port.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Introduction%20to%20USB%20Printing%20with%20Microsoft%20Windows"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
