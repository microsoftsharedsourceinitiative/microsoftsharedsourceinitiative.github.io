<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>DiBuildClassDrvListFromOldInf</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="DiBuildClassDrvListFromOldInf">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_201"></A>DiBuildClassDrvListFromOldInf</H1>

<P>Builds a class driver list from an old (Windows 3.1) style INF file. </P>

<PRE class=syntax><B>RETERR
  DiBuildClassDrvListFromOldInf(
    LPDEVICE_INFO  </B><I>lpdi</I><B>,
    LPCSTR  </B><I>lpszSection</I><B>,
    OLDINFPROC  </B><I>lpfnOldInfProc</I><B>, 
    LPARAM  </B><I>lParam</I><B>
    );</B></PRE>

<H4>Return Value</H4>

<UL>
	<LI>OK</LI>
</UL>

<H4>Parameters</H4>

<DL>
<DT><I>lpdi</I> </DT>

<DD>Pointer to a device info structure for a device that is being installed. </DD>

<DT><I>lpszSection</I> </DT>

<DD>The install section in the old INF to be converted </DD>

<DT><I>lpfnOldInfProc</I> </DT>

<DD>Callback function to fill in content of INF file. </DD>

<DT><I>lParam</I> </DT>

<DD>Reference data passed to the callback proc. 
</DD>
</DL>

<H4>Comments</H4>

<P>The atDriverPath field of the <I>lpdi</I> must be set to a valid OEM INF file, which is type INF_TEXT. This function will generate an appropriate Windows 95 INF header, and then call the supplied callback proc to convert the specified section into Windows 95 specific data. After the new INF is generated, this function will build a class driver list much like the DiBuildClassDrvList API does. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: DiBuildClassDrvListFromOldInf"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
