<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Initiating Image Color Management</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="_glyphs_initiating_image_color_management"></A>Initiating Image Color Management</H2>

<P>There are two ways in which ICM can be initiated:

<UL>
	<LI>An application calls <B>SetICMMode(</B><I>hdc</I><B>,</B> ICM_ON<B>)</B>, which begins the ICM for the device context specified by <I>hdc</I>. <B>SetICMMode</B> is described in the Platform SDK documentation.</LI>

	<LI>An application or printer driver sets the <B>dmICMMethod</B> member of the DEVMODE to DMICMMETHOD_SYSTEM, DMICMMETHOD_DRIVER, or DMICMMETHOD_DEVICE. The application must do this at <B>CreateDC</B> time or by the printer driver at <B>DevEnable</B> time. If ICM is initiated this way, only device independent bitmaps (DIBs) are color corrected.</LI>
</UL>

<P>When ICM begins for a printer DC, the system checks to see if any color profiles are associated with that printer instance. If there are profiles associated, the operating system looks through each one of them to find the most appropriate profile for the current device settings as specified by the DEVMODE structure. The operating system specifically tries to match the current resolution, media type, and dithering mode to find a match. If more than one profile is found to match the current settings, the first profile is used. If no match is found or there are no profiles associated with the device instance, it uses the system supplied <B>sRGB</B> profile.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Initiating%20Image%20Color%20Management"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
