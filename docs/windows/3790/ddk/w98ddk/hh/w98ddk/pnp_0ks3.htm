<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>CONFIGMG_Lock</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="_pss_3743"></A>CONFIGMG_Lock</H3>

<PRE>CONFIGRET CONFIGMG_Lock(ULONG ulFlags)
 </PRE>

<P>Prevents Configuration Manager from sending events. 

<UL>
	<LI>Returns CR_SUCCESS if the function is successful. Otherwise, the return value can be CR_INVALID_FLAG. </LI>
</UL>

<DL>
<DT><I>ulFlags</I> </DT>

<DD>Must be zero. 
</DD>
</DL>

<P>This function increments a counting semaphore that prevents Configuration Manager from sending events. Since Configuration Manager processes events during the system task time but with interrupts disabled at the critical places, there is little need to bracket a linear piece of VxD code or an interrupt handler. </P>

<P>This function is asynchronous (that is, callable at interrupt time), reentrant, and fast. </P>

<H4>See Also</H4>

<P><B>CONFIGMG_Process_Events_Now</B>, <B>CONFIGMG_Unlock</B> </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: CONFIGMG_Lock"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
