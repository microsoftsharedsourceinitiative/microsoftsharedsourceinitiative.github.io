<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Interacting with Multimedia Device Drivers</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="_pss_2264"></A>Interacting with Multimedia Device Drivers</H2>

<P>An application that controls a multimedia driver is an integral part of the driver operation. For example, a video-capture application that doesn't use the AVICap window class allocates the memory used for audio and video capture and manages the data buffers used to transfer data. If audio is to be captured simultaneously with video, the application also controls the audio driver used for capturing the input audio. Once the video and audio drivers capture the data, the application has the responsibility for any post-processing of this data. For example, for the application to save the data as an AVI file, it must add the appropriate headers and create the AVI RIFF structure saved in the disk file. </P>

<P>Windows provides the interface between applications and device drivers - applications do not call the drivers directly. When an application calls a function, Windows translates the call into a message and sends the message to the appropriate device driver. When a device driver must notify a client of an event, it calls MMSYSTEM with a message, and MMSYSTEM routes the message back to the client application. </P>

<P>The term <I>client application</I> is sometimes used to describe the Windows interface from the device driver's perspective. The client application can include the Windows environment as well as the application that is controlling multimedia operation. </P>

<P>The following table summarizes the DLLs Windows requires to provide access to multimedia audio and video device drivers. </P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=30%>This DLL </TH>
<TH align=left width=70%>Provides an interface to these drivers </TH>
</TR>

<TR VALIGN="top">
<TD width=30%>MMSYSTEM.DLL </TD>
<TD width=70%>Waveform 
<P>MIDI </P>

<P>Auxiliary </P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=30%>MSVIDEO.DLL </TD>
<TD width=70%>Video capture, compression and decompression, rendering </TD>
</TR>

<TR VALIGN="top">
<TD width=30%>MSACM.DRV </TD>
<TD width=70%>Audio compression and decompression mapper </TD>
</TR>

<TR VALIGN="top">
<TD width=30%>MSACM.DLL </TD>
<TD width=70%>Compression and system management for the ACM </TD>
</TR>
</TABLE><BR>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Interacting%20with%20Multimedia%20Device%20Drivers"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
