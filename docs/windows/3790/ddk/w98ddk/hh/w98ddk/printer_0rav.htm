<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>GetPrinterDataFromPort</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_3987"></A>GetPrinterDataFromPort</H1>

<PRE>BOOL GetPrinterDataFromPort(
    HANDLE   hPort,
    DWORD    ControlID,
    LPTSTR   pValueName,
    LPTSTR   lpInBuffer,
    DWORD    cbInBuffer,
    LPTSTR   lpOutBuffer,
    DWORD    cbOutBuffer,
    LPDWORD  lpcbReturned
);
 </PRE>

<P>Gets data from a bidirectional printer by providing IEEE 1284 support. 

<UL>
	<LI>Returns TRUE if the operation is successful. </LI>
</UL>

<TABLE>

<TR VALIGN="top">
<TD width=24%><I>hPort</I> </TD>
<TD width=76%>The handle of the port to which the bidirectional printer is connected. </TD>
</TR>

<TR VALIGN="top">
<TD width=24%><I>ControlID</I> </TD>
<TD width=76%>Specifies the control code for the operation. </TD>
</TR>

<TR VALIGN="top">
<TD width=24%><I>pValueName</I> </TD>
<TD width=76%>Ignored by the port monitor. </TD>
</TR>

<TR VALIGN="top">
<TD width=24%><I>lpInBuffer</I> </TD>
<TD width=76%>Points to a buffer containing the data required to perform the operation. This parameter can be NULL if the <I>ControlID</I> parameter specifies an operation that does not require input data. </TD>
</TR>

<TR VALIGN="top">
<TD width=24%><I>cbInBuffer</I> </TD>
<TD width=76%>Size of the input buffer, in bytes. </TD>
</TR>

<TR VALIGN="top">
<TD width=24%><I>lpOutBuffer</I> </TD>
<TD width=76%>Points to a buffer in which to return the specified operation's output data. This parameter can be NULL if the <I>ControlID</I> parameter specifies an operation that does not produce output data. </TD>
</TR>

<TR VALIGN="top">
<TD width=24%><I>cbOutBuffer</I> </TD>
<TD width=76%>Size of the output buffer, in bytes. </TD>
</TR>

<TR VALIGN="top">
<TD width=24%><I>lpcbReturned</I> </TD>
<TD width=76%>Points to a variable that receives the actual size, in bytes, of the output data returned in the output buffer. </TD>
</TR>
</TABLE><BR>

<P>The <B>GetPrinterDataFromPort</B> function can be used to make any IEEE 1284 specification IOCTL call. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: GetPrinterDataFromPort"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
