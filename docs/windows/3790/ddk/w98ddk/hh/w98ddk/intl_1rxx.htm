<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>About SCS_CHANGEATTR</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="_pss_905"></A>About SCS_CHANGEATTR</H2>

<P>SCS_CHANGEATTR effects only attribute information. The IME should not update the composition string, the clause information of the composition string, the reading of the composition string, or the clause information of reading of the composition string. </P>

<P>First, the IME checks the new attribute to determine if it is acceptable. Second, the IME sets the new attribute in the <B>COMPOSITIONSTRING</B> structure of <I>hIMC</I>. At last, the IME generates the WM_IME_COMPOSITION message. </P>

<P>If it is necessary, IME may update the candidate information and generate the candidate messages IMN_OPENCANDIDATE, IMN_CHANGECANDIDATE, or IMN_CLOSECANDIDATE. </P>

<P>IME cannot finalize the composition string. </P>

<P>If the <I>lpRead</I> parameter of <B>ImeSetCompositionString</B> is available, the IME follows the new attribute in <I>lpRead</I>. The IME should also make a new attribute of the composition string for the current composition string. At this time, the clause information will not be changed. </P>

<P>The composition string, the attribute, the clause information, the reading string, the reading attribute, and the reading clause information must be available. The IME generates WM_IME_COMPOSITION with (GCS_COMP | GCS_COMPREAD). If the IME cannot accept the new attribute that is in <I>lpRead</I>, the IME does not need to generate any message and returns FALSE. </P>

<P>If the <B>lpComp</B> parameter of <B>ImeSetCompositionString</B> is available, the IME follows the new attribute in <I>lpComp</I>. At this time, the clause information will not change. </P>

<P>If the capability of the IME has SCS_CAP_MAKEREAD and the reading string is available, the IME should make a new attribute of the reading of the composition string for the current reading of the composition string. </P>

<P>If both <I>lpRead</I> and <I>lpComp</I> are available and if the IME can accept the new information, the IME sets the new information into the <B>COMPOSITION</B> structure of <I>hIMC</I> and generates WM_IME_COMPOSITION with (GCS_COMP | GCS_COMPREAD). </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: About%20SCS_CHANGEATTR"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
