<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>TDI_EVENT_CONNECT</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="TDI_EVENT_CONNECT">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_vxdtdi_tdi_event_connect"></A>TDI_EVENT_CONNECT</H1>

<P>The event handler for <B>TDI_EVENT_CONNECT</B> is called when an incoming connection request arrives (a SYN frame) for a local address represented by the specified address object and there is no connection in the listening state that could handle the request. The called client must indicate either acceptance or rejection of the connection by the return code from the call. If the client returns TDI_MORE_PROCESSING, the connection will be accepted. Returning any other return code will cause the connection to be rejected.</P>

<PRE class=syntax><B>TDI_STATUS
  ConnectEvent(
    PVOID  </B><I>EventContext</I><B>, </B>
<B>    uint  </B><I>AddressLength</I><B>,  </B>
<B>    PTRANSPORT_ADDRESS  </B><I>Address</I><B>, </B>
<B>    uint  </B><I>UserDataLength</I><B>, </B>
<B>    PVOID  </B><I>UserData</I><B>, </B>
<B>    uint  </B><I>OptionsLength</I><B>, </B>
<B>    PVOID  </B><I>Options</I><B>,  </B>
<B>    PVOID  *</B><I>AcceptingID</I><B>, </B>
<B>    ConnectEventInfo  *</B><I>EventInfo</I>
<B>    );</B></PRE>

<H4>Parameters</H4>

<DL>
<DT><I>EventContext </I></DT>

<DD>Context value supplied on the <B>TdiSetEvent</B> call. </DD>

<DT><I>AddressLength </I></DT>

<DD>Length in bytes of the structure pointed to by <I>Address</I>. </DD>

<DT><I>Address </I></DT>

<DD>Pointer to a <B>TRANSPORT_ADDRESS</B> structure identifying the remote peer that is attempting to connect. This structure is valid only for the duration of the call to the event handler. </DD>

<DT><I>UserDataLength</I> </DT>

<DD>Length is the length is bytes of <I>UserData</I>. This is zero for MSTCP. </DD>

<DT><I>UserData</I> </DT>

<DD>Pointer to connect data. This is NULL for MSTCP. </DD>

<DT><I>OptionsLength</I> </DT>

<DD>Length in bytes of <I>Options</I>. </DD>

<DT><I>Options</I> </DT>

<DD>Pointer to a buffer containing IP options received with the SYN. This buffer is valid only for the duration of the call to the event handler, and may be NULL. </DD>

<DT><I>AcceptingID </I></DT>

<DD>Pointer to where the called client should store the <I>ConnectionContext</I> of a connection on which to accept the incoming request, if it is to be accepted. This connection must be associated with the address object that received the connect request.</DD>

<DT><I>EventInfo</I> </DT>

<DD>Pointer to a <B>ConnectEventInfo</B> structure. The client may fill in this structure with pointers to information that the transport will use in accepting the connection, and fill in with information about the remote peer when the connect completes. If the connection is accepted, the client must minimally fill in the <B>cei_rtn</B> field to a pointer to a callback routine and set the <B>cei_acceptinfo</B> and <B>cei_conninfo</B> fields to NULL.
</DD>
</DL>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: TDI_EVENT_CONNECT"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
