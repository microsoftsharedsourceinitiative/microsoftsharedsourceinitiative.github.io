<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>NPGetPolicyPath</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_3332"></A>NPGetPolicyPath</H1>

<P>This function is used to determine the default location and filename for a policy file on a given network. The path should be one which network administrators can write to, but users cannot. The directory should also allow unvalidated connections, since policies are retrieved prior to log on. (If unvalidated connections are not available, then policies will be downloaded after user log on and not all settings will take effect immediately.) </P>

<PRE>DWORD NPGetPolicyPath(
  LPTSTR lpPath,
  LPDWORD lpBufferSize,
  DWORD dwFlags
  );
 </PRE>

<DL>
<DT><I>lpPath</I> </DT>

<DD>Points to a buffer to receive the path and filename of the policy file. This will be either in UNC or drive-relative form, whichever is supported by the network. </DD>

<DT><I>lpBufferSize</I> </DT>

<DD>This is used to specify the size of the buffer passed in. If the call fails because the buffer is not big enough, this location is used to return the required buffer size. </DD>

<DT><I>dwFlags</I> </DT>

<DD>Any combination of the following values: 

<TABLE>

<TR VALIGN="top">
<TD width=43%>GPP_LOADBALANCE </TD>
<TD width=57%>The NP should pick a load-balancing policy path if it supports it. Normally the policy path should be to a known location on a single server, but if the load-balancing flag is set and the NP has a pool of servers that it may use, it should do so. </TD>
</TR>
</TABLE><BR>

</DD>
</DL>

<UL>
	<LI>WN_SUCCESS if the call is successful. Otherwise, <B>GetLastError</B> should be called for extended error information. </LI>
</UL>

<TABLE>

<TR VALIGN="top">
<TD width=43%>WN_MORE_DATA </TD>
<TD width=57%>The buffer is too small. </TD>
</TR>
</TABLE><BR>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: NPGetPolicyPath"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
