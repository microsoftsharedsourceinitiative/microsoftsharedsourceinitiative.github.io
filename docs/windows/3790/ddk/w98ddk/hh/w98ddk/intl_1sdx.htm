<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>ImeProcessKey</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_995"></A>ImeProcessKey</H1>

<PRE>BOOL ImeProcessKey (HIMC hIMC, UINT uVirKey, DWORD lParam, 
    CONST LPBYTE lpbKeyState)
 </PRE>

<P>Preprocesses keystrokes given through IMM. </P>

<P>The return value is TRUE if a key is necessary for the IME with the given input context. Otherwise, it is FALSE. 

<DL>
<DT><I>hIMC</I> </DT>

<DD>Handle of the input context. </DD>

<DT><I>uVirKey</I> </DT>

<DD>Virtual key to be processed. </DD>

<DT><I>lParam</I> </DT>

<DD><I>lParam</I> of a key message. </DD>

<DT><I>lpbKeyState</I> </DT>

<DD>Address of a 256-byte array that contains the current keyboard state. The IME should not modify the keyboard state. 
</DD>
</DL>

<P>The system determines a key is handled by the IME by calling this function. When the function returns TRUE, the IME processes the key message before it is passed to an application. The system also calls the <B>ImeToAsciiEx</B> function. The function returns FALSE if the IME does not handle the key, in which case the system sends the key message to the target application. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: ImeProcessKey"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
