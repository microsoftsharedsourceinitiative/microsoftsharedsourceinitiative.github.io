<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>What WMI Does</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_wmi_wp_what_wmi_does"></A>What WMI Does</H1>

<P>WMI publishes information, configures device settings, and supplies event notification from device drivers. WMI is part of the Win32® Driver Model (WDM) architecture. However, it has broad utility and can be used with other types of drivers as well (such as SCSI and NDIS). WMI distributes the following data:

<UL>
	<LI><B>Published data</B><I> </I><I>—</I><I> </I>A standard set of WMI data will be built into the Windows&nbsp;2000-supplied port/class drivers.</LI>

	<LI><B>Custom data </B><I>—</I><I> </I>Provided through OEM/IHV driver extensions.</LI>

	<LI><B>Secure data</B><I> </I><I>—</I><I> </I>Provided through Windows&nbsp;NT®/Windows® 2000 security descriptors for a designated usage.</LI>

	<LI><B>Expensive data</B> (optional) <I>—</I><I> </I>Some data collection activity can significantly affect the performance of the driver. Thus, this data should only be collected when the management application specifically requests it. By default, a driver will not collect the expensive data. When a management application using WBEM expresses interest in that expensive data, WMI signals the driver to start collecting the data. WMI also keeps a reference count and signals the driver to stop collecting the data when the last WBEM application interested in that data terminates. An important point to note is that the driver writer, not WMI, decides what data is expensive to collect. The mechanism for indicating that data is expensive to collect is extremely simple. </LI>

	<LI><B>Event Notifications</B><I> </I><I>—</I><I> </I>Event notification is a key feature of WMI, allowing drivers to detect hardware events and/or errors. An event can then be passed to WBEM for corrective action based on the specific event that occurred. For example, a disk driver has an abnormally high amount of disk write/read errors, and it sends an event notification to a disk management utility. As another example, a Network Interface Card (NIC) detects the loss of the Ethernet signal and sends notification to a consumer of management data that is watching for events affecting the network.</LI>
</UL>

<P>WMI also allows a management application to configure a device, which may need to do this because of some driver-raised event or because of the data collected by the management application. </P>

<P>Note that the two key features of WMI are its extensibility and its event notification mechanism. WMI allows an IHV to extend the instrumentation data set and add value to a hardware/software solution. In addition, WMI provides a means for the driver writer to provide adequate notification of driver events. This eliminates situations where the driver detects a potentially disastrous situation and can only write an entry to the event log. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: What%20WMI%20Does"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
