<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Calculating Calibration Values</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="_pss_2728"></A>Calculating Calibration Values</H2>

<P>To calculate the base and delta calibration values, the Joystick option of Control Panel sets the base value to zero and the delta values to 1. It then polls the joystick driver while the user holds the joystick at each corner of the device coordinate space. This produces the actual value range returned by the device for each coordinate. </P>

<P>After retrieving the coordinate ranges specified by the <B>joyGetDevCaps</B> function, the Joystick option uses the following formulas to calculate new base and delta values. </P>

<PRE>wDelta = (wTargetMax - wTargetMin) / (wActualMax - wActualMin)
wBase = (wActualMin * wDelta) - wTargetMin
 </PRE>

<P>In the following example, the joystick returned <I>x</I> coordinate values in the range 43 to 345, compared to a logical value range of zero to 65535: </P>

<PRE>wDelta = (65535-0) / (345-43)
       = 216

wBase  = 43 * 216 - 0
       = 9288
 </PRE>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Calculating%20Calibration%20Values"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
