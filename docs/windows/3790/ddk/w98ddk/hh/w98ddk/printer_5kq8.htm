<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Sample Language Monitor</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_4000"></A>Sample Language Monitor</H1>

<P>This section describes the sample PJL language monitor source code shipped with the Windows 95 DDK. The source code builds an executable named PJLMON.DLL, so the sample language monitor will be called PJLMON in this section. </P>

<P>After the Windows 95 DDK is installed, the sample language monitor source code is in the \%DDKROOT%\PRINTER\SAMPLES\SPOOLER\PJLMON directory. </P>

<P>The C source code modules and their header files that make up the sample language monitor PJLMON are identified and briefly described in the following table. If you are developing a different language monitor, suggestions on how you might use each of the modules are also in the following table. Note that an object module, PARSEPJL.OBJ, is also part of the sample language monitor. This object module parses the data read from the printer, using PJL language rules. PARSEPJL.OBJ is included in the sample language monitor directory to enable you to build the language monitor. When you develop the object module that parses the printer status language your printer uses, you will have to substitute it for PARSEPJL.OBJ when you build your language monitor. </P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=41%>Source Module Name/Description </TH>
<TH align=left width=59%>Comment </TH>
</TR>

<TR VALIGN="top">
<TH align=left width=41%>PJLMON.C </TH>
<TH align=left width=59%>&nbsp;</TH>
</TR>

<TR VALIGN="top">
<TD width=41%>Contains the <B>InitializeMonitorEx</B> and <B>LibMain</B> functions and all of the functions that <B>InitializeMonitorEx</B> puts pointers to in the <B>MONITOR</B> structure. </TD>
<TD width=59%>Contains two functions, <B>CreateUstatusThread</B> and <B>UstatusThread</B>, that manage the thread that handles unsolicited responses from the printer. The <B>IsPJL</B> and <B>Find1284Key</B> that determine if the printer connected to the port is bidirectional and if it is PJL-capable. Another interesting set of functions is <B>ProcessPJLString</B>, <B>InterpretTokens</B>, and <B>ProcessParserError</B>, which are the callers of the working parser functions in PARSEPJL.C. </TD>
</TR>

<TR VALIGN="top">
<TH align=left width=41%>UTILLM.C </TH>
<TH align=left width=59%>&nbsp;</TH>
</TR>

<TR VALIGN="top">
<TD width=41%>Utility functions that provide memory allocation, string handling, semaphore management, and debugging services. </TD>
<TD width=59%>Contains a function that finds a particular <B>PINIPORT</B> structure in an array of such structures. </TD>
</TR>

<TR VALIGN="top">
<TH align=left width=41%>SPLTYPES.H </TH>
<TH align=left width=59%>&nbsp;</TH>
</TR>

<TR VALIGN="top">
<TD width=41%>Header file for PJLMON.C </TD>
<TD width=59%>Defines the <B>PINIPORT</B> structure, which the sample language monitor uses to keep track of the status of the port being monitored. You may want to change the contents of this structure. This header file also defines PP_* constants which define the bit positions in the <I>status</I> member of the <B>PINIPORT</B> structure (port is open, sending data to the printer, PJL command was sent to printer, etc.). </TD>
</TR>

<TR VALIGN="top">
<TH align=left width=41%>LOCAL.H </TH>
<TH align=left width=59%>&nbsp;</TH>
</TR>

<TR VALIGN="top">
<TD width=41%>Header file for UTILLM.C </TD>
<TD width=59%>&nbsp;</TD>
</TR>
</TABLE><BR>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Sample%20Language%20Monitor"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
