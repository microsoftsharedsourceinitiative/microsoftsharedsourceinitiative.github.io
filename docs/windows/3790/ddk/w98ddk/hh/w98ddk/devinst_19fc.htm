<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Using the API Installation Method</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="_pss_398"></A>Using the API Installation Method</H2>

<P>Under Windows 3.1, the only way other than using Control Panel to install a printer driver was for an application to modify WIN.INI directly. But under Windows 95, the printer subsystem does not get any information about an installed printer driver from WIN.INI. Windows 95 applications wishing to install their own printer driver should either: 

<UL>
	<LI>Call the necessary Win32 printing APIs (<B>AddPrinter</B>, <B>AddPrinterDriver</B>, <B>AddPrintProcessor</B>, <B>AddMonitor</B>, etc.), or </LI>

	<LI>Use the printer-specific INF file extensions provided by the Windows 95 printer installer utility. </LI>

	<LI>Launch the Add Printer Wizard using WinHelp. </LI>
</UL>

<P>The relative advantages and disadvantages of each method are summarized in the following table. </P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=33%>Installation Method </TH>
<TH align=left width=33%>Advantages </TH>
<TH align=left width=34%>Disadvantage </TH>
</TR>

<TR VALIGN="top">
<TD width=33%>Use Win32 APIs such as <B>AddPrintProcessor</B> or <B>AddMonitor</B>. </TD>
<TD width=33%>Offers flexibility, compared to the .INF file extension method. </TD>
<TD width=34%>Difficult to code and test, compared to the .INF file extension method. </TD>
</TR>

<TR VALIGN="top">
<TD width=33%>Use printer-specific .INF file extensions. </TD>
<TD width=33%>Relatively inflexible. </TD>
<TD width=34%>Easy to code and test. </TD>
</TR>
</TABLE><BR>

<P>This section describes how to use the Win32 APIs to install printer support. For information on how to use the printer-specific INF file extensions, see the section Using the Printer-Specific Windows 95 INF File Extensions. </P>

<P>The topics of printer-specific INF file extensions and using Win32® APIs in a DLL to install printer support are not completely independent. If you decide to develop a DLL to install some level of printer support, you will have to name the DLL in either a VendorSetup or VendorInstaller statement in an INF file in order for your DLL to be known by the Windows 95 printer installer. The VendorSetup and VendorInstaller printer-specific INF file extensions are described in the section Printer-Specific INF File Extensions Reference. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Using%20the%20API%20Installation%20Method"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
