<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>cCall</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_1705"></A>cCall</H1>

<PRE>include vmm.inc

cCall Procedure
cCall Procedure, Param1, Flags
cCall Procedure, &lt;Param1, Param2, Param3, ..., ParamN&gt;, Flags
 </PRE>

<P>Pushes the specified parameters on the stack and calls the specified procedure. When the procedure returns, the macro pops the parameters from the stack. 

<UL>
	<LI>The return value depends on the specified procedure. </LI>
</UL>

<DL>
<DT><I>Procedure</I></DT>

<DD>Name of the procedure to call. This parameter can be either a local or public procedure, but must be defined within the virtual device making the call. </DD>

<DT><I>Param1, Param2, Param3, ..., ParamN</I></DT>

<DD>Optional parameters to pass to the procedure. If more than one parameter is given, they must be separated with commas and enclosed in angle brackets (&lt;&gt;). </DD>

<DT><I>Flags</I></DT>

<DD>Optional parameter, that if set to the value PRESERVE_FLAGS, causes the <B>cCall</B> macro to preserve the flags register on return from the called procedure. The <B>cCall</B> macro normally changes the contents of the flags register as part of its cleanup operations. 
</DD>
</DL>

<P>This macro pushes the parameters using the C-language calling convention, in order from right to left, then removes the parameters from the stack after the procedure returns. It also assumes that the called procedure follows the C-language register conventions, viz., that the EAX, ECX, EDX, and flags registers may be modified by the call, and that the return value is placed in the EAX register (and sometimes also the EDX register). If your procedure does not follow these rules, you should not use the <B>cCall</B> macro. </P>

<H4>See Also</H4>

<P><B>VMMCall</B>, <B>VxDCall</B> </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: cCall"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
