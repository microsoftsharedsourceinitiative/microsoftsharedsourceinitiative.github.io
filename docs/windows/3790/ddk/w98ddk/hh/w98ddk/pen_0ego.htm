<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Structure of the Pen Calibration Program Source Code</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_3548"></A>Structure of the Pen Calibration Program Source Code</H1>

<P>The functional structure of the pen calibration DLL is reflected in the entry points that it exports: </P>

<PRE>EXPORTS
WEP                @1 RESIDENTNAME
CalDlg             @2
Calibrate          @3
VerifyChangesDlg   @4
ErrMsgDlg          @5
 </PRE>

<P>The pen calibration application 

<UL>
	<LI>Presents a calibration dialog to the user on the non-opaque tablet which prompts the user to touch targets displayed on the tablet. </LI>

	<LI>Uses the touch input information to fill in a DRV_CALBSTRUCT data structure for use by the pen Unidriver. </LI>

	<LI>Presents a calibration changes dialog and error message dialog to the user, if necessary. </LI>
</UL>

<P>The source modules that make up the pen calibration program source code are listed in the following table along with a description of each module. </P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=41%>Module </TH>
<TH align=left width=59%>Description </TH>
</TR>

<TR VALIGN="top">
<TD width=41%>CAL.H </TD>
<TD width=59%>General header file for PENCAL.DLL </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>CALDLG.C </TD>
<TD width=59%>Conducts the calibration dialog with the user and writes the new configuration information to the pen driver key in the Registry. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>CALERR.C </TD>
<TD width=59%>Calibration error handling routine. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>CALERR.H </TD>
<TD width=59%>Defines the error messages that can be output by PENCAL.DLL; header file for CALERR.C. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>CALINIT.C </TD>
<TD width=59%>Contains <B>LibMain</B> and <B>WEP</B> functions. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>MAKEFILE </TD>
<TD width=59%>16-bit makefile for the DLL. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>PENCAL.DEF </TD>
<TD width=59%>Definitions file. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>PENCAL.DLG </TD>
<TD width=59%>Defines the pen calibration dialog box. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>PENCAL.RC </TD>
<TD width=59%>Resources file. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>PENCAL.RCV </TD>
<TD width=59%>Contains version strings read by the operating system. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>RES.H </TD>
<TD width=59%>Resource header file for PENCAL.DLL. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>UMULDIV.ASM </TD>
<TD width=59%>Multiplies signed 16.16 by 16.16 and returns 16.16 result. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>_CALDLG.H </TD>
<TD width=59%>Dialog header file for PENCAL.DLL </TD>
</TR>
</TABLE><BR>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Structure%20of%20the%20Pen%20Calibration%20Program%20Source%20Code"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
