<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>VM_Not_Executeable</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_1800"></A>VM_Not_Executeable</H1>

<PRE>include vmm.inc

mov     ebx, VMHandle
mov     edx, Flags
mov     eax, VM_Not_Executeable
VMMCall System_Control
 </PRE>

<P>Notifies the virtual device that the virtual machine is no longer capable of executing. The system sends this message as the first phase of terminating the virtual machine. The virtual device may modify all general registers and flags. 

<UL>
	<LI>This message cannot be failed. The virtual device must return carry clear. </LI>
</UL>

<DL>
<DT><I>VMHandle</I></DT>

<DD>Handle of the virtual machine. </DD>

<DT><I>Flags</I></DT>

<DD>Reason the virtual machine is no longer executable. Can be one of these values: 

<TABLE>

<TR VALIGN="top">
<TH align=left width=20%>Value </TH>
<TH align=left width=80%>Meaning </TH>
</TR>

<TR VALIGN="top">
<TD width=20%>VNE_Crashed </TD>
<TD width=80%>Virtual machine has crashed. </TD>
</TR>

<TR VALIGN="top">
<TD width=20%>VNE_Nuked </TD>
<TD width=80%>Virtual machine was destroyed while active. </TD>
</TR>

<TR VALIGN="top">
<TD width=20%>VNE_CreateFail </TD>
<TD width=80%>Some device failed <B>Create_VM</B>. </TD>
</TR>

<TR VALIGN="top">
<TD width=20%>VNE_CrInitFail </TD>
<TD width=80%>Some device failed <B>VM_Critical_Init</B>. </TD>
</TR>

<TR VALIGN="top">
<TD width=20%>VNE_InitFail </TD>
<TD width=80%>Some device failed <B>VM_Init</B>. </TD>
</TR>
</TABLE><BR>


</DD>
</DL>

<P>When destroying a running virtual machine, the system sends this message first and never sends the <B>VM_Terminate</B> message. </P>

<P>The virtual device must <I>not</I> call the <B>Simulate_Int</B> or <B>Exec_Int</B> service in the specified virtual machine. </P>

<H4>See Also</H4>

<P><B>VM_Not_Executeable2</B>, <B>VM_Terminate</B> </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: VM_Not_Executeable"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
