<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>V86MMGR_Get_EMS_XMS_Avail</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_1945"></A>V86MMGR_Get_EMS_XMS_Avail</H1>

<P><B>Do not use this service</B>. <B>Attempting to do so may result in unexpected behavior</B>. </P>

<PRE>&lt;!--include v86mmgr.inc

mov     ebx, VMHandle
VxDcall V86MMGR_Get_EMS_XMS_Avail
mov     [LargestFreeBlockXMS], eax
mov     [AvailableEMS], ecx
mov     [TotalEMS], edx
mov     [TotalXMS], edi
 </PRE>

<P>Gets the current EMS and XMS usage information for a VM. Uses all registers except EBX, EBP, and the segment registers. 

<UL>
	<LI>Returns with the carry flag clear and these values in these registers: </LI>
</UL>

<TABLE>

<TR VALIGN="top">
<TD width=12%>EAX </TD>
<TD width=88%>Largest free XMS memory block, in kilobytes. </TD>
</TR>

<TR VALIGN="top">
<TD width=12%>ECX </TD>
<TD width=88%>Amount of available EMS memory, in units of 16 K. </TD>
</TR>

<TR VALIGN="top">
<TD width=12%>EDX </TD>
<TD width=88%>Total EMS memory size for the VM, in units of 16 K. This value does not take into account the minimum EMS limit for the VM. </TD>
</TR>

<TR VALIGN="top">
<TD width=12%>EDI </TD>
<TD width=88%>Total XMS memory size for the VM, in kilobytes. This value does not take into account the minimum XMS limit for the VM. </TD>
</TR>
</TABLE><BR>

<P class=indent1>To determine the minimum EMS and XMS limits, use the V86MMGR_Get_EMS_XMS_Limits service. </P>

<DL>
<DT>VMHandle </DT>

<DD>Handle of the VM to get the information for. 
</DD>
</DL>

<P>This service is always available for versions of V86MMGR greater than 3.1. For version 3.1, the service may or may not be available. To find out, you can attempt to hook the service using the Hook_Device_Service service. If the hook fails, the service is not available. Otherwise, the service is available, and you should unhook it by calling Hook_Device_Service again. The service is not available for versions prior to 3.1.--&gt; </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: V86MMGR_Get_EMS_XMS_Avail"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
