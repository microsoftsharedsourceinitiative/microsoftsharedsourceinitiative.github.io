<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>gdiPlaySpoolStream</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_3961"></A>gdiPlaySpoolStream</H1>

<PRE>HDC gdiPlaySpoolStream(
    LPSTR   lpszDevice,
    LPSTR   lpszOutput,
    LPSTR   lpszSpoolFile,
    DWORD   JobId,
    LPDWORD lpcbBuf,
    HDC     hDC
);
 </PRE>

<P>The Microsoft-provided GDI 32 <B>gdiPlaySpoolStream</B> function plays back a spool file or a buffer of spool data, or deletes all the EMFs of a spool file. 

<UL>
	<LI>Returns a non-NULL hDC if successful in playing back a spool file or buffer, or successfully delete all the EMFs for a spool file. If a buffer of data was played back, <I>lpcbBuf</I> contains the amount of data (number of bytes) that were actually processed. Otherwise, returns NULL upon failure. </LI>
</UL>

<TABLE>

<TR VALIGN="top">
<TD width=24%><I>lpszDevice</I> </TD>
<TD width=76%>Specifies the name of the printer that prints the document, or NULL. If NULL, <B>gdiPlaySpoolStream</B> deletes all the .TMP files whose paths are listed in the job description file specified by the <I>lpszSpoolFile</I> parameter. </TD>
</TR>

<TR VALIGN="top">
<TD width=24%><I>lpszOutput</I> </TD>
<TD width=76%>Output file name from <B>StartDoc</B>, that will be passed back into <B>StartDoc</B>. </TD>
</TR>

<TR VALIGN="top">
<TD width=24%><I>lpszSpoolFile</I> </TD>
<TD width=76%>Spool file name or a buffer of spool data depending on the value in the <I>lpcbBuf</I> parameter. </TD>
</TR>

<TR VALIGN="top">
<TD width=24%><I>JobId</I> </TD>
<TD width=76%>Identifies the print job. </TD>
</TR>

<TR VALIGN="top">
<TD width=24%><I>lpcbBuf</I> </TD>
<TD width=76%>If <I>lpcbBuf</I> is NULL, <I>lpszSpoolFile</I> is a spool file name and this parameter is not used. </TD>
</TR>

<TR VALIGN="top">
<TD width=24%>&nbsp;</TD>
<TD width=76%>If <I>lpcbBuf</I> is non-NULL, <I>lpszSpoolFile</I> is a buffer of spool data and <I>lpcbBuf</I> points to the size of the buffer. Upon return, <I>lpcbBuf</I> points to the amount of data (number of bytes) in the buffer that was processed, since the buffer may not end at a spool data block boundary. </TD>
</TR>

<TR VALIGN="top">
<TD width=24%><I>hDC</I> </TD>
<TD width=76%>If the <I>lpcbBuf</I> parameter is NULL, the <I>hDC</I> parameter is not used by the <B>gdiPlaySpoolStream</B> function. </TD>
</TR>

<TR VALIGN="top">
<TD width=24%>&nbsp;</TD>
<TD width=76%>If the <I>lpcbBuf</I> parameter is non-NULL, the <I>hDC</I> parameter specifies the handle of the DC used to play back the spool buffer. If the <I>lpcbBuf</I> parameter is non-NULL and the <I>hDC</I> parameter is NULL, the very first buffer of the job is being played and there is not a valid handle to a DC yet. </TD>
</TR>
</TABLE><BR>

<P>If <I>lpcbBuf</I> is NULL, <I>lpszSpoolFile</I> points to the file name of the spool file to playback. Otherwise, <I>lpszSpoolFile</I> is the pointer to a buffer of spool data, and <I>lpcbBuf</I> points to the size of the buffer and upon return, <I>lpcbBuf</I> points to the number of bytes that were actually sent to the printer. </P>

<P>If the <I>hDC</I> parameter is NULL, then this is the first call made to play the spool file. Otherwise, the <I>hDC</I> parameter will contain the handle of the DC that <B>gdiPlaySpoolStream</B> will use to play the remainder of the spool file. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: gdiPlaySpoolStream"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
