<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>IFSMgr_CDROM_Attach</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="_pss_4516"></A>IFSMgr_CDROM_Attach</H3>

<PRE>IFSMgr_CDROM_Attach(
 unsigned long Drive,
 unsigned long * pVRP,
 int fDoMount
 )
 </PRE>

<P>This service is used by the CD-ROM FSD while doing asynchronous operations. It indicates to the IFS manager that it has a reference to the resource so that it will not disappear while the operation is still in effect. It also has an option to not mount even if the volume needs to be mounted. This can be used by FSDs that perform asynchronous operations. 

<DL>
<DT><I>Drive</I> </DT>

<DD>Supplies the zero-based drive number of the drive the attachment needs to be done to. </DD>

<DT><I>pVRP</I> </DT>

<DD>Supplies a pointer to the variable in which the IFS manager returns the system volume handle for this drive. This handle is later used to pass requests down to the IOS. </DD>

<DT><I>fDoMount</I> </DT>

<DD>Supplies a boolean flag indicating whether a mount operation is allowed or not. A value of TRUE indicates that the mount operation can be done, if necessary. An error is returned if a mount is needed, but is not allowed. </DD>
</DL>

<UL>
	<LI>Returns zero if successful. If a mount was needed, but not allowed by the caller using the <I>fDoMount</I> flag, an error code of -1 is returned. If the mount was allowed, but there were errors mounting the drive, the appropriate error code is returned. </LI>
</UL>

<TABLE>

<TR VALIGN="top">
<TD width=34%><I>pVRP</I> </TD>
<TD width=66%>Contains the system volume handle for the specified drive on a successful return. </TD>
</TR>
</TABLE><BR>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: IFSMgr_CDROM_Attach"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
