<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>IoWMISystemControl</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_wmiguid1_iowmisystemcontrol"></A>IoWMISystemControl</H1>

<P>The <B>IoWMISystemControl</B> routine is the dispatch routine for IRP_MJ_SYSTEM_CONTROL. This routine processes all WMI requests received and forwards them if they are not for this driver. Otherwise, the routine determines if the GUID is valid and, if so, passes it to the driver-specific function for handing WMI requests. This routine may only be called at PASSIVE_LEVEL.</P>

<PRE class=syntax><B>NTSTATUS IoWMISystemControl(
    IN PWMILIB_INFO </B><I>WmiLibInfo</I><B>,</B>
<B>    IN PDEVICE_OBJECT </B><I>DeviceObject</I><B>,</B>
<B>    IN PIRP </B><I>Irp</I>
<B>    );</B>
 </PRE>

<H4>Parameters</H4>

<DL>
<DT><I>WmiLibInfo</I></DT>

<DD>WMI information control block.</DD>

<DT><I>DeviceObject</I></DT>

<DD>Supplies a pointer to the device object for this request.</DD>

<DT><I>Irp</I></DT>

<DD>Supplies the IRP making the request.
</DD>
</DL>

<H4>Return Value</H4>

<P>Returns a status code.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: IoWMISystemControl"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
