<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>INSTALLWIZARDDATA</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="INSTALLWIZARDDATA">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_224"></A>INSTALLWIZARDDATA</H1>

<P>DIF_INSTALLWIZARD class install parameters. This structure is used by class installers to extend the operation of the hardware installation wizard by adding custom pages. </P>

<PRE class=syntax>typedef struct {
  UINT  cbSize;
  LPDEVICE_INFO  lpdiOriginal;
  LPDEVICE_INFO  lpdiSelected;
  DWORD  dwFlags;
  LPVOID  lpConfigData;
  WORD  wAnalyzeResult;
  HPROPSHEETPAGE hpsDynamicPages[MAX_INSTALLWIZARD_DYNAPAGES];
  WORD  wNumDynaPages;
  DWORD  dwDynaWizFlags;
  DWORD  dwPrivateFlags;
  LPARAM  lpPrivateData;
  LPSTR  lpExtraRunDllParams;
  HWND  hwndWizardDlg;
} INSTALLWIZARDDATA;</PRE>

<H4>Members</H4>

<DL>
<DT><B>cbSize</B> </DT>

<DD>Size of the INSTALLWIZARDDATA structure. </DD>

<DT><B>lpdiOriginal</B> </DT>

<DD>Pointer to the Original DEVICE_INFO structure at the start of the manual installation. </DD>

<DT><B>lpdiSelected</B> </DT>

<DD>Pointer to the current DEVICE_INFO structure that is being manually selected. </DD>

<DT><B>dwFlags</B> </DT>

<DD>Flags that control the operation of the hardware installation wizard. There are currently none defined. </DD>

<DT><B>lpConfigData</B> </DT>

<DD>Pointer to configuration data for analysis to determine if the selected device can be installed with no conflicts. </DD>

<DT><B>wAnalyzeResult</B> </DT>

<DD>Results of analysis to determine if the device can be installed with no problems. The following values are defined: 

<TABLE>

<TR VALIGN="top">
<TD width=43%>ANALYZE_FACTDEF_OK </TD>
<TD width=57%>The device can be installed using its factory default settings. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>ANALYZE_STDCFG_OK </TD>
<TD width=57%>The device can be installed using a configuration specified in one if its basic logical configurations. The user will probably have to set jumpers or switches on the hardware to match the settings determined by the install wizard. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>ANALYZE_CONFLICT </TD>
<TD width=57%>The device cannot be installed without causing a conflict with another device. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>ANALYZE_NORESOURCES </TD>
<TD width=57%>The device does not require any resources, so it can be installed witth no conflicts. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>ANALYZE_ERROR </TD>
<TD width=57%>There was an error during analysis. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>ANALYZE_PNP_DEV </TD>
<TD width=57%>The device has at least one softsettable logical configurations, allowing it to be automatically configured. Additionally the device will be enumerated by one of the standard bus enumerators, so it does not require manual installation, except to pre-copy driver files. </TD>
</TR>
</TABLE><BR>

</DD>

<DT><B>hpsDynamicPages[MAX_INSTALLWIZARD_DYNAPAGES]</B> </DT>

<DD>An array of property sheet page handles. The class installer would use this array to create custom wizard pages, and insert their handles into this array. </DD>

<DT><B>wNumDynaPages</B> </DT>

<DD>The number of pages inserted into the hpsDynamicPages array. </DD>

<DT><B>dwDynaWizFlags</B> </DT>

<DD>Flags that control the behavior of the installation wizard when dynamic pages have been added. 

<TABLE>

<TR VALIGN="top">
<TD width=43%>DYNAWIZ_FLAG_PAGESADDED </TD>
<TD width=57%>Will be set by the install wizard if the class installer adds custom pages. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>DYNAWIZ_FLAG_INSTALLDET_NEXT </TD>
<TD width=57%>If set, the install wizard will allow going forward from the detected devices page, otherwise finish will be the default option for the detected devices page. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>DYNAWIZ_FLAG_INSTALLDET_PREV </TD>
<TD width=57%>If set, the install wizard will allow going back from the detected devices page. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>DYNAWIZ_FLAG_ANALYZE_HANDLECONFLICT </TD>
<TD width=57%>If set, the class installer will handle the case where the selected device cannot be installed because of a conflict. </TD>
</TR>
</TABLE><BR>

</DD>

<DT><B>dwPrivateFlags</B> </DT>

<DD>Flags that may be defined and used by the class installer. </DD>

<DT><B>lpPrivateData</B> </DT>

<DD>Pointer to private reference data defined and set by the class installer. </DD>

<DT><B>lpExtraRunDllParams</B> </DT>

<DD>Pointer to a string containing extra parameters passed to the hardware install rundll function. </DD>

<DT><B>hwndWizardDlg</B> </DT>

<DD>Window handle of the install wizard top level window. 
</DD>
</DL>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: INSTALLWIZARDDATA"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
