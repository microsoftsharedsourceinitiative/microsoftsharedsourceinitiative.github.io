<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>InquireEx</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="_pss_2215"></A>InquireEx</H3>

<PRE class=syntax><B>int InquireEx(
  WORD </B><I>wAction</I><B>, </B>
<B>  LPKBINFO </B><I>lpKBInfo</I><B>, </B>
<B>  int </B><I>nCount</I>
<B> );</B>
 </PRE>

<P>Sets and retrieves keyboard information. 

<UL>
	<LI>Returns a value that depends on the <I>wAction</I> parameter. </LI>
</UL>

<DL>
<DT><I>wAction</I> </DT>

<DD>Action flag. Can be one of these values: 

<TABLE>

<TR VALIGN="top">
<TH align=left width=35%>Value </TH>
<TH align=left width=65%>Meaning and return value </TH>
</TR>

<TR VALIGN="top">
<TD width=35%>INQEX_KBDINFO (1) </TD>
<TD width=65%>Retrieves keyboard information. Returns, in AX, the number of bytes copied to the buffer. </TD>
</TR>

<TR VALIGN="top">
<TD width=35%>INQEX_NLCID (2) </TD>
<TD width=65%>Retrieves the number of layouts currently in the driver. Returns the number in AX. </TD>
</TR>

<TR VALIGN="top">
<TD width=35%>INQEX_LPLCID (3) </TD>
<TD width=65%>Retrieves the list of layouts currently installed in the driver. Returns the number of layouts in in the list. </TD>
</TR>

<TR VALIGN="top">
<TD width=35%>INQEX_KEYBOARDTYPE (4) </TD>
<TD width=65%>Retrieves the keyboard type. </TD>
</TR>

<TR VALIGN="top">
<TD width=35%>INQEX_KEYBOARDSUBTYPE(5) </TD>
<TD width=65%>Retrieves the keyboard sub-type. </TD>
</TR>

<TR VALIGN="top">
<TD width=35%>INQEX_NFUNCKEYS(6) </TD>
<TD width=65%>Retrieves the number of function keys. </TD>
</TR>

<TR VALIGN="top">
<TD width=35%>INQEX_SETBASELOCALE (7) </TD>
<TD width=65%>Sets the current locale. No return value. </TD>
</TR>

<TR VALIGN="top">
<TD width=35%>INQEX_SETSYSLOCALE (8) </TD>
<TD width=65%>Sets the system locale. No return value. </TD>
</TR>
</TABLE><BR>

</DD>

<DT><I>lpKBInfo</I> </DT>

<DD>Value depends on <I>wAction</I>. Can be one of these values: 

<TABLE>

<TR VALIGN="top">
<TH align=left width=35%>Value of wAction </TH>
<TH align=left width=65%>Meaning of lpKBInfo </TH>
</TR>

<TR VALIGN="top">
<TD width=35%>INQEX_KBDINFO (1) </TD>
<TD width=65%>Address of a <B>KBINFO</B> structure that that receives the information. </TD>
</TR>

<TR VALIGN="top">
<TD width=35%>INQEX_LPLCID (3) </TD>
<TD width=65%>Address of a buffer containing an array of layout identifiers. </TD>
</TR>

<TR VALIGN="top">
<TD width=35%>INQEX_SETBASELOCALE (7) </TD>
<TD width=65%>Locale identifier. </TD>
</TR>

<TR VALIGN="top">
<TD width=35%>INQEX_SETSYSLOCALE (8) </TD>
<TD width=65%>Locale identifier </TD>
</TR>
</TABLE><BR>



<P>The <I>lpKBInfo</I> parameter is not used if <I>wAction</I> specifies any other value. 
</DD>

<DT><I>nCount</I> </DT>

<DD>Number of layout identifiers in the <I>lpKBInfo</I> buffer. This parameter is used only if <I>wAction</I> specifies INQEX_LPLCID. 
</DD>
</DL>

<P>The export ordinal for this function is 9. </P>

<P>New keyboard drivers should support both the <B>InquireEx</B> and <B>Inquire</B> functions. </P>

<H4>See Also</H4>

<P><B>Inquire</B> </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: InquireEx"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
