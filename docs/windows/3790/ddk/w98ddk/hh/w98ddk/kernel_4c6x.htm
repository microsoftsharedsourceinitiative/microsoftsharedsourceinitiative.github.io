<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>_PELDR_LoadModule</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_2009"></A>_PELDR_LoadModule</H1>

<PRE>#include &lt;vxdldr.h&gt;

LRESULT CDECL PELDR_LoadModule(PHPEMODULE  phModule, 
    PSTR pFileName, PHLIST phList);
 </PRE>

<UL>
	<LI>Loads a portable executable, performs relocation fixups and resolves imports. Uses C calling Returns PELDR_ERR_NOERROR if successful, otherwise returns a non-zero error number. Possible error return values include the following: </LI>
</UL>

<TABLE>

<TR VALIGN="top">
<TD width=44%>PELDR_ERR_FILE_UNABLETOOPEN </TD>
<TD width=56%>Unable to open the specified file. </TD>
</TR>

<TR VALIGN="top">
<TD width=44%>PELDR_ERR_MEM_NOMEMORY </TD>
<TD width=56%>Insufficient memory to complete the request. </TD>
</TR>

<TR VALIGN="top">
<TD width=44%>PELDR_ERR_IMAGE_INVALIDSIZE </TD>
<TD width=56%>Module image size is invalid. </TD>
</TR>

<TR VALIGN="top">
<TD width=44%>PELDR_ERR_IMAGE_INVALIDFORMAT </TD>
<TD width=56%>The specified file is not a valid portable executable type binary. </TD>
</TR>

<TR VALIGN="top">
<TD width=44%>PELDR_ERR_FILE_READER
<P>PELDR_ERR_FILE_READER</P>

<P>PELDR_ERR_FILE_READER</P>

<P>PELDR_ERR_FILE_READERROR </P>
</TD>
<TD width=56%>A read error occurred while loading the file. </TD>
</TR>
</TABLE><BR>

<DL>
<DT><I>phModule</I> </DT>

<DD>Address of the handle to receive the module handle on successful return. </DD>

<DT><I>pFileName</I> </DT>

<DD>Address of a null terminated string containing the path and filename to the executable. If the path is not specified, the path of the VMM32 executable is used. </DD>

<DT><I>phList</I> </DT>

<DD>Address of the list handle of export tables. This parameter is specified when a client restricts the export table list. If NULL, the global export table list is used. If the handle pointed to by phList is NULL, a new local export table list is created. 



<P class=note><B>Note</B>&nbsp;&nbsp;This function does not load modules to resolve external dependencies, instead, this function assumes that the caller is loading modules in the appropriate order to resolve dynamic link dependencies. During system initialization (up to the Init_Complete notification), <B>_PELDR_LoadModule</B> will check the V86MMGR translation buffer state and automatically allocate a temporary global V86 data area for I/O buffering if the translation buffer does not exist. 

</DD>
</DL>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: _PELDR_LoadModule"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
