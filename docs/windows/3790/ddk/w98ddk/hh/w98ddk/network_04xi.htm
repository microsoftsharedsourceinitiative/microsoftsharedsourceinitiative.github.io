<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>WNetGetUniversalName</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_3236"></A>WNetGetUniversalName</H1>

<P>This function is used to get Universal information about a network name which is referred to using a local device name. The following levels of information can be obtained about a network name. </P>

<PRE>DWORD WNetGetUniversalName (
    LPTSTR lpLocalPath,
    DWORD dwInfoLevel,
    LPVOID lpBuffer,
    LPDWORD lpBufferSize
    );
 </PRE>

<DL>
<DT><I>lpLocalPath</I> </DT>

<DD>Contains the local path to an object on a network resource. This path is drive based path. </DD>

<DT><I>dwInfoLevel </I></DT>

<DD>The level of detail of information the caller is interested in as described above. </DD>

<DT><I>lpBuffer </I>__ </DT>

<DD>Points to a buffer to receive the info the user has requested. The specific structure returned is one of those described above. </DD>

<DT><I>lpBufferSize</I> </DT>

<DD>This is used to specify the size, in bytes, of the buffer passed in. If the call fails because the buffer is not big enough, this location will be used to return the required buffer size. </DD>
</DL>

<UL>
	<LI>WN_SUCCESS if the call is successful. Otherwise, <B>GetLastError </B>should be called for extended error information. Extended error codes include: </LI>
</UL>

<TABLE>

<TR VALIGN="top">
<TD width=43%>WN_BAD_LOCALNAME </TD>
<TD width=57%><I>lpLocalName</I> is invalid </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WN_NOT_CONNECTED </TD>
<TD width=57%><I>lpLocalName</I> not a redirected device </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WN_MORE_DATA </TD>
<TD width=57%>the buffer is too small </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WN_CONNECTION_CLOSED </TD>
<TD width=57%>the device is not currently connected, but it is a remembered (persistent) connection. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WN_FUNCTION_BUSY </TD>
<TD width=57%>The router or provider is busy (possibly initializing). The caller should retry. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WN_NO_NETWORK </TD>
<TD width=57%>network is not present. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WN_NOT_SUPPORTED </TD>
<TD width=57%>This function is not supported by any of the providers. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WN_EXTENDED_ERROR </TD>
<TD width=57%>a network specific error occured. <B>WNetGetLastError</B> should be called to obtain a description of the error. </TD>
</TR>
</TABLE><BR>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: WNetGetUniversalName"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
