<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>_PageQuery</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_1264"></A>_PageQuery</H1>

<PRE>#include &lt;vmm.h&gt;

ULONG EXTERNAL _PageQuery(ULONG pbase,
    PMEMORY_BASIC_INFORMATION pmbi,     ULONG cbmbi);
 </PRE>

<P>Retrieves information about a range of virtual pages. This service carries out the work for the <B>_VirtualQuery</B> function in the Win32 API. Uses EAX, ECX, EDX and Flags. </P>

<P>Returns the count of bytes filled in return structure (0 if error) 

<DL>
<DT><I>pbase</I></DT>

<DD>Linear address of the first page in the range. This address is rounded down to the nearest page boundary. The range includes all consecutive pages starting at this address that share the following attributes: 

<UL>
	<LI>The pages share the same state: committed, reserved, or free. </LI>

	<LI>If the initial page is not free, all pages were reserved by the same call to the _PageReserve service. </LI>

	<LI>The pages share the same read and write privileges: read-only, read-write, or no access. </LI>
</UL>
</DD>

<DT><I>pmbi</I> and <I>cbmbi</I></DT>

<DD>Address of a <B>MEMORY_BASIC_INFORMATION</B> structure that receives information about the range of pages, and the size of the structure in bytes. 
</DD>
</DL>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: _PageQuery"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
