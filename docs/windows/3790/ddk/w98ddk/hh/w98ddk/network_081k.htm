<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>NPLogoff</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_3328"></A>NPLogoff</H1>

<P>This function is used to log the user off from this network. The NP has the opportunity to confirm the log off, if its effects could reach beyond those of active connections being disconnected and open files being closed (the MPR will warn about these before calling any NPs). </P>

<P>NPLogoff is also called with the same sequence when the user chooses to shut down or restart the computer. </P>

<PRE>DWORD NPLogoff(
HWND hwndOwner,
LPLOGONINFO lpAuthentInfo
DWORD dwReason
  );
 </PRE>

<DL>
<DT><I>hwndOwner</I> </DT>

<DD>A handle to a window which should be the owner for any dialog boxes or messages which the provider might display. </DD>

<DT><I>lpAuthentInfo</I> </DT>

<DD>A structure describing the currently logged-on user. </DD>

<DT><I>dwReason</I> </DT>

<DD>One of the following values: 

<TABLE>

<TR VALIGN="top">
<TD width=43%>LOGOFF_PENDING </TD>
<TD width=57%>Log off is beginning. The NP should display additional confirmations if necessary. If the user wishes to cancel the log on, the NP should return WN_CANCEL. The NP should <I>not</I> perform any logoff or cleanup operations until LOGOFF_COMMIT. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>LOGOFF_COMMIT </TD>
<TD width=57%>Log off is approved. The NP should take whatever actions necessary to log the user off. The NP may not refuse the log off at this point. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>LOGOFF_CANCEL </TD>
<TD width=57%>Passed only if this NP has been called with LOGOFF_PENDING for this log off. An NP or application has canceled the log off, so the log off is not happening after all. </TD>
</TR>
</TABLE><BR>

</DD>
</DL>

<UL>
	<LI>WN_SUCCESS if the call is successful. Otherwise, an error code is returned, which may include: </LI>
</UL>

<TABLE>

<TR VALIGN="top">
<TD width=43%>WN_CANCEL </TD>
<TD width=57%>The user wishes to cancel the log off. </TD>
</TR>
</TABLE><BR>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: NPLogoff"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
