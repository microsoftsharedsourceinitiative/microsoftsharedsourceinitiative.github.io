<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>NETINFOSTRUCT Structure</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_3248"></A>NETINFOSTRUCT Structure</H1>

<PRE>typedef struct _NETINFOSTRUCT{
    DWORD cbStructure;    
    DWORD dwProviderVersion;
    DWORD dwStatus; 
    DWORD dwCharacteristics; 
    DWORD dwHandle; 
    WORD wNetType;
    DWORD dwPrinters;
    DWORD dwDrives;
} NETINFOSTRUCT, *LPNETINFOSTRUCT;
 </PRE>

<DL>
<DT><I>cbStructure</I> </DT>

<DD>The size of the <B>NETINFOSTRUCT </B>structure in bytes. This is filled in by the caller to indicate the size of the structure passed in. Upon return, it has the size of the structure filled in. </DD>

<DT><I>dwProviderVersion</I> </DT>

<DD>The version number of the network. </DD>

<DT><I>dwStatus</I> </DT>

<DD>The current status of the network provider software. This can have one of the following values: 

<TABLE>

<TR VALIGN="top">
<TD width=43%>WN_SUCCESS </TD>
<TD width=57%>The network is up and running. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WN_NO_NETWORK </TD>
<TD width=57%>The network is not currently running. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WN_BUSY </TD>
<TD width=57%>The network is not currently able to service requests, but should become available. This usually means that the network is starting up. </TD>
</TR>
</TABLE><BR>

</DD>

<DT><I>dwCharacteristics</I> </DT>

<DD>Characteristics of the network provider software. This can have one or more of the following bit values: 

<TABLE>

<TR VALIGN="top">
<TD width=43%>NETINFO_DLL16 </TD>
<TD width=57%>The network provider is running as a 16 bit Winnet driver. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>NETINFO_DISKRED </TD>
<TD width=57%>The network provider requires a local disk drive device redirected to access server file systems. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>NETINFO_PRINTERRED </TD>
<TD width=57%>The network provider requires a local printer port redirected to access server file systems. </TD>
</TR>
</TABLE><BR>

</DD>

<DT><I>dwHandle</I> </DT>

<DD>The instance handle for the network provider or 16 bit Winnet driver for the network. </DD>

<DT><I>wNetType</I> </DT>

<DD>A network type unique to the network being run. This value is used to associate resources with a specific network when they are made persistent, or stored in links. </DD>

<DT><I>dwPrinters</I> </DT>

<DD>A bit mask indicating the valid print numbers for redirecting local printer devices, with the lowest order bit correspondinding to LPT1. A network may support more print numbers than indicated here. This mask does not take into account non-network related reasons that could stop the local printer device from being redirected (for example, having a local printer connected to the device). </DD>

<DT><I>dwDrives</I> </DT>

<DD>A 32 bit mask indicating the valid local disk devices for redirecting disk drives, with the lowest order bit correspondinding to A:. This mask does not take into account non-network related reasons that could stop the disk drive from being redirected (for example, having a RAM drive assigned to the device). </DD>
</DL>

<UL>
	<LI>WN_SUCCESS if the call is successful. </LI>
</UL>

<TABLE>

<TR VALIGN="top">
<TD width=43%>WN_BAD_PROVIDER </TD>
<TD width=57%><I>lpProvider</I> does not match any running NP. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WN_BAD_VALUE </TD>
<TD width=57%><I>cbStructure</I> is not filled in with a valid structure size. </TD>
</TR>
</TABLE><BR>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: NETINFOSTRUCT%20Structure"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
