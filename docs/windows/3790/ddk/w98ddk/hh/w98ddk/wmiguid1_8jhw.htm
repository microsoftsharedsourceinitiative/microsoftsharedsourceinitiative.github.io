<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Data Item Data Format</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="_wmiguid1_data_item_data_format"></A>Data Item Data Format</H2>

<P>WMI uses a set of standard data structures called WNODEs for passing queries, returning results from queries, and delivering events. The WNODE formats are designed to efficiently pass both tabular data of an arbitrary size and single data items. A feature of the WNODE_ALL_DATA format is the ability to quickly locate data items for individual instances within the data. Depending upon the amount of data needed, a data consumer will fill in the beginning of one of the WNODE structures and the driver will then fill in the end of the WNODE with the data requested.</P>

<P>Each WNODE format has a common header defined by WNODE_HEADER. WNODE_ALL_DATA is used to query for and return all data items for all instances of the block. WNODE_SINGLE_INSTANCE is used to query for and return all data items for a specific instance of the block. WNODE_SINGLE_ITEM is used to change the value of a single data item for a single instance of the block. </P>

<P>WMI itself maintains no additional information on the definition, content, or size of the data items other than what is stored in the WNODE and cannot interpret the data within a WNODE. Note that all strings are Unicode and are immediately preceded by a WORD that specifies the length of the string. The string does not need to be null terminated and the count does not include the null terminator. All WNODEs are aligned on an eight-byte basis. </P>

<P>WNODEs represent instance names differently, depending upon whether the data block was registered with static or dynamic instance names. WNODEs for dynamic instance name data blocks always contain the instance name strings. WNODEs for static instance name data blocks contain instance name indexes into the list of instance names that was registered for the data block. WMI sets the WNODE_FLAG_STATIC_INSTANCE_NAMES flag in the WNODE header appropriately in case the data provider does not remember how it registered its data block.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Data%20Item%20Data%20Format"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
