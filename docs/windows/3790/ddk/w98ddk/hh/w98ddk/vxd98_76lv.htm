<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>WIN32_SYSTEM_POWER_STATUS</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="WIN32_SYSTEM_POWER_STATUS">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_vxd98_win32_system_power_status"></A>WIN32_SYSTEM_POWER_STATUS</H1>

<P>The <B>WIN32_SYSTEM_POWER_STATUS</B> contains detailed information about the power supply and its status for the device.</P>

<PRE>typedef struct _WIN32_SYSTEM_POWER_STATUS {
    BYTE    W32PS_AC_Line_Status;
    BYTE    W32PS_Battery_Flag;
    BYTE    W32PS_Battery_Life_Percent;
    BYTE    W32PS_Reserved1;
    DWORD   W32PS_Battery_Life_Time;
    DWORD   W32PS_Battery_Full_Life_Time;
}   WIN32_SYSTEM_POWER_STATUS;</PRE>

<H4>Members</H4>

<DL>
<DT><B>W32PS_AC_Line_Status</B></DT>

<DD>Indicates the state of the AC power input line. The following values are provided:

<P class=indent1>APM_GPS_AC_LINE_OFFLINE</P>


<P class=indent1>APM_GPS_AC_LINE_ONLINE</P>


<P class=indent1>APM_GPS_AC_LINE_BACKUP_POWER</P>


<P class=indent1>APM_GPS_AC_LINE_UNKNOWN</P>
</DD>

<DT><B>W32PS_Battery_Flag</B></DT>

<DD>Indicates the presence of a battery and its charging state. This value may be one of the following values, or a combination:

<P class=indent1>APM_GPS_BATTERY_STATUS_HIGH</P>


<P class=indent1>APM_GPS_BATTERY_STATUS_LOW</P>


<P class=indent1>APM_GPS_BATTERY_STATUS_CRITICAL</P>


<P class=indent1>APM_GPS_BATTERY_STATUS_CHARGING</P>


<P class=indent1>APM_GPS_BATTERY_STATUS_UNKNOWN</P>


<P class=indent1>APM_GPS_BATTERY_FLAG_HIGH</P>


<P class=indent1>APM_GPS_BATTERY_FLAG_LOW</P>


<P class=indent1>APM_GPS_BATTERY_FLAG_CRITICAL</P>


<P class=indent1>APM_GPS_BATTERY_FLAG_CHARGING</P>


<P class=indent1>APM_GPS_BATTERY_FLAG_NO_BATTERY</P>


<P class=indent1>APM_GPS_BATTERY_FLAG_UNKNOWN</P>



<P>The following value is applicable to APM version 1.2 or later:


<P class=indent1>APM_GPS_BATTERY_NOT_PRESENT</P>
</DD>

<DT><B>W32PS_Battery_Life_Percent</B></DT>

<DD>Remaining expected life of the battery, in percent amount. It may also be APM_GPS_BATTERY_PERCENTAGE_UNKNOWN.</DD>

<DT><B>W32PS_Reserved1</B></DT>

<DD>Reserved. Do not use.</DD>

<DT><B>W32PS_Battery_Life_Time</B></DT>

<DD>Remaining expected life of the battery, in seconds.</DD>

<DT><B>W32PS_Battery_Full_Life_Time</B></DT>

<DD>Expected life of the battery. This value is not returned by the APM BIOS, so it is calculated by using the current battery lifetime and the percentage of battery life remaining, if available. This value may be BATTERY_LIFE_W32_UNKNOWN.</DD>
</DL>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: WIN32_SYSTEM_POWER_STATUS"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
