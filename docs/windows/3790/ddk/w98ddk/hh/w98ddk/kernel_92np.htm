<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>VMM_Remove_DDB</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_1425"></A>VMM_Remove_DDB</H1>

<PRE>include vmm.inc

mov     edi, OFFSET32 ddb
VMMCall VMM_Remove_DDB
jc      DDB_Not_Found
 </PRE>

<P>Removes a <B>Vxd_Desc_Block</B> structure (DDB or Device Description Block) from the device list. 

<UL>
	<LI>Clears the carry flag if the DDB was removed; the carry flag is set if the DDB was not found. </LI>
</UL>

<DL>
<DT><I>ddb</I></DT>

<DD>A <B>Vxd_Desc_Block</B> structure that contains the driver version numbers, the addresses of required procedures, and so on. 
</DD>
</DL>

<P>Virtual devices should call this service with extreme caution. DDBs removed in this manner are removed from the system without being given any opportunity to clean up. If you want to unload a VxD, you would be much better off using the VxD loader services than trying to manipulate the DDB list directly. Removing a DDB at a bad time destabilizes the system. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: VMM_Remove_DDB"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
