<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>POWER_STATUS</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_2081"></A>POWER_STATUS</H1>

<PRE>typedef struct _POWER_STATUS {
    BYTE PS_AC_Line_Status;
    BYTE PS_Battery_Status;
    BYTE PS_Battery_Flag;
    BYTE PS_Battery_Life_Percentage;
    WORD PS_Battery_Life_Time
} POWER_STATUS;
 </PRE>

<P>Contains information about the APM BIOS power status. With the exception of the <B>BatteryLifeTime</B> parameter, this information is structured identically to that specified in the APM 1.1 specification. 

<DL>
<DT><B>PS_AC_Line_Status</B> </DT>

<DD>AC line status. Can be 00h for off-line, 01h for on-line, or 02h for on backup power (that is, on an uninterruptible power supply). It is 0FFh if the AC status is unknown. All other values are reserved. </DD>

<DT><B>PS_Battery_Status</B> </DT>

<DD>Battery charge status. Can be 00h for high charge, 01h for low charge, 02h for critical, 03h for charging, and 0FFh for unknown status. All other values are reserved. </DD>

<DT><B>PS_Battery_Flag</B> </DT>

<DD>Battery status. Can be a combination of 01h for high charge, 02h for low charge, 04h for critical, 08h for charging, and 080h for no system battery. all other bit values are reserved. This member is 0FFh if status is unknown. </DD>

<DT><B>PS_Battery_Life_Percentage</B> </DT>

<DD>Percentage of Full Charge remaining. Can be a value in the range 0 to 100, or 0xFF if the battery life is unknown. All other values are reserved. </DD>

<DT><B>PS_Battery_Life_Time</B> </DT>

<DD>Number of seconds of battery life remaining, or 0FFFFFFFFh if the life time is unknown. 
</DD>
</DL>

<P>When <B>PS_AC_Line_Status</B> is 02h (on backup power), the power status values apply to the system's backup battery. </P>

<P>Since <B>PS_Battery_Flag</B> and <B>PS_Battery_Life_Time</B> are not supported by an APM 1.0 BIOS, VPOWERD returns 0FFh and 0FFFFFFFFh in these fields when connected to an APM 1.0 BIOS. The <B>PS_Battery_Flag</B> value should be used preferentially over the <B>PS_Battery_Status</B> value. The <B>PS_Battery_Status</B> specifies only the most recently changed status item since the last call to the BIOS power status function and therefore is supported only for backward compatibility with older systems not capable of reporting the <B>PS_Battery_Flag</B> value. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: POWER_STATUS"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
