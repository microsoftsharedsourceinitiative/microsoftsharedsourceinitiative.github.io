<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Other Pen Driver Messages</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="_pss_3466"></A>Other Pen Driver Messages</H2>

<P>The other messages the pen driver can receive are summarized in the following table. The pen driver should, at a minimum, respond to each of these messages by returning the code DRV_SUCCESS or DRV_FAILURE. </P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=41%>Message </TH>
<TH align=left width=59%>Description </TH>
</TR>

<TR VALIGN="top">
<TD width=41%>DRV_EXITSESSION </TD>
<TD width=59%>The sample pen driver ignores this message. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>DRV_EXITAPPLICATION </TD>
<TD width=59%>The sample pen driver ignores this message. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>DRV_GetCalibration </TD>
<TD width=59%>Instructs the pen driver to fill a calibration structure with the current calibration settings. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>DRV_GetName </TD>
<TD width=59%>Returns the name of the pen driver. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>DRV_GetPenSamplingRate </TD>
<TD width=59%>Returns the current sampling rate. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>DRV_GetPenInfo </TD>
<TD width=59%>Fills a specified <B>DRV_PENINFO</B> structure with the current pen information. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>DRV_GetVersion </TD>
<TD width=59%>Returns the driver version and the pen packet size. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>DRV_PenPlayBack </TD>
<TD width=59%>Performs the playback of a specified number of pen packets from an array of pen packets. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>DRV_PenPlayStart </TD>
<TD width=59%>Tells the pen driver the format of the pen packet data it will receive with the DRV_PenPlayBack message. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>DRV_PenPlayStop </TD>
<TD width=59%>Forces the pen driver out of playback mode. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>DRV_POWER </TD>
<TD width=59%>The sample pen driver ignores this message. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>DRV_Query </TD>
<TD width=59%>Returns whether or not the pen driver supports the specified message. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>DRV_RemoveEntryPoints </TD>
<TD width=59%>Removes an interrupt processing routine that was registered with a DRV_SetEntryPoints message. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>DRV_SetEntryPoints </TD>
<TD width=59%>Registers a device or DLL to receive pen information (pen packets or any other OEM-specific information) at interrupt time. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>DRV_SetPenSamplingRate </TD>
<TD width=59%>Instructs the pen hardware or software to report a specified number of points per second. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>DRV_SetPenSamplingDist </TD>
<TD width=59%>Instructs the pen driver to filter out pen packets that have not moved a specified number of tablet units from the last reported locations. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>DRV_SetCalibration </TD>
<TD width=59%>Instructs the pen drivers to calibrate the pen input to new tablet dimensions. </TD>
</TR>
</TABLE><BR>

<P>An OEM can define a list of custom messages. Custom messages must have defined values between DRV_RESERVED and DRV_USER, as set in the WINDOWS.H file. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Other%20Pen%20Driver%20Messages"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
