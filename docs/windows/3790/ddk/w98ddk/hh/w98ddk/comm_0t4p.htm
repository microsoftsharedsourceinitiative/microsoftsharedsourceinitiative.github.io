<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Initialization</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="_pss_99"></A>Initialization</H2>

<P>At load time, a port driver must register itself with VCOMM by calling the <B>_VCOMM_Register_Port_Driver</B> service. Static port drivers register when they receive the Sys_Device_Init control message. Dynamic (plug-and-play) port drivers register when they receive the Sys_Dynamic_Device_Init control message. </P>

<P>Before the <B>_VCOMM_Register_Port_Driver</B> service returns, VCOMM calls the port driver's <B>DriverControl</B> function, specifying the DC_InitializePort action. For plug-and-play port drivers, VCOMM calls the function once for each port supported by the driver. For other port drivers, VCOMM calls the function exactly once. The port driver must check for the existence of the port (or ports), and then calls the <B>_VCOMM_Add_Port</B> service. </P>

<H4>See Also</H4>

<P><B>DriverControl</B>, <B>_VCOMM_Add_Port</B>, <B>_VCOMM_Register_Port_Driver</B> </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Initialization"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
