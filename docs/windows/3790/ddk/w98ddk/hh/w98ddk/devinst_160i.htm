<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Class Install Section</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Class Install Section">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_242"></A>Class Install Section</H1>

<PRE>[ClassInstall]
AddReg=&lt;Add-registry-section&gt;[,&lt;Add-registry-section&gt;]...
Copyfiles=&lt;file-list-section&gt;[,&lt;file-list-section&gt;]...
Delfiles=&lt;File-list section&gt;[,&lt;File-list-section&gt;]...
DelReg=&lt;Del-registry-section&gt;[,&lt;Del-registry-section&gt;]...
Renfiles=&lt;File-list-section&gt;[,&lt;File-list-section&gt;]...
UpdateInis=&lt;Update-ini-section&gt;[,&lt;Update-ini-section&gt;]...
UpdateIniFields=&lt;Update-inifields-Section&gt;[,&lt;Update-inifields-section&gt;]...</PRE>

<P>Installs a new class for a device in the class section of the registry. </P>

<P>Not all the item types shown in the preceding syntax are needed or required. Typically a <B>ClassInstall</B> section will use AddReg-type items to add a class description and a class icon to the registry. These will be visible in the Windows 95 user interface. </P>

<P>In addition a class install section can specify a property provider and exert control over how the class is handled in the Windows 95 user interface. </P>

<P>Every device installed in Windows 95 has a class associated with it even if the class is UNKNOWN and every class has a class installer associated with it. </P>

<P>The installer processes the <B>ClassInstall</B> section if one of the devices defined in an INF file is about to be installed and the class is not built into Windows 95. Following is a list of the hardware class names that are built into Windows 95: 

<UL>
	<LI>CD-ROM Controllers </LI>

	<LI>Display Adapters </LI>

	<LI>Floppy disk controllers </LI>

	<LI>Hard disk controllers </LI>

	<LI>Keyboard </LI>

	<LI>Memory Technology Drivers (MTDs) </LI>

	<LI>Modem </LI>

	<LI>Mouse </LI>

	<LI>Multifunction adapters </LI>

	<LI>Network adapters </LI>

	<LI>Other devices </LI>

	<LI>PCMCIA sockets </LI>

	<LI>Ports (COM &amp; LPT) </LI>

	<LI>Printer </LI>

	<LI>SCSI Controllers </LI>

	<LI>Sound, video and game controllers </LI>

	<LI>System devices </LI>
</UL>

<P>The relative key is your class section. The Device Manager will create a class entry then you have a normal install section in here. </P>

<P>This example creates the class Sample and registers the description, installer, and icon for the class: </P>

<PRE>[ClassInstall]
Addreg=SampleClassReg
CopyFiles=@Sample.cpl

[SampleClassReg]
HKR,,,,%SampleClassDesc%
HKR,,Installer,,Sample.cpl
HKR,,Icon,HEX,00,00

[Strings]
SampleClassDesc=Sample</PRE>

<P>The following special controls over the class can be registered by adding one or more of the following items in the <B>AddReg</B>-type item referred to by the <B>ClassInstall</B> section: </P>

<PRE>HKR,,NoUseClass,,1        ;Class will not be seen anywhere
HKR,,NoInstallClass,,1    ;Class is not shown in New Device Wizard
HKR,,NoDisplayClass,,1    ;Class will not be displayed by Device Manager
HKR,,SilentInstall,,1    ;Class is installed without any user interaction
 </PRE>

<P></P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Class%20Install%20Section"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
