<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Time Stamping MIDI Input</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="_pss_2379"></A>Time Stamping MIDI Input</H2>

<P>MIDI input drivers must time-stamp incoming MIDI events. The time stamp is the number of milliseconds since MIDI input was started. </P>

<P>The MIDM_START message resets time stamps to zero. When your <B>midMessage</B> entry-point function receives a MIDM_START message, use <B>timeGetTime</B> to get a reference time stamp. Then, each time you receive an incoming MIDI event, call <B>timeGetTime</B> to get the current system time. Subtract the reference time stamp from the current system time to get a time stamp for the MIDI event. For multi-byte MIDI events, the time stamp specifies when the first byte (the MIDI status byte) was received. </P>

<P class=note><B>Note</B>&nbsp;&nbsp;If the target hardware supports time stamping, you can use its capabilities to generate time stamps more efficiently than calling the timeGetTime function. However, time stamps must still specify the time in milliseconds since MIDI input was started with the MIDM_START message. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Time%20Stamping%20MIDI%20Input"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
