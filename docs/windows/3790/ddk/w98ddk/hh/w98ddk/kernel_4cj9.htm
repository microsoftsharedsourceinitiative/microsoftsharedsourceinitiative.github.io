<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>VPowerHandlerProc</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_2075"></A>VPowerHandlerProc</H1>

<PRE>POWERRET VPowerHandlerProc(POWERFUNC PowerFunc, ULONG Flags);
 </PRE>

<P>A driver-supplied callback function that receives notifications of power management events. This function must be registered using the <B>_VPOWERD_Register_Power_Handler</B> service and must be in locked code. </P>

<P><B>This is intended for use by Configuration Manager only</B>. Virtual devices that require notification of power changes should install a message hook procedure using the <B>_SHELL_HookSystemBroadcast</B> service. 

<UL>
	<LI>Returns PR_SUCCESS if it handles the event successfully, or one of the error values beginning with PR_ listed in VPOWERD.H. </LI>
</UL>

<DL>
<DT><I>PowerFunc</I> </DT>

<DD>Power function. Can be one of these values: 

<TABLE>

<TR VALIGN="top">
<TD width=39%>PF_SUSPEND_PHASE1 </TD>
<TD width=61%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>PF_SUSPEND_PHASE2 </TD>
<TD width=61%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>PF_RESUME_PHASE2 </TD>
<TD width=61%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>PF_RESUME_PHASE1 </TD>
<TD width=61%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>PF_BATTERY_LOW </TD>
<TD width=61%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>PF_POWER_STATUS_CHANGE </TD>
<TD width=61%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>PF_UPDATE_TIME </TD>
<TD width=61%>&nbsp;</TD>
</TR>
</TABLE><BR>

</DD>

<DT><I>Flags</I> </DT>

<DD>Power flags. Can be one of these values: 

<TABLE>

<TR VALIGN="top">
<TD width=39%>PFG_UI_ALLOWED (0x00000001) </TD>
<TD width=61%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>PFG_CANNOT_FAIL (0X00000002) </TD>
<TD width=61%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>PFG_REQUEST_VETOED (0X00000004) </TD>
<TD width=61%>Indicates that the user may not be available to answer questions prior to the suspend operation. If this value is not given, higher levels of software may attempt some user interaction prior to accepting a suspend request. </TD>
</TR>

<TR VALIGN="top">
<TD width=39%>PFG_REVERSE (0x00000008) </TD>
<TD width=61%>Clear for suspend operations, set on resume. </TD>
</TR>

<TR VALIGN="top">
<TD width=39%>PFG_STANDBY (0x00000010) </TD>
<TD width=61%>Indicates a standby request when set as opposed to a suspend request. </TD>
</TR>

<TR VALIGN="top">
<TD width=39%>PFG_CRITICAL (0x00000020) </TD>
<TD width=61%>Set to notify power handlers of critical resume operations so that they may attempt to resume their clients as best as possible. Critical suspends do not reach the power handlers in order to maintain compliance with the APM 1.1 specification. </TD>
</TR>
</TABLE><BR>


</DD>
</DL>

<P>Although the callback function is called from within application time, the function must not use application-time services when interrupts are disabled. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: VPowerHandlerProc"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
