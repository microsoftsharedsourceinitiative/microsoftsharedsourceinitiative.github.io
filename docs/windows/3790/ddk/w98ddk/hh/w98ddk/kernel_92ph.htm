<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>_lstrcpyn</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_1435"></A>_lstrcpyn</H1>

<PRE>include vmm.inc

cld
VMMCall _lstrcpyn, &lt;OFFSET32 pszDst, OFFSET32 pszSrc, dwBufSize&gt; 
mov     pszDst, eax
mov     cbUnused, ecx
mov     pszNull, edx
 </PRE>

<P>Copies a zero-terminated ASCII string to a sized buffer. Uses the C calling convention. Uses EAX, ECX, EDX, and Flags. The direction flag must be clear. 

<UL>
	<LI>Returns the following information: </LI>
</UL>

<TABLE>

<TR VALIGN="top">
<TD width=13%>EAX </TD>
<TD width=87%>Address of the destination buffer. </TD>
</TR>

<TR VALIGN="top">
<TD width=13%>ECX </TD>
<TD width=87%>Number of unused bytes in the buffer, not including the terminating null character. </TD>
</TR>

<TR VALIGN="top">
<TD width=13%>EDX </TD>
<TD width=87%>Address of the terminating null byte in the destination buffer. </TD>
</TR>
</TABLE><BR>

<DL>
<DT><I>pszDst</I></DT>

<DD>Address of destination buffer. </DD>

<DT><I>pszSrc</I></DT>

<DD>Address of source buffer. </DD>

<DT><I>dwBufSize</I></DT>

<DD>Size, in bytes, of the destination buffer. Set this parameter to – 1 if the size is unlimited. 
</DD>
</DL>

<P>If the destination buffer is larger than the source string, the unused portion of the buffer is not padded with null characters. If the destination buffer is smaller than the source string (<I>dwBufSize</I> - 1), characters from the source string are copied, followed by a (premature) terminating null character. If <I>dwBufSize</I> is set to zero, no bytes are copied to the destination buffer. </P>

<P>Setting <I>pszSrc</I> to zero is equivalent to specifying a null source string. This service accesses only bytes from <I>pszSrc</I> that are copied. If the destination buffer fills before the end of the source buffer is reached, the remaining bytes of the source buffer are not accessed. </P>

<P>The source and destination buffers must not overlap. This is an asynchronous service. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: _lstrcpyn"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
