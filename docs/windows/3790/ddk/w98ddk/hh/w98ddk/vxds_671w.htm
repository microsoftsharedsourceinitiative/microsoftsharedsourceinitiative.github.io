<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Real-Mode Initialization Procedure</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_4744"></A>Real-Mode Initialization Procedure</H1>

<P>This section describes the real-mode initialization procedure for static VxDs and defines the real-mode initialization services. Real-mode initialization does not apply to dynamically loadable VxDs. </P>

<P>The VMM calls the real-mode initialization procedure once only, and then discards the segment containing the procedure. It is not possible to have a real-mode procedure that permanently remains in the virtual machine. </P>

<P>The VMM requires the real-mode initialization procedure to start at offset zero in the virtual device's real-mode initialization segment. Before calling this address, the VMM sets the CS, DS, and ES registers to the address of this segment. The VMM requires that the code or data for the procedure be defined within the real-mode segment, or in fixed memory (for example, in the ROM BIOS at segment address 40h). In general, the procedure should not attempt to access code or data outside the real-mode segment. </P>

<P>The procedure can use most ROM BIOS routines and MS-DOS system functions to examine memory and check the computer's configuration. It must not attempt to call any MS-DOS program termination function; this will hang the computer. Also, the procedure must close any files it opens before it returns to the VMM. The procedure must return to the VMM by executing a near <B>ret</B> instruction. </P>

<P>The real-mode procedure can modify all other registers except the SS:SP register pair. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Real-Mode%20Initialization%20Procedure"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
