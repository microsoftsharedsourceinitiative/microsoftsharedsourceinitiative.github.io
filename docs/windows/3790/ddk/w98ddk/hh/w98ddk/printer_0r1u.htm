<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Passing Buffers and Strings</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="_pss_3932"></A>Passing Buffers and Strings</H2>

<P>A number of the NPP functions take as parameters the address and size of a buffer to be filled with a data structure of variable size. The buffer is allocated by the caller and passed to Win32, along with a <B>DWORD</B> parameter indicating the buffer's size in bytes. In many cases, an <B>LPDWORD</B> parameter is also passed in which the called function may indicate the number of bytes of data that it retrieved. The called function should compare the size of the buffer supplied by the caller with the number of bytes retrieved. If the supplied buffer is not large enough to contain at least one complete record, the NPP function should return failure, setting the last error code to <B>ERROR_INSUFFICIENT_BUFFER</B>. </P>

<P>NPP functions should store fixed-length structures contiguously starting at the beginning of the buffer, so that simple indexing can be used to access the Nth structure in an array of structures. If the returned data includes variable-length strings, the fixed-length data structures will contain pointers to these strings. The strings themselves will be placed at the end of the buffer. Note that pointers to strings or other variable length data are actual 32-bit pointers and are not offsets into the buffer. </P>

<P>Windows 95 uses DBCS ANSI/OEM character sets. When a buffer is used to pass and return strings, the specified buffer size represents the number of bytes that will fit, and not the number of characters. This differs from Windows NT/Windows 2000, which uses Unicode and allows the number of characters to be specified. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Passing%20Buffers%20and%20Strings"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
