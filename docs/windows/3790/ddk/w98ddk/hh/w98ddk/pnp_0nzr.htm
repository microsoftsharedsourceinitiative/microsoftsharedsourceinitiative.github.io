<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>_RegCreateDynKey</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="_pss_3857"></A>_RegCreateDynKey</H3>

<PRE>VMMREGRET _RegCreateDynKey (PCHAR lpszSubKey, PVOID pvKeyContext, 
      PPROVIDER pprovHandlerInfo, PPVALUE ppvalueValueInfo, 
      DWORD cpvalueValueInfo, PVMMHKEY phkResult);
 </PRE>

<P>Creates a dynamic key. It is defined in VXDWRAPS.H. This function makes copies of <I>pprovKeyHandlerInfo</I> and <I>ppvalueValueInfo</I>. 

<UL>
	<LI>Returns ERROR_SUCCESS if the function succeeds; otherwise returns one of the error values which can be returned by <B>RegCreateKeyEx</B>. In addition if the key already exists the function will return ERROR_REGISTRY_CANNOT_CREATE. </LI>
</UL>

<DL>
<DT><I>lpszSubKey</I> </DT>

<DD>Pointer to the name of key to be created. The name is relative to HKEY_DYN_DATA. For example, suppose the new dynamic key will be HKEY_DYN_DATA\Keyname1\Keyname2. Then lpszSubKey="Keyname1\\Keyname2". The registry will create Keyname1 if it does not exist, and Keyname2. The provider will only be queried for values under the lowest level key (Keyname2). </DD>

<DT><I>pvKeyContext</I> </DT>

<DD>The key context. This is a 32-bit value that is only meaningful to the provider. It is only necessary when the same provider is handling multiple dynamic keys. If the provider is only going to handle one dynamic key, then this parameter can be NULL. </DD>

<DT><I>pprovHandlerInfo</I> </DT>

<DD>A pointer to a <B>provider_info</B> structure. </DD>

<DT><I>ppvalueValueInfo</I> </DT>

<DD>An array of Pvalue structures. There must be one structure for each value under the dynamic key to be created. </DD>

<DT><I>cpvalueValueInfo</I> </DT>

<DD>The number of structures in the <I>ppvalueValueInfo</I> array, which is equal to the number of values under this dynamic key. </DD>

<DT><I>phkResult</I> </DT>

<DD>Pointer in which the function will return the open handle of the newly created dynamic key. 
</DD>
</DL>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: _RegCreateDynKey"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
