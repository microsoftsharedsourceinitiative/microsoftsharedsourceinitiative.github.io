<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>DiRemoveDevice</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="DiRemoveDevice">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_217"></A>DiRemoveDevice</H1>

<P>Removes a device from the computer </P>

<PRE class=syntax><B>RETERR
  DiRemoveDevice(
</B>    <B>LPDEVICE</B>_<B>INFO</B>  <I>lpdi</I>
<B>    );</B></PRE>

<H4>Return Value</H4>

<P>OK</P>

<H4>Parameters</H4>

<DL>
<DT><I>lpdi</I> </DT>

<DD>Pointer to a DEVICE_INFO structure for the device to be removed. 
</DD>
</DL>

<H4>Comments</H4>

<P>This function will remove the device from the system, deleting both of its registry keys, and dynamically stopping the device if it has a Devnode. If the device cannot be dynamically stopped, then flags will be set in the lpdi-&gt;Flags field that will eventually cause the user to be prompted to shut the system down. The removal is either global to all configurations, or specific to one configuration depending on the content of the lpdi-&gt;lpClassInstallParams field. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: DiRemoveDevice"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
