<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>_RegCreateDynKey</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_1508"></A>_RegCreateDynKey</H1>

<PRE>include vmm.h

RegCreateDynKey(LPSTR lpszName, LPVOID KeyContext, PPROVIDER pInfo,
    PPVALUE pValList, DWORD dwNumVals, HKEY FAR * pKeyHandle);
 </PRE>

<P>Creates the specified registry key under HKEY_DYN_DATA. Values under HKEY_DYN_DATA are maintained by the VxDs that create them. The VMM will call the appropriate VxD's enumeration entry point when a value is enumerated or queried. 

<UL>
	<LI>Returns ERROR_SUCCESS if the function succeeds. Otherwise, an error code is returned, possibly one of the following: </LI>
</UL>

<TABLE>

<TR VALIGN="top">
<TD width=100%>ERROR_ACCESS_DENIED </TD>
</TR>

<TR VALIGN="top">
<TD width=100%>ERROR_INSUFFICIENT_MEMORY </TD>
</TR>

<TR VALIGN="top">
<TD width=100%>ERROR_CANNOT_OPEN_REGFILE </TD>
</TR>

<TR VALIGN="top">
<TD width=100%>ERROR_REGFILE_READERROR </TD>
</TR>

<TR VALIGN="top">
<TD width=100%>ERROR_REGFILE_WRITEERROR </TD>
</TR>

<TR VALIGN="top">
<TD width=100%>ERROR_REGKEY_INVALIDKEY </TD>
</TR>
</TABLE><BR>

<DL>
<DT><I>lpszName</I></DT>

<DD>Name of the key to create: </DD>

<DT><I>KeyContext</I></DT>

<DD>Four bytes of context that will be passed to the owning VxD when its enumeration entry point is called. </DD>

<DT><I>pInfo</I></DT>

<DD>Address of a <B>PROVIDER</B> structure (see vmmreg.h) that specifies the enumeration entry points for a key. </DD>

<DT><I>pValList</I></DT>

<DD>Address of an array of <B>PVALUE</B> structures (see vmmreg.h) that specify the value names and other attributes for the values under <I>lpszName</I>. </DD>

<DT><I>dwNumVals</I></DT>

<DD>Number of <B>PVALUE</B> structures in the <I>pValList</I> array. </DD>

<DT><I>pKeyHandle</I></DT>

<DD>Address of the variable to receive the handle of the newly created key, <I>lpszName</I>. 
</DD>
</DL>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: _RegCreateDynKey"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
