<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>FS_SetNamedPipeHandleState</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="_pss_4400"></A>FS_SetNamedPipeHandleState</H3>

<PRE>FS_SetNamedPipeHandleState(
 PIOREQ pir
 )
 </PRE>

<P>Information about a given named pipe handle is set through <B>FS_SetNamedPipeHandleState</B>. This routine handles the Win32 function: <B>SetNamedPipeHandleState()</B>. 

<DL>
<DT><I>ir_rh</I> </DT>

<DD>Supplies handle to local NP FS or network resource that contains the named pipe. </DD>

<DT><I>ir_fh</I> </DT>

<DD>Supplies FSD file handle of an opened named pipe. </DD>

<DT><I>ir_sfn</I> </DT>

<DD>Supplies system file number. </DD>

<DT><I>ir_options</I> </DT>

<DD>Supplies pipe mode state. 

<TABLE>

<TR VALIGN="top">
<TD width=34%><B>Pipe Mode State Values:</B> 
<P>Any combination of the following options may be specified. </P>
</TD>
<TD width=66%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TH align=left width=34%>Value </TH>
<TH align=left width=66%>Meaning </TH>
</TR>

<TR VALIGN="top">
<TD width=34%>PIPE_NOWAIT </TD>
<TD width=66%>Nonblocking mode is to be used for this handle. If not specified blocking mode will be used. </TD>
</TR>

<TR VALIGN="top">
<TD width=34%>PIPE_READMODE_MESSAGE </TD>
<TD width=66%>Read pipe as a message stream. If not specified the pipe will be read as a byte stream. </TD>
</TR>
</TABLE><BR>

</DD>

<DT><I>ir_length</I> </DT>

<DD>Supplies the length of the handle data structure. </DD>

<DT><I>ir_data</I> </DT>

<DD>Supplies an optional pointer to a handle data structure where additional handle information is placed. 

<TABLE>

<TR VALIGN="top">
<TD width=34%><B>Handle Data Structure:</B> </TD>
<TD width=66%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TH align=left width=34%>Value </TH>
<TH align=left width=66%>Meaning </TH>
</TR>

<TR VALIGN="top">
<TD width=34%><I>hd_size</I> </TD>
<TD width=66%>Supplies the maximum number of bytes that will be collected on the client machine before transferring to the server. This value will be set to NULL if the handle is for the server end of a named pipe or when the client and server applications are on the same machine. </TD>
</TR>

<TR VALIGN="top">
<TD width=34%><I>hd_timeout</I> </TD>
<TD width=66%>Supplies the collection time-out value (in milliseconds). The collection time-out is the maximum time that can pass before a remote named pipe transfers buffered information over the network. This value will be NULL if the handle is for the server end of a named pipe or when client and server applications are on the same machine. </TD>
</TR>
</TABLE><BR>



<TABLE>

<TR VALIGN="top">
<TD width=34%><I>ir_error</I> </TD>
<TD width=66%>Returns status of the operation (zero if no error, the error code otherwise). </TD>
</TR>
</TABLE><BR>

</DD>
</DL>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: FS_SetNamedPipeHandleState"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
