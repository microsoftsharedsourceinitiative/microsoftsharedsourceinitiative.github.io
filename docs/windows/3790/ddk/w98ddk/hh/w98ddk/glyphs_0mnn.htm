<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>The USB Printer Installation Process</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="_glyphs_the_usb_printer_installation_process"></A>The USB Printer Installation Process</H2>

<P>USB printer installation varies slightly over Windows 98, Windows Me, and Windows&nbsp;2000 and later. This section gives the differences between the three operating systems in the context of the general USB printer installation process.</P>

<P>Driver selection is also influenced by digital signature and the driver signing policy in effect on the system. For information, see: <I>http://whpg/hwdev/desinit/digitsign.htm</I>. </P>

<P class=proch><B><IMG SRC="../images/wedge.gif" ALT="" BORDER=0>In the USB printer installation process</B>

<OL>
	<LI>The user connects a USB printer to the PC for the first time.
<P><B>All systems</B>  The system displays the “Found New Hardware” message.
</LI>

	<LI>The kernel-mode USB print driver is loaded.
<P><B>Windows 2000</B>  On the basis of the USB printer’s compatible ID (USB class code Class_07), Setup locates the system-supplied <I>usbprint.inf</I> and uses it to load <I>usbprint.sys</I> silently. 

<P><B>Windows Me</B>  The Add Hardware Wizard appears. The user points to a vendor-supplied <I>usbprint.inf</I> or requests Windows&nbsp;Me to perform an automatic search for this file. After <I>usbprint.inf</I> is found, Setup uses it to install <I>usbprint.sys</I>.

<P><B>Windows 98</B>  The Add Hardware Wizard appears. The user points to a vendor-supplied <I>usbprint.inf</I>. After <I>usbprint.inf</I> is found, Setup uses it to install <I>usbprint.sys</I> from the vendor-supplied product media.
</LI>

	<LI>The high-level printer driver is installed.
<P><B>Windows&nbsp;2000 </B> Setup looks through <I>ntprint.inf</I> for a matching Hardware ID. If Setup finds an exact match in <I>ntprint.inf</I>, it installs the corresponding in-box driver. The user sees a message that lists the vendor name and model of the printer.

<P>Otherwise, the Add Hardware Wizard pops up again. The user points to the location of the vendor-supplied INF and driver files, which Setup uses to install the vendor-supplied printer driver.

<P><B>Windows&nbsp;Me </B> Setup looks for a matching in-box printer driver and, if it finds one, loads that driver without prompting the user.

<P>Otherwise, the Add Hardware Wizard pops up again. The user points to the location of the vendor-supplied INF and driver files, which Setup uses to install the vendor-supplied printer driver.

<P><B>Windows&nbsp;98 </B> The Add Hardware Wizard appears and prompts the user to complete installation. The default installation point is the original vendor file location. Setup uses the vendor-supplied printer INF file to install the printer driver.  
</LI>

	<LI>The printer is fully installed and ready to print.</LI>
</OL>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: The%20USB%20Printer%20Installation%20Process"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
