<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>_DCB</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="_pss_47"></A>_DCB</H3>

<PRE>include vcomm.inc

_DCB    STRUC
DCBLength       DD ?    ;size of the structure, in bytes
BaudRate        DD ?    ;see below
BitMask         DD ?    ;see below
XonLim          DD ?    ;see below
XoffLim         DD ?    ;see below
dwReserved      DW ?    ;reserved
ByteSize        DB ?    ;data bits per character (4-8)
Parity          DB ?    ;see below
StopBits        DB ?    ;see below
XonChar         DB ?    ;XON character for transmit and receive
XoffChar        DB ?    ;XOFF character for transmit and receive
ErrorChar       DB ?    ;parity-error replacement character
EofChar         DB ?    ;character used to signal the end of data
EvtChar1        DB ?    ;event-generating character
EvtChar2        DB ?    ;additional event character
bReserved       DB ?    ;reserved; do not use
RlsTimeout      DD ?    ;max. milliseconds to wait for RLSD
CtsTimeout      DD ?    ;max. milliseconds to wait for CTS
DsrTimeout      DD ?    ;max. milliseconds to wait for DSR
TxDelay         DD ?    ;milliseconds between transmission of chars
_DCB    ENDS
 </PRE>

<P>Defines the control settings for a communications resource. </P>

<H4>Members</H4>

<DL>
<DT><B>BaudRate</B> </DT>

<DD>Baud rate or baud rate index. Can be one of these values: 

<TABLE>

<TR VALIGN="top">
<TD width=33%>CBR_110 </TD>
<TD width=33%>CBR_4800 </TD>
<TD width=34%>CBR_56000 </TD>
</TR>

<TR VALIGN="top">
<TD width=33%>CBR_300 </TD>
<TD width=33%>CBR_9600 </TD>
<TD width=34%>CBR_128000 </TD>
</TR>

<TR VALIGN="top">
<TD width=33%>CBR_600 </TD>
<TD width=33%>CBR_14400 </TD>
<TD width=34%>CBR_256000 </TD>
</TR>

<TR VALIGN="top">
<TD width=33%>CBR_1200 </TD>
<TD width=33%>CBR_19200 </TD>
<TD width=34%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>CBR_2400 </TD>
<TD width=33%>CBR_38400 </TD>
<TD width=34%>&nbsp;</TD>
</TR>
</TABLE><BR>

</DD>

<DT><B>BitMask</B> </DT>

<DD>Communications options. Can be one or more of these values: 

<TABLE>

<TR VALIGN="top">
<TH align=left width=19%>Value </TH>
<TH align=left width=81%>Meaning </TH>
</TR>

<TR VALIGN="top">
<TD width=19%>fBinary </TD>
<TD width=81%>Specifies binary mode. In binary mode, the character specified by the <B>EofChar</B> field is not recognized as ending the data stream. </TD>
</TR>

<TR VALIGN="top">
<TD width=19%>fCh1Evt </TD>
<TD width=81%>Specifies that reception of the character specified by the <B>EvtChar1</B> field signals an event. </TD>
</TR>

<TR VALIGN="top">
<TD width=19%>fCh2Evt </TD>
<TD width=81%>Specifies that reception of the character specified by the <B>EvtChar2</B> field signals an event. </TD>
</TR>

<TR VALIGN="top">
<TD width=19%>fDtrDisable </TD>
<TD width=81%>Disables the DTR line. If this flag is specified, DTR is disabled when the device is opened, and remains disabled. Otherwise, DTR is enabled when the device is opened and remains enabled. </TD>
</TR>

<TR VALIGN="top">
<TD width=19%>fDtrflow </TD>
<TD width=81%>Enables DTR handshaking for input. If this flag is set, DTR is turned off when the XOFF limit is reached and is turned back on when the XON limit is reached. </TD>
</TR>

<TR VALIGN="top">
<TD width=19%>fEnqAck </TD>
<TD width=81%>Enables enquiry (ENQ)/acknowledgment (ACK) handshaking. </TD>
</TR>

<TR VALIGN="top">
<TD width=19%>fEtxAck </TD>
<TD width=81%>Enables end-of-text (ETX)/acknowledgment (ACK) handshaking. </TD>
</TR>

<TR VALIGN="top">
<TD width=19%>fInX </TD>
<TD width=81%>Enables XON/XOFF handshaking for input. If this flag is set, the XOFF character is sent when the XOFF limit is reached, and the XON character is sent when the XON limit is reached. </TD>
</TR>

<TR VALIGN="top">
<TD width=19%>fNull </TD>
<TD width=81%>Specifies that received null characters are to be discarded. </TD>
</TR>

<TR VALIGN="top">
<TD width=19%>fOutX </TD>
<TD width=81%>Enables XON/XOFF handshaking for output. If this flag is set, transmission is suspended when the XOFF character is received, and resumes when the XON character is received. </TD>
</TR>

<TR VALIGN="top">
<TD width=19%>fOutxCtsFlow </TD>
<TD width=81%>Enables CTS handshaking for output. If this flag is set, transmission is suspended whenever CTS is off. </TD>
</TR>

<TR VALIGN="top">
<TD width=19%>fOutxDsrFlow </TD>
<TD width=81%>Enables DSR handshaking for output. If this flag is set, transmission is suspended whenever DSR is off. </TD>
</TR>

<TR VALIGN="top">
<TD width=19%>fParity </TD>
<TD width=81%>Enables parity checking. </TD>
</TR>

<TR VALIGN="top">
<TD width=19%>fPeChar </TD>
<TD width=81%>Enables parity error replacement. If set, characters received with parity errors are replaced with the character specified by the <B>ErrorChar</B> field. </TD>
</TR>

<TR VALIGN="top">
<TD width=19%>fRtsDisable </TD>
<TD width=81%>Disables the RTS line. If this flag is specified, RTS is disabled when the device is opened, and remains disabled. Otherwise, RTS is enabled when the device is opened and remains enabled. </TD>
</TR>

<TR VALIGN="top">
<TD width=19%>fRtsflow </TD>
<TD width=81%>Enables RTS handshaking for input. If this flag is set, RTS is turned off when the XOFF limit is reached and is turned back on when the XON limit is reached. </TD>
</TR>
</TABLE><BR>

</DD>

<DT><B>XonLim</B> </DT>

<DD>The XON limit. If input handshaking is enabled, handshaking signals (for example, the XON character) are sent when the number of characters in the receive queue falls below this value. </DD>

<DT><B>XoffLim</B> </DT>

<DD>The XOFF limit. If input handshaking is enabled, handshaking signals (for example, the XOFF character) are sent when the number of free bytes in the receive queue falls below this value. </DD>

<DT><B>Parity</B> </DT>

<DD>The type of parity to perform on input and output: NOPARITY, ODDPARITY, EVENPARITY, MARKPARITY, or SPACEPARITY. </DD>

<DT><B>StopBits</B> </DT>

<DD>Specifies the number of stop bits: ONESTOPBIT, ONE5STOPBITS, or TWOSTOPBITS. 
</DD>
</DL>

<H4>See Also</H4>

<P><B>_VCOMM_GetCommState</B>, <B>_VCOMM_SetCommState</B> </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: _DCB"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
