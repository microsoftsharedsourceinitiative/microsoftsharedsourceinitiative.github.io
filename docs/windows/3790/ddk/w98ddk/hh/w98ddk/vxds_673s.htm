<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Service Functions</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="_pss_4758"></A>Service Functions</H2>

<P>The service functions let drivers and TSRs obtain the Windows version number, obtain the current virtual-machine (VM) identifier, set critical sections, and retrieve the addresses of the entry points for virtual-device service functions. There are the following service functions: 

<UL>
	<LI>Get Windows Installed State (Interrupt 2Fh Function 1600h) </LI>

	<LI>Get Windows Entry-Point Address (Interrupt 2Fh Function 1602h) </LI>

	<LI>Release Current VM Time-Slice (Interrupt 2Fh Function 1680h) </LI>

	<LI>Begin Critical Section (Interrupt 2Fh Function 1681h) </LI>

	<LI>End Critical Section (Interrupt 2Fh Function 1682h) </LI>

	<LI>Get Current Virtual Machine ID (Interrupt 2Fh Function 1683h) </LI>

	<LI>Get Device Entry Point Address (Interrupt 2Fh Function 1684h) </LI>

	<LI>Switch VMs and CallBack (Interrupt 2Fh Function 1685h) </LI>

	<LI>Detect Interrupt 31h Services (Interrupt 2Fh Function 1686h) </LI>
</UL>

<P>Windows issues Windows Initialization Notification (Interrupt 2Fh Function 1605h) and Windows Termination Notification (<A HREF="vxds_675j.htm">Interrupt 2Fh Function 1606h</A>). These notifications gives MS-DOS drivers and TSR programs in either Windows environment the opportunity to free extended memory before Windows starts, and reallocate the memory when Windows stops. </P>

<P>Windows also support Detect Interrupt 31h Services. Supporting these services lets MS-DOS drivers and TSR programs check for and use these service functions. </P>

<P>If the user starts a TSR program after Windows starts, the TSR program can always use Get Windows Installed State (Interrupt 2Fh Function 1600h) to determine whether Windows is running. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Service%20Functions"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
