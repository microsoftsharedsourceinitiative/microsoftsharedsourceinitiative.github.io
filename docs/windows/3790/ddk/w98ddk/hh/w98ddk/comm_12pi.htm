<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>PortOpen</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="_pss_116"></A>PortOpen</H3>

<PRE>cCall [pPortOpen], &lt;&lt;OFFSET32 PortName&gt;, VMId, &lt;OFFSET32 dwError&gt;&gt;
mov     pPortInformation, eax
 </PRE>

<P>Called by <B>_VCOMM_OpenComm</B> to open a port. Uses the C calling convention. 

<UL>
	<LI>Returns the address of a <B>_PORTINFORMATION</B> structure if successful, NULL otherwise. VCOMM specifies the address in all subsequent calls to port-driver functions for the port. </LI>
</UL>

<DL>
<DT><I>PortName</I> </DT>

<DD>Address of a null-terminated string specifying the port name, or NULL if the port should be opened by number. </DD>

<DT><I>VMId</I> </DT>

<DD>Handle of the virtual machine (VM) that owns the port. </DD>

<DT><I>dwError</I> </DT>

<DD>Address of a 32-bit value that receives an error code if the return value is NULL. This parameter is ignored if the return value is not NULL. 
</DD>
</DL>

<P>A port driver should call the <B>_VCOMM_Acquire_Port</B> service to block access to the port when this function is called. If the service fails, the port is already in use and the port driver should not attempt to open it. </P>

<P>The communications resource handle returned by <B>_VCOMM_OpenComm</B> is not necessarily the same as the address returned by this function. </P>

<H4>See Also</H4>

<P><B>_PORTINFORMATION</B>, <B>_VCOMM_Acquire_Port</B>, <B>_VCOMM_OpenComm</B> </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: PortOpen"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
