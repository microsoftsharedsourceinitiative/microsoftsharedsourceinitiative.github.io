<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>The USB Printer Installation Process</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="The USB Printer Installation Process">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="ddk_the_usb_printer_installation_process_me"></A>The USB Printer Installation Process</H2>

<P>USB printer installation varies slightly over Windows 2000, Windows Me, and Windows 98. This section gives the differences between the three operating systems in context of the general USB printer installation process. </P>

<P>For information about how Windows ranks drivers and selects the preferred driver to load, see "How Does Setup Select a Driver For a Device?" in the Windows 2000 DDK. This information also applies to Windows 98/Me. Driver selection is also influenced by digital signature and the driver signing policy in effect on the system. For information, see: http://whpg/hwdev/desinit/digitsign.htm 

<OL>
	<LI>The user connects a USB printer to the PC for the first time. 
<P><B>All systems.</B> The system displays the "Found New Hardware" message. 
</LI>

	<LI>The kernel-mode USB print driver is loaded. 
<P><B>Windows 2000</B>. On the basis of the USB printer's compatible ID (USB class code Class_07), Setup locates the system-supplied Usbprint.inf and uses it to load Usbprint.sys silently. 

<P><B>Windows Me.</B> The Add Hardware Wizard appears. The user points to a vendor-supplied Usbprint.inf or requests Windows Me to perform an automatic search for this file. After Usbprint.inf is found, Setup uses it to install Usbprint.sys. 

<P><B>Windows 98.</B> The Add Hardware Wizard appears. The user points to a vendor-supplied Usbprint.inf. After Usbprint.inf is found, Setup uses it to install Usbprint.sys from the vendor-supplied product media. 
</LI>

	<LI>The high-level printer driver is installed. 
<P><B>Windows 2000.</B> Setup looks through Ntprint.inf for a matching Hardware ID. If Setup finds an exact match in Ntprint.inf, it installs the corresponding in-box driver. The user sees a message that lists the vendor name and model of the printer. 

<P>Otherwise, the Add Hardware Wizard pops up again. The user points to the location of the vendor-supplied INF and driver files, which Setup uses to install the vendor-supplied printer driver. 

<P><B>Windows Me.</B> Setup looks for a matching in-box printer driver and, if it finds one, loads that driver without prompting the user. Otherwise, the Add Hardware Wizard pops up again. The user points to the location of the vendor-supplied INF and driver files, which Setup uses to install the vendor-supplied printer driver. 

<P><B>Windows 98.</B> The Add Hardware Wizard appears and prompts the user to complete installation. The default installation point is the original vendor file location. Setup uses the vendor-supplied printer INF file to install the printer driver. 
</LI>

	<LI>The printer is fully installed and ready to print. </LI>
</OL>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: The%20USB%20Printer%20Installation%20Process"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
