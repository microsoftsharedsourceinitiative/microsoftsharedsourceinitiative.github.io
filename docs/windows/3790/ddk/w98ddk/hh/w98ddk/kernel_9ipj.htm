<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Virtual-Device (VxD) Loader</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_1977"></A>Virtual-Device (VxD) Loader</H1>

<P>A dynamically loadable VxD can be loaded and unloaded at any time. (By contrast, static VxDs can be loaded only when the system is initialized and cannot be unloaded.) A dynamically loadable VxD can be loaded by another VxD using the services provided by the dynamic VxD loader (VXDLDR), by a 16-bit, ring-3 application using protected- and virtual-86 mode API, or by a Win32 application using the <B>DeviceIOControl</B> function. For more information about <B>DeviceIOControl</B>, see the <I>Guide to Programming Windows 95</I>. </P>

<P>Dynamically loaded VxDs are new for this release of Windows. Dynamically loadable VxDs are useful when a VxD is needed only once, because when it is no longer needed it can be unloaded. If a device monopolizes many system resources but is used rarely or intermittently, the VxDs could be loaded and unloaded again whenever required. (Networks are a good example of this.) If a VxD is required to temporarily modify the capabilities of a device, it can be loaded and used without forcing the user to restart their computer. In addition, the Plug and Play architecture is dependent on dynamically loadable VxDs. When the system starts, it determines what devices are present, then uses the VxD loader to load VxDs for those devices. The protected-mode block-device driver model (Dragon) also requires dynamically loadable VxDs. </P>

<P>Dynamically loadable VxDs use the same file format as static VxDs. VxDs are labeled as dynamically loadable by using the module flags. The real-mode VxD loader accepts both static and dynamically loadable VxDs; this allows a VxD binary file to be both dynamically loadable and static. The VxD loader (VXDLDR) loads only VxDs that are marked as dynamically loadable. </P>

<P>Applications can use the <B>VXDLDR_LoadDevice</B> service to load a dynamically loadable VxD and the <B>VXDLDR_UnloadDevice</B> service to unload one. The <B>VXDLDR_GetVersion</B> service retrieves the version number of VXDLDR. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Virtual-Device%20(VxD)%20Loader"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
