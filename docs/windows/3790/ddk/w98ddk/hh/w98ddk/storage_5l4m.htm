<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>File Date and Time Formats</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="_pss_4086"></A>File Date and Time Formats</H2>

<P>There are two date and time formats used by the Win32 and INT 21h APIs. The DOS time format is used in the INT 21h APIs. The date and time are stored as bit fields in a DWORD. </P>

<P>The hour, minute, and second are stored in the low-order word in the following format: </P>

<PRE>    +---------------+---------------+
    |H|H|H|H|H|M|M|M|M|M|M|S|S|S|S|S|
    +---------------+---------------+
    15                             0
 </PRE>

<P>Where "H" is the hour (zero through 23), "M" is the minute (zero through 59), and "S" is the number of seconds divided by 2. For the new Create Time APIs, additional precision has been added by specifying the 10 millisecond remainder in the 2-second interval that the DOS time format provides for. This remainder can be a value between zero and 199. </P>

<P>The year, month, and day are stored in the high-order word in the following format: </P>

<PRE>    +---------------+---------------+
    |Y|Y|Y|Y|Y|Y|Y|M|M|M|M|D|D|D|D|D|
    +---------------+---------------+
    15                             0
 </PRE>

<P>Where "Y" is the year minus 1980, "M" is the month (1 = January, 2 = February, etc.), and "D" is the day of the month (1 through 31). </P>

<P>The Win32 time format is used by the Win32 APIs. The date and time is stored in a 64-bit value that represents the number of 100 nanoseconds since January 1st, 1601. This date was chosen because it is 400 years prior to the start of a new century. At 100ns resolution 32 bits is good for about 429 seconds (or 7 minutes) and a 63-bit integer is good for about 29,247 years. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: File%20Date%20and%20Time%20Formats"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
