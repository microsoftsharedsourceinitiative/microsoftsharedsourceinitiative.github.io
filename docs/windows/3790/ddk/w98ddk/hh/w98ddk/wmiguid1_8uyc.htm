<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>IoWMICompleteRequest</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_wmiguid1_iowmicompleterequest"></A>IoWMICompleteRequest</H1>

<P>The <B>IoWMICompleteRequest</B> routine completes a WMI IRP. Depending on the WMI request, this routine will fix the returned WNODE appropriately.</P>

<PRE class=syntax><B>NTSTATUS IoWMICompleteRequest(
    IN PWMILIB_INFO </B><I>WmiLibInfo</I><B>,</B>
<B>    IN PDEVICE_OBJECT </B><I>DeviceObject</I><B>,</B>
<B>    IN PIRP </B><I>Irp</I><B>,</B>
<B>    IN NTSTATUS </B><I>Status</I><B>,</B>
<B>    IN ULONG </B><I>BufferUsed</I><B>,</B>
<B>    IN CCHAR </B><I>PriorityBoost</I>
<B>    );</B>
</PRE>

<H4>Parameters</H4>

<DL>
<DT><I>WmiLibInfo</I></DT>

<DD>WMI information control block.</DD>

<DT><I>DeviceObject</I></DT>

<DD>Supplies a pointer to the device object for this request.</DD>

<DT><I>Irp</I></DT>

<DD>Supplies the IRP making the request.</DD>

<DT><I>Status</I></DT>

<DD>Return status code for the IRP</DD>

<DT><I>BufferUsed</I></DT>

<DD>Number of bytes needed by the device to return the data requested in any query. In the case that the buffer passed to the device is too small, this has the number of bytes needed for the return data. If the buffer passed is large enough, then this has the number of bytes actually used by the device.</DD>

<DT>PriorityBoost</DT>

<DD>Value used for the <B>IoCompleteRequest</B> call.</DD>
</DL>

<H4>Return Value</H4>

<P>Returns a status code.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: IoWMICompleteRequest"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
