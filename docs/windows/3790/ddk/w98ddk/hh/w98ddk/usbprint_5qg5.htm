<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Introduction</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Introduction">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_introduction_me"></A>Introduction</H1>

<P>Microsoft® Windows® 2000 and Windows Millennium Edition (Windows Me) supply a general kernel-mode USB print driver, Usbprint.sys, which works with the system-supplied port monitor Usbmon.dll to provide end-to-end connectivity between USB printers and high-level printer drivers. Together these components make up the Microsoft USB printing solution. </P>

<P>Vendors are encouraged to write high-level printer drivers that rely on Usbprint.sys rather than writing their own kernel-mode USB print drivers. Printer vendors can now redistribute Usbprint.sys and Usbmon.dll for installation on Windows 98 and Windows 98 Second Edition, making their Windows Me printing solutions backward-compatible with Windows 98. For information, contact Microsoft at USBWinPrint@microsoft.com </P>

<P>Usbprint.sys greatly simplifies the task of writing a high-level printer driver: 

<UL>
	<LI>Usbprint.sys handles kernel-mode operations such as power management on behalf of the high-level printer driver. </LI>

	<LI>Usbprint.sys provides an interface very similar to that used by parallel printers, so it is possible for a single printer driver to work correctly on both USB and parallel port, without modification. </LI>

	<LI>Usbprint.sys has been extensively tested with numerous printers, dongles, PCs, and mobile systems on the Windows 2000 operating system. </LI>
</UL>

<P>For maximum cross-platform compatibility, vendor-supplied printer drivers should not depend on proprietary device-control commands or any parallel port IOCTLs except for IOCTL_PAR_QUERY_DEVICE_ID. A printer driver that follows these guidelines can drive printers over both USB and parallel port on Microsoft Windows 2000, Windows 98, Windows 98 Second Edition, and Windows Me operating systems. </P>

<P>Procedures for writing a printer driver are described in the Windows 2000 DDK and Windows 98 DDK. If such a driver is correctly implemented as described in the DDK, the driver should "just work," because the printer driver installation mechanisms are the same on all three operating systems, over any bus. For a list of references, see the end of this article. </P>

<P class=note><B>Note</B>&nbsp;&nbsp;Usbprint.sys and Usbmon.dll work together to simplify the task of writing a vendor-supplied language monitor. If a language monitor uses only the WritePort, ReadPort, and IOCTL_PAR_QUERY_DEVICE_ID interfaces, it will be portable between USB and parallel port. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Introduction"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
