<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>PPChangePassword</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_3372"></A>PPChangePassword</H1>

<P>This function is used to inform the password provider that the user wishes to change the password for this provider. </P>

<PRE>DWORD PPChangePassword(
LPLOGONINFO lpAuthentInfo,
LPLOGONINFO lpPreviousAuthentInfo
DWORD dwAction
    );
 </PRE>

<DL>
<DT><I>lpAuthentInfo</I> </DT>

<DD>A structure specifying the logged-on user's name and new password. </DD>

<DT><I>lpPreviousAuthentInfo</I> </DT>

<DD>A structure specifying the user's name and old password. </DD>

<DT><I>dwAction</I> </DT>

<DD>One of the following values: 

<TABLE>

<TR VALIGN="top">
<TD width=43%>PWDCHANGE_MASTERPWD_NOTIFY </TD>
<TD width=57%>The Windows password has changed. The provider may wish to take some action, such as giving the new password to a network redirector. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>PWDCHANGE_PROVIDERPWD_PENDING </TD>
<TD width=57%>The user wants to change a password maintained by the provider. This message is a first-phase notification. The provider should not change the password at this time. The provider should do any pre-commit verification that is appropriate, such as pinging a server or checking that the old password is valid, if possible. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>PWDCHANGE_PROVIDERPWD_COMMIT </TD>
<TD width=57%>Commit-phase notification, the provider should change the password in response to this message. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>PWDCHANGE_PROVIDERPWD_CANCEL </TD>
<TD width=57%>A provider will receive this message if it has already received a first-phase notification (PWDCHANGE_PROVIDERPWD_ PENDING) and the password-change action has been canceled (for example, in response to another provider being unable to change its password). </TD>
</TR>
</TABLE><BR>

</DD>
</DL>

<UL>
	<LI>WN_SUCCESS if the call is successful. </LI>
</UL>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: PPChangePassword"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
