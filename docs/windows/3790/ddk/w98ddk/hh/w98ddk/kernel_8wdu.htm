<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>_PageGetSizeAddr</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_1232"></A>_PageGetSizeAddr</H1>

<PRE>include vmm.inc

VMMCall _PageGetSizeAddr, &lt;hMem, flags&gt;

test    eax, eax            ; returns zero if error

mov     [Pages], eax        ; number of pages in memory block
mov     [Address], edx      ; ring-0 linear address of memory block
 </PRE>

<P>Returns the size and linear address of a memory block. Uses EAX, ECX, EDX, and Flags. </P>

<P>Returns the number of pages in the memory block in the EAX register. For compatibility with Windows 3.1, the ring-0 linear address of the memory block is returned in the EDX register. Both registers are zero if an error occurs. (Under Windows 95, handles and addresses are the same, so the return value in EDX is relatively meaningless.) 

<DL>
<DT><I>hMem</I></DT>

<DD>Base linear address of the memory block for which to return information. This parameter may be a handle returned by the <B>_PageAllocate</B> or <B>_PageReAllocate</B> service, or may be a linear address returned by the <B>_PageReserve</B> service. </DD>

<DT><I>flags</I></DT>

<DD>Operation flags. Must be zero. 
</DD>
</DL>

<P>The return value specifies the number of reserved pages for the memory block, which may be greater than the number of committed pages. For example, if the <B>_PageReAllocate</B> service is used to reduce the size of a memory block, the number of virtual pages reserved for that block may remain unchanged. </P>

<H4>See Also</H4>

<P><B>_PageAllocate</B>, <B>_PageReAllocate</B> </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: _PageGetSizeAddr"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
