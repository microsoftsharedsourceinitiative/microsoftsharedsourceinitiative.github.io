<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>SHELL_SYSMODAL_Message</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_2095"></A>SHELL_SYSMODAL_Message</H1>

<PRE>include shell.inc
mov ebx, Handle            ; virtual machine handle
mov eax, Flags             ; message box flags
mov ecx, OFFSET32 Message  ; address of message
mov edi, OFFSET32 Caption  ; address of caption
VxDcall SHELL_SYSMODAL_Message

mov [Response], eax        ; response code from message box
 </PRE>

<P>Displays a system modal message box in the Windows shell. Uses EAX and Flags. 

<UL>
	<LI>Returns the response code from the message box in the EAX register. A response code can be one of the ID symbols defined in the SHELL.INC file. </LI>
</UL>

<DL>
<DT><I>Handle</I> </DT>

<DD>Specifies the handle of the virtual machine responsible for the message. </DD>

<DT><I>Flags</I> </DT>

<DD>Specifies the message box flags. See the MB_ symbols in the SHELL.INC file. The MB_SYSTEMMODAL value must be given. </DD>

<DT><I>Message</I> </DT>

<DD>Address of a null-terminated string specifying the message text. </DD>

<DT><I>Caption</I> </DT>

<DD>Address of a null-terminated string specifying the caption text. If this parameter is zero, the service uses the standard caption. If this parameter points to an empty string, the message box has no caption. 
</DD>
</DL>

<P>The strings pointed to by the ECX and EDI registers must remain valid until <B>SHELL_Sysmodal_Message</B> returns. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: SHELL_SYSMODAL_Message"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
