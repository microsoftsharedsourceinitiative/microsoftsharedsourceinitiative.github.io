<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>MatchBasisName</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="_pss_4480"></A>MatchBasisName</H3>

<PRE>MatchBasisName(
 string_t pBasisName,
 string_t pName
 )
 </PRE>

<P>This service compares two FCB-format Unicode strings. One string is the "basis" name created from a long-name using the CreateBasis service. The other is a the FCB-format name retrieved from the OEM directory entry and converted to Unicode by calling the BCSToUni service. The basis and the name are then "matched”. This matching is different from normal matching. The name retrieved from the media could have a numeric tail on the primary name if it was an auto-generated name. This service compares the part of the primary name without the numeric tail and the extension of the directory name to the corresponding parts of the basis name. If there is a match, then the basis name is considered to match the directory name.</P>

<P>This helps during auto-generation of a unique name with a numeric tail. Instead of sequentially generating a name with increasing values for the numeric tail and searching the entire directory for each generated name to check if it is unique, the entire directory can be walked once looking for a match with the basis name. Any number that does not already exist as a numeric tail for the matched primary name can now be used as a numeric tail for the basis name without checking further for uniqueness. While this scheme may not generate the most accurate numeric tail for a given basis name, it is certainly far more efficient than scanning the directory for each auto-generated name. 

<DL>
<DT><I>pBasisName</I> </DT>

<DD>Supplies a pointer to the basis name in FCB Unicode format that needs to be matched. </DD>

<DT><I>pName</I> </DT>

<DD>Supplies a pointer to the directory name in FCB Unicode format that needs to be matched with the basis name. </DD>
</DL>

<UL>
	<LI>Returns the value of the numeric tail on the directory name passed in. A value of zero means the basis name and the directory name do not match. A value of -1 indicates that the basis name and the directory name match, but there was no numeric tail on the directory name. Any other value is the value of the numeric tail on the directory name. The values for the numeric tail can range from 1 to 9999999. </LI>
</UL>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: MatchBasisName"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
