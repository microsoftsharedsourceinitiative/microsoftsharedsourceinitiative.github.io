<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Required Command Messages for All Drivers</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="_pss_2520"></A>Required Command Messages for All Drivers</H2>

<P>The following table summarizes the messages that correspond to the required command messages an application can send to your device driver. Your device driver must support all of these command messages. </P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=26%>MCI Message </TH>
<TD width=74%>Description </TD>
</TR>

<TR VALIGN="top">
<TD width=26%>DRV_CLOSE (MCI_CLOSE_DRIVER) </TD>
<TD width=74%>Closes the device. MCI translates the MCI_CLOSE sent by an application into the MCI_CLOSE DRIVER and DRV_CLOSE messages it sends to your device driver. </TD>
</TR>

<TR VALIGN="top">
<TD width=26%>DRV_OPEN (MCI_OPEN_DRIVER) </TD>
<TD width=74%>Initializes the device. MCI translates the MCI_OPEN message sent by an application into the DRV_OPEN and MCI_OPEN_DRIVER messages it sends to your device driver. </TD>
</TR>

<TR VALIGN="top">
<TD width=26%>MCI_GETDEVCAPS </TD>
<TD width=74%>Obtains information about the capabilities of the device. </TD>
</TR>

<TR VALIGN="top">
<TD width=26%>MCI_INFO </TD>
<TD width=74%>Obtains information from a device driver. </TD>
</TR>

<TR VALIGN="top">
<TD width=26%>MCI_STATUS </TD>
<TD width=74%>Returns status information from the device driver. </TD>
</TR>
</TABLE><BR>

<P>The following table identifies the flags and structures of the required MCI command messages: </P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=26%>MCI Command</TH>
<TH align=left width=37%>Command Flags</TH>
<TH align=left width=37%>Structure </TH>
</TR>

<TR VALIGN="top">
<TD width=26%>DRV_CLOSE</TD>
<TD width=37%>&nbsp;</TD>
<TD width=37%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=26%>DRV_OPEN</TD>
<TD width=37%>&nbsp;</TD>
<TD width=37%>MCI_OPEN_DRV_PARMS </TD>
</TR>

<TR VALIGN="top">
<TD width=26%>MCI_CLOSE_DRIVER</TD>
<TD width=37%>MCI_NOTIFY
<P>MCI_WAIT</P>

<P>MCI_TEST</P>
</TD>
<TD width=37%>MCI_GENERIC_PARMS </TD>
</TR>

<TR VALIGN="top">
<TD width=26%>MCI_GETDEVCAPS</TD>
<TD width=37%>MCI_GETDEVCAPS_ITEM
<P>MCI_NOTIFY</P>

<P>MCI_WAIT</P>

<P>MCI_TEST</P>
</TD>
<TD width=37%>MCI_GETDEVCAPS_PARMS </TD>
</TR>

<TR VALIGN="top">
<TD width=26%>MCI_INFO </TD>
<TD width=37%>MCI_INFO_PRODUCT 
<P>MCI_WAIT </P>

<P>MCI_NOTIFY </P>

<P>MCI_TEST </P>
</TD>
<TD width=37%>MCI_INFO_PARMS </TD>
</TR>

<TR VALIGN="top">
<TD width=26%>MCI_OPEN_DRIVER </TD>
<TD width=37%>MCI_OPEN_ALIAS 
<P>MCI_OPEN_ELEMENT </P>

<P>MCI_OPEN_ELEMENT_ID </P>

<P>MCI_OPEN_SHAREABLE </P>

<P>MCI_OPEN_TYPE </P>

<P>MCI_OPEN_TYPE_ID </P>

<P>MCI_NOTIFY </P>

<P>MCI_WAIT </P>

<P>MCI_TEST </P>
</TD>
<TD width=37%>MCI_OPEN_PARMS 
<P>MCI_ANIM_OPEN_PARMS </P>

<P>MCI_OVLY_OPEN_PARMS </P>

<P>MCI_WAVE_OPEN_PARMS </P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=26%>MCI_STATUS </TD>
<TD width=37%>MCI_STATUS_ITEM 
<P>MCI_STATUS_START </P>

<P>MCI_NOTIFY </P>

<P>MCI_WAIT </P>

<P>MCI_TEST </P>
</TD>
<TD width=37%>MCI_STATUS_PARMS </TD>
</TR>
</TABLE><BR>

<P>Your device driver might create extended commands by adding new flags and structure members to those already defined. When you extend a command message, your device driver must still support the required flags and members. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Required%20Command%20Messages%20for%20All%20Drivers"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
