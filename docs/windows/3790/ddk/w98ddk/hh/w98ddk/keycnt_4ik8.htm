<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>MapVirtualKeyEx</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="_pss_2218"></A>MapVirtualKeyEx</H3>

<PRE class=syntax><B>int MapVirtualKeyEx(
  WORD </B><I>wCode</I><B>, </B>
<B>  WORD </B><I>wMapType</I><B>, </B>
<B>  DWORD </B><I>lcid</I>
<B> );</B>
</PRE>

<P>Maps scan codes to virtual-key codes, and virtual-key codes to either scan codes or ANSI character. The mapping is based on the specified locale. This function is intended to be used by the Program Information File (PIF) Editor and Windows to get information about keyboard mapping. 

<UL>
	<LI>Returns, in AX, a nonzero scan code or virtual-key code, if successful. Returns zero if mapping cannot be performed. </LI>
</UL>

<DL>
<DT><I>wCode</I> </DT>

<DD>Input scan code or virtual-key code. </DD>

<DT><I>wMapType</I> </DT>

<DD>Mapping to carry out. Can be one of these values. 

<TABLE>

<TR VALIGN="top">
<TH align=left width=8%>Value </TH>
<TH align=left width=92%>Meaning </TH>
</TR>

<TR VALIGN="top">
<TD width=8%>0 </TD>
<TD width=92%>Map virtual key to scan code. </TD>
</TR>

<TR VALIGN="top">
<TD width=8%>1 </TD>
<TD width=92%>Map scan code to virtual key. </TD>
</TR>

<TR VALIGN="top">
<TD width=8%>2 </TD>
<TD width=92%>Map virtual key to ASCII character. </TD>
</TR>
</TABLE><BR>

</DD>

<DT><I>lcid</I> </DT>

<DD>Layout identifier. This must be a valid identifier as passed to the driver via the <B>NewtableEx</B> function. 
</DD>
</DL>

<P>The export ordinal for this function is 12. </P>

<P>For the first two mappings, the scan code to virtual-key code translation table is examined to determine the translations. Some valid codes may not be translated in this table. </P>

<P>For the third type of mapping, uppercase letters A through Z are returned for VK_A through VK_Z. ASCII characters are returned for the top-row numeric keys VK_0 through VK_9. For punctuation and dead keys in the main part of the keyboard, the unshifted character will be returned. </P>

<H4>See Also</H4>

<P><B>NewTableEx</B> </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: MapVirtualKeyEx"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
