<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>ICM-Aware Applications</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="_glyphs_icm_aware_applications"></A>ICM-Aware Applications</H2>

<P><B><U>Windows 98 only</U></B></P>

<P>Some printer drivers do proprietary color manipulation if ICM is not turned on. In some cases where an application has already color corrected the drawing objects (using ICM outside the DC), the driver needs to make sure it does not perform any correction on these colors. The application calls <B>SetICMMode(</B><I>hdc</I><B>, </B>ICM_DONE_OUTSIDEDC<B>)</B> or <B>SetICMMode(</B><I>hdc</I><B>, </B>ICM_OFF<B>)</B> to specify that no more color correction takes place. This call is conveyed to the printer driver by the system using the <B>Control</B> DDI as follows:</P>

<PRE>#define ICMMODESTATUS 5000
Control(LPPDEVICE, ICMMODESTATUS, lpInData, NULL);
</PRE>

<P>The <I>lpInData</I> parameter points to a <B>WORD</B>, which is set to the <I>fEnableICM</I> parameter of the <B>SetICMMode</B> function.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: ICM-Aware%20Applications"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
