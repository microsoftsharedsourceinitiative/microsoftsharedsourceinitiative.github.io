<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Event Functions and Extended Functions</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="_pss_104"></A>Event Functions and Extended Functions</H3>

<P>VCOMM clients can request that they be notified when communications events occur or when queue thresholds reach specified limits. In addition, VCOMM clients can enable or disable specific events and specify the location of the event variable. </P>

<P>To support event notification, a port driver provides the <B>PortEnableNotification</B> function. This function registers a callback function that the port driver calls when enabled events occur. Enabled events are specified by a 32-bit variable called the event mask. A port driver's <B>PortSetEventMask</B> and <B>PortGetEventMask</B> functions set and retrieve the event mask, and may also specify the location of the event variable. The <B>PortSetModemStatusShadow</B> function may also set the event mask. </P>

<P>To support queue threshold notifications, a port driver provides the <B>PortSetReadCallback</B> and <B>PortSetWriteCallback</B> functions. These functions set the notification thresholds for the receive and transmit queues, respectively, and register callback functions that the port driver calls when these thresholds are reached. </P>

<P>The <B>PortEscapeFunction</B> function enables port drivers to define extended functions. A set of common extended functions is defined in VCOMM.INC in the Windows 95 DDK. By defining additional extended functions, a port driver can expose capabilities of a device that are not otherwise defined by the communications API. Extended functions can be used in conjunction with driver-defined events to facilitate two-way message passing between a VCOMM client and a port driver. </P>

<H4>See Also</H4>

<P><B>_PORTDATA</B>, <B>PortEnableNotification</B>, <B>PortEscapeFunction</B>, <B>PortGetEventMask</B>, <B>PortSetEventMask</B>, <B>PortSetModemStatusShadow</B>, <B>PortSetReadCallback</B>, <B>PortSetWriteCallback</B>, <B>_VCOMM_GetModemStatus</B> </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Event%20Functions%20and%20Extended%20Functions"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
