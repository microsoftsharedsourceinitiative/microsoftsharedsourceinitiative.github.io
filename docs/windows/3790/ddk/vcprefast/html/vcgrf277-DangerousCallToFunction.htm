<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>277 - Dangerous call to &lt;function&gt;.</TITLE>
<META Name="InChm" Content="True">
<META name="rtfFileName" content="prefast.rtf">
<!--CSS_START-->
<SCRIPT SRC="../scripts/dtuelink.js"></SCRIPT>
<!--CSS_END--></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<!--NONSCROLLING BANNER START-->
<div id="nsbanner">
<div id="bannerrow1">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="runninghead" nowrap>PREfast&nbsp;User&nbsp;Guide</TD>
<TD CLASS="product" nowrap>&nbsp;</TD>
</TR>
</TABLE>
</div>
<div id="TitleRow">
<H1 class="dtH1"><A NAME="vcgrf277-dangerouscalltofunction"></A>277 - Dangerous call to &lt;function&gt;.</H1>

<H1 class="dtH1">Additional Information: NULL application name and unquoted path. </H1>

<H1 class="dtH1">Consequence: This will result in security vulnerability if the path contains spaces.</H1>
</div></div>
<!--NONSCROLLING BANNER END-->
<DIV id="nstext" valign="bottom">
<div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()"></div><!-- Topic Status -->
<P>This warning indicates a potential security problem. Creating processes with explicit strings for the process name requires that you escape the spaces in the name. Without this precaution, the code can create unintentional processes.</P>

<P>This warning is sometimes reported in situations where the space occurs between the executable name and the argument. In this case, unless the executable name is fully qualified, there can be a security problem where an attacker can be able to insert a rogue executable with the same name earlier in the path than expected.</P>

<H4 class="dtH4">Example</H4>

<P><B>Defective Source</B></P>

<PRE class="code">CreateProcessA(NULL,
               "c:\\program files\\Project.exe arg1",
               NULL,
               NULL,
               false,
               0,
               NULL,
               NULL,
               NULL,
               NULL);</PRE>

<P><B>Corrected Source</B></P>

<PRE class="code">CreateProcessA(NULL,
               "\"c:\\program files\\Project.exe\" arg1",
               NULL,
               NULL,
               FALSE,
               0,
               NULL,
               NULL,
               NULL,
               NULL);</PRE>
<!--Footer Start-->
<DIV CLASS="footer">
<br>
<HR><!--Copyright-->
<p><MSHelp:link keywords="vxmscCopyright" TABINDEX="0">&copy; Microsoft Corporation. All rights reserved.</MSHelp:link></p></div> <!--Closes the footer div-->
</div> <!--closes the topic content div-->
<!--FOOTER_END-->
</BODY>
</HTML>
