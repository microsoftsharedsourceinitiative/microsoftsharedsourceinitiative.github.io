<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>IRegistryKey</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="IRegistryKey">
</HEAD>
<BODY TOPMARGIN="0">
<DIV STYLE="display:none;">
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_key_basic_information_kr">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_key_full_information_kr">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_key_node_information_kr">
</OBJECT>
</DIV>


<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Streaming&nbsp;Devices&nbsp;(Video&nbsp;and&nbsp;Audio):&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_iregistrykey_ks"></A>IRegistryKey</H1>

<P>The <B>IRegistryKey</B> interface provides an abstraction of a registry key that a miniport driver can use to access the key and its subkeys. The PortCls system driver implements this interface and exposes it to miniport drivers. A miniport driver obtains a reference to an <B>IRegistryKey</B> object by calling <A HREF="audpc-routines_1kc3.htm"><B>PcNewRegistryKey</B></A> or <A HREF="audmp-routines_2jhv.htm"><B>IPort::NewRegistryKey</B></A>. <B>IRegistryKey</B> inherits from the <B>IUnknown</B> interface.</P>

<P>When querying an <B>IRegistryKey</B> object for information about a registry entry under the specified key, the query can output the information in one of three formats, each of which uses a different key-query structure. The following table shows the KEY_INFORMATION_CLASS enumeration values that indicate which of the three key-query structures is output by the query.</P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=44%>KEY_INFORMATION_CLASS Value</TH>
<TH align=left width=56%>Key-Query Structure</TH>
</TR>

<TR VALIGN="top">
<TD width=44%><B>KeyBasicInformation</B></TD>
<TD width=56%><A HREF="JavaScript:hhobj_1.Click()">KEY_BASIC_INFORMATION</A></TD>
</TR>

<TR VALIGN="top">
<TD width=44%><B>KeyFullInformation</B></TD>
<TD width=56%><A HREF="JavaScript:hhobj_2.Click()">KEY_FULL_INFORMATION</A></TD>
</TR>

<TR VALIGN="top">
<TD width=44%><B>KeyNodeInformation</B></TD>
<TD width=56%><A HREF="JavaScript:hhobj_3.Click()">KEY_NODE_INFORMATION</A></TD>
</TR>
</TABLE><BR>

<P>When a new registry-key object is created, the object either opens or creates the registry key and stores the handle to the key. When that object is later released and its reference count decrements to zero, the object automatically closes its handle to the key.</P>

<P>In addition to the methods that <B>IRegistryKey</B> inherits from the <B>IUnknown</B> interface, <B>IRegistryKey</B> supports the following methods:</P>

<P class=indent1><A HREF="audmp-routines_8ptf.htm"><B>IRegistryKey::DeleteKey</B></A></P>

<P class=indent1><A HREF="audmp-routines_4z03.htm"><B>IRegistryKey::EnumerateKey</B></A></P>

<P class=indent1><A HREF="audmp-routines_94tv.htm"><B>IRegistryKey::EnumerateValueKey</B></A></P>

<P class=indent1><A HREF="audmp-routines_9l83.htm"><B>IRegistryKey::NewSubKey</B></A></P>

<P class=indent1><A HREF="audmp-routines_5z90.htm"><B>IRegistryKey::QueryKey</B></A></P>

<P class=indent1><A HREF="audmp-routines_9hyr.htm"><B>IRegistryKey::QueryRegistryValues</B></A></P>

<P class=indent1><A HREF="audmp-routines_7iur.htm"><B>IRegistryKey::QueryValueKey</B></A></P>

<P class=indent1><A HREF="audmp-routines_9far.htm"><B>IRegistryKey::SetValueKey</B></A></P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: IRegistryKey"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
