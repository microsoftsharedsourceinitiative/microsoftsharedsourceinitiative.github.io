<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>IPowerNotify</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="IPowerNotify">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Streaming&nbsp;Devices&nbsp;(Video&nbsp;and&nbsp;Audio):&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_ipowernotify_ks"></A>IPowerNotify</H1>

<P>The <B>IPowerNotify</B> interface is an optional interface that miniport drivers can expose if they require advance notification of impending power-state changes. To determine whether the miniport driver supports the <B>IPowerNotify</B> interface, the port driver calls the miniport object's <B>QueryInterface</B> method with REFIID <B>IID_IPowerNotify</B>. The following miniport types can support <B>IPowerNotify</B>:</P>

<P class=indent1><A HREF="audmp-routines_6ier.htm"><B>IMiniportWavePci</B></A> </P>

<P class=indent1><A HREF="audmp-routines_8pir.htm"><B>IMiniportWaveCyclic</B></A> </P>

<P class=indent1><A HREF="audmp-routines_1fsj.htm"><B>IMiniportMidi</B></A> </P>

<P class=indent1><A HREF="audmp-routines_4vjn.htm"><B>IMiniportDMus</B></A> </P>

<P class=indent1><A HREF="audmp-routines_70z7.htm"><B>IMiniportTopology</B></A> </P>

<P><B>IPowerNotify</B> inherits from the <B>IUnknown</B> interface.</P>

<P>The <B>IPowerNotify</B> interface provides a single method that the port driver calls to notify the miniport driver when a power-state change occurs.</P>

<P>Using wave audio as an example, when the device is requested to go to a sleep state the port driver pauses any active streams and then calls the power-notify callback to inform the miniport driver of the impending power down. The miniport driver then has an opportunity to save any necessary context before the adapter's <B>PowerChangeState</B> method is called.</P>

<P>The process is reversed when the device is powering up. PortCls first calls the adapter's <B>PowerChangeState</B> method to power up the adapter. The port driver then calls the miniport driver's callback to allow the miniport driver to restore its context. Finally, the port driver unpauses any previously paused active audio streams.</P>

<P>For additional information, see <A HREF="pcdesign_8ox3.htm">Implementing the IPowerNotify Interface</A>.</P>

<P>In addition to the methods that <B>IPowerNotify</B> inherits from the <B>IUnknown</B> interface, <B>IPowerNotify</B> supports the following method:</P>

<P class=indent1><A HREF="audmp-routines_3s4z.htm"><B>IPowerNotify::PowerChangeNotify</B></A> </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: IPowerNotify"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
