<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>KsAllocateDefaultClock</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="KsAllocateDefaultClock">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Streaming&nbsp;Devices&nbsp;(Video&nbsp;and&nbsp;Audio):&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="ddk_ksallocatedefaultclock_ks"></A>KsAllocateDefaultClock</H3>

<P>The <B>KsAllocateDefaultClock</B> function allocates and initializes the default clock structure. </P>

<P>The function can only be called at PASSIVE_LEVEL.</P>

<PRE class=syntax><B>KSDDKAPI NTSTATUS NTAPI
  KsAllocateDefaultClock(
  </B>  <B>OUT PKSDEFAULTCLOCK* </B> <I>DefaultClock</I><B>
    ); </B></PRE>

<H4>Parameters</H4>

<DL>
<DT><I>DefaultClock</I></DT>

<DD>Specifies the caller-allocated shared default clock structure. The current time is set to zero and the state is set to KSSTATE_STOP. Upon successful completion of this routine, the structure indicated by this pointer will contain a reference to the default clock. The data returned should be treated as opaque and reserved for system use.
</DD>
</DL>

<H4>Return Value</H4>

<P>The <B>KsAllocateDefaultClock</B> function returns<B> </B>STATUS_SUCCESS if successful, or a memory error if unsuccessful.</P>

<H4>Headers</H4>

<P>Declared in <I>ks.h</I>. Include <I>ks.h</I>.</P>

<H4>Comments</H4>

<P>The internal DefaultClock.ReferenceCount element is initialized to one by the <A HREF="#ddk_ksallocatedefaultclock_ks"><B>KsAllocateDefaultClock</B></A> function. The element is incremented and decremented as each notification DPC is queued and completed. When the structure is to be freed, the element is used to determine if the owner of the clock should free the structure or if a pending DPC should free it asynchronously.</P>

<P>When the clock is no longer needed, the driver must call <A HREF="ksfunc_2svn.htm"><B>KsFreeDefaultClock</B></A> to release any resources allocated for use with the clock.</P>

<H4>See Also</H4>

<P><A HREF="ksfunc_2svn.htm"><B>KsFreeDefaultClock</B></A> , <A HREF="ksfunc_25df.htm">KsAllocateDefaultClockEx</A></P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: KsAllocateDefaultClock"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
