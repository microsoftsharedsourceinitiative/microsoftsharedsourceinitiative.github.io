<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Video Port Capture Device</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Video Port Capture Device">
</HEAD>
<BODY TOPMARGIN="0">
<DIV STYLE="display:none;">
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_kernel_mode_video_transport_gg">
</OBJECT>
</DIV>


<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Streaming&nbsp;Devices&nbsp;(Video&nbsp;and&nbsp;Audio):&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="ddk_video_port_capture_device_ksg"></A>Video Port Capture Device</H3>

<P>Video port-based capture devices must provide a video port pin that is connected to the Video Port Manager. This video port stream allows hardware-based transport to display the preview image without CPU or PCI bus overhead. A separate pin provides capture capability (such as is the case when captured video must be written to disk). During capture, the capture buffers are provided to the display driver, which fills the buffer by bus mastering. The interaction between the capture minidriver and the display driver is defined in <A HREF="JavaScript:hhobj_1.Click()">Kernel-Mode Video Transport</A>.</P>

<P>On Windows&nbsp;98SE and Windows&nbsp;2000, the Overlay Mixer (subsumed by the Video Port Manager) does not support video port connections on secondary monitors. The pin connection will fail in this case. This limitation does not exist on Windows&nbsp;Me or Windows&nbsp;XP.</P>

<P>If a device supports vertical blanking interval capture it typically exposes two additional pins: VPVBI and VBI. The VPVBI pin is used by the Video Port Manager filter to allocate video port surfaces for VBI capture. The VBI pin itself provides the raw VBI samples. The following illustration shows the separate paths for VPVBI and VBI capture.</P>

<P><IMG SRC="images/bt829grf.gif" ALT="" BORDER=0></P>

<P><B>Analog TV video and VBI capture filter graph</B></P>

<P>Property sets that are unique to this type of graph are <A HREF="dvdref_4ilv.htm">KSPROPSETID_VPConfig and KSPROPSETID_VPVBIConfig</A> and <A HREF="vidcapref_1gz7.htm">PROPSETID_ALLOCATOR_CONTROL</A>.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Video%20Port%20Capture%20Device"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
