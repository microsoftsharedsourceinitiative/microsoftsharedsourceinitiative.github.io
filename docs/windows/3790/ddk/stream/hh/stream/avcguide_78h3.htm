<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Virtual Driver Enumeration</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Virtual Driver Enumeration">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Streaming&nbsp;Devices&nbsp;(Video&nbsp;and&nbsp;Audio):&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="ddk_virtual_driver_enumeration_ksg"></A>Virtual Driver Enumeration</H2>

<P>As virtual AV/C devices are added and removed from the system, drivers are loaded and unloaded by the Plug and Play Manager. The following diagram illustrates the driver stack.</P>

<P><IMG SRC="images/avcdiagv.gif" ALT="" BORDER=0></P>

<P><B>Virtual AV/C Device Stack</B></P>

<P>At the bottom of the stack are <I>1394ohci.sys</I> and <I>1394bus.sys</I>. These drivers provide the basic 1394 infrastructure support. There are instances of these drivers for each 1394 adapter in the system.</P>

<P>Next in the stack is <I>61883.sys</I>. This protocol driver provides the IEEE 61883-1 connection management protocol (CMP), common isochronous packet (CIP), and function control protocol (FCP) support, as well as PnP enumeration of devices for each command transaction set (CTS). Instances of this driver are loaded as a result of I/O control codes delivered to 1394 bus, or from registry entries managed by 1394 bus.</P>

<P>Next in the stack is <I>avc.sys</I>. This driver provides AV/C protocol support and PnP enumeration of devices for each virtual AV/C subunit. Instances of this device are loaded from registry entries managed by <I>61883.sys</I> (using the default virtual device ID in <I>61883.inf</I> or by providing a custom INFfile).</P>

<P>Next in the stack are the virtual subunit drivers. This is the level where all of the unique AV/C subunit functionality is implemented. There is an instance of a particular subunit driver for each virtual subunit.</P>

<P>For more information about the mechanism for subunit enumeration and the format of the device IDs associated with an AV/C device, see <A HREF="avcguide_36p3.htm">Virtual Subunit Enumeration</A>.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Virtual%20Driver%20Enumeration"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
