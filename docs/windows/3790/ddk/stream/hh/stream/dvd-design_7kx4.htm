<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Input Streams</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Input Streams">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Streaming&nbsp;Devices&nbsp;(Video&nbsp;and&nbsp;Audio):&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="ddk_input_streams_ksg"></A>Input Streams</H2>

<P>DVD input streams are provided to the minidriver as arrays of encrypted DVD PACKs. PACKs are as defined in the DVD specification. Note that the system clock reference (SCR) field of the PACK is set to zero because Microsoft’s DVD architecture uses the “master clock” paradigm for audio and video synchronization. Typically, the audio stream of the DVD decoder minidriver provides the master clock. For more information, see <A HREF="dvd-design_3okn.htm">Master Clock</A>.</P>

<P>DVD data streams are sent to the minidriver through the <A HREF="strclass-srbs_2bzn.htm">SRB_WRITE_DATA</A> request. For more information on SRB requests, see <A HREF="strmini-design_8pif.htm">Handling Stream Request Blocks</A> and <A HREF="strclass-srbs_35pv.htm">Stream Class SRB Reference</A>. Hardware should support scatter/gather DMA, because several DVD PACKs may be present in a single request packet. </P>

<P>The following table describes the MPEG2 video input stream media types used by DVD movies:</P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=36%>Attribute</TH>
<TH align=left width=64%>Value</TH>
</TR>

<TR VALIGN="top">
<TD width=36%>Major Format GUID</TD>
<TD width=64%>KSDATAFORMAT_TYPE_DVD_ENCRYPTED_PACK</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>Minor Format GUID</TD>
<TD width=64%>KSDATAFORMAT_SUBTYPE_MPEG2_VIDEO</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>Format Block Specifier GUID </TD>
<TD width=64%>KSDATAFORMAT_SPECIFIER_MPEG2_VIDEO</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>Format Block Structure</TD>
<TD width=64%>MPEG2VIDEOINFO <BR>
(Superset of VIDEOINFO2 structure. Also indicates MPEG profile and level.)</TD>
</TR>
</TABLE><BR>

<P>The following table describes the AC-3 audio input stream media types used by DVD movies:</P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=36%>Attribute</TH>
<TH align=left width=64%>Value</TH>
</TR>

<TR VALIGN="top">
<TD width=36%>Major Format GUID</TD>
<TD width=64%>KSDATAFORMAT_TYPE_DVD_ENCRYPTED_PACK</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>Minor Format GUID</TD>
<TD width=64%>KSDATAFORMAT_SUBTYPE_AC3_AUDIO</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>Format Block Specifier GUID</TD>
<TD width=64%>KSDATAFORMAT_SPECIFIER_WAVEFORMATEX
<P>(Note that this is expected to change.)</P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>Format Block Structure</TD>
<TD width=64%>KSDATAFORMAT_WAVEFORMATEX<BR>
Superset of WaveFormatEx 
<P>(More than two channels. Down-mix descriptor.)</P>
</TD>
</TR>
</TABLE><BR>

<P>The following table describes the LPCM audio input stream media types used by DVD movies:</P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=36%>Attribute</TH>
<TH align=left width=64%>Value</TH>
</TR>

<TR VALIGN="top">
<TD width=36%>Major Format GUID</TD>
<TD width=64%>KSDATAFORMAT_TYPE_DVD_ENCRYPTED_PACK</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>Minor Format GUID</TD>
<TD width=64%>KSDATAFORMAT_SUBTYPE_LPCM_AUDIO</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>Format Block Specifier GUID</TD>
<TD width=64%>KSDATAFORMAT_SPECIFIER_WAVEFORMATEX</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>Format Block Structure</TD>
<TD width=64%>KSDATAFORMAT_WAVEFORMATEX</TD>
</TR>
</TABLE><BR>

<P>The following table describes the DTS audio input stream media types used by DVD movies:</P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=36%>Attribute</TH>
<TH align=left width=64%>Value</TH>
</TR>

<TR VALIGN="top">
<TD width=36%>Major Format GUID</TD>
<TD width=64%>KSDATAFORMAT_TYPE_DVD_ENCRYPTED_PACK</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>Minor Format GUID</TD>
<TD width=64%>KSDATAFORMAT_SUBTYPE_DTS_AUDIO</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>Format Block Specifier GUID</TD>
<TD width=64%>KSDATAFORMAT_SPECIFIER_WAVEFORMATEX
<P>(Note that this is expected to change.)</P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>Format Block Structure</TD>
<TD width=64%>KSDATAFORMAT_WAVEFORMATEX<BR>
Superset of WaveFormatEx 
<P>(More than two channels. Down-mix descriptor.)</P>
</TD>
</TR>
</TABLE><BR>

<P>The following table describes the SDDS audio input stream media types used by DVD movies:</P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=36%>Attribute</TH>
<TH align=left width=64%>Value</TH>
</TR>

<TR VALIGN="top">
<TD width=36%>Major Format GUID</TD>
<TD width=64%>KSDATAFORMAT_TYPE_DVD_ENCRYPTED_PACK</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>Minor Format GUID</TD>
<TD width=64%>KSDATAFORMAT_SUBTYPE_SDDS_AUDIO</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>Format Block Specifier GUID</TD>
<TD width=64%>KSDATAFORMAT_SPECIFIER_WAVEFORMATEX
<P>(Note that this is expected to change.)</P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>Format Block Structure</TD>
<TD width=64%>KSDATAFORMAT_WAVEFORMATEX<BR>
Superset of WaveFormatEx 
<P>(More than two channels. Down-mix descriptor.)</P>
</TD>
</TR>
</TABLE><BR>

<P>The following table describes the subpicture stream media types used by DVD movies:</P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=36%>Attribute</TH>
<TH align=left width=64%>Value</TH>
</TR>

<TR VALIGN="top">
<TD width=36%>Major Format GUID</TD>
<TD width=64%>KSDATAFORMAT_TYPE_DVD_ENCRYPTED_PACK</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>Minor Format GUID</TD>
<TD width=64%>KSDATAFORMAT_SUBTYPE_SUBPICTURE</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>Format Block Specifier GUID</TD>
<TD width=64%>KSDATAFORMAT_SPECIFIER_NONE</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>Format Block Structure</TD>
<TD width=64%>None</TD>
</TR>
</TABLE><BR>

<P>For subpicture highlighting, palette information and highlight information are passed as properties. The subpicture data stream consists of packets of data, as provided by the DVD specification. Although the PACK header is stripped off, it is still provided.</P>

<P>The Microsoft supplied DVD navigator filter parses all button and keyboard information and only passes one highlight rectangle down to the subpicture decoder at any given time. As a result, highlight information is sent to the decoder more often than it is present in the DVD stream. This is different from the DVD specification.</P>

<P>The DVD navigator/splitter filter processes all keystroke information and sends new highlight information each time a button state changes. The information describes only one mode of one button at a time. It includes a display rectangle in pixel coordinates of the screen, or a display of the sub-picture, if present. The <A HREF="dvdref_3j5f.htm">KSPROPERTY_SPHLI</A> structure also contains color and contrast information but only for the present state of the currently selected button. The format is defined in the DVD specification.</P>

<P>The highlight information arrives asynchronously to the data stream. The DVD decoder minidriver must use the highlight Start and End time stamps to correlate the highlight information to the relevant sub-picture information, if any. If the DVD decoder minidriver has not received any sub-picture stream information for the requested time stamps, the decoder assumes that the highlight information is stand-alone and does not apply to a sub-picture. In this case, the color and contrast information can be assumed to be all the same color.</P>

<P>Highlight information contains Start and End time-stamps. These are in the same units as other time stamps, with two exceptions: A Start time-stamp of 0xFFFFFFFF means the highlight property is effective upon receipt, and an End time-stamp of 0xFFFFFFFF means the highlight property is valid until the next highlight is received.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Input%20Streams"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
