<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Capture, Preview, and Still Categories</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Capture and Preview and Still Categories">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Streaming&nbsp;Devices&nbsp;(Video&nbsp;and&nbsp;Audio):&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="ddk_capture_preview_and_still_categories_ksg"></A>Capture, Preview, and Still Categories</H3>

<P>The capture, preview, and still stream categories are almost identical in terms of data formats and stream characteristics.</P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=43%>Category/PinName</TH>
<TH align=left width=57%>Description</TH>
</TR>

<TR VALIGN="top">
<TD width=43%><B>PINNAME_VIDEO_CAPTURE</B></TD>
<TD width=57%>Capture category output pins provide a stream of compressed or uncompressed digital video. Typically, this stream is used for writing movies to disk, video conferencing, and for image analysis.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%><B>PINNAME_VIDEO_PREVIEW</B></TD>
<TD width=57%>Preview category output pins provide a stream of usually uncompressed digital video. Typically, the stream is used to view the video stream on the local monitor, in either RGB or YUV formats that can be directly displayed by DirectDraw. In resource-limited situations, capture minidrivers should prioritize the preview stream lower than the capture stream.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%><B>PINNAME_VIDEO_STILL</B></TD>
<TD width=57%>Still category output pins are used with dual-mode cameras that are capable of producing both a capture stream and a still image stream (that is often of higher quality than the capture stream). The still image stream includes the ability to externally or programmatically trigger acquisition of an image.</TD>
</TR>
</TABLE><BR>

<P class=note><B>Note</B>&nbsp;&nbsp;Since many cameras produce only a single output stream, the DirectShow SDK includes a Smart Tee filter that splits a single stream into a Capture and a Preview stream. Therefore, cameras that produce only a single stream should not internally duplicate their data streams to produce a preview stream.</P>

<P>The following table lists the common characteristics of Capture, Preview, and Still streams. </P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=41%>Attribute</TH>
<TH align=left width=59%>Value</TH>
</TR>

<TR VALIGN="top">
<TD width=41%><B>DataRange Structure</B></TD>
<TD width=59%><A HREF="vidcapref_8vqr.htm">KS_DATARANGE_VIDEO</A> (frames only)<BR>
<A HREF="vidcapref_4j3n.htm">KS_DATARANGE_VIDEO2</A> (fields or frames, bob or weave settings)<BR>
<A HREF="vidcapref_2oqb.htm">KS_DATARANGE_MPEG1_VIDEO</A><BR>
<A HREF="vidcapref_6to3.htm">KS_DATARANGE_MPEG2_VIDEO</A></TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>DataFormat Structure</B></TD>
<TD width=59%>KS_DATAFORMAT_VIDEO (frames only)<BR>
KS_DATAFORMAT_VIDEO2 (fields or frames, bob or weave settings)<BR>
<A HREF="vidcapref_9ir7.htm">KS_MPEG1VIDEOINFO</A> (for MPEG1)<BR>
<A HREF="vidcapref_010z.htm">KS_MPEGVIDEOINFO2</A> (for MPEG2)</TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>Major Format GUID</B></TD>
<TD width=59%>KSDATAFORMAT_TYPE_VIDEO</TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>Sub-Format GUID</B></TD>
<TD width=59%>RGB16, RGB24, UYVY, JPEG, …</TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>Specifier GUID</B></TD>
<TD width=59%>KSDATAFORMAT_SPECIFIER_VIDEOINFO (frames only)<BR>
KSDATAFORMAT_SPECIFIER_VIDEOINFO2 (fields or frames)</TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>Extended Header Size</B></TD>
<TD width=59%><A HREF="vidcapref_1rg3.htm">KS_FRAME_INFO</A> if not an MPEG format. Zero if an MPEG format.</TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>Required Property Sets</B></TD>
<TD width=59%><A HREF="ks-prop_5kj7.htm">KSPROPSETID_Connection</A><BR>
<A HREF="vidcapref_51gz.htm">PROPSETID_VIDCAP_DROPPEDFRAMES</A></TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>Required Event Sets</B></TD>
<TD width=59%>None</TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>DirectShow majortype</B></TD>
<TD width=59%>MEDIATYPE_Video</TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>DirectShow formattype</B></TD>
<TD width=59%>FORMAT_VideoInfo (frames only)<BR>
FORMAT_VideoInfo2 (fields or frames)</TD>
</TR>
</TABLE><BR>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Capture,%20Preview,%20and%20Still%20Categories"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
