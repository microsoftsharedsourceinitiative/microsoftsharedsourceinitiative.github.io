<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>DirectSound Capture Effects</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="DirectSound Capture Effects">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Streaming&nbsp;Devices&nbsp;(Video&nbsp;and&nbsp;Audio):&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="ddk_directsound_capture_effects_ksg"></A>DirectSound Capture Effects</H2>

<P>DirectSound&nbsp;8 adds some new features for enabling and controlling third-party effects during audio capture. This and later versions of DirectSound support the following two capture effects:

<UL>
	<LI>Acoustic echo cancellation (AEC)</LI>

	<LI>Noise suppression (NS)</LI>
</UL>

<P>In a full-duplex audio application such as telephone conferencing, echoes of the render stream being output through the speakers are picked up in the microphone that generates the capture stream. After characterizing the sound reflections in the room or other physical environment, the full-duplex system uses AEC to monitor the render stream to cancel out the echoes that it adds to the capture stream. The system can further improve the quality of the capture stream by using NS to detect noise spikes and remove them from the stream.</P>

<P>A full-duplex DirectSound application can use the <B>IDirectSoundCaptureFXAec</B> and <B>IDirectSoundCaptureFXNoiseSuppress</B> interfaces to control the AEC and NS effects. The <B>IDirectSoundCaptureBuffer::GetObjectInPath</B> method retrieves pointers to objects with these interfaces. The <B>DirectDrawFullDuplexCreate</B> function creates the <B>IDirectSoundCaptureBuffer</B> object, and the parameters that the caller passes to this function include an array of DSCEFFECTDESC structures. The array specifies the effects that are to be enabled in the capture buffer. The <B>guidDSCFXClass</B> member of each structure in the array contains a GUID that specifies an effect: AEC or NS. The DirectSound name for each GUID is shown in the following table, along with the KS name for the same GUID value. For details, see the DirectX 8.0 SDK documentation.</P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=37%>DirectSound GUID Name</TH>
<TH align=left width=63%>KS GUID Name</TH>
</TR>

<TR VALIGN="top">
<TD width=37%>GUID_DSCFX_CLASS_AEC</TD>
<TD width=63%><A HREF="aud-prop_01wz.htm">KSNODETYPE_ACOUSTIC_ECHO_CANCEL</A></TD>
</TR>

<TR VALIGN="top">
<TD width=37%>GUID_DSCFX_CLASS_NS</TD>
<TD width=63%><A HREF="aud-prop_7t0z.htm">KSNODETYPE_NOISE_SUPPRESS</A></TD>
</TR>
</TABLE><BR>

<P>In Microsoft® Windows®&nbsp;XP and later, you can expose your audio device's hardware-accelerated capture effects to DirectSound applications. In addition, the AEC system filter (<I>aec.sys</I>) provides software emulation of AEC and NS effects. </P>

<P>These topics are discussed in the remainder of this section:</P>

<P class=indent1><A HREF="pcdesign_1pyf.htm">Exposing Hardware-Accelerated Capture Effects</A></P>

<P class=indent1><A HREF="pcdesign_82av.htm">AEC System Filter</A></P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: DirectSound%20Capture%20Effects"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
