<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>MIDI Miniport</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="MIDI Miniport">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Streaming&nbsp;Devices&nbsp;(Video&nbsp;and&nbsp;Audio):&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="ddk_midi_miniport_ksg"></A>MIDI Miniport</H3>

<P>The MIDI miniport driver model is intended for simple devices that process MIDI data on a byte-by-byte basis. This model supports multiple MIDI streams; each stream is unidirectional. This functionality is supported in miniport drivers by the following interfaces:</P>

<P class=indent1><A HREF="audmp-routines_1fsj.htm"><B>IMiniportMidi</B></A> handles miniport driver initialization and creation of MIDI streams.</P>

<P class=indent1><A HREF="audmp-routines_6svn.htm"><B>IMiniportMidiStream</B></A> moves MIDI bytes and sets the state of the stream.</P>

<P>The MIDI port driver handles all timing issues in both directions and relies on the miniport driver to promptly move data on and off the adapter in response to the port driver's calls to the <B>IMiniportMidiStream</B> read and write methods.</P>

<P>The miniport driver uses the port driver's <A HREF="audmp-routines_49pv.htm"><B>IPortMidi</B></A> interface to notify the port driver of hardware interrupts.</P>

<P>In Windows&nbsp;XP and later, the <B>IPortMidi</B> and <A HREF="audmp-routines_7pgz.htm"><B>IPortDMus</B></A> interfaces are both implemented in a single internal driver module. This consolidation is facilitated by the similarity of these two interfaces. For example, the same methods are defined for both interfaces. Applications written for previous versions of Windows should see no change in the behavior of the <B>IPortMidi</B> and <B>IPortDMus</B> interfaces resulting from consolidation of the MIDI and DirectMusic port drivers.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: MIDI%20Miniport"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
