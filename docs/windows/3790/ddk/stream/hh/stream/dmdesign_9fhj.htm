<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>IMXF Interfaces</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Streaming&nbsp;Devices&nbsp;(Video&nbsp;and&nbsp;Audio):&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H4><A NAME="ddk_imxf_interfaces_ksg"></A>IMXF Interfaces</H4>

<P>All MIDI transport in the DirectMusic port and miniport driver is carried out using the same interface: <A HREF="audmp-routines_9fw3.htm"><B>IMXF</B></A>.</P>

<P><B>IMXF</B> is the COM interface for a DirectMusic MIDI transform filter. The miniport driver, the sequencer, and other entities in the port driver that handle MIDI data use <B>IMXF</B> as their common COM interface. When the miniport driver implements this interface, it can participate in MIDI transport. <A HREF="audmp-routines_7pgz.htm"><B>IPortDMus</B></A>, which resides in PortCls, manages <B>IMXF</B>. The interface from the capture device to capture sink is also an <B>IMXF</B> interface.</P>

<P>MIDI data is transported between user mode and kernel mode in buffers of packed time-stamped data. The kernel port driver breaks these buffers into individual events (see <A HREF="aud-prop_10kz.htm">DMUS_KERNEL_EVENT</A>). The high-resolution MIDI sequencer passes these events to the miniport driver when the trigger time occurs.</P>

<P>On the input side, the kernel port driver extracts individual input messages from the miniport driver and builds packed buffers to pass up to user mode. Accordingly, the data transport model for DirectMusic miniport drivers consists of <A HREF="audmp-routines_38vn.htm"><B>IMXF::PutMessage</B></A><B> </B>and <A HREF="audmp-routines_5n3n.htm"><B>IAllocatorMXF::GetMessage</B></A>. More detail on both these interfaces is presented in <A HREF="dmdesign_0u5j.htm">Allocator</A>.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: IMXF%20Interfaces"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
