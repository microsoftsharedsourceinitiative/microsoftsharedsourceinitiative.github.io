<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>KsSetTargetDeviceObject</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="KsSetTargetDeviceObject">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Streaming&nbsp;Devices&nbsp;(Video&nbsp;and&nbsp;Audio):&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="ddk_kssettargetdeviceobject_ks"></A>KsSetTargetDeviceObject</H3>

<P>The <B>KsSetTargetDeviceObject</B> function sets the target device object of an object. The function adds the object header to a list of object headers that have target devices. </P>

<PRE class=syntax><B>KSDDKAPI VOID NTAPI
  KsSetTargetDeviceObject(</B>
    <B>IN KSOBJECT_HEADER </B> <I>Header</I><B>,</B>
    <B>IN PDEVICE_OBJECT </B> <I>TargetDevice</I><B> </B> <B>OPTIONAL</B>
    <B>);</B></PRE>

<H4>Parameters</H4>

<DL>
<DT><I>Header</I> </DT>

<DD>Points to a header previously allocated by <A HREF="ksfunc_0u2b.htm"><B>KsAllocateObjectHeader</B></A>.</DD>

<DT><I>TargetDevice</I> </DT>

<DD>Optionally contains the target device object that will be used when recalculating the stack depth for the underlying device object. If the value is NULL, any current setting is removed. If the value is any setting other than NULL, the current setting is replaced.
</DD>
</DL>

<H4>Return Value</H4>

<P>None</P>

<H4>Headers</H4>

<P>Declared in <I>ks.h</I>. Include <I>ks.h</I>.</P>

<H4>Comments</H4>

<P>The <B>KsSetTargetDeviceObject</B> function assumes that the caller has previously allocated a device header on the underlying device object with the <B>KsAllocateDeviceHeader</B> function. The presence of the device header allows future calls to the function <B>KsRecalculateStackDepth</B>, and the device header is used when the object will be forwarding IRPs through a connection to another device and needs to keep track of the stack depth.</P>

<P>If <B>KsSetDevicePnpAndBaseObject</B> is also used to assign the PnP object stack, that device object will also be taken into account when recalculating stack depth.</P>

<H4>See Also</H4>

<P><A HREF="ksfunc_8437.htm"><B>KsSetDevicePnpAndBaseObject</B></A>, <A HREF="ksfunc_0ptf.htm"><B>KsRecalculateStackDepth</B></A>, <A HREF="ksfunc_1elv.htm"><B>KsAllocateDeviceHeader</B></A>, <A HREF="ksfunc_0u2b.htm"><B>KsAllocateObjectHeader</B></A> </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: KsSetTargetDeviceObject"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
