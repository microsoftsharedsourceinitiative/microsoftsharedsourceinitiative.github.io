<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>IOCTL_HID_SET_POLL_FREQUENCY_MSEC</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="IOCTL_HID_SET_POLL_FREQUENCY_MSEC">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Interactive&nbsp;Input&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_ioctl_hid_set_poll_frequency_msec_kr"></A>IOCTL_HID_SET_POLL_FREQUENCY_MSEC</H1>

<H4>Operation</H4>

<P>The IOCTL_HID_SET_POLL_FREQUENCY_MSEC request sets the polling frequency, in milliseconds, for a <A HREF="hidclass_2w13.htm">top-level collection</A>. </P>

<P>User-mode applications or kernel-mode drivers that do irregular, opportunistic reads on a polled device must furnish a polling interval of zero. In such cases, IOCTL_HID_SET_POLL_FREQUENCY_MSEC does not actually change the polling frequency of the device, but if the report data is not stale when it is read, the read is completed immediately with the latest report data for the indicated collection. If the report data is stale, it is refreshed immediately, without waiting for the expiration of the polling interval, and the read is completed with the new data. </P>

<P>If the value for the polling interval provided in the IRP is not zero, then it must be &gt;= MIN_POLL_INTERVAL_MSEC and &lt;= MAX_POLL_INTERVAL_MSEC.</P>

<P>For general information about HIDClass devices, see <A HREF="hidclass_2v53.htm">HID Concepts</A>, <A HREF="hidclass_7ixz.htm">HID collections</A>, and <A HREF="hidclass_7odj.htm">Operating HID Collections</A>. </P>

<H4>Input</H4>

<P><B>Parameters.DeviceIoControl.InputBufferLength</B> in the I/O stack location of the IRP indicates the size, in bytes, of the input buffer, which must be &gt;= <B>sizeof</B>(ULONG). </P>

<P><B>Irp-&gt;AssociatedIrp.SystemBuffer</B> contains the new polling interval. </P>

<H4>Output</H4>

<P>None.</P>

<H4>I/O Status Block</H4>

<P>The HID class driver sets the following fields of <B>Irp.IoStatus</B>:

<UL>
	<LI><B>Status</B> is set to STATUS_SUCCESS if the transfer completed without error. Otherwise, it is set to an appropriate NTSTATUS error code.</LI>
</UL>

<H4>Headers</H4>

<P>Defined in<I> hidclass.h</I>. Include <I>hidclass.h</I>.</P>

<H4>See Also</H4>

<P><A HREF="hidioreq_11yq.htm">IOCTL_HID_GET_POLL_FREQUENCY_MSEC</A></P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: IOCTL_HID_SET_POLL_FREQUENCY_MSEC"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
