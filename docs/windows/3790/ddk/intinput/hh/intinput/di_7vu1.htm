<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Joystick Driver Model</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Joystick Driver Model">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Interactive&nbsp;Input&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="ddk_joystick_driver_model_di"></A>Joystick Driver Model</H2>

<P>One of the most critical goals of the joystick driver model is to provide timely access to joystick information. Windows&nbsp;95/98/Me joystick services are provided through two drivers: a 16-bit ring 3 driver (<I>Msjstick.drv</I>), and a 32-bit ring 0 driver (<I>Vjoyd.vxd</I>). The <I>Msjstick.drv</I> driver provides basic services such as registry updating and caps info; <I>Vjoyd.vxd</I> provides polling services. </P>

<P>The API for the joystick is provided through the <I>Mmsystem.dll</I> dynamic-link library (DLL) for 16-bit applications on Windows&nbsp;95/98/Me, and through the <I>Winmm.dll</I> DLL for 32-bit applications. <I>Mmsystem.dll</I> communicates with <I>Msjstick.drv</I> for all joystick services (<I>Msjstick.drv</I> communicates with <I>Vjoyd.vxd</I> to supply polling services). <I>Winmm.dll</I> communicates directly with <I>Vjoyd.vxd</I> for the polling services, and thunks to <I>Mmsystem.dll</I> for the basic services that are not time-critical.</P>

<P>Starting in DirectX 5.0, DirectInput offers an alternative, COM-based API. <I>Dinput.dll</I> uses VJoyD and, if available, the Human Interface Device (HID) stack, to provide polling services. HID devices are also reported through VJoyD so that applications using the older API are still able to read the new devices. Force-feedback handling is provided by a driver supplied by the OEM, which can be either a DLL loaded by <I>Dinput.dll</I>, or an extended VJoyD minidriver. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Joystick%20Driver%20Model"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
