<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>IDirectInputJoyConfig8::OpenTypeKey</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="IDirectInputJoyConfig8::OpenTypeKey">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Interactive&nbsp;Input&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_idirectinputjoyconfig8_opentypekey_di"></A>IDirectInputJoyConfig8::OpenTypeKey</H1>

<P>The <B>IDirectInputJoyConfig8::OpenTypeKey </B>method opens the registry key associated with a joystick type. Control panel applications can use this key to store per-type persistent information, such as global configuration parameters. Such private information should be kept in a subkey named <B>OEM</B>; do not store private information in the main type key. Control panel applications can also use this key to read configuration information, such as the strings to use for device calibration prompts. The application should use <B>RegCloseKey</B> to close the registry key. </P>

<PRE class=syntax><B>HRESULT
  IDirectInputJoyConfig8::OpenTypeKey(
</B>    <B>LPCWSTR </B> <I>pwszType</I><B>,</B>
    <B>REGSAM</B>  <I>regsam</I><B>,</B>
    <B>PHKEY </B> <I>phk</I> 
<B>    );</B></PRE>

<H4>Parameters</H4>

<DL>
<DT><I>pwszType</I> </DT>

<DD>Points to the name of the type. The name of the type cannot exceed MAX_PATH characters, including the terminating null character. The name cannot begin with a "#" character. Types beginning with "#" are reserved by DirectInput. </DD>

<DT><I>regsam</I> </DT>

<DD>Specifies a registry security access mask. This can be any of the values permitted by the <B>RegOpenKeyEx</B> function. If write access is requested, then joystick configuration must first have been acquired. If only read access is requested, then acquisition is not required. </DD>

<DT><I>phk</I> </DT>

<DD>Points to the opened registry key, on success. 
</DD>
</DL>

<H4>Return Value</H4>

<P>Returns DI_OK on success; otherwise returns one of the following COM error values:

<DL>
<DT>DIERR_NOTACQUIRED </DT>

<DD>Joystick configuration has not been acquired. You must call <A HREF="di_ref_0bmx.htm"><B>IDirectInputJoyConfig8::Acquire</B></A> before you can open a joystick type configuration key for writing. </DD>

<DT>DIERR_INVALIDPARAM </DT>

<DD>One or more parameters was invalid. </DD>

<DT>MAKE_HRESULT(SEVERITY_ERROR, FACILITY_WIN32, ErrorCode) </DT>

<DD>A Win32 error code if access to the key is denied by registry permissions or some other external factor. 
</DD>
</DL>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: IDirectInputJoyConfig8::OpenTypeKey"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
