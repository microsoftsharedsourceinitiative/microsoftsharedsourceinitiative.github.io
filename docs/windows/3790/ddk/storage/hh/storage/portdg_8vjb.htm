<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Making ScsiPort Miniport Drivers Work with Storport</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Making ScsiPort Miniport Drivers Work with Storport">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Storage&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="ddk_making_scsiport_miniport_drivers_work_with_storport_kg"></A>Making ScsiPort Miniport Drivers Work with Storport</H2>

<P>The Storport-miniport interface is designed to be as similar to the ScsiPort-miniport interface as possible, in order to facilitate the adaptation of ScsiPort miniport drivers to work with the Storport driver. In order to make a ScsiPort miniport work with Storport, you must take the following basic steps:

<OL>
	<LI>Change all instances of the <B>#include</B> &lt;<I>scsi.h</I>&gt; directive with the <B>#include</B> &lt;<I>storport.h</I>&gt; directive. <BR>
If both the <I>scsi.h</I> and <I>storport.h</I> header files are included, a compile time error will occur.</LI>

	<LI>Replace s<I>csiport.lib</I> with <I>storport.lib</I> in your build scripts, that is, in the sources or <B>makefile</B> file.</LI>

	<LI>Make certain that all expanded structures are properly initialized. 
<P>The sizes of both the <A HREF="k306_5s1e.htm">HW_INITIALIZATION_DATA</A> structure and the <A HREF="k306_2h4i.htm">PORT_CONFIGURATION_INFORMATION</A> structure have changed, so make certain the new members are properly initialized.
</LI>
</OL>

<P>The Storport header file, <I>storport.h,</I> currently retains both ScsiPort-prefixed commands and StorPort-prefixed commands to facilitate porting from the ScsiPort. </P>

<P>This section provides more detailed instructions for driver writers who wish to modify a miniport that is designed to work with ScsiPort, so that it can work with Storport. The following topics are covered:</P>

<P class=indent1><A HREF="portdg_1uw7.htm">Requirements for Using Storport with an Adapter</A></P>

<P class=indent1><A HREF="portdg_1icn.htm">Hardware Initialization with Storport</A></P>

<P class=indent1><A HREF="portdg_655z.htm">Setting Port Configuration Information with Storport</A></P>

<P class=note></P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Making%20ScsiPort%20Miniport%20Drivers%20Work%20with%20Storport"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
