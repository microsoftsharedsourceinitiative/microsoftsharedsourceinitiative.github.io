<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Accessing Device Configuration Space</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Accessing Device Configuration Space">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Kernel-Mode&nbsp;Driver&nbsp;Architecture:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_accessing_device_configuration_space_kg"></A>Accessing Device Configuration Space</H1>

<P>Some buses provide a way of accessing a special configuration space for each device attached to the bus. This section explains how a driver can get information from a target device's configuration space, provided the driver is loaded in the same driver stack as the driver for the target device, either as a function driver or a filter driver. </P>

<P>In Microsoft® Windows NT® 4.0, drivers get information from a target device's configuration space by scanning the bus and calling the <A HREF="k103_3o6q.htm"><B>HalGetBusData</B></A> and <A HREF="k103_5waa.htm"><B>HalGetBusDataByOffset</B></A> routines. In Windows®&nbsp;2000 and later operating systems, the hardware buses are controlled by their respective bus drivers and not by HAL. Therefore, all of the HAL routines that used to help drivers retrieve bus-related information are obsolete in Windows2000.</P>

<P>The configuration space for a device contains a description of the device and its resource requirements. On Windows&nbsp;2000 and later operating systems, a driver does not need to query a device to find resources. The driver gets the resources from the Plug and Play (PnP) manager in its <A HREF="pnp-irps_1gqa.htm">IRP_MN_START_DEVICE</A> request. Typically, a well-written driver would not require any of this information to function correctly. If for some reason the driver requires this information, the code sample in the <A HREF="iputoput_4pev.htm">Obtaining Device Configuration Information at Passive IRQL</A> section shows how to get the resources. The driver must be part of the target device's driver stack, because it requires the underlying physical device objects (PDO) of the target device to send the appropriate PnP request.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Accessing%20Device%20Configuration%20Space"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
