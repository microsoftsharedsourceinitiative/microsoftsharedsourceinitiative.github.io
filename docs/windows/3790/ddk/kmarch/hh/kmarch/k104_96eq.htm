<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>IoBuildPartialMdl</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="IoBuildPartialMdl">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Kernel-Mode&nbsp;Driver&nbsp;Architecture:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_iobuildpartialmdl_kr"></A>IoBuildPartialMdl</H1>

<P>The <B>IoBuildPartialMdl</B> routine maps a portion of a buffer described by another MDL into an MDL.</P>

<PRE class=syntax><B>VOID 
</B>  <B>IoBuildPartialMdl(</B>
<B>    IN PMDL</B>  <I>SourceMdl</I><B>,</B>
<B>    IN OUT PMDL</B>  <I>TargetMdl</I><B>,</B>
<B>    IN PVOID</B>  <I>VirtualAddress</I><B>,</B>
<B>    IN ULONG</B>  <I>Length</I>
<B>    );</B></PRE>

<H4>Parameters</H4>

<DL>
<DT><I>SourceMdl</I></DT>

<DD>Pointer to an MDL describing the original buffer, of which a subrange is to be mapped.</DD>

<DT><I>TargetMdl</I></DT>

<DD>Pointer to a caller-allocated MDL. The MDL must be large enough to map the subrange specified by <I>VirtualAddress</I> and <I>Length</I>.</DD>

<DT><I>VirtualAddress</I></DT>

<DD>Pointer to the base virtual address for the subrange to be mapped in the <I>TargetMdl</I>.</DD>

<DT><I>Length</I></DT>

<DD>Specifies the length in bytes to be mapped by the <I>TargetMdl</I>. This value, in combination with <I>VirtualAddress</I>, must specify a buffer that is a proper subrange of the buffer described by <I>SourceMdl</I>. If <I>Length</I> is zero, the subrange to be mapped starts at <I>VirtualAddress</I> and includes the remaining range described by the <I>SourceMdl</I>.
</DD>
</DL>

<H4>Return Value</H4>

<P>None</P>

<H4>Headers</H4>

<P>Declared in <I>wdm.h</I> and <I>ntddk.h</I>. Include <I>wdm.h</I> or <I>ntddk.h</I>.</P>

<H4>Comments</H4>

<P><B>IoBuildPartialMdl</B> maps a subrange of a buffer currently mapped by <I>SourceMdl</I>. The <I>VirtualAddress</I> and <I>Length</I> parameters describe the subrange to be mapped from the <I>SourceMdl</I> into the <I>TargetMdl</I>.</P>

<P>Drivers that must split large transfer requests can use this routine. The caller must release the partial MDL it allocated when it has transferred all the requested data or completed the IRP with an error status.</P>

<P>Callers of <B>IoBuildPartialMdl</B> can be running at IRQL&nbsp;&lt;= DISPATCH_LEVEL.</P>

<H4>See Also</H4>

<P><A HREF="k104_3c8i.htm"><B>IoAllocateMdl</B></A>, <A HREF="k104_1agi.htm"><B>IoCallDriver</B></A>, <A HREF="k104_7cfm.htm"><B>IoFreeMdl</B></A>, <A HREF="k104_5w6q.htm"><B>IoSetCompletionRoutine</B></A> </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: IoBuildPartialMdl"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
