<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>IRP_MJ_INTERNAL_DEVICE_CONTROL</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="IRP_MJ_INTERNAL_DEVICE_CONTROL">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Kernel-Mode&nbsp;Driver&nbsp;Architecture:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_irp_mj_internal_device_control_kr"></A>IRP_MJ_INTERNAL_DEVICE_CONTROL</H1>

<P>In general, any replacement for an existing driver that supports internal device control requests should handle this request in a <A HREF="drvrrtns_0cvm.htm"><I>DispatchInternalDeviceControl</I></A> routine. Such a driver also should support at least the same set of internal I/O control codes as the driver it replaces. Otherwise, existing higher-level drivers might not work with the new driver.</P>

<P>Drivers that replace certain lower-level system drivers are required to handle this request. For example, a replacement for the system parallel port driver must continue to support existing parallel class drivers. Note that certain system drivers that handle this request cannot be replaced, in particular, the system-supplied SCSI and video port drivers.</P>

<H4>When Sent</H4>

<P>Any time after the successful completion of a create request.</P>

<H4>Input Parameters</H4>

<P>The I/O control code is contained at <B>Parameters.DeviceIoControl.IoControlCode</B> in the I/O stack location of the IRP.</P>

<P>Other input parameters depend on the I/O control code's value. For more information, see <A HREF="irps_7j53.htm">Buffer Descriptions for I/O Control Codes</A>.</P>

<H4>Output Parameters</H4>

<P>Output parameters depend on the I/O control code's value. For more information, see <A HREF="irps_7j53.htm">Buffer Descriptions for I/O Control Codes</A>.</P>

<H4>Operation</H4>

<P>This I/O control code has been defined for communication between paired and layered kernel-mode drivers, such as one or more class drivers layered over a port driver. The higher-level driver sets up IRPs with device- or driver-specific I/O control codes, requesting support from the next-lower driver.</P>

<P>The requested operation is device- or driver-specific.</P>

<P>For general information about I/O control codes for <A HREF="k113_0hiq.htm">IRP_MJ_DEVICE_CONTROL</A> or IRP_MJ_INTERNAL_DEVICE_CONTROL requests, see <A HREF="irps_65k7.htm">Using I/O Control Codes</A>. See also <A HREF="irps_0hlz.htm">Device Type-specific I/O Requests</A>.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: IRP_MJ_INTERNAL_DEVICE_CONTROL"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
