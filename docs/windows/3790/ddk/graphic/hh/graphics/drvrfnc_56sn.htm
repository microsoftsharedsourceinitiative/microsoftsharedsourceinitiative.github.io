<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>DrvQueryJobAttributes</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="DrvQueryJobAttributes">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Display&nbsp;and&nbsp;Print&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_drvqueryjobattributes_gg"></A>DrvQueryJobAttributes</H1>

<P>The <B>DrvQueryJobAttributes</B> function allows a printer interface DLL to specify support for such capabilities as printing multiple document pages on a physical page ("N-up" printing), printing multiple copies of each page, collating pages, and printing pages in reverse order.</P>

<PRE class=syntax><B>BOOL
  DrvQueryJobAttributes(
    HANDLE  </B><I>hPrinter</I><B>,
    PDEVMODE  </B><I>pDevMode</I><B>,
    DWORD  </B><I>dwLevel</I><B>,
    LPBYTE  </B><I>lpAttributeInfo</I><B>
    );</B></PRE>

<H4>Parameters</H4>

<DL>
<DT><I>hPrinter</I></DT>

<DD>Caller-supplied printer handle.</DD>

<DT><I>pDevMode</I></DT>

<DD>Caller-supplied pointer to a <A HREF="grstrcts_6v8n.htm">DEVMODE</A> structure.</DD>

<DT><I>dwLevel</I></DT>

<DD>Caller-supplied value indicating the type of structure pointed to by <I>lpAttributeInfo</I>, as indicated in the following table.

<TABLE>

<TR VALIGN="top">
<TH align=left width=26%><I>dwLevel</I> Value</TH>
<TH align=left width=74%>Structure pointed to by <I>lpAttributeInfo</I></TH>
</TR>

<TR VALIGN="top">
<TD width=26%>1</TD>
<TD width=74%><A HREF="drvrfnc_18dk.htm">ATTRIBUTE_INFO_1</A></TD>
</TR>

<TR VALIGN="top">
<TD width=26%>2</TD>
<TD width=74%><A HREF="drvrfnc_6unb.htm">ATTRIBUTE_INFO_2</A></TD>
</TR>

<TR VALIGN="top">
<TD width=26%>3</TD>
<TD width=74%><A HREF="drvrfnc_2gx3.htm">ATTRIBUTE_INFO_3</A></TD>
</TR>
</TABLE><BR>

</DD>

<DT><I>lpAttributeInfo</I></DT>

<DD>Caller-supplied pointer to a structure identified by <I>dwLevel</I>.
</DD>
</DL>

<H4>Return Value</H4>

<P>If the operation succeeds, the function should return TRUE. Otherwise, it should return FALSE. Returning FALSE causes the current print job to be canceled.</P>

<H4>Headers</H4>

<P>Declared in <I>winddiui.h</I>. Include <I>winddiui.h</I>.</P>

<H4>Comments</H4>

<P>A <A HREF="drvarch_29pj.htm">printer interface DLL</A> can optionally provide a <B>DrvQueryJobAttributes</B> function. If the function is provided, it should fill in the supplied structure, described by <I>dwLevel</I> and <I>plAttributeInfo</I>, to indicate the current print job's user-requested attributes (such as N-up parameters and the number of copies) and the driver's ability to support those attributes. The function is typically called by the EMF print processor, so it can determine which job attributes can be handled by the driver (or printer), and which must be handled by the print processor.</P>

<P>For descriptions of the job attributes that the function can specify, see the descriptions of <A HREF="drvrfnc_18dk.htm">ATTRIBUTE_INFO_1</A>, <A HREF="drvrfnc_6unb.htm">ATTRIBUTE_INFO_2</A>, and <A HREF="drvrfnc_2gx3.htm">ATTRIBUTE_INFO_3</A>.</P>

<H4>See Also</H4>

<P><A HREF="drvrfnc_18dk.htm">ATTRIBUTE_INFO_1</A>, <A HREF="drvrfnc_6unb.htm">ATTRIBUTE_INFO_2</A>, <A HREF="drvrfnc_2gx3.htm">ATTRIBUTE_INFO_3</A>.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: DrvQueryJobAttributes"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
