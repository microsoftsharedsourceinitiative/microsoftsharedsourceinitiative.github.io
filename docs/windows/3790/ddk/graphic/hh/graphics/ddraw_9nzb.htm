<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Interface Between BaseVDD/MiniVDD/Display Drivers</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Interface Between BaseVDD/MiniVDD/Display Drivers">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Display&nbsp;and&nbsp;Print&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="ddk_interface_between_basevdd_minivdd_display_drivers_gg"></A>Interface Between BaseVDD/MiniVDD/Display Drivers</H2>

<P><B>This topic applies only to Windows Me.</B></P>

<P>The following table lists the functions that must be supported by each display driver/miniVDD for the primary and secondary display adapters or usable services.</P>

<H4>MiniVDD Functions</H4>

<P><B>baseVDD </B><B>—</B><B>&gt; miniVDD</B></P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=8%>No.</TH>
<TH align=left width=37%>Function</TH>
<TH align=left width=22%>&nbsp;</TH>
<TH align=left width=7%>Pri</TH>
<TH align=left width=12%>Sec</TH>
<TH align=left width=14%>Notes</TH>
</TR>

<TR VALIGN="top">
<TD width=8%>1</TD>
<TD width=37%><B>REGISTER_DISPLAY_DRIVER</B></TD>
<TD width=22%>Interface between miniVDD and driver</TD>
<TD width=7%>2</TD>
<TD width=12%>2</TD>
<TD width=14%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=8%>2</TD>
<TD width=37%><B>PRE_HIRES_TO_VGA</B></TD>
<TD width=22%>Switch to core graph</TD>
<TD width=7%>1</TD>
<TD width=12%>3</TD>
<TD width=14%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=8%>3</TD>
<TD width=37%><B>SAVE_REGISTERS</B></TD>
<TD width=22%>Save registers</TD>
<TD width=7%>2</TD>
<TD width=12%>3</TD>
<TD width=14%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=8%>4</TD>
<TD width=37%><B>RESTORE_REGISTERS</B></TD>
<TD width=22%>Restore registers</TD>
<TD width=7%>2</TD>
<TD width=12%>3</TD>
<TD width=14%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=8%>5</TD>
<TD width=37%><B>ENABLE_TRAPS </B></TD>
<TD width=22%>Enable I/O traps</TD>
<TD width=7%>2</TD>
<TD width=12%>3</TD>
<TD width=14%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=8%>6</TD>
<TD width=37%><B>DISABLE_TRAPS </B></TD>
<TD width=22%>Disable I/O traps</TD>
<TD width=7%>2</TD>
<TD width=12%>3</TD>
<TD width=14%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=8%>7</TD>
<TD width=37%><B>DISPLAY_DRIVER_DISABLING</B></TD>
<TD width=22%>Disable display</TD>
<TD width=7%>1</TD>
<TD width=12%>1</TD>
<TD width=14%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=8%>8</TD>
<TD width=37%><B>ENABLE_ACCELERATER</B></TD>
<TD width=22%>Enable display</TD>
<TD width=7%>1</TD>
<TD width=12%>3</TD>
<TD width=14%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=8%>9</TD>
<TD width=37%><B>DISABLE_ACCELERATER</B></TD>
<TD width=22%>&nbsp;</TD>
<TD width=7%>3</TD>
<TD width=12%>3</TD>
<TD width=14%>Not Used</TD>
</TR>

<TR VALIGN="top">
<TD width=8%>10</TD>
<TD width=37%><B>CHECK_UPDATE </B></TD>
<TD width=22%>&nbsp;</TD>
<TD width=7%>3</TD>
<TD width=12%>3</TD>
<TD width=14%>Not Used</TD>
</TR>

<TR VALIGN="top">
<TD width=8%>11</TD>
<TD width=37%><B>CHECK_WINDOWED </B></TD>
<TD width=22%>&nbsp;</TD>
<TD width=7%>3</TD>
<TD width=12%>3</TD>
<TD width=14%>Not Used</TD>
</TR>

<TR VALIGN="top">
<TD width=8%>12</TD>
<TD width=37%><B>ACC_VBE_PM</B></TD>
<TD width=22%>VBE/PM </TD>
<TD width=7%>2</TD>
<TD width=12%>2</TD>
<TD width=14%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=8%>13</TD>
<TD width=37%><B>ACC_VBE_DDC</B></TD>
<TD width=22%>VBE/DDC </TD>
<TD width=7%>2</TD>
<TD width=12%>2</TD>
<TD width=14%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=8%>14</TD>
<TD width=37%><B>ACC_INT_10</B></TD>
<TD width=22%>ESA BIOS (VGA BIOS) </TD>
<TD width=7%>4</TD>
<TD width=12%>3</TD>
<TD width=14%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=8%>15</TD>
<TD width=37%><B>ACC_GET_CAPABILITIES</B></TD>
<TD width=22%>Accelerator BIOS</TD>
<TD width=7%>4</TD>
<TD width=12%>3</TD>
<TD width=14%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=8%>16</TD>
<TD width=37%><B>ACC_GET_EXT_MODE_INFO</B></TD>
<TD width=22%>Accelerator BIOS</TD>
<TD width=7%>4</TD>
<TD width=12%>3</TD>
<TD width=14%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=8%>17</TD>
<TD width=37%><B>ACC_GET_FLAT_SELECTOR</B></TD>
<TD width=22%>Accelerator BIOS</TD>
<TD width=7%>4</TD>
<TD width=12%>3</TD>
<TD width=14%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=8%>18</TD>
<TD width=37%><B>ACC_ENABLE_BIOS</B></TD>
<TD width=22%>Accelerator BIOS</TD>
<TD width=7%>4</TD>
<TD width=12%>3</TD>
<TD width=14%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=8%>19</TD>
<TD width=37%><B>ACC_DISABLE_BIOS</B></TD>
<TD width=22%>Accelerator BIOS</TD>
<TD width=7%>4</TD>
<TD width=12%>3</TD>
<TD width=14%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=8%>20</TD>
<TD width=37%><B>ACC_SET_PALETTE</B></TD>
<TD width=22%>Accelerator BIOS </TD>
<TD width=7%>4</TD>
<TD width=12%>3</TD>
<TD width=14%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=8%>21</TD>
<TD width=37%><B>ACC_GET_PALETTE</B></TD>
<TD width=22%>Accelerator BIOS </TD>
<TD width=7%>4</TD>
<TD width=12%>3</TD>
<TD width=14%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=8%>22</TD>
<TD width=37%><B>ACC_SET_CURSOR</B></TD>
<TD width=22%>Accelerator BIOS</TD>
<TD width=7%>4</TD>
<TD width=12%>3</TD>
<TD width=14%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=8%>23</TD>
<TD width=37%><B>ACC_SHOW_CURSOR</B></TD>
<TD width=22%>Accelerator BIOS</TD>
<TD width=7%>4</TD>
<TD width=12%>3</TD>
<TD width=14%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=8%>24</TD>
<TD width=37%><B>ACC_HIDE_CURSOR</B></TD>
<TD width=22%>Accelerator BIOS</TD>
<TD width=7%>4</TD>
<TD width=12%>3</TD>
<TD width=14%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=8%>26</TD>
<TD width=37%><B>ACC_GET_CURSOR_POS</B></TD>
<TD width=22%>Accelerator BIOS</TD>
<TD width=7%>4</TD>
<TD width=12%>3</TD>
<TD width=14%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=8%>27</TD>
<TD width=37%><B>GET_NUM_UNITS</B></TD>
<TD width=22%>Obtain number of monitor units available for connection</TD>
<TD width=7%>2</TD>
<TD width=12%>2</TD>
<TD width=14%>New Feature<BR>
(not yet supported)</TD>
</TR>

<TR VALIGN="top">
<TD width=8%>28</TD>
<TD width=37%><B>SET_ADAPTER_POWER_STATE</B></TD>
<TD width=22%>&nbsp;</TD>
<TD width=7%>2</TD>
<TD width=12%>2</TD>
<TD width=14%>New Feature<BR>
(not yet supported)</TD>
</TR>

<TR VALIGN="top">
<TD width=8%>29</TD>
<TD width=37%><B>GET_ADAPTER_POWER_<BR>
STATE_CAPS</B></TD>
<TD width=22%>&nbsp;</TD>
<TD width=7%>2</TD>
<TD width=12%>2</TD>
<TD width=14%>New Feature</TD>
</TR>

<TR VALIGN="top">
<TD width=8%>30</TD>
<TD width=37%><B>SET_MONITOR_POWER_STATE</B></TD>
<TD width=22%>&nbsp;</TD>
<TD width=7%>2</TD>
<TD width=12%>2</TD>
<TD width=14%>New Feature</TD>
</TR>

<TR VALIGN="top">
<TD width=8%>31</TD>
<TD width=37%><B>GET_MONITOR_POWER_<BR>
STATE_CAPS</B></TD>
<TD width=22%>&nbsp;</TD>
<TD width=7%>2</TD>
<TD width=12%>2</TD>
<TD width=14%>New Feature</TD>
</TR>

<TR VALIGN="top">
<TD width=8%>32</TD>
<TD width=37%><B>ET_MONITOR_INFO</B></TD>
<TD width=22%>&nbsp;</TD>
<TD width=7%>2</TD>
<TD width=12%>2</TD>
<TD width=14%>New Feature</TD>
</TR>

<TR VALIGN="top">
<TD width=8%>33</TD>
<TD width=37%><B>I2C_OPEN</B></TD>
<TD width=22%>&nbsp;</TD>
<TD width=7%>2</TD>
<TD width=12%>2</TD>
<TD width=14%>New Feature</TD>
</TR>

<TR VALIGN="top">
<TD width=8%>34</TD>
<TD width=37%><B>I2C_ACCESS</B></TD>
<TD width=22%>&nbsp;</TD>
<TD width=7%>2</TD>
<TD width=12%>2</TD>
<TD width=14%>New Feature</TD>
</TR>

<TR VALIGN="top">
<TD width=8%>35</TD>
<TD width=37%><B>GPIO_OPEN</B></TD>
<TD width=22%>&nbsp;</TD>
<TD width=7%>2</TD>
<TD width=12%>2</TD>
<TD width=14%>New Feature</TD>
</TR>

<TR VALIGN="top">
<TD width=8%>36</TD>
<TD width=37%><B>GPIO_ACCESS</B></TD>
<TD width=22%>&nbsp;</TD>
<TD width=7%>2</TD>
<TD width=12%>2</TD>
<TD width=14%>New Feature</TD>
</TR>

<TR VALIGN="top">
<TD width=8%>37</TD>
<TD width=37%><B>COPYPROTECTION_ACCESS</B></TD>
<TD width=22%>&nbsp;</TD>
<TD width=7%>2</TD>
<TD width=12%>2</TD>
<TD width=14%>New Feature</TD>
</TR>

<TR VALIGN="top">
<TD colspan=6 width=100%>1: Support is necessary<BR>
2: Support may be necessary<BR>
3: Support is unnecessary (not in use)<BR>
4: Necessary for accelerator BIOS support (this function may not be supported in the future)</TD>
</TR>
</TABLE><BR>

<H4>Protected Mode API Functions</H4>

<P><B>Display driver (Windows kernel) </B><B>—</B><B>&gt; baseVDD</B> </P>

<P>The functions in the following table that comprise the miniVDD-related protected mode API call interface will be changed partially. </P>

<P>Display drivers to be created in the future must follow these guidelines.</P>

<P>For multimonitor support to operate — when a candidate for the secondary display adapter exists, a display driver that meets the calling guidelines in the following table must be set as the primary (or it can be used as a secondary). </P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=5%>No</TH>
<TH align=left width=40%>Function</TH>
<TH align=left width=25%>&nbsp;</TH>
<TH align=left width=7%>Pri</TH>
<TH align=left width=7%>Sec</TH>
<TH align=left width=16%>Notes</TH>
</TR>

<TR VALIGN="top">
<TD width=5%>1</TD>
<TD width=40%><B>VDD_DRIVER_REGISTER</B></TD>
<TD width=25%>Register VDD driver</TD>
<TD width=7%>1</TD>
<TD width=7%>1</TD>
<TD width=16%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=5%>2</TD>
<TD width=40%><B>VDD_DRIVER_UNREGISTER </B></TD>
<TD width=25%>Unregister VDD driver</TD>
<TD width=7%>1</TD>
<TD width=7%>1</TD>
<TD width=16%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=5%>3</TD>
<TD width=40%><B>VDD_SAVE_DRIVER_STATE </B></TD>
<TD width=25%>&nbsp;</TD>
<TD width=7%>3</TD>
<TD width=7%>3</TD>
<TD width=16%>Not Used</TD>
</TR>

<TR VALIGN="top">
<TD width=5%>4</TD>
<TD width=40%><B>VDD_REGISTER_DISPLAY_<BR>
DRIVER_INFO</B></TD>
<TD width=25%>Interface between miniVDD and driver</TD>
<TD width=7%>2</TD>
<TD width=7%>2</TD>
<TD width=16%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=5%>5</TD>
<TD width=40%><B>VDD_REGISTER_SSB_FLAGS</B></TD>
<TD width=25%>&nbsp;</TD>
<TD width=7%>3</TD>
<TD width=7%>3</TD>
<TD width=16%>Not Used</TD>
</TR>

<TR VALIGN="top">
<TD width=5%>6</TD>
<TD width=40%><B>VDD_GET_DISPLAY_CONFIG</B></TD>
<TD width=25%>Obtain display settings</TD>
<TD width=7%>2</TD>
<TD width=7%>2</TD>
<TD width=16%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=5%>7</TD>
<TD width=40%><B>VDD_PRE_MODE_CHANGE</B></TD>
<TD width=25%>&nbsp;</TD>
<TD width=7%>3</TD>
<TD width=7%>3</TD>
<TD width=16%>Not Used</TD>
</TR>

<TR VALIGN="top">
<TD width=5%>8</TD>
<TD width=40%><B>VDD_POST_MODE_CHANGE</B></TD>
<TD width=25%>&nbsp;</TD>
<TD width=7%>3</TD>
<TD width=7%>3</TD>
<TD width=16%>Not Used</TD>
</TR>

<TR VALIGN="top">
<TD width=5%>9</TD>
<TD width=40%><B>VDD_SET_USER_FLAGS</B></TD>
<TD width=25%>&nbsp;</TD>
<TD width=7%>3</TD>
<TD width=7%>3</TD>
<TD width=16%>Not Used</TD>
</TR>

<TR VALIGN="top">
<TD width=5%>10</TD>
<TD width=40%><B>VDD_SET_BUSY_FLAG_ADDR</B></TD>
<TD width=25%>&nbsp;</TD>
<TD width=7%>3</TD>
<TD width=7%>3</TD>
<TD width=16%>Not Used</TD>
</TR>

<TR VALIGN="top">
<TD width=5%>11</TD>
<TD width=40%><B>VDD_VBE_PM</B></TD>
<TD width=25%>Power management 
<P>(—&gt; ACC_VBE_PM) </P>
</TD>
<TD width=7%>2</TD>
<TD width=7%>2</TD>
<TD width=16%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=5%>12</TD>
<TD width=40%><B>VDD_ENABLE</B></TD>
<TD width=25%>Resource control</TD>
<TD width=7%>3</TD>
<TD width=7%>3</TD>
<TD width=16%>New Feature</TD>
</TR>

<TR VALIGN="top">
<TD width=5%>13</TD>
<TD width=40%><B>VDD_GETMEMBASE</B></TD>
<TD width=25%>Obtain memory address</TD>
<TD width=7%>3</TD>
<TD width=7%>3</TD>
<TD width=16%>New Feature</TD>
</TR>

<TR VALIGN="top">
<TD width=5%>14</TD>
<TD width=40%><B>VDD_OPEN</B></TD>
<TD width=25%>Open device</TD>
<TD width=7%>2</TD>
<TD width=7%>2</TD>
<TD width=16%>New Feature</TD>
</TR>

<TR VALIGN="top">
<TD width=5%>15</TD>
<TD width=40%><B>VDD_CLOSE</B></TD>
<TD width=25%>Close device</TD>
<TD width=7%>2</TD>
<TD width=7%>2</TD>
<TD width=16%>New Feature</TD>
</TR>

<TR VALIGN="top">
<TD width=5%>16</TD>
<TD width=40%><B>VDD_OPEN_KEY</B></TD>
<TD width=25%>Open settings key</TD>
<TD width=7%>2</TD>
<TD width=7%>2</TD>
<TD width=16%>New Feature</TD>
</TR>

<TR VALIGN="top">
<TD width=5%>17</TD>
<TD width=40%><B>VDD_SET_POWER_STATE</B></TD>
<TD width=25%>Power management 
<P>(—&gt; ACC_VBE_PM)</P>
</TD>
<TD width=7%>2</TD>
<TD width=7%>2</TD>
<TD width=16%>New Feature</TD>
</TR>

<TR VALIGN="top">
<TD colspan=6 width=100%>1: Support is necessary<BR>
2: Can be used<BR>
3: Cannot be used</TD>
</TR>
</TABLE><BR>

<H4>VDD Service Functions</H4>

<P><B>miniVDD </B><B>—</B><B>&gt; baseVDD</B></P>

<P>The functions in the following table that comprise the miniVDD-related VDD service call interface will be changed partially.</P>

<P>Display drivers to be created in the future must follow these guidelines.</P>

<TABLE>

<TR VALIGN="top">
<TD width=5%>No</TD>
<TH align=left width=39%>Function</TH>
<TH align=left width=27%>Pri</TH>
<TH align=left width=8%>Sec</TH>
<TH align=left width=8%>Notes</TH>
<TH align=left width=13%>Notes</TH>
</TR>

<TR VALIGN="top">
<TD width=5%>1</TD>
<TD width=39%><B>VDD_Get_Special_VM_IDs</B></TD>
<TD width=27%>Obtain Message VM ID </TD>
<TD width=8%>1</TD>
<TD width=8%>1</TD>
<TD width=13%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=5%>2</TD>
<TD width=39%><B>VDD_Register_Mini_VDD</B></TD>
<TD width=27%>Register miniVDD </TD>
<TD width=8%>1</TD>
<TD width=8%>1</TD>
<TD width=13%>Modified</TD>
</TR>

<TR VALIGN="top">
<TD width=5%>3</TD>
<TD width=39%><B>VDD_Install_IO_Handler</B></TD>
<TD width=27%>I/O trap </TD>
<TD width=8%>3</TD>
<TD width=8%>&nbsp;</TD>
<TD width=13%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=5%>4</TD>
<TD width=39%><B>VDD_Install_Mult_IO_Handlers</B></TD>
<TD width=27%>I/O trap </TD>
<TD width=8%>3</TD>
<TD width=8%>&nbsp;</TD>
<TD width=13%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=5%>5</TD>
<TD width=39%><B>VDD_Enable_Local_Trapping</B></TD>
<TD width=27%>I/O trap </TD>
<TD width=8%>3</TD>
<TD width=8%>&nbsp;</TD>
<TD width=13%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=5%>6</TD>
<TD width=39%><B>VDD_Disable_Local_Trapping</B></TD>
<TD width=27%>I/O trap </TD>
<TD width=8%>3</TD>
<TD width=8%>&nbsp;</TD>
<TD width=13%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=5%>7</TD>
<TD width=39%><B>Test_Vid_VM_Handle</B></TD>
<TD width=27%>Display owner VM check </TD>
<TD width=8%>1</TD>
<TD width=8%>1</TD>
<TD width=13%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=5%>8</TD>
<TD width=39%><B>VDD_Trap_Suspend</B></TD>
<TD width=27%>Interrupt process </TD>
<TD width=8%>1</TD>
<TD width=8%>1</TD>
<TD width=13%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=5%>9</TD>
<TD width=39%><B>VDD_Map_VRAM</B></TD>
<TD width=27%>Accelerator BIOS</TD>
<TD width=8%>3</TD>
<TD width=8%>2</TD>
<TD width=13%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD colspan=6 width=100%>1: Can be used<BR>
2: Cannot be used<BR>
3: Cannot be used due to possible discontinuation of support in the future (supported in Windows 98 for compatibility with current drivers)</TD>
</TR>
</TABLE><BR>

<P></P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Interface%20Between%20BaseVDD%2FMiniVDD%2FDisplay%20Drivers"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
