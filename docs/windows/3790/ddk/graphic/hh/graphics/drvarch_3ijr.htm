<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Printer Driver Architecture</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Printer Driver Architecture">
</HEAD>
<BODY TOPMARGIN="0">
<DIV STYLE="display:none;">
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_print_processor_gg_gly">
</OBJECT>
</DIV>


<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Display&nbsp;and&nbsp;Print&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_printer_driver_architecture_gg"></A>Printer Driver Architecture</H1>

<P>Print jobs are created by applications through calls to Microsoft® Win32® GDI functions. These function calls can be spooled as <A HREF="provider_1jmv.htm">EMF data type</A> records for later playback by the EMF <A HREF="JavaScript:hhobj_1.Click()">print processor</A>, or they can immediately render a printable image for each document page. Image rendering, whether performed immediately or during the playback of EMF records, is controlled by the GDI rendering engine. During the rendering operation, the GDI rendering engine calls the appropriate Windows®&nbsp;2000 and later printer driver for assistance.</P>

<P>Windows&nbsp;2000 and later printer drivers have the following responsibilities:

<UL>
	<LI>They assist GDI in rendering print jobs by providing printer-specific drawing capabilities that cannot be supported by GDI.</LI>

	<LI>They send the rendered image's data stream to the print spooler.</LI>

	<LI>They provide a user interface to the modifiable configuration parameters associated with printers and print documents, such as which input and output trays are selected, the number of copies, image resolution and orientation, and so on.</LI>
</UL>

<P>Windows&nbsp;2000 and later printer drivers are made up of a set of <A HREF="drvarch_0krr.htm">printer driver components</A> that divide a driver's drawing and user interface operations into separate DLLs.</P>

<P>While the purpose of this section is to explain how to write your own printer driver for Windows&nbsp;2000 and later, it is important to keep in mind that the following three printer drivers are shipped with the operating system:</P>

<P class=indent1><A HREF="nt5gpd_4mcn.htm">Microsoft Universal Printer Driver</A> </P>

<P class=indent1><A HREF="pscript_3jfr.htm">Microsoft Postscript Printer Driver</A> </P>

<P class=indent1><A HREF="plotter_4vjb.htm">Microsoft Plotter Driver</A> </P>

<P>These three drivers support most printing devices on the market today. You only need to write a printer driver if your printing device is not compatible with the appropriate Microsoft-supplied driver. Most new printers can be supported by simply adding a <A HREF="drvarch_1usn.htm">printer data file</A> to one of these drivers. Devices that might require a new driver include those containing hardware drawing accelerators controlled by proprietary command sequences.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Printer%20Driver%20Architecture"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
