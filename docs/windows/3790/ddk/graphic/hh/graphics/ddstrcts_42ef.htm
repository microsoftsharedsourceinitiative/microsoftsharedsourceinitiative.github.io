<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>DDRAWI_DDRAWSURFACE_GBL_MORE</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="DDRAWI_DDRAWSURFACE_GBL_MORE">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Display&nbsp;and&nbsp;Print&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_ddrawi_ddrawsurface_gbl_more_gg"></A>DDRAWI_DDRAWSURFACE_GBL_MORE</H1>

<P>The DDRAWI_DDRAWSURFACE_GBL_MORE structure contains additional global DirectDrawSurface data that can be shared between object instances. </P>

<PRE class=syntax>typedef struct _DDRAWI_DDRAWSURFACE_GBL_MORE {
  DWORD    dwSize;
  union {
     DWORD     dwPhysicalPageTable;
     FLATPTR   fpPhysicalVidMem;
  };
  LPDWORD  pPageTable;
  DWORD    cPages;
  ULONG_PTR    dwSavedDCContext;
  FLATPTR  fpAliasedVidMem;
  ULONG_PTR    dwDriverReserved;
  ULONG_PTR    dwHELReserved;
  DWORD    cPageUnlocks;
  ULONG_PTR    hKernelSurface;
  DWORD    dwKernelRefCnt;
  LPDDCOLORCONTROL lpColorInfo;
  FLATPTR  fpNTAlias;
  DWORD    dwContentsStamp;
  LPVOID   lpvUnswappedDriverReserved;
  LPVOID   lpDDRAWReserved2;
  DWORD    dwDDRAWReserved1;
  DWORD    dwDDRAWReserved2;
  FLATPTR  fpAliasOfVidMem;
} DDRAWI_DDRAWSURFACE_GBL_MORE;</PRE>

<H4>Members</H4>

<DL>
<DT><B>dwSize</B></DT>

<DD>Specifies the size of the structure. This member must be initialized before the structure is used.</DD>

<DT><B>dwPhysicalPageTable</B></DT>

<DD>Specifies the physical address of the page table (an array of physical addresses with one per 4KB page). This is the physical address of the table of physical addresses of the pages that hold the page-locked system memory surface. This table is valid whenever the <B>dwPageLockCount</B> member of the <A HREF="ddstrcts_4q07.htm">DDRAWI_DDRAWSURFACE_MORE</A> structure is non-zero.</DD>

<DT><B>fpPhysicalVidMem</B></DT>

<DD>Specifies the physical address of the surface (non-local display memory only).</DD>

<DT><B>pPageTable</B></DT>

<DD>Specifies the linear address of the page table whose physical address is given in <B>dwPhysicalPageTable</B>.</DD>

<DT><B>cPages</B></DT>

<DD>Specifies the count of elements in the array pointed to by <B>dwPhysicalPageTable</B> and <B>pPageTable</B>. This is equal to the number of physical pages representing the surface.</DD>

<DT><B>dwSavedDCContext</B></DT>

<DD>Used by the DirectDraw API and should not be filled in by the driver.</DD>

<DT><B>fpAliasedVidMem</B></DT>

<DD>Used by DirectDraw and should not be filled in by the driver.</DD>

<DT><B>dwDriverReserved</B></DT>

<DD>Reserved for driver use (both system and display memory surfaces).</DD>

<DT><B>dwHELReserved</B></DT>

<DD>Used by DirectDraw and should not be filled in by the driver.</DD>

<DT><B>cPageUnlocks</B></DT>

<DD>Specifies the number of times a surface is page-unlocked. This member is incremented whenever the surface is page-unlocked. Drivers can cache the physical page table of a surface, then check this value whenever a new DMA request is received. If the value has changed, then the driver's cache of the physical page table needs to be updated. If not, the surface has remained page-locked since the last time it was passed to the driver.</DD>

<DT><B>hKernelSurface</B></DT>

<DD>Specifies the kernel handle for this surface.</DD>

<DT><B>dwKernelRefCnt</B></DT>

<DD>Used by DirectDraw and should not be filled in by the driver.<B> </B></DD>

<DT><B>lpColorInfo</B></DT>

<DD>Used by DirectDraw and should not be filled in by the driver.</DD>

<DT><B>fpNTAlias</B></DT>

<DD>Used by internally by DirectDraw and should not be filled in by the driver.</DD>

<DT><B>dwContentsStamp</B></DT>

<DD>Specifies a value that changes when the surface data changes. A value of 0 means no information.</DD>

<DT><B>lpvUnswappedDriverReserved</B></DT>

<DD>Reserved for use by the display driver. It is not swapped when a <B>Flip</B> is called on this surface.</DD>

<DT><B>lpDDRAWReserved2</B></DT>

<DD>Reserved.</DD>

<DT><B>dwDDRAWReserved1</B></DT>

<DD>Reserved.</DD>

<DT><B>dwDDRAWReserved2</B></DT>

<DD>Reserved.</DD>

<DT><B>fpAliasOfVidMem</B></DT>

<DD>Used by DirectDraw and should not be filled in by the driver.
</DD>
</DL>

<H4>Headers</H4>

<P>Defined in <I>ddrawi.h</I>. Include <I>ddrawi.h</I>.</P>

<H4>Comments</H4>

<P>Driver writers should use the <B>GET_LPDDRAWSURFACE_GBL_MORE</B> macro to traverse from a <A HREF="ddstrcts_5mw7.htm">DDRAWI_DDRAWSURFACE_GBL</A> address to the DDRAWI_DDRAWSURFACE_GBL_MORE structure. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: DDRAWI_DDRAWSURFACE_GBL_MORE"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
