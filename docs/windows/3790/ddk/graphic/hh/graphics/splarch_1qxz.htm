<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Functions Defined by Print Providers</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Functions Defined by Print Providers">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Display&nbsp;and&nbsp;Print&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="ddk_functions_defined_by_print_providers_gg"></A>Functions Defined by Print Providers</H3>

<P>This topic lists all of the functions a print provider can supply. Most of these functions are described in the Platform SDK documentation. If the function is described in this DDK, the function name provides a link to the associated reference page.</P>

<P>All print providers must supply pointers for all listed functions. However, most vendor-supplied print providers are "partial providers" which do not need to support many of the operations defined by the functions. Therefore, many of the function pointers can be NULL. For more information about partial print providers, see <A HREF="provider_1f6v.htm">Writing a Network Print Provider</A>.</P>

<P>In the following function lists, functions that must be supported are labeled "Required".</P>

<P>All print providers must export the initialization function, <A HREF="spoolfnc_6qef.htm"><B>InitializePrintProvidor</B></A>. Pointers to all the other functions must be supplied in a <A HREF="spoolfnc_8zl3.htm">PRINTPROVIDOR</A> structure. (Note that these two names are misspelled, but are consistent with the names that appear in the header file, <I>winsplp.h</I>.)</P>

<P>Functions are divided into the following groups:</P>

<P class=indent1><A HREF="#ddk_initialization_function_gg">Initialization Function</A> </P>

<P class=indent1><A HREF="#ddk_print_queue_management_functions_gg">Print Queue Management Functions</A> </P>

<P class=indent1><A HREF="#ddk_printer_driver_management_functions_gg">Printer Driver Management Functions</A> </P>

<P class=indent1><A HREF="#ddk_print_job_creation_functions_gg">Print Job Creation Functions</A> </P>

<P class=indent1><A HREF="#ddk_print_job_scheduling_functions_gg">Print Job Scheduling Functions</A> </P>

<P class=indent1><A HREF="#ddk_forms_management_functions_gg">Forms Management Functions</A> </P>

<P class=indent1><A HREF="#ddk_print_processor_management_functions_gg">Print Processor Management Functions</A> </P>

<P class=indent1><A HREF="#ddk_print_monitor_management_functions_gg">Print Monitor Management Functions</A> </P>

<P class=indent1><A HREF="#ddk_port_management_functions_gg">Port Management Functions</A> </P>

<P class=indent1><A HREF="#ddk_registry_management_functions_gg">Registry Management Functions</A> </P>

<P class=indent1><A HREF="#ddk_other_functions_gg">Other Functions</A> </P>



<H4><A NAME="ddk_initialization_function_gg"></A>Initialization Function</H4>

<TABLE>

<TR VALIGN="top">
<TH align=left width=28%>Function</TH>
<TH align=left width=72%>Description</TH>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><A HREF="spoolfnc_6qef.htm"><B>InitializePrintProvidor</B></A> (<I>Required</I>)</TD>
</TR>

<TR VALIGN="top">
<TD width=28%>&nbsp;</TD>
<TD width=72%>Initializes the print provider and returns pointers to supplied functions.</TD>
</TR>
</TABLE><BR>



<H4><A NAME="ddk_print_queue_management_functions_gg"></A>Print Queue Management Functions</H4>

<TABLE>

<TR VALIGN="top">
<TH align=left width=28%>Function</TH>
<TH align=left width=72%>Description</TH>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><B>AddPrinter</B></TD>
</TR>

<TR VALIGN="top">
<TD width=28%>&nbsp;</TD>
<TD width=72%>Adds a print queue to the list of those managed by the print provider, and associates a print processor with the print queue.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><B>AddPrinterConnection</B></TD>
</TR>

<TR VALIGN="top">
<TD width=28%>&nbsp;</TD>
<TD width=72%>Creates a connection to the specified print queue.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><B>ClosePrinter</B> (<I>Required</I>)</TD>
</TR>

<TR VALIGN="top">
<TD width=28%>&nbsp;</TD>
<TD width=72%>Disables caller access to a specified print queue.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><B>DeletePrinter</B></TD>
</TR>

<TR VALIGN="top">
<TD width=28%>&nbsp;</TD>
<TD width=72%>Deletes a print queue from the list of those managed by the print provider.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><B>DeletePrinterConnection</B></TD>
</TR>

<TR VALIGN="top">
<TD width=28%>&nbsp;</TD>
<TD width=72%>Removes a connection to the specified print queue.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><B>EnumPrinters</B> (<I>Required</I>)</TD>
</TR>

<TR VALIGN="top">
<TD width=28%>&nbsp;</TD>
<TD width=72%>Enumerates the list of print queues currently managed by the print provider.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><B>FindClosePrinterChangeNotification</B></TD>
</TR>

<TR VALIGN="top">
<TD width=28%>&nbsp;</TD>
<TD width=72%>Disables printer change notifications that were enabled by <B>FindFirstPrinterChangeNotification</B>.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><B>FindFirstPrinterChangeNotification</B></TD>
</TR>

<TR VALIGN="top">
<TD width=28%>&nbsp;</TD>
<TD width=72%>Returns a handle to a wait object that the caller can use to wait for specified printer events.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><B>GetPrinter</B> (<I>Required</I>)</TD>
</TR>

<TR VALIGN="top">
<TD width=28%>&nbsp;</TD>
<TD width=72%>Returns current parameter values for a specified print queue.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><B>OpenPrinter</B> (<I>Required</I>)</TD>
</TR>

<TR VALIGN="top">
<TD width=28%>&nbsp;</TD>
<TD width=72%>Enables caller access to a specified print queue.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><A HREF="spoolfnc_9xgn.htm"><B>RefreshPrinterChangeNotification</B></A></TD>
</TR>

<TR VALIGN="top">
<TD width=28%>&nbsp;</TD>
<TD width=72%>Called by router if client calls <B>FindNextPrinterChangeNotification</B> (see the Platform SDK documentation) with the PRINTER_NOTIFY_OPTIONS_REFRESH flag set.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><B>ResetPrinter</B></TD>
</TR>

<TR VALIGN="top">
<TD width=28%>&nbsp;</TD>
<TD width=72%>Modifies a print queue's data type or <A HREF="grstrcts_6v8n.htm">DEVMODE</A> structure.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><B>SetPrinter</B> (<I>Required</I>)</TD>
</TR>

<TR VALIGN="top">
<TD width=28%>&nbsp;</TD>
<TD width=72%>Sets parameters for a specified print queue.</TD>
</TR>

<TR VALIGN="top">
<TD width=28%><B>WaitForPrinterChange</B></TD>
<TD width=72%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=28%>&nbsp;</TD>
<TD width=72%><I>Obsolete</I>.</TD>
</TR>
</TABLE><BR>



<H4><A NAME="ddk_printer_driver_management_functions_gg"></A>Printer Driver Management Functions</H4>

<TABLE>

<TR VALIGN="top">
<TH align=left width=28%>Function</TH>
<TH align=left width=72%>Description</TH>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><B>AddPrinterDriver</B></TD>
</TR>

<TR VALIGN="top">
<TD width=28%>&nbsp;</TD>
<TD width=72%>Adds a specified printer's driver files to a specified server.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><B>AddPrinterDriverEx</B></TD>
</TR>

<TR VALIGN="top">
<TD width=28%>&nbsp;</TD>
<TD width=72%>Same as <B>AddPrinterDriver</B>, with additional parameters.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><B>DeletePrinterDriver</B></TD>
</TR>

<TR VALIGN="top">
<TD width=28%>&nbsp;</TD>
<TD width=72%>Deletes access to a specified printer's driver files, on a specified server.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><B>DeletePrinterDriverEx</B></TD>
</TR>

<TR VALIGN="top">
<TD width=28%>&nbsp;</TD>
<TD width=72%>Same as <B>DeletePrinterDriver</B>, with additional parameters.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><B>EnumPrinterDrivers</B></TD>
</TR>

<TR VALIGN="top">
<TD width=28%>&nbsp;</TD>
<TD width=72%>Returns a list of printer drivers that have been added to a specified server by calling <B>AddPrinterDriver</B> or <B>AddPrinterDriverEx</B>.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><B>GetPrinterDriver</B></TD>
</TR>

<TR VALIGN="top">
<TD width=28%>&nbsp;</TD>
<TD width=72%>Returns information about a printer driver, which the caller can then pass to <B>AddPrinterDriver</B>. (The returned information is typically obtained from an .<I>inf</I> file.)</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><B>GetPrinterDriverEx</B></TD>
</TR>

<TR VALIGN="top">
<TD width=28%>&nbsp;</TD>
<TD width=72%>Same as <B>GetPrinterDriver</B>, with additional parameters.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><B>GetPrinterDriverDirectory</B></TD>
</TR>

<TR VALIGN="top">
<TD width=28%>&nbsp;</TD>
<TD width=72%>Returns the name of the server's printer driver directory.</TD>
</TR>
</TABLE><BR>



<H4><A NAME="ddk_print_job_creation_functions_gg"></A>Print Job Creation Functions</H4>

<TABLE>

<TR VALIGN="top">
<TH align=left width=28%>Function</TH>
<TH align=left width=72%>Description</TH>
</TR>

<TR VALIGN="top">
<TD width=28%><B>AbortPrinter</B><BR>
(<I>Required</I>)</TD>
<TD width=72%>Attempts to delete the current job from the specified print queue.</TD>
</TR>

<TR VALIGN="top">
<TD width=28%><B>AddJob</B><BR>
(<I>Required</I>)</TD>
<TD width=72%>Returns a job identifier and spool file path. The caller uses <B>CreateFile</B> and <B>WriteFile</B> to send data to the spool file.</TD>
</TR>

<TR VALIGN="top">
<TD width=28%><B>EndDocPrinter</B><BR>
(<I>Required</I>)</TD>
<TD width=72%>Performs job completion operations.</TD>
</TR>

<TR VALIGN="top">
<TD width=28%><B>EndPagePrinter</B></TD>
<TD width=72%>Performs page completion operations.</TD>
</TR>

<TR VALIGN="top">
<TD width=28%><B>ReadPrinter</B></TD>
<TD width=72%>Obtains status information from a bidirectional printer.</TD>
</TR>

<TR VALIGN="top">
<TD width=28%><B>ScheduleJob</B><BR>
(<I>Required</I>)</TD>
<TD width=72%>Informs the provider that a specified job can be scheduled. The job is specified by a job identifier previously returned by <B>AddJob</B>.</TD>
</TR>

<TR VALIGN="top">
<TD width=28%><B>StartDocPrinter</B><BR>
(<I>Required</I>)</TD>
<TD width=72%>Prepares the print provider to begin spooling a print job.</TD>
</TR>

<TR VALIGN="top">
<TD width=28%><B>StartPagePrinter</B></TD>
<TD width=72%>Prepares the print provider to receive a print job page.</TD>
</TR>

<TR VALIGN="top">
<TD width=28%><B>WritePrinter</B><BR>
(<I>Required</I>)</TD>
<TD width=72%>Receives a portion of the print job's data stream.</TD>
</TR>
</TABLE><BR>

<P class=note><B>Note</B>&nbsp;&nbsp;The <B>AddJob</B>...<B>ScheduleJob</B> sequence is an alternative to the <B>StartDocPrinter</B>...<B>EndDocPrinter</B> sequence.</P>



<H4><A NAME="ddk_print_job_scheduling_functions_gg"></A>Print Job Scheduling Functions</H4>

<TABLE>

<TR VALIGN="top">
<TH align=left width=28%>Function</TH>
<TH align=left width=72%>Description</TH>
</TR>

<TR VALIGN="top">
<TD width=28%><B>EnumJobs</B><BR>
(<I>Required</I>)</TD>
<TD width=72%>Returns a list of scheduled print jobs.</TD>
</TR>

<TR VALIGN="top">
<TD width=28%><B>GetJob</B><BR>
(<I>Required</I>)</TD>
<TD width=72%>Returns job parameters.</TD>
</TR>

<TR VALIGN="top">
<TD width=28%><B>SetJob</B><BR>
(<I>Required</I>)</TD>
<TD width=72%>Cancels, pauses, resumes, or restarts a print job, or sets job parameters.</TD>
</TR>
</TABLE><BR>



<H4><A NAME="ddk_forms_management_functions_gg"></A>Forms Management Functions</H4>

<TABLE>

<TR VALIGN="top">
<TH align=left width=28%>Function</TH>
<TH align=left width=72%>Description</TH>
</TR>

<TR VALIGN="top">
<TD width=28%><B>AddForm</B></TD>
<TD width=72%>Adds a specified form to the list of those available for a specified printer.</TD>
</TR>

<TR VALIGN="top">
<TD width=28%><B>DeleteForm</B></TD>
<TD width=72%>Removes a specified form from the list of those available for a specified printer.</TD>
</TR>

<TR VALIGN="top">
<TD width=28%><B>EnumForms</B></TD>
<TD width=72%>Returns a list of forms available for a specified printer.</TD>
</TR>

<TR VALIGN="top">
<TD width=28%><B>GetForm</B></TD>
<TD width=72%>Returns characteristics of a specified form.</TD>
</TR>

<TR VALIGN="top">
<TD width=28%><B>SetForm</B></TD>
<TD width=72%>Modifies characteristics of a specified form.</TD>
</TR>
</TABLE><BR>



<H4><A NAME="ddk_print_processor_management_functions_gg"></A>Print Processor Management Functions</H4>

<TABLE>

<TR VALIGN="top">
<TH align=left width=28%>Function</TH>
<TH align=left width=72%>Description</TH>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><B>AddPrintProcessor</B></TD>
</TR>

<TR VALIGN="top">
<TD width=28%>&nbsp;</TD>
<TD width=72%>Installs a print processor on the specified server and adds it to the list of those that the print provider can call.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><B>DeletePrintProcessor</B></TD>
</TR>

<TR VALIGN="top">
<TD width=28%>&nbsp;</TD>
<TD width=72%>Deletes a print processor from the list of those that the print provider can call.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><B>EnumPrintProcessorDataTypes</B></TD>
</TR>

<TR VALIGN="top">
<TD width=28%>&nbsp;</TD>
<TD width=72%>Returns a list of the data types supported by the print processors that are callable by the print provider.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><B>EnumPrintProcessors</B></TD>
</TR>

<TR VALIGN="top">
<TD width=28%>&nbsp;</TD>
<TD width=72%>Returns the list of print processors that the print provider can call.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><B>GetPrintProcessorDirectory</B></TD>
</TR>

<TR VALIGN="top">
<TD width=28%>&nbsp;</TD>
<TD width=72%>Returns the directory path in which print processor files must be stored.</TD>
</TR>
</TABLE><BR>



<H4><A NAME="ddk_print_monitor_management_functions_gg"></A>Print Monitor Management Functions</H4>

<TABLE>

<TR VALIGN="top">
<TH align=left width=28%>Function</TH>
<TH align=left width=72%>Description</TH>
</TR>

<TR VALIGN="top">
<TD width=28%><B>AddMonitor</B></TD>
<TD width=72%>Adds a print monitor to the list of those that the print provider can call.</TD>
</TR>

<TR VALIGN="top">
<TD width=28%><B>DeleteMonitor</B></TD>
<TD width=72%>Deletes a print monitor from the list of those that the print provider can call.</TD>
</TR>

<TR VALIGN="top">
<TD width=28%><B>EnumMonitors</B></TD>
<TD width=72%>Returns the list of print monitors that the print provider can call.</TD>
</TR>
</TABLE><BR>



<H4><A NAME="ddk_port_management_functions_gg"></A>Port Management Functions</H4>

<TABLE>

<TR VALIGN="top">
<TH align=left width=28%>Function</TH>
<TH align=left width=72%>Description</TH>
</TR>

<TR VALIGN="top">
<TD width=28%><B>AddPort</B></TD>
<TD width=72%>Adds a printer port to the list of those available, typically by calling the specified port monitor's <A HREF="spoolfnc_1b1j.htm"><B>AddPortUI</B></A> function.</TD>
</TR>

<TR VALIGN="top">
<TD width=28%><B>AddPortEx</B></TD>
<TD width=72%>Same as <B>AddPort</B>, with additional parameters.</TD>
</TR>

<TR VALIGN="top">
<TD width=28%><B>ConfigurePort</B><BR>
(<I>Required</I>)</TD>
<TD width=72%>Configures a printer port,  typically by calling the specified port monitor's <A HREF="spoolfnc_9kbr.htm"><B>ConfigurePortUI</B></A> function.</TD>
</TR>

<TR VALIGN="top">
<TD width=28%><B>DeletePort</B><BR>
(<I>Required</I>)</TD>
<TD width=72%>Deletes a printer port from the list of those available, typically by calling the specified port monitor's <A HREF="spoolfnc_9fs7.htm"><B>DeletePortUI</B></A> function.</TD>
</TR>

<TR VALIGN="top">
<TD width=28%><B>EnumPorts</B><BR>
(<I>Required</I>)</TD>
<TD width=72%>Returns a list of available printer ports.</TD>
</TR>

<TR VALIGN="top">
<TD width=28%><B>SetPort</B></TD>
<TD width=72%>Sets parameters for a specified printer port.</TD>
</TR>
</TABLE><BR>



<H4><A NAME="ddk_registry_management_functions_gg"></A>Registry Management Functions</H4>

<TABLE>

<TR VALIGN="top">
<TH align=left width=28%>Function</TH>
<TH align=left width=72%>Description</TH>
</TR>

<TR VALIGN="top">
<TD width=28%><B>DeletePrinterData</B></TD>
<TD width=72%>Deletes the value currently assigned to a specified value name, under the specified printer's <B>PrinterDriverData</B> key.</TD>
</TR>

<TR VALIGN="top">
<TD width=28%><B>DeletePrinterDataEx</B></TD>
<TD width=72%>Same as <B>DeletePrinterData</B>, with additional parameters.</TD>
</TR>

<TR VALIGN="top">
<TD width=28%><B>DeletePrinterKey</B></TD>
<TD width=72%>Deletes a specified key and its subkeys, if they are currently stored in the registry under the specified printer's <B>PrinterDriverData</B> key.</TD>
</TR>

<TR VALIGN="top">
<TD width=28%><B>EnumPrinterData</B></TD>
<TD width=72%>Returns each of the value names and currently assigned values that are stored in the registry under the specified printer's <B>PrinterDriverData</B> key.</TD>
</TR>

<TR VALIGN="top">
<TD width=28%><B>EnumPrinterDataEx</B></TD>
<TD width=72%>Same as <B>EnumPrinterData</B>, with additional parameters.</TD>
</TR>

<TR VALIGN="top">
<TD width=28%><B>EnumPrinterKey</B></TD>
<TD width=72%>Returns a list of subkeys currently contained in the registry under a specified key name.</TD>
</TR>

<TR VALIGN="top">
<TD width=28%><B>GetPrinterData</B></TD>
<TD width=72%>Returns the value currently assigned to a specified value name, which is stored in the registry under the specified printer's <B>PrinterDriverData</B> key.</TD>
</TR>

<TR VALIGN="top">
<TD width=28%><B>GetPrinterDataEx</B></TD>
<TD width=72%>Same as <B>GetPrinterData</B>, with additional parameters.</TD>
</TR>

<TR VALIGN="top">
<TD width=28%><B>SetPrinterData</B></TD>
<TD width=72%>Stores a specified value name and value in the registry, under the specified printer's <B>PrinterDriverData</B> key.</TD>
</TR>

<TR VALIGN="top">
<TD width=28%><B>SetPrinterDataEx</B></TD>
<TD width=72%>Same as <B>SetPrinterData</B>, with additional parameters.</TD>
</TR>
</TABLE><BR>



<H4><A NAME="ddk_other_functions_gg"></A>Other Functions</H4>

<TABLE>

<TR VALIGN="top">
<TH align=left width=28%>Function</TH>
<TH align=left width=72%>Description</TH>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><A HREF="spoolfnc_2gtj.htm"><B>XcvData</B></A></TD>
</TR>

<TR VALIGN="top">
<TD width=28%>&nbsp;</TD>
<TD width=72%>Provides a communication path between a port monitor UI DLL and a port monitor server DLL.</TD>
</TR>
</TABLE><BR>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Functions%20Defined%20by%20Print%20Providers"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
