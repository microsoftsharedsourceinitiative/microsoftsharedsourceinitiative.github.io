<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>AgpSetRate</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="AgpSetRate">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Display&nbsp;and&nbsp;Print&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_agpsetrate_gg"></A><I>AgpSetRate</I></H1>

<P>The <I>AgpSetRate</I> function reprograms the data transfer rate of the AGP chipset.</P>

<PRE class=syntax><B>BOOLEAN
</B>  <B>(*PAGP_SET_RATE)(</B>
    <B>IN PVOID</B> <I>HwDeviceExtension</I>,
    <B>IN ULONG</B> <I>AgpRate</I>
    <B>);</B></PRE>

<H4>Parameters</H4>

<DL>
<DT><I>HwDeviceExtension</I></DT>

<DD>Pointer to the miniport driver's device extension.</DD>

<DT><I>AgpRate</I></DT>

<DD>Specifies the transfer rate to be set. This value can be one of the following:

<TABLE>

<TR VALIGN="top">
<TH align=left width=48%>Value</TH>
<TH align=left width=52%>Meaning</TH>
</TR>

<TR VALIGN="top">
<TD width=48%>VIDEO_AGP_RATE_1X</TD>
<TD width=52%>Single speed (66 Mhz)</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>VIDEO_AGP_RATE_2X</TD>
<TD width=52%>Two times single speed</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>VIDEO_AGP_RATE_4X</TD>
<TD width=52%>Four times single speed</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>VIDEO_AGP_RATE_8X</TD>
<TD width=52%>Eight times single speed</TD>
</TR>
</TABLE><BR>


</DD>
</DL>

<H4>Return Value</H4>

<P><I>AgpSetRate</I> returns TRUE if it was successful in changing the transfer rate; otherwise, it returns FALSE.</P>

<H4>Headers</H4>

<P>Declared in <I>videoagp.h</I>. Include <I>video.h</I>.</P>

<H4>Comments</H4>

<P>This function is available in Microsoft® Windows®&nbsp;XP and later.</P>

<P>The transfer rate set by the <I>AgpSetRate</I> function is persistent across changes in power state. The video miniport driver does not have to reset the AGP transfer rate when it changes from a low power state to a full power state. For information about change of power state, see <A HREF="vmpfncs_6v1j.htm"><I>HwVidSetPowerState</I></A>.</P>

<P>The <I>AgpSetRate</I> function can be used to change an AGP chipset's data transfer rate to any of the rates shown in the preceding table, as long as that transfer rate has not been explicitly eliminated in the INF file that loaded the display driver. See <A HREF="vidintro_58h3.htm">Display INF File Sections</A> for more information.</P>

<P>Callers of <I>AgpSetRate</I> must be running at IRQL = PASSIVE_LEVEL.</P>

<H4>See Also</H4>

<P><A HREF="vstrcts_55t3.htm">VIDEO_PORT_AGP_INTERFACE_2</A></P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: AgpSetRate"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
