<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Local Print Provider</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Local Print Provider">
</HEAD>
<BODY TOPMARGIN="0">
<DIV STYLE="display:none;">
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_emf_gg_gly">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_partial_print_provider_gg_gly">
</OBJECT>
</DIV>


<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Display&nbsp;and&nbsp;Print&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="ddk_local_print_provider_gg"></A>Local Print Provider</H3>

<P>The local print provider for Windows&nbsp;2000 and later provides job control and printer management capabilities for all printers that are accessed through the local print provider's port monitors. (A client administrator sets up access to such printers by selecting the <B>Local Printer</B> option when using the Add Printer Wizard.) Such printers include those connected to the local system's serial and parallel ports. They can also include devices connected to other I/O channels, such as SCSI ports, along with printers connected to remote non-NT-based-operating system servers.</P>

<P>The local print provider implements the entire set of <A HREF="splarch_1qxz.htm">functions defined by print providers</A>. It also supplies the following capabilities:

<UL>
	<LI>Print job spooler, with despooling of jobs directed to locally accessible print queues.</LI>

	<LI>Support for the Windows&nbsp;2000 and later operating system versions <A HREF="drvarch_3ijr.htm">printer driver architecture</A> with calls to local printer interface DLLs.</LI>

	<LI>Support for vendor-supplied print processors (see <A HREF="provider_9f6v.htm">Writing a Print Processor</A>).</LI>

	<LI>Support for vendor-supplied print monitors (see <A HREF="provider_6cyv.htm">Writing a Print Monitor</A>).</LI>
</UL>

<P>The following diagram provides a (somewhat simplified) view of control flow among the local printer provider's components, when an application creates a print job.</P>

<P><IMG SRC="images/contflow.gif" ALT="" BORDER=0></P>

<P><B>Control Flow in Local Printer Provider</B></P>

<P>As the diagram shows, an application creates a print job by calling the Graphics Driver Interface (GDI). Regardless of whether the print job's initial output format is EMF, the local print provider's job creation API creates a spool file. Later, when the job is scheduled, the spool file is read and, if the format is <A HREF="JavaScript:hhobj_1.Click()">EMF</A>, the EMF print processor sends the job back to GDI for conversion to RAW format, with the help of a <A HREF="drvarch_3v6v.htm">printer graphics DLL</A>. The converted data stream can then be sent back through the local print provider to the printer (without being respooled).</P>

<P>Vendor can create <A HREF="JavaScript:hhobj_2.Click()">partial print providers</A> that work in conjunction with the local print provider to support custom network configurations.</P>

<P></P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Local%20Print%20Provider"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
