<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>EngGetPrinterDriver</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="EngGetPrinterDriver">
</HEAD>
<BODY TOPMARGIN="0">
<DIV STYLE="display:none;">
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_gpd_gg_gly">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_ppd_gg_gly">
</OBJECT>
</DIV>


<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Display&nbsp;and&nbsp;Print&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_enggetprinterdriver_gg"></A>EngGetPrinterDriver</H1>

<P>The <B>EngGetPrinterDriver</B> function retrieves driver data for the specified printer.</P>

<PRE class=syntax><B>BOOL
  EngGetPrinterDriver(</B>
<B>    IN HANDLE</B>  <I>hPrinter</I><B>,</B>
<B>    IN LPWSTR</B>  <I>pEnvironment</I><B>,</B>
<B>    IN DWORD</B>  <I>dwLevel</I><B>,</B>
<B>    OUT BYTE</B>  <I>*lpbDrvInfo</I><B>,</B>
<B>    IN DWORD</B>  <I>cbBuf</I><B>,</B>
<B>    OUT DWORD</B>  <I>*pcbNeeded</I>
<B>    );</B></PRE>

<H4>Parameters</H4>

<DL>
<DT><I>hPrinter</I></DT>

<DD>Handle to the printer for which the driver data should be retrieved.</DD>

<DT><I>pEnvironment</I></DT>

<DD>Pointer to a null-terminated string that specifies the environment. For example, "Windows NT x86" specifies an NT-based operating system running on an Intel processor. If <I>pEnvironment</I> is NULL, the current environment of the calling driver and client machine is used.</DD>

<DT><I>dwLevel</I></DT>

<DD>Specifies the version of the structure to which <I>lpbDrvInfo</I> points. This parameter must be one of the following values:

<TABLE>

<TR VALIGN="top">
<TH align=left width=17%>Value</TH>
<TH align=left width=83%>Meaning</TH>
</TR>

<TR VALIGN="top">
<TD width=17%>1</TD>
<TD width=83%>GDI writes a DRIVER_INFO_1 structure in the buffer to which <I>lpbDrvInfo</I> points.</TD>
</TR>

<TR VALIGN="top">
<TD width=17%>2</TD>
<TD width=83%>GDI writes a DRIVER_INFO_2 structure in the buffer to which <I>lpbDrvInfo</I> points.</TD>
</TR>

<TR VALIGN="top">
<TD width=17%>3</TD>
<TD width=83%>GDI writes a DRIVER_INFO_3 structure in the buffer to which <I>lpbDrvInfo</I> points.</TD>
</TR>
</TABLE><BR>

</DD>

<DT><I>lpbDrvInfo</I></DT>

<DD>Pointer to a buffer in which GDI places the requested DRIVER_INFO_<I>X</I> structure.</DD>

<DT><I>cbBuf</I></DT>

<DD>Specifies the size, in bytes, of the buffer to which <I>lpbDrvInfo</I> points.</DD>

<DT><I>pcbNeeded</I></DT>

<DD>Pointer to a memory location in which GDI places the number of bytes copied into the buffer to which <I>lpbDrvInfo</I> points upon success, or the number of bytes required if <I>cbBuf</I> is too small.
</DD>
</DL>

<H4>Return Value</H4>

<P><B>EngGetPrinterDriver</B> returns TRUE upon success; otherwise it reports an error and returns FALSE.</P>

<H4>Headers</H4>

<P>Declared in <I>winddi.h</I>. Include <I>winddi.h</I>.</P>

<H4>Comments</H4>

<P>A printer driver DLL can work with multiple data files to support different printer models. The printer driver calls <B>EngGetPrinterDriver</B> to determine which data file to use. For example, the Unidrv renderer calls this function to determine the name of a <A HREF="JavaScript:hhobj_1.Click()">GPD</A> file, and the postscript driver calls this function to determine the name of a <A HREF="JavaScript:hhobj_2.Click()">PPD</A> file. The DRIVER_INFO_2 and DRIVER_INFO_3 structures contain a full path and filename specifying the location of the data file. The printer driver can then use the returned path and filename to load the data file by calling <A HREF="gdifncs_0yzr.htm"><B>EngLoadModule</B></A> with the path and filename as a single argument.</P>

<P>The DRIVER_INFO_<I>X</I> structures are described in the Platform SDK documentation.</P>

<H4>See Also</H4>

<P><A HREF="gdifncs_0yzr.htm"><B>EngLoadModule</B></A> </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: EngGetPrinterDriver"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
