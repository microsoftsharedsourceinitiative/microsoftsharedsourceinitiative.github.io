<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>ASP Variables for Print Web Pages</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="ASP Variables for Print Web Pages">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Display&nbsp;and&nbsp;Print&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="ddk_asp_variables_for_print_web_pages_gg"></A>ASP Variables for Print Web Pages</H3>

<P>Microsoft provides a set of ASP session variables for use by customized print Web pages. The following table lists the session variables. <I>Customized ASP files must not modify these variables.</I> As indicated, some variables are only valid if Microsoft's TCP/IP port monitor is being used for the printer.</P>

<P>Some variables are passed in as session variables, while others are passed in using URL decoration. Session variables can be accessed by using <B>Session</B>("<I>VariableName"</I>). Parameters passed in by URL decoration can be accessed by using <B>Request</B>("<I>VariableName"</I>). If you wish to automatically refresh the status page, you might find it necessary to redecorate the URL with the variables your page requires. Since <B>Request</B> variables must be passed in the URL, they may require encoding and decoding to translate from ANSI to Unicode representation. A helper object, whose COM ProgID is "OlePrn.OleCvt", has been provided to enable encoding and decoding between the ANSI used in the URL and Unicode. Two methods on this object, <A HREF="webfnc_9vhj.htm"><B>EncodeUnicodeName</B></A>, and <A HREF="webfnc_42zr.htm"><B>DecodeUnicodeName</B></A>, can be used to translate from ANSI to Unicode, and from Unicode to ANSI, respectively. This conversion does not need to be performed for <B>Session</B> variables.</P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=26%>Variable</TH>
<TH align=left width=32%>Value</TH>
<TH align=left width=13%>TCP/IP<BR>
Port<BR>
Monitor<BR>
Only?</TH>
<TH align=left width=13%>Variable<BR>
Type</TH>
<TH align=left width=16%>Encoded?</TH>
</TR>

<TR VALIGN="top">
<TD width=26%>MS_ASP1</TD>
<TD width=32%>Directory path to the initial Web page used for describing printer-specific details.</TD>
<TD width=13%>No</TD>
<TD width=13%>Request</TD>
<TD width=16%>No</TD>
</TR>

<TR VALIGN="top">
<TD width=26%>MS_Community</TD>
<TD width=32%>The print server's SNMP community name.</TD>
<TD width=13%>Yes</TD>
<TD width=13%>Request</TD>
<TD width=16%>No</TD>
</TR>

<TR VALIGN="top">
<TD width=26%>MS_Computer</TD>
<TD width=32%>The print server's computer name.</TD>
<TD width=13%>No</TD>
<TD width=13%>Session</TD>
<TD width=16%>No</TD>
</TR>

<TR VALIGN="top">
<TD width=26%>MS_DefaultPage</TD>
<TD width=32%>The default ASP file for printer-specific details.</TD>
<TD width=13%>No</TD>
<TD width=13%>Session</TD>
<TD width=16%>No</TD>
</TR>

<TR VALIGN="top">
<TD width=26%>MS_Device</TD>
<TD width=32%>The printer's SNMP device index.</TD>
<TD width=13%>Yes</TD>
<TD width=13%>Request</TD>
<TD width=16%>No</TD>
</TR>

<TR VALIGN="top">
<TD width=26%>MS_DHTMLEnabled</TD>
<TD width=32%>TRUE if the client supports dynamic HTML; otherwise FALSE.</TD>
<TD width=13%>No</TD>
<TD width=13%>Session</TD>
<TD width=16%>No</TD>
</TR>

<TR VALIGN="top">
<TD width=26%>MS_IPAddress</TD>
<TD width=32%>The printer's IP address.</TD>
<TD width=13%>Yes</TD>
<TD width=13%>Request</TD>
<TD width=16%>No</TD>
</TR>

<TR VALIGN="top">
<TD width=26%>MS_LocalServer</TD>
<TD width=32%>The print server's identifier. This might be either an IP address or a computer name.</TD>
<TD width=13%>No</TD>
<TD width=13%>Session</TD>
<TD width=16%>No</TD>
</TR>

<TR VALIGN="top">
<TD width=26%>MS_Model</TD>
<TD width=32%>The name of the printer driver.</TD>
<TD width=13%>No</TD>
<TD width=13%>Request</TD>
<TD width=16%>Yes</TD>
</TR>

<TR VALIGN="top">
<TD width=26%>MS_Portname</TD>
<TD width=32%>The printer's port name.</TD>
<TD width=13%>No</TD>
<TD width=13%>Request</TD>
<TD width=16%>Yes</TD>
</TR>

<TR VALIGN="top">
<TD width=26%>MS_Printer</TD>
<TD width=32%>The printer's name.</TD>
<TD width=13%>No</TD>
<TD width=13%>Request</TD>
<TD width=16%>Yes</TD>
</TR>

<TR VALIGN="top">
<TD width=26%>MS_SNMP</TD>
<TD width=32%>TRUE if SNMP is being used with a printer, otherwise FALSE.</TD>
<TD width=13%>Yes</TD>
<TD width=13%>Request</TD>
<TD width=16%>No</TD>
</TR>

<TR VALIGN="top">
<TD width=26%>MS_URLPrinter</TD>
<TD width=32%>The printer's name, in encoded URL format.</TD>
<TD width=13%>No</TD>
<TD width=13%>Request</TD>
<TD width=16%>Yes</TD>
</TR>
</TABLE><BR>

<P>The session variables specify properties of the "current" printer, that is, the printer for which an ASP page was invoked. To obtain additional printer properties for the current printer, or to obtain properties of a different printer, see <A HREF="inetpri_5vvr.htm">ActiveX Objects for Print Web Pages</A>.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: ASP%20Variables%20for%20Print%20Web%20Pages"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
