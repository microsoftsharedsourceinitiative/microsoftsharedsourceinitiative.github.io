<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>QUERY_INTERFACE</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="QUERY_INTERFACE">
</HEAD>
<BODY TOPMARGIN="0">
<DIV STYLE="display:none;">
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_defining_and_exporting_new_guids_kg">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_interface_dr">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_interface_dr">
</OBJECT>
</DIV>


<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Display&nbsp;and&nbsp;Print&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_query_interface_gg"></A>QUERY_INTERFACE</H1>

<P>The QUERY_INTERFACE structure describes the interface being requested.</P>

<PRE class=syntax>typedef struct _QUERY_INTERFACE {
  CONST GUID  *InterfaceType;
  USHORT  Size;
  USHORT  Version;
  PINTERFACE  Interface;
  PVOID  InterfaceSpecificData;
} QUERY_INTERFACE, *PQUERY_INTERFACE;</PRE>

<H4>Members</H4>

<DL>
<DT><B>InterfaceType</B></DT>

<DD>Pointer to a GUID that identifies the interface being requested. If the miniport driver does not support the specified <B>InterfaceType</B>, it should fail the call and return immediately.

<P>The parent generates this GUID with <I>uuidgen.exe</I>. See <A HREF="JavaScript:hhobj_1.Click()">Defining and Exporting New GUIDs</A> for details.
</DD>

<DT><B>Size</B></DT>

<DD>Specifies the size in bytes of the <A HREF="JavaScript:hhobj_2.Click()">INTERFACE</A> structure to which <B>Interface</B> points. The miniport driver must not return an INTERFACE structure larger than <B>Size</B> bytes.</DD>

<DT><B>Version</B></DT>

<DD>Specifies the version of the interface being requested.

<P>If a parent supports more than one version of an interface, its driver should return the specified version or, if possible, the closest supported version without exceeding the requested version. It is the querying driver's responsibility to examine the returned <B>Version</B> and determine what to do based on that value.
</DD>

<DT><B>Interface</B></DT>

<DD>Pointer to an <A HREF="JavaScript:hhobj_3.Click()">INTERFACE</A> structure in which the miniport driver returns the requested interface information. The querying driver is responsible for allocating this structure before calling <A HREF="vmpfncs_36ef.htm"><I>HwVidQueryInterface</I></A>.</DD>

<DT><B>InterfaceSpecificData</B></DT>

<DD>Specifies additional information about the interface being requested. Typically, this member is NULL, and the <B>InterfaceType</B> and <B>Version</B> members are sufficient for the parent to identify the interface being requested.
</DD>
</DL>

<H4>Headers</H4>

<P>Declared in <I>video.h</I>. Include <I>video.h</I>.</P>

<H4>Comments</H4>

<P>The <I>QueryInterface</I> parameter of the video miniport driver's <A HREF="vmpfncs_36ef.htm"><I>HwVidQueryInterface</I></A> function is a pointer to a QUERY_INTERFACE structure. </P>

<H4>See Also</H4>

<P><A HREF="vmpfncs_36ef.htm"><I>HwVidQueryInterface</I></A></P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: QUERY_INTERFACE"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
