<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Introduction to Spooler Components</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Introduction to Spooler Components">
</HEAD>
<BODY TOPMARGIN="0">
<DIV STYLE="display:none;">
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_gdi_gg_gly">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_graphics_engine_gg_gly">
</OBJECT>
</DIV>


<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Display&nbsp;and&nbsp;Print&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="ddk_introduction_to_spooler_components_gg"></A>Introduction to Spooler Components</H2>

<P>The primary components of the Microsoft® Windows®&nbsp;2000 and later print spooler are illustrated in the following diagram. </P>

<P><IMG SRC="images/spoocomp.gif" ALT="" BORDER=0></P>

<P><B>Windows 2000 and Later Print Spooler Components</B>

<DL>
<DT><I>Application</I></DT>

<DD>The print application creates a print job by calling GDI functions.</DD>

<DT><I>GDI</I></DT>

<DD>The Graphics Device Interface (<A HREF="JavaScript:hhobj_1.Click()">GDI</A>) includes both user-mode and kernel-mode components. The user-mode component, Win32 GDI, is used by Win32 applications that require graphics support. The kernel-mode component, the <A HREF="JavaScript:hhobj_2.Click()">graphics engine</A> (or graphics rendering engine), exports services and functions that graphics device drivers can use.</DD>

<DT><I>Winspool.drv</I></DT>

<DD><I>Winspool.drv</I> is the client interface into the spooler. It exports the functions that make up the spooler's Win32® API, and provides RPC stubs for accessing the server. (GDI is the primary client, but applications also call some of its Win32 functions.)</DD>

<DT><I>Spoolsv.exe</I></DT>

<DD><I>Spoolsv.exe</I> is the spooler's API server. It is implemented as a Windows&nbsp;2000 (or later) service that is started when the operating system is started. This module exports an RPC interface to the server side of the spooler's Win32 API. Clients of <I>spoolsv.exe</I> include <I>winspool.drv</I> (locally) and <A HREF="splarch_9qxz.htm#ddk_win32spl.dll_gg"><I>Win32spl.dll</I></A> (remotely). The module implements some API functions, but most function calls are passed to a <A HREF="splarch_684n.htm">print provider</A> by means of the router (<I>spoolss.dll</I>).</DD>

<DT><I>Router</I></DT>

<DD>The router, <I>spoolss.dll</I>, determines which print provider to call, based on a printer name or handle supplied with each function call, and passes the function call to the correct provider.</DD>

<DT><I>Print Provider</I></DT>

<DD>The print provider that supports the specified print device.</DD>

<DT><I>Print Monitor</I></DT>

<DD>Windows&nbsp;XP supports two types of print monitors: language monitors, and port monitors. 
</DD>
</DL>

<P>If printer hardware is local to the system on which the application is running, the "client" and "server" are the same system (although this is not evident in the diagram).</P>

<P>All spooler components execute in user mode.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Introduction%20to%20Spooler%20Components"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
