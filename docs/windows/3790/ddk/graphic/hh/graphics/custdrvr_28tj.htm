<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Customized Color Formats</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Customized Color Formats">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Display&nbsp;and&nbsp;Print&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="ddk_customized_color_formats_gg"></A>Customized Color Formats</H3>

<P>Unidrv supports several color formats, which are listed in <A HREF="nt5gpd_68iv.htm">Handling Color Formats</A>. For these formats, Unidrv converts GDI bitmaps into the correct format before sending it to the printer. If your printer accepts formats not supported by Unidrv, you must provide a rendering plug-in that implements the <A HREF="drvrfnc_5xgn.htm"><B>IPrintOemUni::ImageProcessing</B></A> method.</P>

<P>If you implement <B>IPrintOemUni::ImageProcessing</B>, and if the user has selected a color format (ColorMode option) that Unidrv cannot handle, then each time a buffer of GDI bitmap data is ready for printing, Unidrv calls the method and passes the bitmap's address as an input argument. The method must convert the bitmap to the specified format, perform <A HREF="custdrvr_0p47.htm">customized halftoning</A> operations if necessary, and call the <A HREF="drvrfnc_7g9z.htm"><B>IPrintOemDriverUni::DrvWriteSpoolBuf</B></A> method to send the modified bitmap to the print spooler. It must also call the <A HREF="drvrfnc_0duv.htm"><B>IPrintOemDriverUni::DrvXMoveTo</B></A> and <A HREF="drvrfnc_4isn.htm"><B>IPrintOemDriverUni::DrvYMoveTo</B></A> methods to update the cursor position. For more information about these operations, see the description of <A HREF="drvrfnc_5xgn.htm"><B>IPrintOemUni::ImageProcessing</B></A>.</P>

<P>If a rendering plug-in implements <B>IPrintOemUni::ImageProcessing</B>, it can also implement <A HREF="drvrfnc_9btz.htm"><B>IPrintOemUni::MemoryUsage</B></A>.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Customized%20Color%20Formats"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
