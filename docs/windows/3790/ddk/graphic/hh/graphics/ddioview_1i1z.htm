<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Font Driver Functions</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Font Driver Functions">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Display&nbsp;and&nbsp;Print&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="ddk_font_driver_functions_gg"></A>Font Driver Functions</H3>

<P>In addition to the functions described in the previous topics, the following table lists several other functions that font drivers should support.</P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=38%>Function</TH>
<TH align=left width=62%>Description</TH>
</TR>

<TR VALIGN="top">
<TD width=38%><A HREF="ddifncs_6vjb.htm"><I>DrvLoadFontFile</I></A></TD>
<TD width=62%>Specifies a file to be used for creating font realizations; the driver must prepare the file for use. Required for font drivers.</TD>
</TR>

<TR VALIGN="top">
<TD width=38%><A HREF="ddifncs_7413.htm"><I>DrvQueryAdvanceWidths</I></A></TD>
<TD width=62%>Asks the driver to send GDI character advance widths for a specified set of glyphs.</TD>
</TR>

<TR VALIGN="top">
<TD width=38%><A HREF="ddifncs_8gmf.htm"><I>DrvQueryFontCaps</I></A></TD>
<TD width=62%>Copies an array of bits that defines the capabilities of a font driver, to a specified buffer.</TD>
</TR>

<TR VALIGN="top">
<TD width=38%><A HREF="ddifncs_461z.htm"><I>DrvQueryFontFile</I></A></TD>
<TD width=62%>Depending on the mode of the query, returns the number of font faces in a font file or in a descriptive string. Required for font drivers.</TD>
</TR>

<TR VALIGN="top">
<TD width=38%><A HREF="ddifncs_3hk7.htm"><I>DrvQueryGlyphAttrs</I></A></TD>
<TD width=62%>Returns information about a font's glyphs.</TD>
</TR>

<TR VALIGN="top">
<TD width=38%><A HREF="ddifncs_6syv.htm"><I>DrvUnloadFontFile</I></A></TD>
<TD width=62%>Informs driver that a font file is no longer needed so driver can do necessary cleanup. Required for font drivers.</TD>
</TR>
</TABLE><BR>

<P>GDI calls the <I>DrvLoadFontFile</I> function with a particular file to be used for creating font realizations. This function is required only of font drivers. When the function <I>DrvLoadFontFile</I> is called, the driver performs the conversions necessary to prepare the file for use.</P>

<P><I>DrvLoadFontFile</I> returns a unique identifier that allows GDI to request the correct font using a GDI-maintained font usage table. Once a font is loaded, GDI does not call for the same font to be loaded again.</P>

<P>GDI calls <I>DrvUnloadFontFile</I> when the specified font file is no longer needed. The <I>DrvUnloadFontFile</I> function is required only in font drivers. <I>DrvUnloadFontFile</I> causes all scratch files to be deleted and all allocated system resources to be freed.</P>

<P>GDI calls the <I>DrvQueryFontFile</I> function to return information about a font file that was loaded by the driver. <I>DrvQueryFontFile</I> is required only in font drivers. The type of information to be returned is specified by <I>iMode</I>. If <I>iMode</I> is QFF_DESCRIPTION, the function returns a string that Microsoft® NT-based operating systems use to describe the font file. If <I>iMode</I> is QFF_NUMFACES, the function returns the number of faces in the font file. The faces are identified by an index from the range 1 to number of faces.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Font%20Driver%20Functions"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
