<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Storing Port Configuration Information</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Storing Port Configuration Information">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Display&nbsp;and&nbsp;Print&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="ddk_storing_port_configuration_information_gg"></A>Storing Port Configuration Information</H3>

<P>The Windows®&nbsp;2000 and later print spooler can operate in either a clustered or nonclustered server environment. When the spooler is operating in a server cluster, print monitor configuration information must be stored in the cluster registry. On the other hand, if the spooler is operating on a single, nonclustered server system, print monitor configuration information must be stored in the server's local registry.</P>

<P>The print spooler defines a set of registry functions for use by print monitors. These functions direct configuration data to the appropriate registry, so the print monitor does not have to determine if the server is clustered. Print monitors must not use the Win32 registry API or the cluster registry API directly; all configuration data must be stored and accessed using the spooler's registry functions. Addresses of these functions are supplied to the print monitor in a <A HREF="spoolfnc_0yef.htm">MONITORREG</A> structure when the spooler calls the monitor's <A HREF="spoolfnc_4m5j.htm"><B>InitializePrintMonitor2</B></A> function.</P>

<P>In a server cluster, multiple instances of the spooler can coexist. Specifically, each cluster node possesses its own instance, and an additional instance exists for the cluster itself. One of the input parameters of the spooler registry functions is a spooler handle. This handle is received by the monitor's <B>InitializePrintMonitor2</B> function and identifies the spooler instance (node or cluster) that has opened the monitor. Using the spooler handle, the spooler registry functions maintain subkeys for each spooler instance.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Storing%20Port%20Configuration%20Information"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
