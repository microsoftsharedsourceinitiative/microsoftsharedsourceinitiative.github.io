<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>RevertToPrinterSelf</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="RevertToPrinterSelf">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Display&nbsp;and&nbsp;Print&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_reverttoprinterself_gg"></A>RevertToPrinterSelf</H1>

<P>When <B>RevertToPrinterSelf</B> is called on an impersonating thread, it returns the token for the thread that is being impersonated.</P>

<PRE class=syntax><B>HANDLE</B>
   <B>RevertToPrinterSelf(</B>
    <B>VOID</B>
    <B>);</B></PRE>

<H4>Return Value</H4>

<P>If the operation succeeds, the function returns the token of the impersonated thread. If the current thread is not impersonating another thread, this function returns NULL.</P>

<H4>Headers</H4>

<P>Declared in <I>winsplp.h</I>. Include <I>winsplp.h</I>.</P>

<H4>Comments</H4>

<P><B>RevertToPrinterSelf</B> should be called when a component needs access to resources from the local system context, such as the registry. The local system context is the security context (the collection of settings that define the security behavior of a process or thread) of the system process. The system process is the process that runs in the logon session that is created for the local system account when the operating system boots. </P>

<P>If <B>RevertToPrinterSelf</B> returns a non-NULL value, <A HREF="spoolfnc_4cvb.htm"><B>ImpersonatePrinterClient</B></A> must be called with the return value to complete the operation and clean up the thread handle.</P>

<H4>See Also</H4>

<P><A HREF="spoolfnc_4cvb.htm"><B>ImpersonatePrinterClient</B></A></P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: RevertToPrinterSelf"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
