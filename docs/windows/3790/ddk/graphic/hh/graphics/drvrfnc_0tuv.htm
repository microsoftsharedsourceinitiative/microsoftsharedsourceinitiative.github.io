<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>DEVQUERYPRINT_INFO</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="DEVQUERYPRINT_INFO">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Display&nbsp;and&nbsp;Print&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_devqueryprint_info_gg"></A>DEVQUERYPRINT_INFO</H1>

<P>The DEVQUERYPRINT_INFO structure is used as an input parameter to a printer interface DLL's <A HREF="drvrfnc_1ndz.htm"><B>DevQueryPrintEx</B></A> function.</P>

<PRE class=syntax>typedef struct _DEVQUERYPRINT_INFO {
  WORD  cbSize;
  WORD  Level;
  HANDLE  hPrinter;
  DEVMODE  *pDevMode;
  LPTSTR  pszErrorStr;
  DWORD   cchErrorStr;
  DWORD   cchNeeded;
} DEVQUERYPRINT_INFO, *PDEVQUERYPRINT_INFO;</PRE>

<H4>Members</H4>

<DL>
<DT><B>cbSize</B></DT>

<DD>Spooler-supplied size, in bytes, of the DEVQUERYPRINT_INFO structure.</DD>

<DT><B>Level</B></DT>

<DD>Spooler-supplied level of the DEVQUERYPRINT_INFO structure. Currently, this member is always set to 1.</DD>

<DT><B>hPrinter</B></DT>

<DD>Spooler-supplied printer handle.</DD>

<DT><B>pDevMode</B></DT>

<DD>Spooler-supplied pointer to a <A HREF="grstrcts_6v8n.htm">DEVMODE</A> structure describing printer characteristics required by the print job.</DD>

<DT><B>pszErrorStr</B></DT>

<DD>Spooler-supplied pointer to a buffer to receive a NULL-terminated error text string, if the print job cannot be printed.</DD>

<DT><B>cchErrorStr</B></DT>

<DD>Spooler-supplied size, in bytes, of the string buffer pointed to by <B>pszErrorStr</B>.</DD>

<DT><B>cchNeeded</B></DT>

<DD>Driver-supplied length, in bytes, of the error string supplied in the buffer pointed to by <B>pszErrorStr</B>. If the string is too large to fit in the buffer, the string should be truncated, but the <I>untruncated</I> length should be specified here.
</DD>
</DL>

<H4>Headers</H4>

<P>Declared in <I>winddiui.h</I>. Include <I>winddiui.h</I>.</P>

<H4>See Also</H4>

<P><A HREF="drvrfnc_1ndz.htm"><B>DevQueryPrintEx</B></A> </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: DEVQUERYPRINT_INFO"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
