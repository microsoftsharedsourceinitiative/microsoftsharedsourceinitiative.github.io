<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>DdVideoPortGetConnectInfo</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="DdVideoPortGetConnectInfo">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Display&nbsp;and&nbsp;Print&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_ddvideoportgetconnectinfo_gg"></A><I>DdVideoPortGetConnectInfo</I></H1>

<P>The<I> DdVideoPortGetConnectInfo</I> callback function returns the connections supported by the specified VPE object.</P>

<PRE class=syntax><B>DWORD
  (APIENTRY *PDD_VPORTCB_GETVPORTCONNECT)(</B>
<B>    PDD_GETVPORTCONNECTDATA</B>  <I>lpGetConnect</I>
<B>    );</B></PRE>

<H4>Parameters</H4>

<DL>
<DT><I>lpGetConnect</I></DT>

<DD>Points to a <A HREF="ddstrcts_6wx3.htm">DD_GETVPORTCONNECTDATA</A> structure that contains the information required for the driver to return the VPE object connection data.
</DD>
</DL>

<H4>Return Value</H4>

<P><I>DdVideoPortGetConnectInfo</I> returns one of the following callback codes:</P>

<P class=indent1><A HREF="ddraw_7kbr.htm#ddk_ddhal_driver_handled_gg">DDHAL_DRIVER_HANDLED</A> </P>

<P class=indent1><A HREF="ddraw_7kbr.htm#ddk_ddhal_driver_nothandled_gg">DDHAL_DRIVER_NOTHANDLED</A> </P>

<H4>Headers</H4>

<P class=indent1>Declared in <I>ddrawint.h</I>.  Include <I>winddi.h</I>. </P>

<H4>Comments</H4>

<P><I>DdVideoPortGetConnectInfo</I> must be implemented in DirectDraw drivers that support VPE.</P>

<P>DirectDraw calls <I>DdVideoPortGetConnectInfo</I> to obtain the number of connections supported by the specified VPE object and the characteristics of each connection. <I>DdVideoPortGetConnectInfo</I> is called twice for the specified VPE object:

<UL>
	<LI>In the first call, the <B>lpConnect</B> member of the DD_GETVPORTCONNECTDATA structure at <I>lpGetConnect</I> is NULL. The driver should write the number of connections that the VPE object supports in the <B>dwNumEntries</B> member of DD_GETVPORTCONNECTDATA. Upon return, DirectDraw will allocate this number of DDVIDEOPORTCONNECT structures to pass in the second call to <I>DdVideoPortGetConnectInfo</I>.</LI>

	<LI>In the second call, <B>lpConnect</B> points to the array of allocated DDVIDEOPORTCONNECT structures. The driver should fill in each structure to describe each connection that the VPE object supports. The driver should also return the number of supported connections in <B>dwNumEntries</B>. Note that the driver is guaranteed that the buffer to which <B>lpConnect</B> points is large enough to hold the connection information being requested.</LI>
</UL>

<H4>See Also</H4>

<P><A HREF="ddstrcts_6wx3.htm">DD_GETVPORTCONNECTDATA</A>, <A HREF="ddstrcts_1rfr.htm">DDVIDEOPORTCONNECT</A> </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: DdVideoPortGetConnectInfo"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
