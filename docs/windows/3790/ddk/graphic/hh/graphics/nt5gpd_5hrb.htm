<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Printer Capability Attributes</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="*MemoryUsage">
<META NAME="MS-HKWD" CONTENT="*OEMCustomData">
<META NAME="MS-HKWD" CONTENT="*OutputOrderReversed?">
<META NAME="MS-HKWD" CONTENT="*ReselectFont">
<META NAME="MS-HKWD" CONTENT="*ReverseBandOrderForEvenPages">
<META NAME="MS-HKWD" CONTENT="*RotateCoordinate?">
<META NAME="MS-HKWD" CONTENT="*RotateFont?">
<META NAME="MS-HKWD" CONTENT="*RotateRaster?">
<META NAME="MS-HKWD" CONTENT="*TextCaps">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Display&nbsp;and&nbsp;Print&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H4><A NAME="ddk_printer_capability_attributes_gg"></A>Printer Capability Attributes</H4>

<P><I>Printer capability attributes</I> are <A HREF="nt5gpd_6dyf.htm">general printing attributes</A> that specify such printer characteristics as page margin, rotation, and text printing capabilities that affect all paper sizes and orientations.</P>



<TABLE>

<TR VALIGN="top">
<TH align=left colspan=2 width=15%>Attribute Name</TH>
<TH align=left width=40%>Attribute<BR>
Parameter</TH>
<TH align=left width=45%>Comments</TH>
</TR>

<TR VALIGN="top">
<TD colspan=4 width=100%><A NAME="ddk__memoryusage_gg"></A>*<B>MemoryUsage</B></TD>
</TR>

<TR VALIGN="top">
<TD width=15%>&nbsp;</TD>
<TD colspan=2 width=40%>LIST of constants indicating the types of data that are stored in printer memory. Can be one or more of:<BR>
FONT<BR>
RASTER<BR>
VECTOR
<P>If a data type is listed but not supported by the printer, it is ignored.</P>
</TD>
<TD width=45%>Optional. If not specified, the default value is LIST(FONT, RASTER, VECTOR). For more information, see <A HREF="nt5gpd_7bmv.htm">Describing Printer Memory Configurations</A>.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=4 width=100%><A NAME="ddk__oemcustomdata_gg"></A>*<B>OEMCustomData</B></TD>
</TR>

<TR VALIGN="top">
<TD width=15%>&nbsp;</TD>
<TD colspan=2 width=40%>Quoted text string to be supplied to a <A HREF="custdrvr_91rb.htm">rendering plug-in</A> when it calls <A HREF="drvrfnc_8trb.htm"><B>IPrintOemDriverUni::DrvGetGPDData</B></A>.</TD>
<TD width=45%>Required if a rendering plug-in calls <B>IPrintOemDriverUni::DrvGetGPDData</B>.
<P>Interpretation of text string contents is determined by the rendering plug-in.</P>

<P>This attribute is a relocatable global attribute; it may be placed at the root level (see <A HREF="nt5gpd_64vb.htm">Root-Level-Only Attributes</A>) to signify that it has no dependency on printer configuration, or it may appear with *<B>Option</B> or *<B>Case</B> constructs if there is some dependency.</P>
</TD>
</TR>

<TR VALIGN="top">
<TD colspan=4 width=100%><A NAME="ddk__outputorderreversed__gg"></A>*<B>OutputOrderReversed?</B></TD>
</TR>

<TR VALIGN="top">
<TD width=15%>&nbsp;</TD>
<TD colspan=2 width=40%>TRUE or FALSE, indicating whether multipage documents are sorted from last page to first.</TD>
<TD width=45%>Optional. If not specified, the default value is FALSE.
<P>The <A HREF="nt5gpd_9ixz.htm#ddk_extern_global_gg">EXTERN_GLOBAL</A> symbol should <I>not</I> be used with *<B>OutputOrderReversed?</B>.</P>
</TD>
</TR>

<TR VALIGN="top">
<TD colspan=4 width=100%><A NAME="ddk__reselectfont_gg"></A>*<B>ReselectFont</B></TD>
</TR>

<TR VALIGN="top">
<TD width=15%>&nbsp;</TD>
<TD colspan=2 width=40%>LIST of constants indicating operations after which Unidrv must reselect the current font. Can be on of the following:
<P>AFTER_GRXDATA – After any <B>CmdSend</B><I>xxxx</I><B>Data</B> <A HREF="nt5gpd_0n8n.htm">raster data emission command</A>.</P>

<P>AFTER_XMOVE – After any <I>x</I>-movement <A HREF="nt5gpd_7dwn.htm">cursor command</A>.</P>

<P>AFTER_FF – After the <B>CmdFF</B> command.</P>
</TD>
<TD width=45%>Optional. If not specified, Unidrv does not reselect fonts.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=4 width=100%><A NAME="ddk__reversebandorderforevenpages_gg"></A><B>*ReverseBandOrderForEvenPages?</B></TD>
</TR>

<TR VALIGN="top">
<TD width=15%>&nbsp;</TD>
<TD colspan=2 width=40%>TRUE or FALSE, indicating whether reverse banding is enabled. This attribute is used to support printers with auto-duplex capability; that is, printers that are able to print on both sides of a sheet of paper.
<P>The section following this table contains more information.</P>
</TD>
<TD width=45%>The default value of this attribute is FALSE. Setting this attribute to TRUE enables reverse banding order.
<P>This attribute is a relocatable global attribute; it may be placed at the root level (see <A HREF="nt5gpd_64vb.htm">Root-Level-Only Attributes</A>) to signify that it has no dependency on printer configuration, or it may appear with *<B>Option</B> or *<B>Case</B> constructs if there is some dependency.</P>
</TD>
</TR>

<TR VALIGN="top">
<TD colspan=4 width=100%><A NAME="ddk__rotatecoordinate__gg"></A>*<B>RotateCoordinate?</B></TD>
</TR>

<TR VALIGN="top">
<TD width=15%>&nbsp;</TD>
<TD colspan=2 width=40%>TRUE or FALSE, indicating whether the printer supports commands to rotate the coordinate system to match the page orientation.</TD>
<TD width=45%>Optional. If not specified, the default value is FALSE. If TRUE, <A HREF="nt5gpd_78yv.htm#ddk__option_gg">*<B>Option</B></A> entries for the Orientation feature must specify printer commands. Cannot be placed in a <A HREF="nt5gpd_9yuf.htm#ddk__case_gg">*<B>Case</B></A> entry.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=4 width=100%><A NAME="ddk__rotatefont__gg"></A>*<B>RotateFont?</B></TD>
</TR>

<TR VALIGN="top">
<TD width=15%>&nbsp;</TD>
<TD colspan=2 width=40%>TRUE or FALSE, indicating whether the printer automatically rotates fonts to match the page orientation.</TD>
<TD width=45%>Optional. If not specified, the default value is FALSE. If TRUE, then *<B>RotateCoordinate?</B> must also be TRUE. Cannot be placed in a *<B>Case</B> entry.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=4 width=100%><A NAME="ddk__rotateraster__gg"></A>*<B>RotateRaster?</B></TD>
</TR>

<TR VALIGN="top">
<TD width=15%>&nbsp;</TD>
<TD colspan=2 width=40%>TRUE or FALSE, indicating whether the printer automatically rotates raster data to match the page orientation.</TD>
<TD width=45%>Optional. If not specified, the default value is FALSE. If TRUE, then *<B>RotateCoordinate?</B> must also be TRUE. Cannot be placed in a *<B>Case</B> entry.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=4 width=100%><A NAME="ddk__textcaps_gg"></A>*<B>TextCaps</B></TD>
</TR>

<TR VALIGN="top">
<TD width=15%>&nbsp;</TD>
<TD colspan=2 width=40%>LIST of constants indicating the printer's text capabilities. Can consist of one or more of the TC_<I>xxx</I> flags described in the Platform SDK documentation's description of <B>GetDeviceCaps</B>.</TD>
<TD width=45%>Optional. If not specified, Unidrv assumes no text capabilities are supported.</TD>
</TR>
</TABLE><BR>

<P>For examples, see the <A HREF="nt5gpd_1von.htm">sample GPD files</A>.</P>

<H4>Additional Information on *ReverseBandOrderForEvenPages?</H4>

<P>A side effect of the auto-duplex capability is that the bottom edge of a page that has just been printed is fed back into the printer, to become the top edge of the next page. To maintain the orientation of the second page relative to the first, the raster image of the second page must be sent to the printer in reverse order. In other words, if the printer printed the front side by sending the top scan line first, it must print the back side bottom scan line first. </P>

<P>When *<B>ReverseBandOrderForEvenPages?</B> is TRUE and duplexing is on, Unidrv enumerates each band in reverse order for even-numbered pages (the back sides of odd-numbered pages). The OEM rendering plug-in needs to cache only one band of data before sending it to the printer. The order of the scan lines within each band is not reversed, so the plug-in must still handle that task, and it must also reverse the order of the bits within each scan line. Although this is extra work for the plug-in, the advantage is that the plug-in does not need to cache any raster data and can begin sending data to the printer immediately.</P>

<P>Both the value of the *<B>ReverseBandOrderForEvenPages? </B>attribute and the driver-simulated rotation affect the way bands are enumerated, which is shown in the following table. The band enumeration order specified in the column headed with TRUE applies when *<B>ReverseBandOrderForEvenPages?</B> is TRUE, <I>and</I> duplexing is selected, <I>and</I> the page to be printed is the second (or back) side. Otherwise the column headed with FALSE applies. </P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=33%>&nbsp;</TH>
<TH align=left width=33%>TRUE and Even Page</TH>
<TH align=left width=34%>FALSE or Odd Page</TH>
</TR>

<TR VALIGN="top">
<TH align=left width=33%>Driver-Simulated
<P>Rotation</P>
</TH>
<TH align=left width=33%>&nbsp;</TH>
<TH align=left width=34%>&nbsp;</TH>
</TR>

<TR VALIGN="top">
<TD width=33%>CCW_ROTATE90</TD>
<TD width=33%>SW_LTOR</TD>
<TD width=34%>SW_RTOL</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>CCW_ROTATE270</TD>
<TD width=33%>SW_RTOL</TD>
<TD width=34%>SW_LTOR</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>No Rotation</TD>
<TD width=33%>SW_UP</TD>
<TD width=34%>SW_DOWN</TD>
</TR>
</TABLE><BR>

<P>Legend: SW_LTOR = Left To Right, SW_RTOL = Right To Left, SW_UP = Bottom To Top, SW_DOWN = Top To Bottom.</P>

<P>An OEM rendering plug-in can support auto-duplexing without using the *<B>ReverseBandOrderForEvenPages? </B>attribute. The plug-in can do so by simply caching all of the data for the entire page and sending it to the printer, beginning with the bottom scan line. That scan line, as well as all the others on that page, must be sent in reverse order.</P>

<P class=note><B>Note:</B>&nbsp;&nbsp;The OEM rendering plug-in is responsible for reversing the order of the bits with each scan line and the order of the scan lines with each band as it sends the data to the printer. To determine when this must be done, the value of the <A HREF="nt5gpd_1fdz.htm#ddk_pagenumber_gg"><B>PageNumber</B></A> standard variable can be obtained by making a call to <A HREF="drvrfnc_5h9j.htm"><B>IPrintOemDriverUni::DrvGetStandardVariable</B></A>, using the index SVI_PAGENUMBER. If the page number is odd, no reversing is needed. If the number is even and duplexing is selected, reversing is needed.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Printer%20Capability%20Attributes"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
