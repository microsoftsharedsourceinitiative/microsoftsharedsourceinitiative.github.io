<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>CM_Add_Empty_Log_Conf</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="CM_Add_Empty_Log_Conf">
</HEAD>
<BODY TOPMARGIN="0">
<DIV STYLE="display:none;">
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_logical_configurations_kg">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_forced_configuration_kg">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_boot_configuration_kg">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_basic_configuration_kg">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_filtered_configuration_kg">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_allocated_configuration_kg">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_boot_configuration_kg">
</OBJECT>
<OBJECT ID="hhobj_8" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_forced_configuration_kg">
</OBJECT>
<OBJECT ID="hhobj_9" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_override_configuration_kg">
</OBJECT>
</DIV>


<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Device&nbsp;Installation:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_cm_add_empty_log_conf_dr"></A>CM_Add_Empty_Log_Conf</H1>

<P>The <B>CM_Add_Empty_Log_Conf</B> function creates an empty <A HREF="JavaScript:hhobj_1.Click()">logical configuration</A>, for a specified configuration type and a specified device instance, on the local machine.</P>

<PRE class=syntax><B>CMAPI</B> <B>CONFIGRET</B> <B>WINAPI</B>
  <B>CM_Add_Empty_Log_Conf(</B>
    <B>OUT</B> <B>PLOG_CONF</B>  <I>plcLogConf</I><B>,</B>
    <B>IN</B> <B>DEVINST</B>  <I>dnDevInst</I><B>,</B>
    <B>IN</B> <B>PRIORITY </B> <I>Priority</I><B>,</B>
    <B>IN</B> <B>ULONG</B>  <I>ulFlags</I>
    <B>);</B></PRE>

<H4>Parameters</H4>

<DL>
<DT><I>plcLogConf</I></DT>

<DD>Address of a location to receive the handle to an empty logical configuration.</DD>

<DT><I>dnDevInst</I></DT>

<DD>Caller-supplied device instance handle that is bound to the local machine.</DD>

<DT><I>Priority</I></DT>

<DD>Caller-supplied configuration priority value. This must be one of the constant values listed in the following table. The constants are listed in order of priority, from highest to lowest. (For multiple configurations with the same <I>ulFlags</I> value, the system will attempt to use the one with the highest priority first.)

<TABLE>

<TR VALIGN="top">
<TH align=left width=44%>Priority Constant</TH>
<TH align=left width=56%>Definition</TH>
</TR>

<TR VALIGN="top">
<TD width=44%>LCPRI_FORCECONFIG</TD>
<TD width=56%>Result of a <A HREF="JavaScript:hhobj_2.Click()">forced configuration</A>.</TD>
</TR>

<TR VALIGN="top">
<TD width=44%>LCPRI_BOOTCONFIG</TD>
<TD width=56%>Result of a <A HREF="JavaScript:hhobj_3.Click()">boot configuration</A>.</TD>
</TR>

<TR VALIGN="top">
<TD width=44%>LCPRI_DESIRED</TD>
<TD width=56%>Preferred configuration (better performance).</TD>
</TR>

<TR VALIGN="top">
<TD width=44%>LCPRI_NORMAL</TD>
<TD width=56%>Workable configuration (acceptable performance).</TD>
</TR>

<TR VALIGN="top">
<TD width=44%>LCPRI_LASTBESTCONFIG</TD>
<TD width=56%><I>For internal use only.</I></TD>
</TR>

<TR VALIGN="top">
<TD width=44%>LCPRI_SUBOPTIMAL</TD>
<TD width=56%>Not a desirable configuration, but it will work.</TD>
</TR>

<TR VALIGN="top">
<TD width=44%>LCPRI_LASTSOFTCONFIG</TD>
<TD width=56%><I>For internal use only.</I></TD>
</TR>

<TR VALIGN="top">
<TD width=44%>LCPRI_RESTART</TD>
<TD width=56%>The system must be restarted</TD>
</TR>

<TR VALIGN="top">
<TD width=44%>LCPRI_REBOOT</TD>
<TD width=56%>The system must be restarted (same as LCPRI_RESTART).</TD>
</TR>

<TR VALIGN="top">
<TD width=44%>LCPRI_POWEROFF</TD>
<TD width=56%>The system must be shut down and powered off.</TD>
</TR>

<TR VALIGN="top">
<TD width=44%>LCPRI_HARDRECONFIG</TD>
<TD width=56%>A jumper must be changed.</TD>
</TR>

<TR VALIGN="top">
<TD width=44%>LCPRI_HARDWIRED</TD>
<TD width=56%>The configuration cannot be changed.</TD>
</TR>

<TR VALIGN="top">
<TD width=44%>LCPRI_IMPOSSIBLE</TD>
<TD width=56%>The configuration cannot exist.</TD>
</TR>

<TR VALIGN="top">
<TD width=44%>LCPRI_DISABLED</TD>
<TD width=56%>Disabled configuration.</TD>
</TR>
</TABLE><BR>

</DD>

<DT><I>ulFlags</I></DT>

<DD>Caller-supplied flags that specify the type of the logical configuration. One of the following flags must be specified.

<TABLE>

<TR VALIGN="top">
<TH align=left width=43%>Configuration Type Flags</TH>
<TH align=left width=57%>Definitions</TH>
</TR>

<TR VALIGN="top">
<TD width=43%>BASIC_LOG_CONF</TD>
<TD width=57%>Resource descriptors added to this configuration will describe a <A HREF="JavaScript:hhobj_4.Click()">basic configuration</A>.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>FILTERED_LOG_CONF</TD>
<TD width=57%><I>Do not use.</I> (Only the PnP manager can create a <A HREF="JavaScript:hhobj_5.Click()">filtered configuration</A>.)</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>ALLOC_LOG_CONF</TD>
<TD width=57%><I>Do not use.</I> (Only the PnP manager can create an <A HREF="JavaScript:hhobj_6.Click()">allocated configuration</A>.)</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>BOOT_LOG_CONF</TD>
<TD width=57%>Resource descriptors added to this configuration will describe a <A HREF="JavaScript:hhobj_7.Click()">boot configuration</A>.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>FORCED_LOG_CONF</TD>
<TD width=57%>Resource descriptors added to this configuration will describe a <A HREF="JavaScript:hhobj_8.Click()">forced configuration</A>.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>OVERRIDE_LOG_CONF</TD>
<TD width=57%>Resource descriptors added to this configuration will describe an <A HREF="JavaScript:hhobj_9.Click()">override configuration</A>.</TD>
</TR>
</TABLE><BR>



<P>One of the following bit flags can be OR'ed with the configuration type flag.


<TABLE>

<TR VALIGN="top">
<TH align=left width=44%>Priority Comparison Flags</TH>
<TH align=left width=56%>Definitions</TH>
</TR>

<TR VALIGN="top">
<TD width=44%>PRIORITY_EQUAL_FIRST</TD>
<TD width=56%>If multiple configurations of the same type (<I>ulFlags</I>) have the same priority (<I>Priority</I>), this configuration is placed at the head of the list.</TD>
</TR>

<TR VALIGN="top">
<TD width=44%>PRIORITY_EQUAL_LAST</TD>
<TD width=56%>(Default) If multiple configurations of the same type (<I>ulFlags</I>) have the same priority (<I>Priority</I>), this configuration is placed at the tail of the list.</TD>
</TR>
</TABLE><BR>


</DD>
</DL>

<H4>Return Value</H4>

<P>If the operation succeeds, the function returns CR_SUCCESS. Otherwise, it returns one of the CR_-prefixed error codes defined in <I>cfgmgr32.h</I>.</P>

<H4>Headers</H4>

<P>Declared in <I>cfgmgr32.h</I>. Include <I>cfgmgr32.h</I>.</P>

<H4>Comments</H4>

<P>Calling <B>CM_Add_Empty_Log_Conf</B> can cause the handles returned by <A HREF="cfgmgrfn_412q.htm"><B>CM_Get_First_Log_Conf</B></A> and <A HREF="cfgmgrfn_0u42.htm"><B>CM_Get_Next_Log_Conf</B></A> to become invalid. Thus if you want to obtain logical configurations after calling <B>CM_Add_Empty_Log_Conf</B>, your code must call <B>CM_Get_First_Log_Conf</B> again and start at the first configuration.</P>

<P>To remove a logical configuration created by <B>CM_Add_Empty_Log_Conf</B>, call <A HREF="cfgmgrfn_8o6q.htm"><B>CM_Free_Log_Conf</B></A>.</P>

<P>The handle received in <I>plcLogConf</I> must be explicitly freed by calling <A HREF="cfgmgrfn_4gdu.htm"><B>CM_Free_Log_Conf_Handle</B></A>.</P>

<P>Callers of this function must have <B>SeLoadDriverPrivilege</B>. (Privileges are described in the Platform SDK documentation.)</P>

<P>For information about using device instance handles that are bound to the local machine, see <A HREF="cfgmgrfn_7zea.htm"><B>CM_Get_Child</B></A>.</P>

<H4>See Also</H4>

<P><A HREF="cfgmgrfn_1r02.htm"><B>CM_Add_Empty_Log_Conf_Ex</B></A>, <A HREF="cfgmgrfn_8o6q.htm"><B>CM_Free_Log_Conf</B></A>, <A HREF="cfgmgrfn_4gdu.htm"><B>CM_Free_Log_Conf_Handle</B></A>, <A HREF="cfgmgrfn_7zea.htm"><B>CM_Get_Child</B></A>, <A HREF="cfgmgrfn_412q.htm"><B>CM_Get_First_Log_Conf</B></A>, <A HREF="cfgmgrfn_0u42.htm"><B>CM_Get_Next_Log_Conf</B></A></P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: CM_Add_Empty_Log_Conf"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
