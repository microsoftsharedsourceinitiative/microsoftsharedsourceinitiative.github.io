<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Property Page Callback Function</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Property Page Callback Function">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Device&nbsp;Installation:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_property_page_callback_function_dg"></A>Property Page Callback Function</H1>

<P>When an installer sets up a property page for its device or device class, it supplies a pointer to a callback function. The callback function is called once when the property page is created and again when it is about to be destroyed. </P>

<P>The callback is a <B>PropSheetPageProc</B> function, which is described in the Platform SDK documentation. It must be able to handle the PSPCB_CREATE and PSPCB_RELEASE actions. </P>

<P>The callback is called with a PSPCB_CREATE message when a property page is being created. In response to this message, the callback can allocate memory for data associated with the page. The function should return TRUE to continue creating the page or FALSE if for some reason the page should not be created. </P>

<P>Property pages for a device are destroyed when the user clicks OK or Cancel on the page's dialog box or clicks Uninstall on the Drivers tab. </P>

<P>When a property page is being destroyed, the callback is called with a PSPCB_RELEASE message. The function should free any data allocated when the property page was created. Typically, this involves freeing the data at <B>lParam</B> in the PROPSHEETPAGE structure. The return value is ignored when the page is being destroyed.  </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Property%20Page%20Callback%20Function"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
