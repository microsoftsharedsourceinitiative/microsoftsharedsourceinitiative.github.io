<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>SetupDiGetClassInstallParams</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="SetupDiGetClassInstallParams">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Device&nbsp;Installation:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_setupdigetclassinstallparams_dr"></A>SetupDiGetClassInstallParams</H1>

<P>The <B>SetupDiGetClassInstallParams</B> function retrieves class install parameters for a device information set or a particular device information element. </P>

<PRE class=syntax><B>WINSETUPAPI BOOL WINAPI</B>
  <B>SetupDiGetClassInstallParams(</B>
    <B>IN HDEVINFO</B>  <I>DeviceInfoSet</I><B>,</B>
    <B>IN PSP_DEVINFO_DATA</B>  <I>DeviceInfoData</I><B>,  OPTIONAL</B>
    <B>OUT PSP_CLASSINSTALL_HEADER</B>  <I>ClassInstallParams</I><B>,  OPTIONAL</B>
    <B>IN DWORD</B>  <I>ClassInstallParamsSize</I><B>,
    OUT PDWORD</B>  <I>RequiredSize</I><B>  OPTIONAL
    );</B></PRE>

<H4>Parameters</H4>

<DL>
<DT><I>DeviceInfoSet</I></DT>

<DD>Supplies a handle to the <A HREF="setup-cls_2h9j.htm">device information set</A> that contains the class install parameters to retrieve.</DD>

<DT><I>DeviceInfoData</I></DT>

<DD>Supplies a pointer to an <A HREF="di-struct_7nqq.htm">SP_DEVINFO_DATA</A> structure that contains the class install parameters to retrieve. If this parameter is not specified, the class install parameters retrieved are associated with the device information set for the global class driver list.</DD>

<DT><I>ClassInstallParams</I></DT>

<DD>Supplies a pointer to a buffer that contains an <A HREF="di-struct_98xe.htm">SP_CLASSINSTALL_HEADER</A> structure. This structure must have its <B>cbSize</B> member set to <B>sizeof(</B>SP_CLASSINSTALL_HEADER<B>)</B> on input or the buffer is considered to be invalid. On output, the <B>InstallFunction</B> member is filled with the <A HREF="dif-codes_4x9u.htm">device installation function code</A> for the class installation parameters being retrieved. If the buffer is large enough, it also receives the class installation parameters structure specific to the function code. If <I>ClassInstallParams</I> is not specified, <I>ClassInstallParamsSize</I> must be 0. </DD>

<DT><I>ClassInstallParamsSize</I></DT>

<DD>Supplies the size, in bytes, of the <I>ClassInstallParams</I> buffer. If the buffer is supplied, it must be at least as large as <B>sizeof(</B>SP_CLASSINSTALL_HEADER<B>)</B>. If the buffer is not supplied, <I>ClassInstallParamsSize</I> must be 0<I>.</I></DD>

<DT><I>RequiredSize</I></DT>

<DD>(Optional) If specified, the referenced location receives the number of bytes required to store the class install parameters.
</DD>
</DL>

<H4>Return Value</H4>

<P>The function returns TRUE if it is successful. Otherwise, it returns FALSE and the logged error can be retrieved with a call to <B>GetLastError</B>.</P>

<H4>Headers</H4>

<P>Declared in <I>setupapi.h</I>. Include <I>setupapi.h</I>. </P>

<H4>Comments</H4>

<P>The class install parameters are specific to a particular <A HREF="dif-codes_4x9u.htm">device installation function code</A> that is stored in the <B>ClassInstallHeader</B> field located at the beginning of the <I>ClassInstallParams</I> buffer.</P>

<H4>See Also</H4>

<P><A HREF="di-rtns_5vg2.htm"><B>SetupDiSetClassInstallParams</B></A> </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: SetupDiGetClassInstallParams"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
