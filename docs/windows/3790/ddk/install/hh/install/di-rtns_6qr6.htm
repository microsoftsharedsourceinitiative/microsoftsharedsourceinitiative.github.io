<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>SetupDiCreateDeviceInfoListEx</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="SetupDiCreateDeviceInfoListEx">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Device&nbsp;Installation:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_setupdicreatedeviceinfolistex_dr"></A>SetupDiCreateDeviceInfoListEx</H1>

<P>The <B>SetupDiCreateDeviceInfoListEx</B> function creates an empty <A HREF="setup-cls_2h9j.htm">device information set</A>. This set can be associated with a class GUID and can be for devices on a remote machine.</P>

<PRE class=syntax><B>HDEVINFO</B>
  <B>SetupDiCreateDeviceInfoListEx(</B>
    <B>IN LPGUID</B>  <I>ClassGuid</I><B>,  OPTIONAL</B>
    <B>IN HWND</B>  <I>hwndParent</I><B>,  OPTIONAL</B>
    <B>IN PCTSTR</B>  <I>MachineName</I><B>,  OPTIONAL</B>
    <B>IN PVOID</B>  <I>Reserved</I>
    <B>);</B></PRE>

<H4>Parameters</H4>

<DL>
<DT><I>ClassGuid</I></DT>

<DD>Optionally supplies the GUID of the setup class associated with this device information set. If this parameter is specified, only devices of this class may be included in this device information set.</DD>

<DT><I>hwndParent</I></DT>

<DD>Optionally supplies the window handle of the top-level window to use for any user interface related to non-device-specific actions (such as a select-device dialog using the global class driver list).</DD>

<DT><I>MachineName</I></DT>

<DD>Optionally supplies the name of a machine on the network. If such a name is specified, only devices on that machine can be created and opened in this device information set. If <I>MachineName</I> is NULL, the device information set is for local devices.</DD>

<DT><I>Reserved</I></DT>

<DD>Must be NULL.
</DD>
</DL>

<H4>Return Value</H4>

<P>The function returns a handle to an empty device information set if it is successful. Otherwise, it returns INVALID_HANDLE_VALUE. To get extended error information, call <B>GetLastError</B>.</P>

<H4>Headers</H4>

<P>Declared in <I>setupapi.h</I>. Include <I>setupapi.h</I>. </P>

<H4>Comments</H4>

<P>The caller of this function must delete the returned device information set when it is no longer needed by calling <A HREF="di-rtns_0z8y.htm"><B>SetupDiDestroyDeviceInfoList</B></A>. </P>

<P>If the device information set is for devices on a remote machine (<I>MachineName</I> is not NULL), all subsequent operations on this set or any of its elements must use routines that support device information sets with remote elements. The <B>SetupDi</B><I>Xxx</I> routines that do not provide this support, such as <A HREF="di-rtns_7fjm.htm"><B>SetupDiCallClassInstaller</B></A>, have a statement to that effect in their reference page.</P>

<H4>See Also</H4>

<P><A HREF="di-rtns_2iya.htm"><B>SetupDiCreateDeviceInfoList</B></A>, <A HREF="di-rtns_0z8y.htm"><B>SetupDiDestroyDeviceInfoList</B></A>, <A HREF="di-rtns_8j5e.htm"><B>SetupDiGetDeviceInfoListDetail</B></A> </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: SetupDiCreateDeviceInfoListEx"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
