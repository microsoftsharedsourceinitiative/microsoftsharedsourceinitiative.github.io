<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>INF ControlFlags Section</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="INF ControlFlags Section">
</HEAD>
<BODY TOPMARGIN="0">
<DIV STYLE="display:none;">
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_hardware_id_dg_gly">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_compatible_id_dg_gly">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_hardware_id_dg_gly">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_compatible_id_dg_gly">
</OBJECT>
</DIV>


<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Device&nbsp;Installation:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_inf_controlflags_section_dr"></A>INF ControlFlags Section</H1>

<P><B>[ControlFlags]<BR>
&nbsp;</B><BR>
<B>ExcludeFromSelect=*</B> | <BR>
<B>ExcludeFromSelect=</B><I>device-identification-string</I>[<B>,</B><I>device-identification-string</I>] ... <BR>
[<B>ExcludeFromSelect.nt=</B><I>device-identification-string</I>[<B>,</B><I>device-identification-string</I>] ...]<BR>
[<B>ExcludeFromSelect.ntx86=</B><I>device-identification-string</I>[<B>,</B><I>device-identification-string</I>] ...]<BR>
[<B>ExcludeFromSelect.ntia64=</B><I>device-identification-string</I>[<B>,</B><I>device-identification-string</I>] ...] <BR>
[<B>CopyFilesOnly=</B><I>device-identification-string</I>[<B>,</B><I>device-identification-string</I>] ...]<BR>
[<B>InteractiveInstall</B>=<I>device-identification-string</I>[<B>,</B><I>device-identification-string</I>] ... ]<BR>
<B>&nbsp;</B><BR>
<B>&nbsp;</B><BR>
 </P>

<P>A <B>ControlFlags</B> section identifies devices for which Setup should take certain unique actions during installation.</P>

<H4>Entries and Values</H4>

<DL>
<DT><I>device-identification-string</I></DT>

<DD>Identifies a <A HREF="JavaScript:hhobj_1.Click()">hardware ID</A> or <A HREF="JavaScript:hhobj_2.Click()">compatible ID</A> that has been specified in a per-manufacturer <A HREF="inf-format_3ywi.htm">INF <I>Models</I> section</A>. Each string must be separated from the next with a comma (<B>,</B>). </DD>

<DT><B>ExcludeFromSelect</B></DT>

<DD>Removes all (if <B>*</B> is specified) or the specified list of devices from certain user interface displays, from which a user is expected to select a particular device for installation.

<P>For the NT-based operating system, the specified devices will not be displayed by the Add Hardware Wizard, but will be displayed by the Found New Hardware and Hardware Update wizards.


<P>For Windows 9x/Me, the specified devices will not be displayed by any device selection wizard.


<P>To exclude a set of OS-incompatible or platform-incompatible devices from this display, one or more <B>ExcludeFromSelect</B> entries can have the following case-insensitive extensions appended:


<DL>
<DT><B>.nt</B></DT>

<DD>Do not display these devices on computers running Windows&nbsp;2000 or later.</DD>

<DT><B>.ntx86</B></DT>

<DD>Do not display these devices on x86-based computers running Windows&nbsp;2000 or later.</DD>

<DT><B>.ntia64</B> </DT>

<DD>Do not display these devices on IA-64-based computers running Windows XP or later.
</DD>
</DL>


<P>For more information about how to use the system-defined <B>.nt</B>, <B>.ntx86</B>, and <B>.ntia64</B> extensions, see <A HREF="create-inf_9xpj.htm">Creating INF Files for Multiple Platforms and Operating Systems</A>. 
</DD>

<DT><B>CopyFilesOnly</B></DT>

<DD>Installs only the INF-specified files for the given devices because the device hardware is not accessible or available yet. This entry is rarely used. However, it can be used to preinstall the drivers of a device for which the card will later be seated in a particular slot that is currently in use. For example, if a device currently seated in the particular slot is necessary to transfer INF-specified files to the target, the INF would have this entry. </DD>

<DT><B>InteractiveInstall</B></DT>

<DD>Forces the specified list of devices to be installed in a user's context. Each line can specify one or more hardware IDs or compatible IDs and there can be one or more lines. 

<P>This entry is optional. The preferred way to install devices is to omit this entry and allow Setup to install the device in the context of a trusted system thread, if possible. However, if a device absolutely requires a user to be logged in when the device is installed, include this entry in the device INF. This entry is not supported on Windows 9x systems. 

</DD>
</DL>

<H4>Comments</H4>

<P>Typically, a <B>ControlFlags</B> section has one or more <B>ExcludeFromSelect</B> entries to identify devices that are listed in the per-manufacturer INF <I>Models</I> section, but which should not be displayed to the end user as options during manual installations. </P>

<P>The system's Add Hardware wizard builds a list of installable devices by searching through all available INF files. It extracts information about models/devices from each of these INF files and displays this information to the end user, unless an INF overrides this behavior by suppressing the display of one or more models/devices in that INF's <B>ControlFlags</B> section.</P>

<P>Listing a device's <A HREF="JavaScript:hhobj_3.Click()">hardware ID</A> or <A HREF="JavaScript:hhobj_4.Click()">compatible ID</A> in an <B>ExcludeFromSelect </B>entry removes it from the display shown to the end user. Specifying <B>*</B> (an asterisk) for the <B>ExcludeFromSelect</B> value removes all devices/models defined in the INF file from this user-visible list.</P>

<P>An INF writer should use the <B>InteractiveInstall</B> sparingly and only in the following situations:

<UL>
	<LI>To install drivers for devices that have corrupted or otherwise incorrectly defined hardware IDs. For example, when two or more different devices share the same Hardware ID. This case is strictly forbidden by the Plug and Play standard, but some hardware vendors have made this error in hardware. </LI>

	<LI>To install drivers for devices that require their own driver and absolutely cannot use the generic class driver or another driver supplied with the operating system. The <B>InteractiveInstall</B> directive forces the Device Manager to ask the user for confirmation for compatible ID matches.</LI>
</UL>

<P>INF files that install exclusively PnP devices can have a <B>ControlFlags</B> section unless they set the <B>NoInstallClass</B> value entry in their respective <I>SetupClassGUID</I> registry keys to TRUE, as described in the reference for the <A HREF="inf-format_6p9u.htm">INF <B>ClassInstall32</B> section</A>.</P>

<P>In the future, WHQL might not grant the Windows Logo to devices whose INF files include <B>InteractiveInstall</B> entries. </P>

<H4>Example</H4>

<P>This example of the <B>ControlFlags</B> section in the system mouse class installer INF suppresses the display of devices/models that cannot be installed on NT-based x86 platforms. </P>

<PRE>[ControlFlags]
; Exclude all bus mice and InPort mice for x86 platforms
ExcludeFromSelect.ntx86=*PNP0F0D,*PNP0F11,*PNP0F00,*PNP0F02,*PNP0F15
; Hide this entry always
ExcludeFromSelect=UNKNOWN_MOUSE</PRE>

<P>The following INF file fragment shows two devices:  one that is fully PnP-capable and requires no user intervention during installation and another that requires its own driver and cannot use any other driver. Specifying <B>InteractiveInstall</B> for the second device forces Setup to install this device in a user’s context (a user with administrative rights), including prompting the user for the location of the driver files (INF file, driver file, and so on) as required. </P>

<PRE>; ...
[Manufacturer]
%Mfg% = ModelsSection

[ModelsSection]
; Models section, with two entries
%Device1.DeviceDesc% = Device1.Install, \
  PCI\VEN_1000&amp;DEV_0001&amp;SUBSYS_00000000&amp;REV_01
%Device2.Device.Desc%    = Device2.Install, \
  PCI\VEN_1000&amp;DEV_0001&amp;SUBSYS_00000000&amp;REV_02

[ControlFlags]
InteractiveInstall = \
  PCI\VEN_1000&amp;DEV_0001&amp;SUBSYS_00000000&amp;REV_02
; ...
</PRE>

<H4>See Also</H4>

<P><A HREF="inf-format_6p9u.htm"><B>ClassInstall32</B></A>, <A HREF="inf-format_816a.htm"><B>Manufacturer</B></A>, <A HREF="inf-format_3ywi.htm"><I>Models</I></A> </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: INF%20ControlFlags%20Section"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
