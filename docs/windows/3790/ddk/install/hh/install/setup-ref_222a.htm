<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>INF File Processing Functions</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="INF File Processing Functions">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Device&nbsp;Installation:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_inf_file_processing_functions_dr"></A>INF File Processing Functions</H1>

<P>The INF file processing functions provide setup and installation functionality that includes:

<UL>
	<LI>Opening and closing an INF file</LI>

	<LI>Retrieving information about an INF file</LI>

	<LI>Retrieving information about source files and target directories for copy operations</LI>

	<LI>Performing the installation actions specified in an INF file section</LI>
</UL>

<P>The following table lists the functions used for processing INF files. For detailed function descriptions, see the Platform SDK documentation.</P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=53%>Function</TH>
<TH align=left width=47%>Description</TH>
</TR>

<TR VALIGN="top">
<TD width=53%><B>InstallHinfSection</B></TD>
<TD width=47%>Executes a specified section in a specified INF file.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%><B>SetupCloseInfFile</B></TD>
<TD width=47%>Frees resources and closes the INF handle.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%><B>SetupCopyOEMInf</B></TD>
<TD width=47%>Copies a file into <I>%windir%\Inf</I>.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%><B>SetupDecompressOrCopyFile</B></TD>
<TD width=47%>Copies a file and, if necessary, decompresses it.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%><B>SetupFindFirstLine</B></TD>
<TD width=47%>Finds a pointer to the first line in a section of an INF file or, if a key is specified, the first line that matches the key. </TD>
</TR>

<TR VALIGN="top">
<TD width=53%><B>SetupFindNextLine</B></TD>
<TD width=47%>Returns a pointer to the next line in an INF file section.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%><B>SetupFindNextMatchLine</B></TD>
<TD width=47%>Returns a pointer to the next line in an INF file section or, if a key is specified, the next line that matches the key.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%><B>SetupGetBinaryField</B></TD>
<TD width=47%>Retrieves binary data from a field in a specified line, in an INF file.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%><B>SetupGetFieldCount</B></TD>
<TD width=47%>Returns the number of fields in a line.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%><B>SetupGetFileCompressionInfo</B></TD>
<TD width=47%>Retrieves file compression information from an INF file.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%><B>SetupGetInfFileList</B></TD>
<TD width=47%>Returns a list of the INF files in a specified directory.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%><B>SetupGetInfInformation</B></TD>
<TD width=47%>Returns information about an INF file.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%><B>SetupGetIntField</B></TD>
<TD width=47%>Obtains the integer value of a specified field in a specified line, in an INF file.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%><B>SetupGetLineByIndex</B></TD>
<TD width=47%>Returns a pointer to the line associated with a specified index value in a specified section.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%><B>SetupGetLineCount</B></TD>
<TD width=47%>Returns the number of lines in the specified section.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%><B>SetupGetLineText</B></TD>
<TD width=47%>Retrieves the contents of a specified line from an INF file.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%><B>SetupGetMultiSzField</B></TD>
<TD width=47%>Returns multiple strings, starting at a specified field in a line.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%><B>SetupGetSourceFileLocation</B></TD>
<TD width=47%>Returns the location of a source file listed in an INF file.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%><B>SetupGetSourceFileSize</B></TD>
<TD width=47%>Returns the size of a specified file or a set of files listed in a specified section of an INF file.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%><B>SetupGetSourceInfo</B></TD>
<TD width=47%>Retrieves the path, tag file, or description for a source.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%><B>SetupGetStringField</B></TD>
<TD width=47%>Retrieves string data from a field in a specified line, in an INF file.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%><B>SetupGetTargetPath</B></TD>
<TD width=47%>Determines the target path for the files listed in a specified INF file section.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%><B>SetupInstallFile</B></TD>
<TD width=47%>Installs a specified file into a specific target directory.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%><B>SetupInstallFileEx</B></TD>
<TD width=47%>Installs a specified file into a specific target directory. The installation is postponed if an existing version of the file is in use.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%><B>SetupInstallFilesFromInfSection</B></TD>
<TD width=47%>Queues the files in a specified INF file section for copying. (Same as <B>SetupQueueCopySection</B>.)</TD>
</TR>

<TR VALIGN="top">
<TD width=53%><B>SetupInstallFromInfSection</B></TD>
<TD width=47%>Performs the directives specified in an INF <I>DDInstall </I>section.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%><B>SetupInstallServicesFromInfSection</B></TD>
<TD width=47%>Performs service installation and deletion operations as specified in an INF <I>DDInstall</I><B>.Services</B> section.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%><B>SetupOpenAppendInfFile</B></TD>
<TD width=47%>Opens an INF file and appends it to an existing INF handle.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%><B>SetupOpenInfFile</B></TD>
<TD width=47%>Opens an INF file and returns a handle to it.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%><B>SetupOpenMasterInf</B></TD>
<TD width=47%>Opens the master INF file that contains file and layout information for files shipped with the operating system.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%><B>SetupQueryInfFileInformation</B></TD>
<TD width=47%>Returns the name of one of the constituent INF files of a specified INF file.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%><B>SetupQueryInfVersionInformation</B></TD>
<TD width=47%>Returns the version number of one of the constituent INF files of a specified INF file.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%><B>SetupSetDirectoryId</B></TD>
<TD width=47%>Assigns a directory ID (DIRID) to a specified directory.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%><B>SetupUninstallOEMInf</B></TD>
<TD width=47%>Uninstalls a specified INF file, and deletes the associated .<I>pnf</I> and .<I>cat</I> files, if they exist.</TD>
</TR>
</TABLE><BR>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: INF%20File%20Processing%20Functions"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
