<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>INF ClassInstall32.Services Section</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="INF ClassInstall32.Services Section">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Device&nbsp;Installation:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_inf_classinstall32.services_section_dr"></A>INF ClassInstall32.Services Section</H1>

<P><B>[ClassInstall32.Services]</B> | <BR>
<B>[ClassInstall32.nt.Services]</B> | <BR>
<B>[ClassInstall32.ntx86.Services]</B> | <B><BR>
[ClassInstall32.ntia64.Services]</B> <B><BR>
</B>&nbsp;<BR>
<B>AddService=</B><I>ServiceName</I><B>,</B>[<I>flags</I>]<B>,</B><I>service-install-section</I>[<B>,</B><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<I>event-log-install-section</I>[<B>,</B>[<I>EventLogType</I>][<B>,</B><I>EventName</I>]]]...<BR>
[<B>DelService=</B><I>ServiceName</I>[<B>,</B>[<I>flags</I>][<B>,</B>[<I>EventLogType</I>][<B>,</B><I>EventName</I>]]]...<BR>
[<B>Include=</B><I>filename</I><B>.</B><I>inf</I>[<B>,</B><I>filename2</I><B>.</B><I>inf</I>]...]<BR>
[<B>Needs=</B><I>inf-section-name</I>[<B>,</B><I>inf-section-name</I>]...]<BR>
<B>&nbsp;</B><BR>
<B>&nbsp;</B><BR>
 </P>

<P>Each <B>ClassInstall32.Services</B> section contains one or more <B>AddService</B> directives referencing additional INF-writer-defined sections in a Windows&nbsp;2000 or later INF file. </P>

<P>INF files commonly use the <B>ClassInstall32.Services</B> section with at least one <B>AddService</B> directive to control how and when the services of a particular device class are loaded, any dependencies it might have on other services, and so forth. Optionally, they set up event-logging services for the device class as well. </P>

<P><B>ClassInstall32.Services</B> sections should have the same platform and OS decorations as their related <B>ClassInstall32</B> sections. For example, a <B>ClassInstall32.ntx86</B> section would have a corresponding <B>ClassInstall32.ntx86.Services</B> section.</P>

<P>This section is irrelevant to exclusively Windows&nbsp;9x/Me installations. </P>

<H4>Directives and Entries</H4>

<DL>
<DT><B>AddService=</B><I>ServiceName</I><B>,</B>[<I>flags</I>]<B>,</B><I>service-install-section</I>[<B>,</B><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<I>event-log-install-section</I>[<B>,</B>[<I>EventLogType</I>][<B>,</B><I>EventName</I>]]]...</DT>

<DD>This directive references an INF-writer-defined <I>service-install-section</I> and, possibly, an <I>event-log-install-section</I> elsewhere in the INF file for the drivers of the device class covered by the <B>ClassInstall32</B> section. For more information, see <A HREF="inf-format_79te.htm">INF <B>AddService</B> Directive</A>.</DD>

<DT><B>DelService=</B><I>ServiceName</I>[<B>,</B>[<I>flags</I>][<B>,</B>[<I>EventLogType</I>][<B>,</B><I>EventName</I>]]]...</DT>

<DD>This directive removes a previously installed service from the target machine. This directive is very rarely used. For more information, see <A HREF="inf-format_91iq.htm">INF <B>DelService</B> Directive</A>.</DD>

<DT><B>Include=</B><I>filename</I><B>.</B><I>inf</I>[<B>,</B><I>filename2</I><B>.</B><I>inf</I>]...</DT>

<DD>This optional entry specifies one or more additional system-supplied named INF files containing sections needed to install this device class. If this entry is specified, usually so is a <B>Needs</B> entry. (For further information on the <B>Include</B> entry and restrictions on its use, see <A HREF="create-inf_82g7.htm">Specifying the Source and Target Locations for Device Files</A>).</DD>

<DT><B>Needs=</B><I>inf-section-name</I>[<B>,</B><I>inf-section-name</I>]...</DT>

<DD>This optional entry specifies the particular named section that must be processed during the installation of this device class. Typically, such a named section is an <B>ClassInstall32.Services</B> section within a system-supplied INF file listed in an <B>Include</B> entry. However, it can be any section that is referenced within such a <B>ClassInstall32.Services</B> section. 

<P><B>Needs</B> entries cannot be nested. (For further information on the <B>Needs</B> entry and restrictions on its use, see <A HREF="create-inf_82g7.htm">Specifying the Source and Target Locations for Device Files</A>).

</DD>
</DL>

<H4>Comments</H4>

<P>The case-insensitive <B>.nt</B>, <B>.ntx86</B>, and <B>.ntia64</B> extensions can be inserted into a <B>ClassInstall32.Services </B>section name in dual-OS and/or cross-platform INF files, as shown in the formal syntax statement. For more information, see <A HREF="create-inf_9xpj.htm">Creating INF Files for Multiple Platforms and Operating Systems</A>.</P>

<H4></H4>

<H4>See Also</H4>

<P><A HREF="inf-format_6p9u.htm"><B>ClassInstall32</B></A>, <A HREF="inf-format_79te.htm"><B>AddService</B></A>, <A HREF="inf-format_2k8i.htm"><I>DDInstall</I></A>, <A HREF="inf-format_5k6q.htm"><I>DDInstall</I>.<B>HW</B></A>, <A HREF="inf-format_91iq.htm"><B>DelService</B></A>, <A HREF="inf-format_3ywi.htm"><I>Models</I></A> </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: INF%20ClassInstall32.Services%20Section"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
