<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>SetupDiGetDeviceRegistryProperty</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="SetupDiGetDeviceRegistryProperty">
</HEAD>
<BODY TOPMARGIN="0">
<DIV STYLE="display:none;">
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_iocreatedevice_kr">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_cm_power_data_kr">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_specifying_device_types_kg">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_software_key_kg_gly">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_enumerator_dg_gly">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_iocreatedevice_kr">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_iocreatedevice_kr">
</OBJECT>
<OBJECT ID="hhobj_8" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_security_descriptor_kr">
</OBJECT>
<OBJECT ID="hhobj_9" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_device_capabilities_dr">
</OBJECT>
<OBJECT ID="hhobj_10" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_iogetdeviceproperty_kr">
</OBJECT>
</DIV>


<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Device&nbsp;Installation:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_setupdigetdeviceregistryproperty_dr"></A>SetupDiGetDeviceRegistryProperty</H1>

<P>The <B>SetupDiGetDeviceRegistryProperty</B> function retrieves the specified Plug and Play device property.</P>

<PRE class=syntax><B>WINSETUPAPI BOOL WINAPI</B>
  <B>SetupDiGetDeviceRegistryProperty(</B>
    <B>IN HDEVINFO</B>  <I>DeviceInfoSet</I><B>,</B>
    <B>IN PSP_DEVINFO_DATA</B>  <I>DeviceInfoData</I><B>,</B>
    <B>IN DWORD</B>  <I>Property</I><B>,</B>
    <B>OUT PDWORD</B>  <I>PropertyRegDataType</I><B>,  OPTIONAL</B>
    <B>OUT PBYTE</B>  <I>PropertyBuffer</I><B>,</B>
    <B>IN DWORD</B>  <I>PropertyBufferSize</I><B>,</B>
    <B>OUT PDWORD</B>  <I>RequiredSize</I><B>  OPTIONAL</B>
    <B>);</B></PRE>

<H4>Parameters</H4>

<DL>
<DT><I>DeviceInfoSet</I></DT>

<DD>Supplies a handle to the <A HREF="setup-cls_2h9j.htm">device information set</A> containing information about the device instance for which to retrieve a Plug and Play property.</DD>

<DT><I>DeviceInfoData</I></DT>

<DD>Supplies a pointer to an <A HREF="di-struct_7nqq.htm">SP_DEVINFO_DATA</A> structure indicating the device instance for which to retrieve the Plug and Play property.</DD>

<DT><I>Property</I></DT>

<DD>Supplies one of the following values, indicating the property to be retrieved:

<DL>
<DT>SPDRP_ADDRESS </DT>

<DD>The function retrieves the device's address.</DD>

<DT>SPDRP_BUSNUMBER </DT>

<DD>The function retrieves the device's bus number.</DD>

<DT>SPDRP_BUSTYPEGUID </DT>

<DD>The function retrieves the GUID for the device's bus type.</DD>

<DT>SPDRP_CAPABILITIES </DT>

<DD>The function retrieves a bitwise OR of a device's capabilities in a DWORD. These capabilities are represented by the CM_DEVCAP_<I>xxxx</I> bit masks that are defined in <I>cfgmgr32.h.</I></DD>

<DT>SPDRP_CHARACTERISTICS </DT>

<DD>The function retrieves a bitwise OR of a device’s characteristics flags in a DWORD. For a description of these flags, which are defined in wdm.h and ntddk.h, see the <A HREF="JavaScript:hhobj_1.Click()"><B>IoCreateDevice</B></A> function's <I>DeviceCharacteristics</I> parameter.</DD>

<DT>SPDRP_CLASS </DT>

<DD>The function retrieves a REG_SZ string that contains the device setup class of a device.</DD>

<DT>SPDRP_CLASSGUID </DT>

<DD>The function retrieves a REG_SZ string that contains the GUID that represents the device setup class of a device.</DD>

<DT>SPDRP_COMPATIBLEIDS </DT>

<DD>The function retrieves a REG_MULTI_SZ string containing the list of compatible IDs for a device. For information about compatible IDs, see <A HREF="idstrings_8tt3.htm">Device Identification Strings</A>.</DD>

<DT>SPDRP_CONFIGFLAGS </DT>

<DD>The function retrieves a bitwise OR of a device's configuration flags in a DWORD value. The configuration flags are represented by the CONFIGFLAG_<I>xxxx</I> bit masks that are defined in <I>regstr.h</I>.</DD>

<DT>SPDRP_DEVICE_POWER_DATA</DT>

<DD>(<I>Windows&nbsp;XP and later</I>) The function retrieves a <A HREF="JavaScript:hhobj_2.Click()">CM_POWER_DATA</A> structure containing the device's power management information.</DD>

<DT>SPDRP_DEVICEDESC </DT>

<DD>The function retrieves a REG_SZ string containing the description of a device. </DD>

<DT>SPDRP_DEVTYPE </DT>

<DD>The function retrieves a DWORD value representing the device's type (see <A HREF="JavaScript:hhobj_3.Click()">Specifying Device Types</A>).</DD>

<DT>SPDRP_DRIVER </DT>

<DD>The function retrieves a string identifying the device's <A HREF="JavaScript:hhobj_4.Click()">software key</A> (sometimes called the <I>driver key</I>). See <A HREF="install-over_6e3r.htm">Driver Information in the Registry</A>.</DD>

<DT>SPDRP_ENUMERATOR_NAME </DT>

<DD>The function retrieves a REG_SZ string containing the name of the device's <A HREF="JavaScript:hhobj_5.Click()">enumerator</A>.</DD>

<DT>SPDRP_EXCLUSIVE </DT>

<DD>The function retrieves a DWORD value that indicates whether a user can obtain exclusive use of the device. The returned value is one if exclusive use is allowed, or zero otherwise. For more information, see <A HREF="JavaScript:hhobj_6.Click()"><B>IoCreateDevice</B></A>.</DD>

<DT>SPDRP_FRIENDLYNAME </DT>

<DD>The function retrieves a REG_SZ string that contains the friendly name of a device.</DD>

<DT>SPDRP_HARDWAREID </DT>

<DD>The function retrieves a REG_MULTI_SZ string containing the list of hardware IDs for a device. For information about hardware IDs, see <A HREF="idstrings_8tt3.htm">Device Identification Strings</A>.</DD>

<DT>SPDRP_LEGACYBUSTYPE </DT>

<DD>The function retrieves the device's legacy bus type as an INTERFACE_TYPE value (defined in <I>wdm.h</I> and <I>ntddk.h</I>).</DD>

<DT>SPDRP_LOCATION_INFORMATION </DT>

<DD>The function retrieves a REG_SZ string that contains the hardware location of a device. </DD>

<DT>SPDRP_LOWERFILTERS </DT>

<DD>The function retrieves a REG_MULTI_SZ string that contains the names of a device's lower filter drivers.</DD>

<DT>SPDRP_MFG </DT>

<DD>The function retrieves a REG_SZ string that contains the name of the device manufacturer.</DD>

<DT>SPDRP_PHYSICAL_DEVICE_OBJECT_NAME </DT>

<DD>The function retrieves a REG_SZ string that contains the name that is associated with the device's PDO. For more information, see <A HREF="JavaScript:hhobj_7.Click()"><B>IoCreateDevice</B></A>.</DD>

<DT>SPDRP_REMOVAL_POLICY</DT>

<DD>(<I>Windows&nbsp;XP and later</I>) The function retrieves the device's current removal policy as a DWORD containing one of the CM_REMOVAL_POLICY_<I>Xxxx</I> values defined in <I>cfgmgr32.h</I>.</DD>

<DT>SPDRP_REMOVAL_POLICY_HW_DEFAULT</DT>

<DD>(<I>Windows&nbsp;XP and later</I>) The function retrieves the device's hardware-specified default removal policy as a DWORD containing one of the CM_REMOVAL_POLICY_<I>Xxxx</I> values defined in <I>cfgmgr32.h</I>.</DD>

<DT>SPDRP_REMOVAL_POLICY_OVERRIDE</DT>

<DD>(<I>Windows&nbsp;XP and later</I>) The function retrieves the device's override removal policy (if it exists) from the registry, as a DWORD containing one of the CM_REMOVAL_POLICY_<I>Xxxx</I> values defined in <I>cfgmgr32.h</I>.</DD>

<DT>SPDRP_SECURITY</DT>

<DD>The function retrieves a <A HREF="JavaScript:hhobj_8.Click()">SECURITY_DESCRIPTOR</A> structure for a device.</DD>

<DT>SPDRP_SECURITY_SDS</DT>

<DD>The function retrieves a REG_SZ string that contains the device's security descriptor. The format of security descriptor strings is described in Platform SDK documentation.</DD>

<DT>SPDRP_SERVICE </DT>

<DD>The function retrieves a REG_SZ string containing the service name for a device.</DD>

<DT>SPDRP_UI_NUMBER </DT>

<DD>The function retrieves a DWORD value set to the value of the <B>UINumber</B> member of the device's <A HREF="JavaScript:hhobj_9.Click()">DEVICE_CAPABILITIES</A> structure.</DD>

<DT>SPDRP_UI_NUMBER_DESC_FORMAT </DT>

<DD>The function retrieves a format string (REG_SZ) used to display the <B>UINumber</B> value.</DD>

<DT>SPDRP_UPPERFILTERS </DT>

<DD>The function retrieves a REG_MULTI_SZ string that contains the names of a device's upper filter drivers.</DD>
</DL>
</DD>

<DT><I>PropertyRegDataType</I></DT>

<DD>Supplies a pointer to a variable to receive the data type of the property being retrieved. This is one of the standard registry data types.</DD>

<DT><I>PropertyBuffer</I></DT>

<DD>Supplies a pointer to a buffer to receive the property being retrieved. If set to NULL, with <I>PropertyBufferSize</I> set to zero, the function just returns a value for <I>RequiredSize</I>.</DD>

<DT><I>PropertyBufferSize</I></DT>

<DD>Supplies the length, in bytes, of <I>PropertyBuffer</I>.</DD>

<DT><I>RequiredSize</I></DT>

<DD>Optional. If not NULL, it is a caller-supplied pointer to a variable that receives the required size, in bytes, of the property buffer pointed to by <I>PropertyBuffer</I>, based on the property requested by <I>Property</I>.
</DD>
</DL>

<H4>Return Value</H4>

<P>The function returns TRUE if it is successful. Otherwise, it returns FALSE and the logged error can be retrieved with a call to <B>GetLastError</B>.</P>

<H4>Headers</H4>

<P>Declared in <I>setupapi.h</I>. Include <I>setupapi.h</I>. </P>

<H4>See Also</H4>

<P><A HREF="di-rtns_6tiq.htm"><B>SetupDiGetClassRegistryProperty</B></A>, <A HREF="di-rtns_6rg2.htm"><B>SetupDiSetClassRegistryProperty</B></A>, <A HREF="di-rtns_18c2.htm"><B>SetupDiSetDeviceRegistryProperty</B></A>, <A HREF="JavaScript:hhobj_10.Click()"><B>IoGetDeviceProperty</B></A> </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: SetupDiGetDeviceRegistryProperty"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
