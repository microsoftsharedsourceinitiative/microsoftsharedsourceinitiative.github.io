<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>CM_Locate_DevNode</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="CM_Locate_DevNode">
</HEAD>
<BODY TOPMARGIN="0">
<DIV STYLE="display:none;">
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_device_instance_id_dg_gly">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_device_instance_id_dg_gly">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_device_tree_kg">
</OBJECT>
</DIV>


<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Device&nbsp;Installation:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_cm_locate_devnode_dr"></A>CM_Locate_DevNode</H1>

<P>The <B>CM_Locate_DevNode</B> function obtains a device instance handle to the device node that is associated with a specified <A HREF="JavaScript:hhobj_1.Click()">device instance identifier</A>, on the local machine.</P>

<PRE class=syntax><B>CMAPI</B> <B>CONFIGRET</B> <B>WINAPI</B>
  <B>CM_Locate_DevNode(</B>
    <B>OUT</B> <B>PDEVINST</B>  <I>pdnDevInst</I><B>,</B>
    <B>IN</B> <B>DEVINSTID </B> <I>pDeviceID</I><B>,</B>  <B>OPTIONAL</B>
    <B>IN</B> <B>ULONG</B>  <I>ulFlags</I>
    <B>);</B></PRE>

<H4>Parameters</H4>

<DL>
<DT><I>pdnDevInst</I> </DT>

<DD>Caller-supplied pointer to a device instance handle that this function retrieves. The retrieved handle is bound to the local machine.</DD>

<DT><I>pDeviceID</I></DT>

<DD>Caller-supplied pointer to a NULL-terminated string representing a <A HREF="JavaScript:hhobj_2.Click()">device instance identifier</A>. If this value is NULL, or if it points to a zero-length string, the function supplies a device instance handle to the device node at the top of the <A HREF="JavaScript:hhobj_3.Click()">device tree</A>.</DD>

<DT><I>ulFlags</I></DT>

<DD>One of the caller-supplied bit flags listed in the following table.

<TABLE>

<TR VALIGN="top">
<TH align=left width=22%>Flag</TH>
<TH align=left width=78%>Definition</TH>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%>CM_LOCATE_DEVNODE_NORMAL</TD>
</TR>

<TR VALIGN="top">
<TD width=22%>&nbsp;</TD>
<TD width=78%>(<I>Default</I>.) The function only searches for device nodes representing devices that are currently plugged into the system.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%>CM_LOCATE_DEVNODE_PHANTOM</TD>
</TR>

<TR VALIGN="top">
<TD width=22%>&nbsp;</TD>
<TD width=78%>The function searches both for device nodes representing devices that are currently plugged into the system, and for device nodes representing devices that are not currently plugged in (but were previously).</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%>CM_LOCATE_DEVNODE_CANCELREMOVE</TD>
</TR>

<TR VALIGN="top">
<TD width=22%>&nbsp;</TD>
<TD width=78%><I>Not used.</I></TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%>CM_LOCATE_DEVNODE_NOVALIDATION</TD>
</TR>

<TR VALIGN="top">
<TD width=22%>&nbsp;</TD>
<TD width=78%><I>Not used</I>.</TD>
</TR>
</TABLE><BR>


</DD>
</DL>

<H4>Return Value</H4>

<P>If the operation succeeds, the function returns CR_SUCCESS. Otherwise, it returns one of the CR_-prefixed error codes defined in <I>cfgmgr32.h</I>.</P>

<H4>Headers</H4>

<P>Declared in <I>cfgmgr32.h</I>. Include <I>cfgmgr32.h</I>.</P>

<H4>Comments</H4>

<P>For information about using device instance handles that are bound to the local machine, see <A HREF="cfgmgrfn_7zea.htm"><B>CM_Get_Child</B></A>.</P>

<H4>See Also</H4>

<P><A HREF="cfgmgrfn_7zea.htm"><B>CM_Get_Child</B></A>, <A HREF="cfgmgrfn_6faq.htm"><B>CM_Locate_DevNode_Ex</B></A> </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: CM_Locate_DevNode"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
