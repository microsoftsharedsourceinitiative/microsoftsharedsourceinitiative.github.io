<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>INF ClassInstall32 Section</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="INF ClassInstall32 Section">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Device&nbsp;Installation:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_inf_classinstall32_section_dr"></A>INF ClassInstall32 Section</H1>

<P><B>[ClassInstall32]</B> | <BR>
<B>[ClassInstall32.nt]</B> | <BR>
<B>[ClassInstall32.ntx86]</B> | <B><BR>
[ClassInstall32.ntia64]</B> <B><BR>
&nbsp;</B><BR>
<B>AddReg=</B><I>add</I>-<I>registry</I>-<I>section</I>[<B>,</B> <I>add</I>-<I>registry</I>-<I>section</I>] ...<BR>
[<B>Copyfiles=@</B><I>filename</I> | <I>file</I>-<I>list</I>-<I>section</I>[<B>,</B> <I>file</I>-<I>list</I>-<I>section</I>] ...]<BR>
[<B>DelReg=</B><I>del</I>-<I>registry</I>-<I>section</I>[<B>,</B> <I>del</I>-<I>registry</I>-<I>section</I>] ...]<BR>
[<B>Delfiles=</B><I>file-list</I> <I>section</I>[<B>,</B> <I>file</I>-<I>list</I>-<I>section</I>] ...]<BR>
[<B>Renfiles=</B><I>file-list-section</I>[<B>, </B><I>file</I>-<I>list</I>-<I>section</I>] ...]<BR>
[<B>BitReg=</B><I>bit-registry-section</I>[<B>,</B><I>bit-registry-section</I>]...]<BR>
[<B>UpdateInis=</B><I>update-ini-section</I>[<B>,</B><I>update-ini-section</I>]...]<BR>
[<B>UpdateIniFields=</B><I>update-inifields-section</I>[<B>,</B><I>update-inifields-section</I>]...]<BR>
[<B>Ini2Reg=</B><I>ini-to-registry-section</I>[<B>,</B><I>ini-to-registry-section</I>]...]<BR>
<B>&nbsp;</B><BR>
<B>&nbsp;</B><BR>
 </P>

<P>A <B>ClassInstall32</B> section installs a new device setup class (and possibly a class installer) for devices of the new type. </P>

<H4>Valid Directives</H4>

<DL>
<DT><B>AddReg=</B><I>add</I>-<I>registry</I>-<I>section</I>[<B>,</B> <I>add</I>-<I>registry</I>-<I>section</I>] ...</DT>

<DD>References one or more named sections containing class-specific value entries to be written into the registry. Typically, this is used to give the new device setup class at least a friendly name that other components can later retrieve from the registry and use to open installed devices of this new device class, to "install" any new device class installer and/or property-page provider for this device setup class, and so forth. An <B>HKR</B> specification in any <I>add-registry-section</I> designates the <B>..Class\{</B><I>SetupClassGUID</I><B>}</B> registry key. For additional information, see the following <B>Comments</B> section.

<P>For more information, see <A HREF="inf-format_2v02.htm">INF <B>AddReg</B> Directive</A>.
</DD>

<DT><B>Copyfiles=@</B><I>filename</I> | <I>file</I>-<I>list</I>-<I>section</I>[<B>,</B> <I>file</I>-<I>list</I>-<I>section</I>] ...</DT>

<DD>Either specifies one named file to be copied from the source media to the destination or references one or more named sections in which class-relevant files on the source media are specified for transfer to the destination. The <B>DefaultDestDir</B> entry in the <B>DestinationDirs</B> section of the INF specifies the destination directory for any class-specific single file to be copied.

<P>System-supplied INF files for device setup classes (and class installers) do not use this directive in this section. 


<P>For more information, see <A HREF="inf-format_4oaa.htm">INF <B>CopyFiles</B> Directive</A>.
</DD>

<DT><B>DelReg=</B><I>del</I>-<I>registry</I>-<I>section</I>[<B>,</B> <I>del</I>-<I>registry</I>-<I>section</I>] ...</DT>

<DD>References one or more named sections in which value entries or keys are specified to be removed from the registry during installation of the class installer. 

<P>However, if a particular <B>{</B><I>SetupClassGUID</I><B>}</B> subkey exists in the registry <B>..Class</B> branch, the system setup code subsequently ignores the <B>ClassInstall32</B> section of any INF that specifies the same GUID value in its <B>Version</B> section. Consequently, an INF cannot replace an existing class installer or modify its behavior from a <B>ClassInstall32</B> section. To modify the behavior of existing class installer, use a class-specific co-installer. 


<P>For more information, see <A HREF="inf-format_21de.htm">INF <B>DelReg</B> Directive</A>.
</DD>

<DT><B>Delfiles=</B><I>file-list</I> <I>section</I>[<B>,</B> <I>file</I>-<I>list</I>-<I>section</I>] ...</DT>

<DD>References one or more named sections in which previously installed class-relevant files on the destination are specified for deletion. 

<P>For more information, see <A HREF="inf-format_3vg2.htm">INF <B>DelFiles</B> Directive</A>.
</DD>

<DT><B>Renfiles=</B><I>file-list-section</I>[<B>, </B><I>file</I>-<I>list</I>-<I>section</I>] ...</DT>

<DD>References one or more named sections in which class-relevant files to be renamed on the destination are listed. 

<P>For more information, see <A HREF="inf-format_0pki.htm">INF <B>RenFiles</B> Directive</A>.
</DD>

<DT><B>BitReg=</B><I>bit-registry-section</I>[<B>,</B><I>bit-registry-section</I>]...</DT>

<DD>Is valid in this section but almost never used. 

<P>For more information, see <A HREF="inf-format_4sj6.htm">INF <B>BitReg</B> Directive</A>.
</DD>

<DT><B>UpdateInis=</B><I>update-ini-section</I>[<B>,</B><I>update-ini-section</I>]...</DT>

<DD>Is valid in this section but almost never used.

<P>For more information, see <A HREF="inf-format_4f76.htm">INF <B>UpdateInis</B> Directive</A>.
</DD>

<DT><B>UpdateIniFields=</B><I>update-inifields-section</I>[<B>,</B><I>update-inifields-section</I>]...</DT>

<DD>Is valid in this section but almost never used.

<P>For more information, see <A HREF="inf-format_5a0i.htm">INF <B>UpdateIniFields</B> Directive</A>.
</DD>

<DT><B>Ini2Reg=</B><I>ini-to-registry-section</I>[<B>,</B><I>ini-to-registry-section</I>]...</DT>

<DD>Is valid in this section but almost never used.

<P>For more information, see <A HREF="inf-format_5a0i.htm">INF <B>UpdateIniFields</B> Directive</A>.

</DD>
</DL>

<H4>Comments</H4>

<P>An INF for devices in a <A HREF="setup-cls_2i1z.htm">system-supplied device setup class</A> should not specify a <B>ClassInstall32</B> section. (You can provide class-specific or device-specific co-installers to supplement system-supplied class installers or the system's device installer. For more information, see <A HREF="coinst_5p0n.htm">Writing a Co-installer</A>.)</P>

<P>Usually, a <B>ClassInstall32</B> section will have one or more <B>AddReg</B> directives to add entries under a system-provided <I>SetupClassGUID</I> subkey in the registry. These entries can include a class-specific "friendly name," class installer path, class icon, property page provider, and so forth.</P>

<P>Except for <B>AddReg</B> and <B>CopyFiles</B>, the other directives shown here are very seldom used in a <B>ClassInstall32</B> section. </P>

<P>The system processes the <B>ClassInstall32</B> section of an INF for a new device setup class when a device is about to be installed but the <I>SetupClassGUID</I> value of that device's class is not predefined by the system. (See <A HREF="setup-cls_1wpz.htm">Device Setup Classes</A> for a list of the system-defined setup class names and GUIDs.) </P>

<P>To support a multiplatform distribution of driver files, construct platform-specific <B>ClassInstall32</B> sections. For example, all system setup API functions that process a <B>ClassInstall32</B> section will search first for a <B>ClassInstall32.ntx86</B> section on an NT-based x86 platform and only look at an undecorated <B>ClassInstall32</B> section if they cannot find a <B>ClassInstall32.ntx86</B> section. For more information about how to use the system-defined <B>.nt</B>, <B>.ntx86</B>, and <B>.ntia64</B> extensions, see <A HREF="create-inf_9xpj.htm">Creating INF Files for Multiple Platforms and Operating Systems</A>. Note that the <B>ClassInstall32</B> section name is also used for installations on 64-bit platforms.</P>

<P>In the registry, every device installed on Windows&nbsp;2000 and later platforms is associated with a device setup class. If the INF for a device to be installed is not associated with a new device class installer, or if its <B>ClassGUID=</B> specification in the <B>Version</B> section does not match a system-defined setup class GUID, that device's registry subkey is created under <B>..Class\{</B><I>UnknownClassGUID</I><B>}</B>. </P>

<P>The INF for any device class installer typically has an <B>AddReg</B> directive in its <B>ClassInstall32</B> section, to define at least one named section that creates a friendly name for its kind of device. The setup code automatically creates a <I>SetupClassGUID</I> subkey in the registry from the value supplied for the <B>ClassGUID=</B> entry in the INF's <B>Version</B> section when the first device of that (new) setup class is installed. </P>

<P>Under this <I>SetupClassGUID</I> subkey, such an INF also provides registry information for <I>Models</I>-specific subkeys, using additional <B>AddReg</B> directives in its per-manufacturer, per-models <I>DDInstall</I> sections. In addition, the INF can use the add-registry sections referenced in its <B>ClassInstall32</B> section to specify a property-page provider and to exert control over how its class of devices is handled in the user interface. </P>

<P>Such a class-specific add-registry section has the following general form:</P>

<P><B>[</B><I>SetupClassAddReg</I><B>]<BR>
&nbsp;</B><BR>
<B>HKR,,,,%</B><I>DevClassName</I><B>%</B> ; device-class friendly name <BR>
[<B>HKR,,Installer32,,"</B><I>class-installer</I><B>.dll,</B><I>class-entry-point</I><B>"</B>] <BR>
[<B>HKR,,EnumPropPages32,,"</B><I>prop-provider</I><B>.dll,</B><I>provider-entry-point</I><B>"</B>]<BR>
<B>HKR,,Icon,,"</B><I>icon-number</I><B>" </B><BR>
[<B>HKR,,SilentInstall,,1</B>]<BR>
[<B>HKR,,NoInstallClass,,1</B>]<BR>
[<B>HKR,,NoDisplayClass,,1</B>]<BR>
 </P>

<P>The system uses the specified icon to represent your installer to the user.

<UL>
	<LI>If the <B>Icon</B> value is positive, it represents a resource identifier for a resource. The resource will be extracted from the class installer DLL, if the <B>Installer32</B> key is specified, or from the property page DLL, if the <B>EnumPropPages32</B> key is specified. The value "0" represents the first icon in the DLL. The value "1" is reserved. </LI>

	<LI>If the <B>Icon</B> value is negative, the absolute value represents a predefined icon. See <A HREF="di-rtns_08ky.htm"><B>SetupDiDrawMiniIcon</B></A> for a list of the predefined icons. For example, "-18" specifies the "Unknown" icon (18).</LI>
</UL>

<P>Setting the predefined <B>SilentInstall</B>, <B>NoDisplayClass</B>, and <B>NoInstallClass</B> Boolean value entries in a class-specific registry key has the following effects:

<UL>
	<LI>Setting <B>SilentInstall</B> directs installers to send no pop-ups to the user that require a response while installing devices of this class, whether specified in the <I>DDInstall</I> sections of the class installer's INF file or in separate INF files for subsequently installed devices that declare themselves of this class by setting the same <B>ClassGuid={</B><I>ClassGUID</I><B>}</B> specification in their respective <B>Version</B> sections. For example, the system class installers of CD-ROM and disk devices and the system parallel port class installer set <B>SilentInstall</B> in their respective registry keys. 
<P>If a class-specific installer requires the machine to be rebooted for any device that it installs, the class-specific add-registry section in its INF cannot have this value entry. 
</LI>

	<LI>Setting <B>NoDisplayClass</B> suppresses the user-visible display of all devices of this class by the Device Manager. For example, the system class installers for printers and for network drivers (including clients, services, and protocols) set <B>NoDisplayClass</B> in their respective registry keys. </LI>

	<LI>Setting <B>NoInstallClass</B> indicates that no device of this type will ever require manual installation by an end user. For example, the system class installers for exclusively Plug and Play (PnP) devices set <B>NoInstallClass</B> in their respective registry keys. </LI>
</UL>

<P>A <B>ClassInstall32</B> section can contain <B>AddReg</B> directives to set the <B>DeviceType</B>, <B>DeviceCharacteristics</B>, and <B>Security</B> for devices of its setup class. See the <A HREF="inf-format_2v02.htm">INF <B>AddReg</B> Directive</A> for more information.</P>

<H4>Examples</H4>

<P>This example shows the <B>ClassInstall32</B> section, along with the named section it references with the <B>AddReg</B> directive, of the INF for the system display class installer. </P>

<PRE>[ClassInstall32] 
AddReg=display_class_addreg
 
[display_class_addreg]
HKR,,,,%DisplayClassName%
HKR,,Installer32,,"Desk.Cpl,DisplayClassInstaller"
HKR,,Icon,,"-1"</PRE>

<P>By contrast, this example shows the add-registry section referenced in the system CD-ROM INF's <B>ClassInstall32</B> section. It sets up a class-specific property-page provider for the CD-ROM devices/drivers that it installs. This INF also sets the <B>SilentInstall</B> and <B>NoInstallClass</B> value entries in the CD-ROM class key to TRUE (<B>1</B>). </P>

<PRE>[cdrom_class_addreg]
HKR,,,,%CDClassName%
HKR,,EnumPropPages32,,"SysSetup.Dll,CdromPropPageProvider"
HKR,,SilentInstall,,1
HKR,,NoInstallClass,,1
HKR,,Icon,,"101"</PRE>

<H4>See Also</H4>

<P><A HREF="inf-format_2v02.htm"><B>AddReg</B></A>, <A HREF="inf-format_4sj6.htm"><B>BitReg</B></A>, <A HREF="inf-format_4oaa.htm"><B>CopyFiles</B></A>, <A HREF="inf-format_2k8i.htm"><I>DDInstall</I></A>, <A HREF="inf-format_3vg2.htm"><B>DelFiles</B></A>, <A HREF="inf-format_21de.htm"><B>DelReg</B></A>, <A HREF="inf-format_2i5u.htm"><B>Ini2Reg</B></A>, <A HREF="inf-format_3ywi.htm"><I>Models</I></A>, <A HREF="inf-format_0pki.htm"><B>RenFiles</B></A>, <A HREF="di-rtns_8whe.htm"><B>SetupDiBuildClassInfoListEx</B></A>, <A HREF="inf-format_5a0i.htm"><B>UpdateIniFields</B></A>, <A HREF="inf-format_4f76.htm"><B>UpdateInis</B></A>, <A HREF="inf-format_2fzm.htm"><B>Version</B></A> </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: INF%20ClassInstall32%20Section"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
