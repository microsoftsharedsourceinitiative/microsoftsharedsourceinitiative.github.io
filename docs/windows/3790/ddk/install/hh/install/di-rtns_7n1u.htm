<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>SetupDiInstallClassEx</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="SetupDiInstallClassEx">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Device&nbsp;Installation:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_setupdiinstallclassex_dr"></A>SetupDiInstallClassEx</H1>

<P>The <B>SetupDiInstallClassEx</B> function installs a class installer or an interface class.</P>

<PRE class=syntax><B>WINSETUPAPI BOOL WINAPI</B>
  <B>SetupDiInstallClassEx(</B>
    <B>IN HWND</B>  <I>hwndParent</I><B>,  OPTIONAL</B>
    <B>IN PCTSTR</B>  <I>InfFileName</I><B>,  OPTIONAL</B>
    <B>IN DWORD</B>  <I>Flags</I><B>,
    IN HSPFILEQ</B>  <I>FileQueue</I><B>,  OPTIONAL</B>
    <B>IN LPGUID</B>  <I>InterfaceClassGuid</I><B>,  OPTIONAL
    IN PVOID</B>  <I>Reserved1</I><B>,
    IN PVOID</B>  <I>Reserved2</I><B>
    );</B></PRE>

<H4>Parameters</H4>

<DL>
<DT><I>hwndParent</I></DT>

<DD>Optionally supplies the handle of the parent window for any user interface used to install this class.</DD>

<DT><I>InfFileName</I></DT>

<DD>Optionally specifies the name of an INF file. 

<P>If this function is being used to install a class installer, the INF file contains an <A HREF="inf-format_6p9u.htm">INF <B>ClassInstall32</B> section</A> and this parameter must not be NULL.


<P>If this function is being used to install an interface class, the INF file contains an <A HREF="inf-format_3o8i.htm">INF <B>InterfaceInstall32</B> section</A>. 
</DD>

<DT><I>Flags</I></DT>

<DD>Specifies flags that control the installation process. Can be a combination of the following:

<DL>
<DT>DI_NOVCP</DT>

<DD>Set this flag if <I>FileQueue</I> is supplied. DI_NOVCP instructs the <B>SetupInstallFromInfSection</B> function (described in Platform SDK documentation) to not create a queue of its own and to use the caller-supplied queue instead. If this flag is set, files are not copied just queued. </DD>

<DT>DI_NOBROWSE</DT>

<DD>Set this flag to disable browsing in the event a copy operation cannot find a specified file. If the caller supplies a file queue, this flag is ignored.</DD>

<DT>DI_FORCECOPY</DT>

<DD>Set this flag to always copy files, even if they are already present on the user's machine. If the caller supplies a file queue, this flag is ignored.</DD>

<DT>DI_QUIETINSTALL</DT>

<DD>Set this flag to suppress the user interface unless absolutely necessary. For example, do not display the progress dialog. If the caller supplies a file queue, this flag is ignored.</DD>
</DL>
</DD>

<DT><I>FileQueue</I></DT>

<DD>If the DI_NOVCP flag is set, this parameter supplies a handle to a file queue where file operations should be queued but not committed.</DD>

<DT><I>InterfaceClassGuid</I></DT>

<DD>Optionally points to a GUID specifying an interface class to be installed. If this parameter is not NULL, this function is being used to install the interface class represented by the GUID. If this parameter is NULL, this function is being used to install a class installer.</DD>

<DT><I>Reserved1</I></DT>

<DD>Reserved. Must be zero.</DD>

<DT><I>Reserved2</I></DT>

<DD>Reserved. Must be zero.
</DD>
</DL>

<H4>Return Value</H4>

<P><B>SetupDiInstallClassEx</B> returns TRUE if it is successful. Otherwise, it returns FALSE and the logged error can be retrieved with a call to <B>GetLastError</B>.</P>

<H4>Headers</H4>

<P>Declared in <I>setupapi.h</I>. Include <I>setupapi.h</I>. </P>

<H4>Comments</H4>

<P>The caller of this function must be a member of the Administrators group.</P>

<P><B>SetupDiInstallClassEx</B> is typically called by a class installer to install a new device setup class or a new device interface class. Note that an interface class can also be installed automatically as a result of installing the device interfaces for a device instance (<A HREF="di-rtns_1v5e.htm"><B>SetupDiInstallDeviceInterfaces</B></A>).</P>

<H4>See Also</H4>

<P><A HREF="di-rtns_7fjm.htm"><B>SetupDiCallClassInstaller</B></A>, <A HREF="di-rtns_1v5e.htm"><B>SetupDiInstallDeviceInterfaces</B></A> </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: SetupDiInstallClassEx"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
