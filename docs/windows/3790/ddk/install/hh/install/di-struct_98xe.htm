<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>SP_CLASSINSTALL_HEADER</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="SP_CLASSINSTALL_HEADER">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Device&nbsp;Installation:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_sp_classinstall_header_dr"></A>SP_CLASSINSTALL_HEADER</H1>

<P>An SP_CLASSINSTALL_HEADER is the first member of any class install parameters structure. It contains the device installation request code that defines the format of the rest of the install parameters structure.</P>

<PRE class=syntax>typedef struct _SP_CLASSINSTALL_HEADER {
  DWORD  cbSize;
  DI_FUNCTION  InstallFunction;
} SP_CLASSINSTALL_HEADER, *PSP_CLASSINSTALL_HEADER;</PRE>

<H4>Members</H4>

<DL>
<DT><B>cbSize</B></DT>

<DD>The size, in bytes, of the SP_CLASSINSTALL_HEADER structure.</DD>

<DT><B>InstallFunction</B></DT>

<DD>The device installation request (DIF code) for the class install parameters structure. 

<P>DIF codes have the format DIF_<I>XXX</I> and are defined in <I>setupapi.h</I>. See <A HREF="dif-codes_4x9u.htm">Device Installation Function Codes</A> for a complete description of DIF codes.

</DD>
</DL>

<H4>Comments</H4>

<P>When a component allocates a class install parameters structure, it typically initializes the header fields of the structure. Such a component sets the <B>InstallFunction</B> member to the DIF code for the installation request and sets <B>cbSize</B> to the size of the SP_CLASSINSTALL_HEADER structure. For example:</P>

<PRE>SP_REMOVEDEVICE_PARAMS RemoveDeviceParams;
RemoveDeviceParams.ClassInstallHeader.cbSize = sizeof(SP_CLASSINSTALL_HEADER);
RemoveDeviceParams.ClassInstallHeader.InstallFunction = DIF_REMOVE;</PRE>

<P>A component must set the <B>InstallFunction</B> member before passing a class install parameters structure to <A HREF="di-rtns_5vg2.htm"><B>SetupDiSetClassInstallParams</B></A>. </P>

<P>However, a component need not set this field when passing class install parameters to <A HREF="di-rtns_11iq.htm"><B>SetupDiGetClassInstallParams</B></A>. This function sets the <B>InstallFunction</B> member in the structure it passes back to the caller. It sets <B>InstallFunction</B> to the DIF_<I>XXX</I> code for the currently active device installation request.</P>

<H4>See Also</H4>

<P><A HREF="di-rtns_7fjm.htm"><B>SetupDiCallClassInstaller</B></A>, <A HREF="di-rtns_11iq.htm"><B>SetupDiGetClassInstallParams</B></A>, <A HREF="di-rtns_5vg2.htm"><B>SetupDiSetClassInstallParams</B></A>, <A HREF="di-struct_2vle.htm">SP_DETECTDEVICE_PARAMS</A>, <A HREF="di-struct_8aya.htm">SP_MOVEDEV_PARAMS</A>, <A HREF="di-struct_92eq.htm">SP_NEWDEVICEWIZARD_DATA</A>, <A HREF="di-struct_3mk2.htm">SP_POWERMESSAGEWAKE_PARAMS</A>, <A HREF="di-struct_588i.htm">SP_PROPCHANGE_PARAMS</A>, <A HREF="di-struct_1qeq.htm">SP_REMOVEDEVICE_PARAMS</A>, <A HREF="di-struct_619u.htm">SP_SELECTDEVICE_PARAMS</A>, <A HREF="di-struct_9b76.htm">SP_TROUBLESHOOTER_PARAMS</A>, <A HREF="di-struct_6x6a.htm">SP_UNREMOVEDEVICE_PARAMS</A> </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: SP_CLASSINSTALL_HEADER"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
