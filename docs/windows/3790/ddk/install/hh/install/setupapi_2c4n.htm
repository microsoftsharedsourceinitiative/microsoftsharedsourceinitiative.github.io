<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Basic Installation Operations</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Basic Installation Operations">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Device&nbsp;Installation:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="ddk_basic_installation_operations_dg"></A>Basic Installation Operations</H2>

<P>Installers can use the <A HREF="setup-ref_1r3m.htm">general Setup functions</A> and <A HREF="di-rtns_85ma.htm">device installation functions</A> provided by Setup API to carry out installation operations. These functions allow installers to search INF files for compatible drivers, to display driver choices to the user through selection dialog boxes, and to perform the actual driver installation.</P>

<P>Most of the device installation functions rely on information in the <A HREF="di-struct_7nqq.htm">SP_DEVINFO_DATA</A> structure to carry out installation tasks. Each device is associated with an SP_DEVINFO_DATA structure. You can retrieve a handle (HDEVINFO) to a <A HREF="setup-cls_2h9j.htm">device information set</A> that contains all installed devices in a particular class by using the <A HREF="di-rtns_9ks2.htm"><B>SetupDiGetClassDevs</B></A> function. You can use the <A HREF="di-rtns_75gy.htm"><B>SetupDiCreateDeviceInfo</B></A> function to add a new device to a device information set. You can free all SP_DEVINFO_DATA structures in a device information set by using the <A HREF="di-rtns_0z8y.htm"><B>SetupDiDestroyDeviceInfoList</B></A> function. This function also frees any compatible device and class device lists that might have been added to the structure.</P>

<P>By using the <A HREF="di-rtns_9pma.htm"><B>SetupDiBuildDriverInfoList</B></A> function, you can generate a list from which the installer or the user can choose the driver or device to install. <B>SetupDiBuildDriverInfoList</B> creates a list of compatible drivers or a list of all devices of a particular class.</P>

<P>Once you have a list of compatible drivers, you can prompt the user to select from the list by using the <A HREF="di-rtns_6fle.htm"><B>SetupDiSelectDevice</B></A> function. This function displays a dialog box that contains information about each device in the device information set. You can install a selected driver by using the <A HREF="di-rtns_3f8y.htm"><B>SetupDiInstallDevice</B></A> function. This function uses information in the driver's INF file to create to any new registry entries required, to set the configuration of the device hardware, and to copy the driver files to the appropriate directories.</P>

<P>An installer might need to examine and set values under the registry key for a device that is about to be installed. You can open the hardware or driver key for a device by using the <A HREF="di-rtns_6v02.htm"><B>SetupDiCreateDevRegKey</B></A> or <A HREF="di-rtns_8g36.htm"><B>SetupDiOpenDevRegKey</B></A> function.</P>

<P>You can install a new <A HREF="setup-cls_1wpz.htm">device setup class</A> by using the <A HREF="di-rtns_6dwy.htm"><B>SetupDiInstallClass</B></A> function. This function installs the new setup class from an INF file that contains an <A HREF="inf-format_6p9u.htm">INF <B>ClassInstall32</B> section</A>.</P>

<P>You can remove a device from the system by using the <A HREF="di-rtns_5fua.htm"><B>SetupDiRemoveDevice</B></A> function. This function deletes the device's registry entries and, if possible, stops the device. If the device cannot be dynamically stopped, the function sets flags that eventually cause the user to be prompted to shut down the system.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Basic%20Installation%20Operations"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
