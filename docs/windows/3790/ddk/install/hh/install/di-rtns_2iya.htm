<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>SetupDiCreateDeviceInfoList</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="SetupDiCreateDeviceInfoList">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Device&nbsp;Installation:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_setupdicreatedeviceinfolist_dr"></A>SetupDiCreateDeviceInfoList</H1>

<P>The <B>SetupDiCreateDeviceInfoList</B> function creates an empty <A HREF="setup-cls_2h9j.htm">device information set</A>. This set can be associated with a class GUID.</P>

<PRE class=syntax><B>HDEVINFO</B>
  <B>SetupDiCreateDeviceInfoList(</B>
    <B>IN LPGUID</B>  <I>ClassGuid</I><B>,  OPTIONAL</B>
    <B>IN HWND</B>  <I>hwndParent</I><B>  OPTIONAL</B>
    <B>);</B></PRE>

<H4>Parameters</H4>

<DL>
<DT><I>ClassGuid</I></DT>

<DD>Optionally supplies the GUID of the setup class associated with this device information set. If this parameter is specified, only devices of this class may be included in this device information set.</DD>

<DT><I>hwndParent</I></DT>

<DD>Optionally supplies the window handle of the top-level window to use for any user interface related to non-device-specific actions (such as a select-device dialog using the global class driver list).
</DD>
</DL>

<H4>Return Value</H4>

<P>The function returns a handle to an empty device information set if it is successful. Otherwise, it returns INVALID_HANDLE_VALUE. To get extended error information, call <B>GetLastError</B>.</P>

<H4>Headers</H4>

<P>Declared in <I>setupapi.h</I>. Include <I>setupapi.h</I>. </P>

<H4>Comments</H4>

<P>The caller of this function must delete the returned device information set when it is no longer needed by calling <B>SetupDiDestroyDeviceInfoList</B>. </P>

<P>To create a device information list for a remote machine use <B>SetupDiCreateDeviceInfoListEx</B>.</P>

<H4>See Also</H4>

<P><A HREF="di-rtns_6qr6.htm"><B>SetupDiCreateDeviceInfoListEx</B></A>, <A HREF="di-rtns_9ks2.htm"><B>SetupDiGetClassDevs</B></A>, <A HREF="di-rtns_0z8y.htm"><B>SetupDiDestroyDeviceInfoList</B></A>, <A HREF="di-rtns_78c2.htm"><B>SetupDiGetDeviceInfoListClass</B></A> </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: SetupDiCreateDeviceInfoList"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
