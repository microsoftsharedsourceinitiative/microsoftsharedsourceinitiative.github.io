<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Co-installer Functionality</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Co-installer Functionality">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Device&nbsp;Installation:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_co_installer_functionality_dg"></A>Co-installer Functionality</H1>

<P>A co-installer is a user-mode Win32 DLL that typically writes additional configuration information to the registry, or performs other installation tasks requiring information that is not available when an INF is written.</P>

<P>A co-installer might do some or all of the following:

<UL>
	<LI>Handle one or more of the <A HREF="dif-codes_4x9u.htm">device installation function codes</A> (DIF codes) received by the <A HREF="coinst_9mqv.htm#ddk_co_installer_entry_point_dg">co-installer entry point</A> function.</LI>

	<LI>Perform operations before the associated class or device installer is called, after the class or device installer is called, or both, as described in <A HREF="coinst_8grr.htm">Co-installer Operation</A>.</LI>

	<LI>Provide "finish install" pages (in response to <A HREF="dif-codes_2msy.htm">DIF_NEWDEVICEWIZARD_FINISHINSTALL</A>) to obtain device parameters that are required so the device can operate, or to ask if device-specific applications should be installed. </LI>

	<LI><A HREF="prop-pages_20vb.htm">Provide device property pages</A>, which are displayed by the Device Manager so users can modify device parameters. </LI>
</UL>

<P>When called for post-processing, a co-installer must check the <B>InstallResult</B> member of the <A HREF="coinst_9mqv.htm#ddk_coinstaller_context_data_dg">COINSTALLER_CONTEXT_DATA</A> structure. If its value is not NO_ERROR, the co-installer must do any necessary clean up operations and return an appropriate value for <B>InstallResult</B>.</P>

<P>Co-installers are sometimes used to obtain information from the user. Such information might include additional device parameters (such as a modem's dialing properties), or whether the user wants device-specific applications installed. Co-installers can create user interfaces by providing "finish install" pages and by providing device property pages. No other form of user interface is allowed. Setup displays "finish install" pages at the end of the installation (within the Found New Hardware, Hardware Update, or Add Hardware Wizard, which require administrator privilege). The Device Manager displays property pages, and allows users with administrator privilege to modify parameters displayed on these pages. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Co-installer%20Functionality"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
