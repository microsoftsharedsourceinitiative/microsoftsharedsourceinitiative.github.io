<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Adding Speakerphone Support</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Adding Speakerphone Support">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Modem&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="ddk_adding_speakerphone_support_mg"></A>Adding Speakerphone Support</H2>

<P>Speakerphone capabilities can be supported by using the following INF file entries: <A HREF="modemref3_954i.htm"><B>SpeakerPhoneSpecs</B></A>, <A HREF="modemref3_9faq.htm#ddk_speakerphoneenable_mr"><B>SpeakerPhoneEnable</B></A>, <A HREF="modemref3_9faq.htm#ddk_speakerphonedisable_mr"><B>SpeakerPhoneDisable</B></A>, <A HREF="modemref3_76sy.htm#ddk_speakerphonemute_mr"><B>SpeakerPhoneMute</B></A>, <A HREF="modemref3_76sy.htm#ddk_speakerphoneunmute_mr"><B>SpeakerPhoneUnMute</B></A> and <A HREF="modemref3_135e.htm"><B>SpeakerPhoneSetVolumeGain</B></A>. For example, here are the six INF file entries from <I>SmpVoice.inf</I>.</P>

<PRE>    HKR,, SpeakerPhoneSpecs, 1, 00,00,00,00,  0f,00,00,00,  03,00,00,00,  00,00,00,00
    HKR, SpeakerPhoneEnable,       1,, "at#vls=5&lt;cr&gt;"
    HKR, SpeakerPhoneDisable,      1,, "at#vls=0&lt;cr&gt;"
    HKR, SpeakerPhoneMute,         1,, "at#spk=0,,,&lt;cr&gt;"
    HKR, SpeakerPhoneUnMute,       1,, "at#spk=1,,,&lt;cr&gt;"
    HKR, SpeakerPhoneSetVolumeGain,1,, "at#spk=,&lt;Vol&gt;,&lt;Gain&gt;&lt;cr&gt;"</PRE>

<P>The four values in the <A HREF="modemref3_954i.htm"><B>SpeakerPhoneSpecs</B></A> entry define the minimum and maximum speakerphone volumes, as well as the minimum and maximum gain. The <B>SpeakerPhoneSpecs</B> entry must be included even if all four values are zero. Use ProCalc to create the <B>SpeakerPhoneSpecs</B> entry, as described in <A HREF="modem7_89ev.htm">Creating Voice Modem INF File Entries with ProCalc</A><I>.</I></P>

<P>The <A HREF="modemref3_135e.htm"><B>SpeakerPhoneSetVolumeGain</B></A> entry values are used to scale the speakerphone volume and gain when TAPI passes Unimodem a speaker volume setting. Scaling is based on the values assigned in the <B>SpeakerPhoneSpecs</B> entry. For more information about speakerphone volume and gain scaling, see <A HREF="modemref1_9wz6.htm">Modem INF File Entries</A>.</P>

<P>Set the following INF file entries to command strings that Unimodem can send to the voice modem to accomplish the indicated functions: <A HREF="modemref3_9faq.htm#ddk_speakerphoneenable_mr"><B>SpeakerPhoneEnable</B></A>, <A HREF="modemref3_9faq.htm#ddk_speakerphonedisable_mr"><B>SpeakerPhoneDisable</B></A>, <A HREF="modemref3_76sy.htm#ddk_speakerphonemute_mr"><B>SpeakerPhoneMute</B></A>, and <A HREF="modemref3_76sy.htm#ddk_speakerphoneunmute_mr"><B>SpeakerPhoneUnMute</B></A>.</P>

<P>Volume and gain must both be set for modems with volume control. If there is no gain control, use AT volume control commands that approximate gain control.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Adding%20Speakerphone%20Support"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
