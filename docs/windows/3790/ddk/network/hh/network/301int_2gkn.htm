<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Handling PnP Events and PM Events in an Intermediate Driver</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Handling PnP Events and PM Events in an Intermediate Driver">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Network&nbsp;Devices&nbsp;and&nbsp;Protocols:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="ddk_handling_pnp_events_and_pm_events_in_an_intermediate_driver_ng"></A>Handling PnP Events and PM Events in an Intermediate Driver</H2>

<P>An intermediate driver must be capable of handling Plug and Play events and Power Management (PM) events. Specifically:

<UL>
	<LI>An intermediate driver must set the NDIS_ATTRIBUTE_NO_HALT_ON_SUSPEND flag in the <I>AttributeFlags</I> parameter passed to <A HREF="103ndisx_1pmb.htm"><B>NdisMSetAttributesEx</B></A>. For more information, see <A HREF="301int_3qp3.htm">Initializing as a Miniport</A>.</LI>

	<LI>The virtual miniport of an intermediate driver must handle OID_PNP_<I>XXX</I> requests.</LI>

	<LI>The protocol section of an intermediate driver must propagate the appropriate OID_PNP_<I>XXX</I> requests to the underlying miniport driver. The virtual miniport of the intermediate driver must pass the underlying miniport driver's responses to these requests back to the protocol driver that originated the requests.</LI>

	<LI>The protocol portion of an intermediate driver must supply a <A HREF="104tdlow_5muq.htm"><I>ProtocolPnPEvent</I></A> handler.</LI>
</UL>

<P>Intermediate driver protocol and miniport event handlers are not called in any particular order. Event handlers for intermediate drivers should be implemented accordingly.</P>

<P>This section includes the following topics: </P>

<P class=indent1><A HREF="301int_4sx3.htm">Handling OID_PNP_<I>XXX</I> Queries and Sets</A></P>

<P class=indent1><A HREF="301int_05pj.htm">Implementing a ProtocolPnPEvent Handler in an Intermediate Driver</A></P>

<P class=indent1><A HREF="301int_82jr.htm">Handling a Set Power Request</A></P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Handling%20PnP%20Events%20and%20PM%20Events%20in%20an%20Intermediate%20Driver"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
