<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>TAPI Objects</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="TAPI Objects">
<META NAME="MS-HKWD" CONTENT="TAPI Type VAR_STRING">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Network&nbsp;Devices&nbsp;and&nbsp;Protocols:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_tapi_objects_nr"></A>TAPI Objects</H1>

<P>TAPI objects use a set of associated OIDs to make both query and set information requests. These OIDs define the request interface between user-mode TAPI service providers and underlying WAN miniport drivers. Each such request goes through NDISTAPI and NDISWAN to the target miniport driver. This section defines the OIDs that are associated with TAPI objects. </P>

<P>The TAPI OIDs are defined in <I>ntddndis.h</I>. When building a driver that supports these OIDs, include <I>ntddndis.h</I> and <I>ndistapi.h</I>.</P>

<P>For more information about higher-level TAPI components, especially about user-mode service providers in which these OID requests originate, see the Microsoft® Win32® SDK. </P>

<P>The following chart summarizes the OIDs used to get operational characteristics for NDIS drivers and NICs that support TAPI on a WAN network.</P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=6%>Q</TH>
<TH align=left width=7%>S</TH>
<TH align=left width=87%>Name</TH>
</TR>

<TR VALIGN="top">
<TD class=indent1 width=6%>&nbsp;</TD>
<TD width=7%>&nbsp;</TD>
<TD width=87%><B>Mandatory OID_TAPI_<I>XXX</I></B></TD>
</TR>

<TR VALIGN="top">
<TD class=indent1 width=6%>&nbsp;</TD>
<TD width=7%>M</TD>
<TD width=87%><A HREF="29tpioid_5jsi.htm">OID_TAPI_ANSWER</A>  <BR>
Answer</TD>
</TR>

<TR VALIGN="top">
<TD class=indent1 width=6%>&nbsp;</TD>
<TD width=7%>M</TD>
<TD width=87%><A HREF="29tpioid_1enm.htm">OID_TAPI_CLOSE</A>  <BR>
Close</TD>
</TR>

<TR VALIGN="top">
<TD class=indent1 width=6%>&nbsp;</TD>
<TD width=7%>M</TD>
<TD width=87%><A HREF="29tpioid_844y.htm">OID_TAPI_CLOSE_CALL</A>  <BR>
Close Call</TD>
</TR>

<TR VALIGN="top">
<TD class=indent1 width=6%>&nbsp;</TD>
<TD width=7%>M</TD>
<TD width=87%><A HREF="29tpioid_3k6q.htm">OID_TAPI_CONDITIONAL_MEDIA_DETECTION</A>  <BR>
Conditional Media Detection</TD>
</TR>

<TR VALIGN="top">
<TD class=indent1 width=6%>&nbsp;</TD>
<TD width=7%>M</TD>
<TD width=87%><A HREF="29tpioid_9376.htm">OID_TAPI_DROP</A>  <BR>
Drop</TD>
</TR>

<TR VALIGN="top">
<TD class=indent1 width=6%>M</TD>
<TD width=7%>&nbsp;</TD>
<TD width=87%><A HREF="29tpioid_9cs2.htm">OID_TAPI_GET_ADDRESS_CAPS</A>  <BR>
Get Address Capabilities</TD>
</TR>

<TR VALIGN="top">
<TD class=indent1 width=6%>M</TD>
<TD width=7%>&nbsp;</TD>
<TD width=87%><A HREF="29tpioid_5koi.htm">OID_TAPI_GET_ADDRESS_ID</A>  <BR>
Get Address ID</TD>
</TR>

<TR VALIGN="top">
<TD class=indent1 width=6%>M</TD>
<TD width=7%>&nbsp;</TD>
<TD width=87%><A HREF="29tpioid_12lu.htm">OID_TAPI_GET_ADDRESS_STATUS</A>  <BR>
Get Address Status</TD>
</TR>

<TR VALIGN="top">
<TD class=indent1 width=6%>M</TD>
<TD width=7%>&nbsp;</TD>
<TD width=87%><A HREF="29tpioid_4zxu.htm">OID_TAPI_GET_CALL_ADDRESS_ID</A>  <BR>
Get Call Address ID</TD>
</TR>

<TR VALIGN="top">
<TD class=indent1 width=6%>M</TD>
<TD width=7%>&nbsp;</TD>
<TD width=87%><A HREF="29tpioid_0oaa.htm">OID_TAPI_GET_CALL_INFO</A>  <BR>
Get Call Information</TD>
</TR>

<TR VALIGN="top">
<TD class=indent1 width=6%>M</TD>
<TD width=7%>&nbsp;</TD>
<TD width=87%><A HREF="29tpioid_6zn6.htm">OID_TAPI_GET_CALL_STATUS</A>  <BR>
Get Call Status</TD>
</TR>

<TR VALIGN="top">
<TD class=indent1 width=6%>M</TD>
<TD width=7%>&nbsp;</TD>
<TD width=87%><A HREF="29tpioid_64c2.htm">OID_TAPI_GET_DEV_CAPS</A>  <BR>
Get Device Capabilities</TD>
</TR>

<TR VALIGN="top">
<TD class=indent1 width=6%>M</TD>
<TD width=7%>&nbsp;</TD>
<TD width=87%><A HREF="29tpioid_5rsi.htm">OID_TAPI_GET_ID</A>  <BR>
Get ID</TD>
</TR>

<TR VALIGN="top">
<TD class=indent1 width=6%>M</TD>
<TD width=7%>&nbsp;</TD>
<TD width=87%><A HREF="29tpioid_9nci.htm">OID_TAPI_GET_LINE_DEV_STATUS</A>  <BR>
Get Line Device Status</TD>
</TR>

<TR VALIGN="top">
<TD class=indent1 width=6%>M</TD>
<TD width=7%>&nbsp;</TD>
<TD width=87%><A HREF="29tpioid_83jm.htm">OID_TAPI_MAKE_CALL</A>  <BR>
Make Call</TD>
</TR>

<TR VALIGN="top">
<TD class=indent1 width=6%>M</TD>
<TD width=7%>&nbsp;</TD>
<TD width=87%><A HREF="29tpioid_9jhu.htm">OID_TAPI_OPEN</A>  <BR>
Open</TD>
</TR>

<TR VALIGN="top">
<TD class=indent1 width=6%>M</TD>
<TD width=7%>&nbsp;</TD>
<TD width=87%><A HREF="29tpioid_5ng2.htm">OID_TAPI_PROVIDER_INITIALIZE</A>  <BR>
Provider Initialize</TD>
</TR>

<TR VALIGN="top">
<TD class=indent1 width=6%>&nbsp;</TD>
<TD width=7%>M</TD>
<TD width=87%><A HREF="29tpioid_4xki.htm">OID_TAPI_PROVIDER_SHUTDOWN</A>  <BR>
Provider Shutdown</TD>
</TR>

<TR VALIGN="top">
<TD class=indent1 width=6%>&nbsp;</TD>
<TD width=7%>M</TD>
<TD width=87%><A HREF="29tpioid_6h2q.htm">OID_TAPI_SET_APP_SPECIFIC</A>  <BR>
Set Application Specific Member </TD>
</TR>

<TR VALIGN="top">
<TD class=indent1 width=6%>&nbsp;</TD>
<TD width=7%>M</TD>
<TD width=87%><A HREF="29tpioid_45bm.htm">OID_TAPI_SET_CALL_PARAMS</A>  <BR>
Set Call Paramaters</TD>
</TR>

<TR VALIGN="top">
<TD class=indent1 width=6%>&nbsp;</TD>
<TD width=7%>M</TD>
<TD width=87%><A HREF="29tpioid_2dbm.htm">OID_TAPI_SET_DEFAULT_MEDIA_DETECTION</A>  <BR>
Set Default Media Detection</TD>
</TR>

<TR VALIGN="top">
<TD class=indent1 width=6%>&nbsp;</TD>
<TD width=7%>M</TD>
<TD width=87%><A HREF="29tpioid_7n8y.htm">OID_TAPI_SET_MEDIA_MODE</A>  <BR>
Set Media Mode</TD>
</TR>

<TR VALIGN="top">
<TD class=indent1 width=6%>&nbsp;</TD>
<TD width=7%>M</TD>
<TD width=87%><A HREF="29tpioid_9l9u.htm">OID_TAPI_SET_STATUS_MESSAGES</A>  <BR>
Set Status Messages</TD>
</TR>

<TR VALIGN="top">
<TD class=indent1 width=6%>&nbsp;</TD>
<TD width=7%>&nbsp;</TD>
<TD width=87%><B>Optional OID_TAPI_<I>XXX</I></B></TD>
</TR>

<TR VALIGN="top">
<TD class=indent1 width=6%>&nbsp;</TD>
<TD width=7%>O</TD>
<TD width=87%><A HREF="29tpioid_7z3m.htm">OID_TAPI_ACCEPT</A>  <BR>
Accept</TD>
</TR>

<TR VALIGN="top">
<TD class=indent1 width=6%>O</TD>
<TD width=7%>&nbsp;</TD>
<TD width=87%><A HREF="29tpioid_8agi.htm">OID_TAPI_CONFIG_DIALOG</A>  <BR>
Configuration Dialog</TD>
</TR>

<TR VALIGN="top">
<TD class=indent1 width=6%>O</TD>
<TD width=7%>&nbsp;</TD>
<TD width=87%><A HREF="29tpioid_4sc2.htm">OID_TAPI_DEV_SPECIFIC</A>  <BR>
Device Specific</TD>
</TR>

<TR VALIGN="top">
<TD class=indent1 width=6%>&nbsp;</TD>
<TD width=7%>O</TD>
<TD width=87%><A HREF="29tpioid_66b6.htm">OID_TAPI_DIAL</A>  <BR>
Dial Specified Number for Specified Call</TD>
</TR>

<TR VALIGN="top">
<TD class=indent1 width=6%>O</TD>
<TD width=7%>&nbsp;</TD>
<TD width=87%><A HREF="29tpioid_0zg2.htm">OID_TAPI_GET_DEV_CONFIG</A>  <BR>
Get Device Configuration</TD>
</TR>

<TR VALIGN="top">
<TD class=indent1 width=6%>O</TD>
<TD width=7%>&nbsp;</TD>
<TD width=87%><A HREF="29tpioid_4u7m.htm">OID_TAPI_GET_EXTENSION_ID</A>  <BR>
Get Extension ID</TD>
</TR>

<TR VALIGN="top">
<TD class=indent1 width=6%>O</TD>
<TD width=7%>&nbsp;</TD>
<TD width=87%><A HREF="29tpioid_54du.htm">OID_TAPI_NEGOTIATE_EXT_VERSION</A>  <BR>
Return Highest Acceptable Version Extension</TD>
</TR>

<TR VALIGN="top">
<TD class=indent1 width=6%>&nbsp;</TD>
<TD width=7%>O</TD>
<TD width=87%><A HREF="29tpioid_0k1e.htm">OID_TAPI_SET_DEV_CONFIG</A>  <BR>
Set Device Configuration</TD>
</TR>

<TR VALIGN="top">
<TD class=indent1 width=6%>&nbsp;</TD>
<TD width=7%>O</TD>
<TD width=87%><A HREF="29tpioid_2p9u.htm">OID_TAPI_SECURE_CALL</A>  <BR>
Secure Call</TD>
</TR>

<TR VALIGN="top">
<TD class=indent1 width=6%>&nbsp;</TD>
<TD width=7%>O</TD>
<TD width=87%><A HREF="29tpioid_1ucy.htm">OID_TAPI_SELECT_EXT_VERSION</A>  <BR>
Select Extension Version</TD>
</TR>

<TR VALIGN="top">
<TD class=indent1 width=6%>&nbsp;</TD>
<TD width=7%>O</TD>
<TD width=87%><A HREF="29tpioid_0m0i.htm">OID_TAPI_SEND_USER_USER_INFO</A>  <BR>
Send User User Information</TD>
</TR>
</TABLE><BR>

<P>In contrast with other OIDs, defined TAPI OID values do not indicate whether each OID is required or optional. The length of the information buffer for TAPI OID requests varies according to the OID-specific structure. Instances of some OID-specific structures also vary in size, in particular for TAPI-defined structures with members of type VAR_STRING, described later. </P>

<P>WAN miniport drivers must support the OIDS labeled as <B>Mandatory</B> in the preceding chart. The extent to which a given miniport driver supports those labeled <B>Optional</B> in the preceding chart depends on the discretion of the driver writer and the capabilities of the NIC. </P>

<P>The functional requirements are quite simple for several of the TAPI OID requests. For example, the OID_TAPI_SET_APP_SPECIFIC request requires a NIC driver only to associate a ULONG value with a specified call instance, which can be retrieved later with an OID_TAPI_GET_CALL_INFO request. Requests that a NIC driver writer chooses to ignore should be completed with the NDIS_STATUS_TAPI_OPERATIONUNAVAIL status code. </P>

<P>A NIC driver can indicate the requests it supports, which might vary over time depending on line, address, or call state, by setting or clearing specific bits in the members of structures for some of the OID_TAPI_GET_<I>XXX</I> requests, such as in the <B>ulAddrCapFlags </B>member in the LINE_ADDRESS_CAPS structure.</P>

<P>For the declaration of LINE_ADDRESS_CAPS and other system-defined structures in which WAN miniport drivers maintain TAPI state, see <I>ndistapi.h</I>. For more information about these structures, see also the Win32 SDK. </P>



<H4><A NAME="ddk_tapi_type_var_string_nr"></A>TAPI Type VAR_STRING</H4>

<P>For several OID_TAPI_<I>XXX</I>, the miniport driver is given an OID-specific structured information buffer. More than one of these TAPI structures have a member of type VAR_STRING, which is also a structured buffer, defined as follows:</P>

<PRE class=syntax>typedef struct _VAR_STRING {
  ULONG  ulTotalSize;
  ULONG  ulNeededSize;
  ULONG  ulUsedSize;
  ULONG  ulStringFormat;
  ULONG  ulStringSize;
  ULONG  ulStringOffset;
} VAR_STRING, *PVAR_STRING;</PRE>

<P>The members of this structure contain the following information:

<DL>
<DT><B>ulTotalSize</B></DT>

<DD>The total size in bytes of the buffer, including the buffered string. </DD>

<DT><B>ulNeededSize</B></DT>

<DD>The size in bytes of a buffer necessary to contain a particular string. For example, the underlying driver sets this value if a protocol-supplied buffer is too short to contain a requested string. </DD>

<DT><B>ulUsedSize</B></DT>

<DD>The number of bytes in the given buffer that were actually used. </DD>

<DT><B>ulStringFormat</B></DT>

<DD>Specifies how the buffered string should be interpreted, as one of the following:<BR>
STRINGFORMAT_ASCII<BR>
STRINGFORMAT_DBCS<BR>
STRINGFORMAT_UNICODE<BR>
STRINGFORMAT_BINARY</DD>

<DT><B>ulStringSize</B></DT>

<DD>The number of bytes in the given buffered string.</DD>

<DT><B>ulStringOffset</B></DT>

<DD>The offset within this buffer at which the string begins.
</DD>
</DL>

<P>The following topics describe the OID_<I>XXX</I> elements listed in the preceding chart. These topics also describe any TAPI structures that may be associated with the OID_<I>XXX</I> elements.</P>

<P class=indent1><A HREF="29tpioid_9zoy.htm">TAPI Query Information Requests</A></P>

<P class=indent1><A HREF="29tpioid_68ky.htm">TAPI Set Information Requests</A></P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: TAPI%20Objects"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
