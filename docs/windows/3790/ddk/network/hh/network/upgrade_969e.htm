<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>HrGetInstanceGuidOfPreNT5NetCardInstance</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="HrGetInstanceGuidOfPreNT5NetCardInstance">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Network&nbsp;Devices&nbsp;and&nbsp;Protocols:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_hrgetinstanceguidofprent5netcardinstance_nr"></A>HrGetInstanceGuidOfPreNT5NetCardInstance</H1>

<P>This function is <B>obsolete</B> for Windows XP (SP1 and later), Windows Server 2003, and later operating systems.</P>

<P>The <B>HrGetInstanceGuidOfPreNT5NetCardInstance</B> function supplies a network migration DLL with the globally unique identifier (GUID) of a network adapter.</P>

<PRE class=syntax><B>LONG __stdcall</B>
  <B>HrGetInstanceGuidOfPreNT5NetCardInstance(</B>
    <B>IN</B> <B>PCWSTR</B>  <I>szPreNt5NetCardInstance</I><B>,
</B>    <B>OUT LPGUID</B>  <I>pguid</I>
    <B>);</B></PRE>

<H4>Parameters</H4>

<DL>
<DT><I>szPreNt5NetCardInstance</I></DT>

<DD>The preupgrade instance of the service (device driver) for an adapter. <I>szPreNt5NetCardInstance </I>typically consists of the service name followed by an instance number as a suffix.</DD>

<DT><I>pguid</I></DT>

<DD>If <I>szPreNt5NetCardInstance</I> existed before the upgrade and could be mapped to its post-upgrade instance, <I>pguid </I>points to the post-upgrade instance GUID for the adapter. Otherwise, <I>pguid </I>is zero.
</DD>
</DL>

<H4>Return Value</H4>

<P>The <B>HrGetInstanceGuidOfPreNT5NetCardInstance</B> function can return either:

<DL>
<DT>ERROR_SUCCESS</DT>

<DD><B>HrGetInstanceGuidOfPreNT5NetCardInstance</B> returned a valid <I>pguid </I>value.</DD>

<DT>ERROR_INVALID_PARAMETER</DT>

<DD><I>szPreNt5NetCardInstance </I>is invalid.
</DD>
</DL>

<P>Any other return values indicate that the <I>szPreNt5NetCardInstance</I> could not be mapped to its Windows&nbsp;2000 or later instance GUID.</P>

<H4>Headers</H4>

<P>Declared in <I>OemUpGex.h</I>. Include <I>OemUpGex.h</I>. </P>

<H4>Comments</H4>

<P>A network migration DLL must call <B>HrGetInstanceGuidOfPreNT5NetCardInstance</B> in the context of the DLL's <B>DoPostUpgradeProcessing </B>function. </P>

<P>If the miniport driver for a network adapter required the adapter's instance ID before the operating system upgrade, it will probably require the adapter's instance ID after the upgrade. A network migration DLL calls <B>HrGetInstanceGuidOfPreNT5NetCardInstance</B> to obtain the Windows&nbsp;2000 or later instance GUID for a network adapter.</P>

<H4>See Also</H4>

<P><A HREF="upgrade_1b02.htm"><B>DoPostUpgradeProcessing</B></A></P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: HrGetInstanceGuidOfPreNT5NetCardInstance"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
