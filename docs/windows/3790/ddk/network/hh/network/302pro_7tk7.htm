<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Queries and Sets from Connection-Oriented Protocol Drivers</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Queries and Sets from Connection-Oriented Protocol Drivers">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Network&nbsp;Devices&nbsp;and&nbsp;Protocols:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="ddk_queries_and_sets_from_connection_oriented_protocol_drivers_ng"></A>Queries and Sets from Connection-Oriented Protocol Drivers</H2>

<P>A connection-oriented protocol driver calls <A HREF="103ndisx_8xde.htm"><B>NdisCoRequest</B></A> to retrieve (query) or set the characteristics of an underlying connection-oriented miniport driver. The type of information in the request is specified by an object identifier (OID). For a complete listing of connection-oriented OIDs, see <A HREF="211cooid_2whe.htm">Connection-Oriented Objects</A>.</P>

<P>A connection-oriented protocol driver can query the underlying miniport driver for its link speed with <A HREF="211cooid_1242.htm">OID_GEN_CO_LINK_SPEED</A> and use the results to set any internal time-out values it maintains. If the protocol driver is bound to NDISWAN, it cannot determine the link speed until it receives a line-up indication from the WAN miniport driver, indicating that a connection has been established between the local node and a remote node. A connection-oriented protocol driver can also set the speed of the underlying NIC with OID_GEN_CO_LINK_SPEED.</P>

<P>A connection-oriented protocol driver can issue an <A HREF="211cooid_3uk2.htm">OID_GEN_CO_MAC_OPTIONS</A> query to determine the operating characteristics of the underlying miniport driver. See the <A HREF="netref_886q.htm"><I>Network Reference</I></A> for the set of NDIS-defined flags that can be returned for this query. </P>

<P>If needed, a connection-oriented protocol driver issues a set request to inform NDIS of its own operating characteristics, passing <A HREF="211cooid_1m5u.htm">OID_GEN_CO_PROTOCOL_OPTIONS</A>.</P>

<P>Protocol drivers should support 64-bit statistics OID queries. In a statistics OID query, the protocol driver sets the <B>InformationBufferLength</B> member of the <A HREF="105nstru_3f8y.htm">NDIS_REQUEST</A> structure to four (bytes) to indicate a 32-bit statistics request or to eight (bytes) to indicate a 64-bit statistics request. In its response, the miniport driver sets the <B>BytesNeeded</B> member to the size of the statistics supported by the miniport driver (four for 32-bits or eight for 64-bits). The miniport driver sets the <B>BytesWritten</B> member to the smaller of these two values: the <B>InformationBufferLength</B>, or the size of statistics supported by the miniport driver. For more information about statistics OIDs for connection-oriented miniport drivers, see <A HREF="211cooid_5t6a.htm">General Statistics for Connection-Oriented Miniport Drivers</A>.  </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Queries%20and%20Sets%20from%20Connection-Oriented%20Protocol%20Drivers"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
