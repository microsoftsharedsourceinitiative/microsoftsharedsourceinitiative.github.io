<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Handling Queries in an NDIS WAN Miniport Driver</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Handling Queries in an NDIS WAN Miniport Driver">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Network&nbsp;Devices&nbsp;and&nbsp;Protocols:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="ddk_handling_queries_in_an_ndis_wan_miniport_driver_ng"></A>Handling Queries in an NDIS WAN Miniport Driver</H2>

<P>An upper-layer driver calls <A HREF="103ndisx_0u42.htm"><B>NdisRequest</B></A> with a query request to determine WAN-specific capabilities and current status of an NDIS WAN miniport driver and the miniport driver's NIC. The NDISWAN intermediate driver forwards the query request, which causes NDIS to call the WAN miniport driver's <A HREF="101mini_2vw2.htm"><I>MiniportQueryInformation</I></A> function. In an NDIS WAN miniport driver, this function is the same as in a non-WAN connectionless miniport driver, except that the WAN miniport driver recognizes standard WAN OIDs. For more information about standard WAN OIDs, see <A HREF="28wanoid_2mb6.htm">Standard WAN Objects</A>.</P>

<P>If the WAN miniport driver completes <I>MiniportQueryInformation</I> asynchronously by returning a status of NDIS_STATUS_PENDING, it must complete the query later by calling <A HREF="103ndisx_4ktu.htm"><B>NdisMQueryInformationComplete</B></A>.</P>

<P>An NDIS WAN miniport driver must handle standard WAN OIDs. The standard WAN query OIDs are summarized in the following table.</P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=62%>Name</TH>
<TH align=left width=38%>Optional or Required</TH>
</TR>

<TR VALIGN="top">
<TD width=62%><A HREF="28wanoid_3v1u.htm">OID_WAN_PERMANENT_ADDRESS</A><BR>
Permanent station address</TD>
<TD width=38%>Required</TD>
</TR>

<TR VALIGN="top">
<TD width=62%><A HREF="28wanoid_0u42.htm">OID_WAN_CURRENT_ADDRESS</A> <BR>
Current station address</TD>
<TD width=38%>Required</TD>
</TR>

<TR VALIGN="top">
<TD width=62%><A HREF="28wanoid_89ki.htm">OID_WAN_MEDIUM_SUBTYPE</A> <BR>
Medium subtype</TD>
<TD width=38%>Required</TD>
</TR>

<TR VALIGN="top">
<TD width=62%><A HREF="28wanoid_3302.htm">OID_WAN_GET_INFO</A> <BR>
Get information </TD>
<TD width=38%>Required</TD>
</TR>

<TR VALIGN="top">
<TD width=62%><A HREF="28wanoid_4pde.htm">OID_WAN_GET_LINK_INFO</A> <BR>
Get link information</TD>
<TD width=38%>Required</TD>
</TR>

<TR VALIGN="top">
<TD width=62%><A HREF="28wanoid_5dyq.htm">OID_WAN_GET_STATS_INFO</A> <BR>
Get statistics information </TD>
<TD width=38%>Optional</TD>
</TR>
</TABLE><BR>

<P>In addition to handling the standard WAN OIDs, an NDIS WAN miniport driver handles queries to the NDIS <A HREF="22genoid_1m2a.htm">General Objects</A>. For more information about querying miniport drivers, see <A HREF="205mpinfo_2uav.htm">Querying a Connectionless Miniport Driver</A>.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Handling%20Queries%20in%20an%20NDIS%20WAN%20Miniport%20Driver"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
