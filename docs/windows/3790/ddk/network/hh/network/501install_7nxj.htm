<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>DDInstall.Services Section</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="DDInstall.Services Section">
</HEAD>
<BODY TOPMARGIN="0">
<DIV STYLE="display:none;">
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_inf_ddinstall.services_section_dr">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_inf_addservice_directive_dr">
</OBJECT>
</DIV>


<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Network&nbsp;Devices&nbsp;and&nbsp;Protocols:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="ddk_ddinstall_services_section_ng"></A><I>DDInstall</I>.Services Section</H2>

<P>A <I>DDInstall</I>.<B>Services</B> section contains one or more <B>AddService</B> directives, each of which references an INF-writer-defined <I>service-install</I>-<I>section</I> that specifies how and when the services of particular component drivers are loaded. </P>

<P>A <I>DDInstall</I>.<B>Services</B> section is required in an INF file that installs a Net component (adapter); it is optional in an INF file that installs a <B>NetTrans</B>, <B>NetClient</B>, or <B>NetService</B> component.</P>

<P>An <B>AddService</B> directive in a <I>DDInstall</I>.<B>Services</B> section can also reference an <I>error-log-install-section </I>that installs an error log for a component. An error log is optional for all network components.</P>

<P>For more information, see <A HREF="JavaScript:hhobj_1.Click()">INF DDInstall.Services Section</A> and <A HREF="JavaScript:hhobj_2.Click()">INF AddService Directive</A>.</P>

<P>The following is an example of a <I>DDInstall</I>.<B>Services</B> section, a <I>service-install-section</I>, an <I>error-log-install-section</I>, and an <I>add-registry-section</I> that is referenced by an <B>AddReg</B> directive in the <I>error-log-install-section</I>:</P>

<PRE>[a1.ndi.NT.Services]
AddService = a1, 2, a1.AddService, a1.AddEventLog
 
[a1.AddService]
DisplayName = %Adapter1.DispName%
ServiceType = 1 ;SERVICE_KERNEL_DRIVER
StartType = 2 ;SERVICE_AUTO_START
ErrorControl = 1 ;SERVICE_ERROR_NORMAL
ServiceBinary = %12%\a1.sys
LoadOrderGroup = NDIS
 
[a1.AddEventLog]
AddReg = a1.AddEventLog.reg
 
[a1.AddEventLog.reg]
HKR,,EventMessageFile,0x00020000,"%%SystemRoot%%\System32\netevent.dll"
HKR,,TypesSupported,0x00010001,7</PRE>

<P>The <I>ServiceName</I> parameter of the <B>AddService</B> directive, which in the above example is <B>a1</B> (the first <B>AddService</B> parameter), must match the component's <B>Ndi\Service</B> value. For more information, see <A HREF="501install_60rr.htm">Adding Service-Related Values to the Ndi Key</A>.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: DDInstall.Services%20Section"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
