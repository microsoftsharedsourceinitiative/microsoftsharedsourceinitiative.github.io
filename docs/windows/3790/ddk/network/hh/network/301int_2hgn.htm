<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Responding to Sets and Queries in an Intermediate Driver</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Responding to Sets and Queries in an Intermediate Driver">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Network&nbsp;Devices&nbsp;and&nbsp;Protocols:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="ddk_responding_to_sets_and_queries_in_an_intermediate_driver_ng"></A>Responding to Sets and Queries in an Intermediate Driver</H3>

<P>Because an intermediate NDIS driver is bound to an overlying NDIS driver, it can also receive queries and sets from its <A HREF="101mini_2vw2.htm"><I>MiniportQueryInformation</I></A> and <A HREF="101mini_7ng2.htm"><I>MiniportSetInformation</I></A> functions. In some cases, the intermediate driver just passes such requests through to the underlying miniport driver. Otherwise, it can respond to these queries and sets as appropriate to the medium it exports at its upper edge. Note that an intermediate driver must always pass through any OID_PNP_<I>XXX</I> requests that it receives from an overlying NDIS driver to the underlying miniport driver.</P>

<P>Typically, the general OIDs that an intermediate driver receives are the same or similar to those that the intermediate driver sends to the underlying miniport driver. The medium-specific OIDs that an intermediate driver receives are the type of the medium that the overlying driver requires.</P>

<P>If an intermediate driver itself processes the setting of an OID rather than passing the set request to an underlying miniport, it should validate the value to be set. If the intermediate driver determines that the value to be set is out of bounds, it should fail the set request.</P>

<P class=note><B>Note</B>&nbsp;&nbsp;If an intermediate driver modifies the contents of TCP packets that it forwards down to an underlying miniport driver such that TCP offload functions cannot be performed on the packets, the intermediate driver should respond to <A HREF="216offload_0acy.htm">OID_TCP_TASK_OFFLOAD</A> queries with a status of NDIS_STATUS_NOT_SUPPORTED instead of passing the request down to the underlying miniport.</P>

<P>For additional information about responding to sets and queries in an intermediate driver, see <A HREF="205mpinfo_96nb.htm">Obtaining and Setting Miniport Driver Information and NDIS Support for WMI</A>.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Responding%20to%20Sets%20and%20Queries%20in%20an%20Intermediate%20Driver"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
