<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>NDISTAPI Interface</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="NDISTAPI Interface">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Network&nbsp;Devices&nbsp;and&nbsp;Protocols:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="ddk_ndistapi_interface_ng"></A>NDISTAPI Interface</H2>

<P>This topic introduces the NDIS TAPI interface as it applies to NDIS WAN miniport drivers. Subsequent topics describe the implementation of operations that use this interface.</P>

<P>This section describes the OID requests that define the interface between the NDISTAPI driver, NDISWAN and underlying NDIS WAN miniport drivers. Each OID request described in the DDK has a corresponding Service Provider Interface (SPI) function defined in the Telephony Software Development Kit, documented in the <I>Platform SDK</I>. </P>

<P>NDIS WAN miniport driver developers should consult the SPI specifications when designing and implementing drivers. Note that function definitions and parameters might differ slightly between the NDISTAPI specification and the SPI specification, in which case the developer should adhere to the NDISTAPI specification.</P>

<P>For a complete listing of the TAPI OIDs, see <A HREF="29tpioid_5jhu.htm">TAPI Objects</A>.</P>

<P>Definitions for these OIDs are provided in <I>ntddndis.h</I>. Definitions for NDIS_TAPI_EVENT messages are provided in <I>ndistapi.h</I>.</P>

<P>The extent to which a given NDIS WAN miniport driver supports this interface depends in large part on the discretion of the miniport driver developer and the capabilities of the underlying hardware. </P>

<P>Requests that the NDIS WAN miniportdriver developer chooses not to support should be completed with the NDIS_STATUS_TAPI_OPERATIONUNAVAIL status code. The NDIS WAN miniport driver can indicate what types of requests it supports (which can vary over time depending on line, address, or call state) by setting or clearing specific bits in the members of structures present in some of the OID_TAPI_GET_<I>XXX</I> requests (for example, the <B>ulAddrCapFlags</B> member in the LINE_ADDRESS_CAPS structure used with <A HREF="29tpioid_9cs2.htm">OID_TAPI_GET_ADDRESS_CAPS</A>).</P>

<P>Query information-type requests differ from set information-type requests in that one or more members in the request structure, denoted by the OUT prefix in the structure definition, are reserved for information to be passed back to the calling process. Members prefixed with IN should be considered read-only. The first member in all query information requests, <B>ulRequestID</B>, is reserved for future use, and should be ignored.</P>

<P>For a complete listing of TAPI query information OIDs, see <A HREF="29tpioid_9zoy.htm">TAPI Query Information Requests</A>.</P>

<P>Set information requests return no information other than completion status. All request structure members should be considered as read-only, and should not be modified by NDIS WAN miniport drivers. The first member in all query information requests, <B>ulRequestID</B>, is reserved for future use, and should be ignored.</P>

<P>For a complete listing of TAPI set information OIDs, see <A HREF="29tpioid_68ky.htm">TAPI Set Information Requests</A>.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: NDISTAPI%20Interface"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
