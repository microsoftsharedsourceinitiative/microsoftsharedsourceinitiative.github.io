<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Writing a Network Migration DLL</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Writing a Network Migration DLL">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Network&nbsp;Devices&nbsp;and&nbsp;Protocols:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_writing_a_network_migration_dll_ng"></A>Writing a Network Migration DLL</H1>

<P><B>Note:</B> vendor-supplied network upgrades are not supported in Windows XP (SP1 and later), Windows Server 2003, and later operating systems.</P>

<P>A network migration DLL migrates the parameter values for one or more network components from Microsoft® Windows NT® 3.51 or Windows&nbsp;NT 4.0 to Windows®&nbsp;2000 or later.</P>

<P>A network migration DLL must:

<UL>
	<LI><B>Load under the preupgrade operating system (Windows&nbsp;NT 3.51 or Windows 4.0)</B> <BR>
The DLL cannot call any functions specific to Windows&nbsp;2000 or later or use any features specific to Windows&nbsp;2000 or later. If the DLL runs in the post-upgrade (GUI mode) phase, it must also load under Windows&nbsp;2000 and later operating systems.</LI>

	<LI><B>Export the <A HREF="upgrade_3jzm.htm">PreUpgradeInitialize</A> and <A HREF="upgrade_5kaa.htm">DoPreUpgradeProcessing</A> functions </B><BR>
If the DLL runs in the GUI mode phase, it must export the <A HREF="upgrade_769e.htm"><B>PostUpgradeInitialize</B></A> and <A HREF="upgrade_1b02.htm"><B>DoPostUpgradeProcessing</B></A> functions, as well.</LI>

	<LI><B>Make no irreversible changes during the Winnt32 phase</B><BR>
The DLL must not make any irreversible changes, such as deleting files or modifying registry keys, during this phase because a user can cancel the upgrade of a network component or the operating system. The DLL can, however, modify files in its temporary working directory, which is specified by NetSetup in the call to <B>PreUpgradeInitialize</B>.</LI>
</UL>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Writing%20a%20Network%20Migration%20DLL"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
