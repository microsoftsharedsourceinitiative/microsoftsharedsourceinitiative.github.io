<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>REMOTE_NDIS_QUERY_MSG</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="REMOTE_NDIS_QUERY_MSG">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Network&nbsp;Devices&nbsp;and&nbsp;Protocols:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_remote_ndis_query_msg_nr"></A>REMOTE_NDIS_QUERY_MSG</H1>

<P>This message is sent to a Remote NDIS device from a host when it needs to query the device for its characteristics, statistics information, or status. The parameter or statistics counter being queried for is identified by means of an NDIS Object Identifier (OID).  The host may send REMOTE_NDIS_QUERY_MSG to the device through the control channel at any time that the device is in either the rndis-initialized or rndis-data-initialized state. The Remote NDIS device will respond to this message by sending a REMOTE_NDIS_QUERY_CMPLT to the host.</P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=12%>Offset</TH>
<TH align=left width=15%>Size</TH>
<TH align=left width=36%>Field</TH>
<TH align=left width=37%>Description</TH>
</TR>

<TR VALIGN="top">
<TD width=12%>0</TD>
<TD width=15%>4</TD>
<TD width=36%>MessageType</TD>
<TD width=37%>Specifies the type of message being sent. Set to 0x00000004.</TD>
</TR>

<TR VALIGN="top">
<TD width=12%>4</TD>
<TD width=15%>4</TD>
<TD width=36%>MessageLength</TD>
<TD width=37%>Specifies, in bytes, the total length of this message, from the beginning of the message.</TD>
</TR>

<TR VALIGN="top">
<TD width=12%>8</TD>
<TD width=15%>4</TD>
<TD width=36%>RequestId</TD>
<TD width=37%>Specifies the Remote NDIS message ID value. This value is used to match messages sent by the host with device responses.</TD>
</TR>

<TR VALIGN="top">
<TD width=12%>12</TD>
<TD width=15%>4</TD>
<TD width=36%>Oid</TD>
<TD width=37%>Specifies the NDIS OID that identifies the parameter being queried.</TD>
</TR>

<TR VALIGN="top">
<TD width=12%>16</TD>
<TD width=15%>4</TD>
<TD width=36%>InformationBufferLength</TD>
<TD width=37%>Specifies, in bytes, the length of the input data for the query. Set to zero when there is no OID input buffer.</TD>
</TR>

<TR VALIGN="top">
<TD width=12%>20</TD>
<TD width=15%>4</TD>
<TD width=36%>InformationBufferOffset</TD>
<TD width=37%>Specifies the byte offset, from the beginning of the <I>RequestId</I> field, at which input data for the query is located. Set to zero if there is no OID input buffer.</TD>
</TR>

<TR VALIGN="top">
<TD width=12%>24</TD>
<TD width=15%>4</TD>
<TD width=36%>DeviceVcHandle</TD>
<TD width=37%>Reserved for connection-oriented devices. Set to zero.</TD>
</TR>
</TABLE><BR>

<H4>Headers</H4>

<P>Defined in <I>rndis.h</I>. Include <I>rndis.h</I>.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: REMOTE_NDIS_QUERY_MSG"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
