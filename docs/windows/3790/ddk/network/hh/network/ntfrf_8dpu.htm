<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>INetCfgLock::IsWriteLocked</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="INetCfgLock::IsWriteLocked">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Network&nbsp;Devices&nbsp;and&nbsp;Protocols:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_inetcfglock_iswritelocked_nr"></A>INetCfgLock::IsWriteLocked</H1>

<P>The <B>IsWriteLocked</B> method indicates whether network configuration is currently locked and, when it is, returns the name of the client that currently controls network configuration.</P>

<PRE class=syntax><B>HRESULT
  IsWriteLocked(</B>
    <B>OUT LPWSTR  *</B><I>ppszwClientDescription  </I>
    <B>);</B></PRE>

<H4>Parameters</H4>

<DL>
<DT><I>ppszwClientDescription</I></DT>

<DD>Pointer to a buffer that receives a constant null-terminated string of 16-bit Unicode characters. If the operating system previously granted the lock on network configuration, this parameter points to the name of the client that currently controls network configuration. If the operating system has not granted the lock on network configuration, this parameter points to a NULL value.
</DD>
</DL>

<H4>Return Value</H4>

<P>Returns zero (S_OK) if successful, indicating that the operating system granted the lock to another client, and returns S_FALSE if the operating system has not granted the lock to any clients. Otherwise, returns NETCFG_* codes that are defined in <I>Netcfgx.h</I>.</P>

<H4>Headers</H4>

<P>Defined in <I>Netcfgx.h</I>. Include <I>Netcfgx.h</I>.</P>

<H4>Comments</H4>

<P>If a call to <B>IsWriteLocked</B> returns the name of the client that already has control of network configuration at <I>ppszwClientDescription</I>, <B>IsWriteLocked</B> allocates the memory required to store the string that contains the name. After applications finish with the name, they must call the COM <B>CoTaskMemFree</B> function to release the memory. For more information on <B>CoTaskMemFree</B>, see the Platform SDK.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: INetCfgLock::IsWriteLocked"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
