<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Mapping PTP Associations to WIA Folders</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Mapping PTP Associations to WIA Folders">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Still&nbsp;Image&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="ddk_mapping_ptp_associations_to_wia_folders_si"></A>Mapping PTP Associations to WIA Folders</H3>

<P>For most object associations, the PTP driver creates a WIA folder item. The WIA_IPA_ITEM_FLAGS property has different flags set, depending on the association type, as shown in this table:</P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=31%>PTP Association Code</TH>
<TH align=left width=34%>Association Type</TH>
<TH align=left width=35%>WIA Item Type Flags<BR>
(described in the Platform SDK documentation)</TH>
</TR>

<TR VALIGN="top">
<TD width=31%>0x0000</TD>
<TD width=34%>Undefined</TD>
<TD width=35%>WiaItemTypeFolder</TD>
</TR>

<TR VALIGN="top">
<TD width=31%>0x0001</TD>
<TD width=34%>GenericFolder</TD>
<TD width=35%>WiaItemTypeFolder</TD>
</TR>

<TR VALIGN="top">
<TD width=31%>0x0002</TD>
<TD width=34%>Album</TD>
<TD width=35%>WiaItemTypeFolder</TD>
</TR>

<TR VALIGN="top">
<TD width=31%>0x0003</TD>
<TD width=34%>TimeSequence</TD>
<TD width=35%>WiaItemTypeFolder | WiaItemTypeBurst</TD>
</TR>

<TR VALIGN="top">
<TD width=31%>0x0004</TD>
<TD width=34%>HorizontalPanoramic</TD>
<TD width=35%>WiaItemTypeFolder | WiaItemTypeHPanorama</TD>
</TR>

<TR VALIGN="top">
<TD width=31%>0x0005</TD>
<TD width=34%>VerticalPanoramic</TD>
<TD width=35%>WiaItemTypeFolder | WiaItemTypeVPanorama</TD>
</TR>

<TR VALIGN="top">
<TD width=31%>0x0006</TD>
<TD width=34%>2DPanoramic</TD>
<TD width=35%>WiaItemTypeFolder</TD>
</TR>

<TR VALIGN="top">
<TD width=31%>0x0007</TD>
<TD width=34%>AncillaryData</TD>
<TD width=35%>See accompanying text.</TD>
</TR>
</TABLE><BR>

<P>The <B>SequenceNumber</B> field of the ObjectInfo dataset is put into the WIA_IPC_SEQUENCE property. The WIA_IPC_XCOORDINATE and WIA_IPC_YCOORDINATE properties are not currently used by the PTP driver. The <B>AssociationDesc</B> member of the ObjectInfo dataset is currently not used.</P>

<P>The following diagram shows an example AncillaryData association as stored on the camera. This association consists of an image together with associated audio and text. </P>

<P><IMG SRC="images/ptp.gif" ALT="" BORDER=0></P>

<P><B>PTP Tree for an Image with Ancillary Data</B></P>

<P>When an AncillaryData association is mapped to a WIA folder, the non-image objects become children of the image object, as shown in the following diagram. The image object has the WiaItemTypeHasAttachments flag set in WIA_IPA_ITEM_FLAGS.</P>

<P><IMG SRC="images/wiaattch.gif" ALT="" BORDER=0></P>

<P><B>WIA Item with Attachments</B></P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Mapping%20PTP%20Associations%20to%20WIA%20Folders"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
