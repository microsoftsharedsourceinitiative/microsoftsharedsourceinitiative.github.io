<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>IWiaMiniDrv COM Interface</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="IWiaMiniDrv COM Interface">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Still&nbsp;Image&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="ddk_iwiaminidrv_com_interface_si"></A>IWiaMiniDrv COM Interface</H2>

<P>Imaging applications make requests to the WIA service, which in turn communicates with the device minidriver through the minidriver writer-implemented <A HREF="minidrv_9961.htm"><B>IWiaMiniDrv</B> interface</A>. Applications typically make requests to:</P>

<P class=indent1><A HREF="#ddk_creating_and_initializing_items_si">Create the item tree</A>.</P>

<P class=indent1><A HREF="#ddk_deleting_items_si">Delete an item in a device tree</A>.</P>

<P class=indent1><A HREF="#ddk_enumerating_device_capabilities_si">Enumerate device capabilities</A>.</P>

<P class=indent1><A HREF="#ddk_enumerating_image_formats_si">Enumerate device image formats</A>.</P>

<P class=indent1><A HREF="#ddk_issuing_device_commands_si">Issue device commands</A>.</P>

<P class=indent1><A HREF="#ddk_locking_and_unlocking_a_device_si">Lock or unlock a device</A>.</P>

<P class=indent1><A HREF="#ddk_notifying_a_device_of_an_event_si">Notify a device of an event</A>.</P>

<P class=indent1><A HREF="#ddk_obtaining_device_error_strings_si">Obtain device error strings</A>.</P>

<P class=indent1><A HREF="#ddk_reading_and_storing_item_properties_si">Read or write item properties</A>.</P>

<P class=indent1><A HREF="#ddk_transferring_data_si">Transfer data from an imaging device</A>.</P>

<P>Applications make requests to the WIA service through the WIA API. See the Platform SDK documentation for more information on this interface.</P>

<P>The <B>IWiaMiniDrv</B> interface provides the entry points shown in the following tables for the WIA service to control the device. A WIA minidriver must implement every <B>IWiaMiniDrv</B> method. These entry points are defined through the following <B>IWiaMiniDrv</B> methods.</P>



<H4><A NAME="ddk_creating_and_initializing_items_si"></A>Creating and Initializing Items</H4>

<TABLE>

<TR VALIGN="top">
<TH align=left width=53%>Method</TH>
<TH align=left width=47%>Description</TH>
</TR>

<TR VALIGN="top">
<TD width=53%><A HREF="minidrv_9p2h.htm"><B>IWiaMiniDrv::drvAnalyzeItem</B></A> </TD>
<TD width=47%>Inspects an item and, if necessary, creates subitems.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%><A HREF="minidrv_4mg9.htm"><B>IWiaMiniDrv::drvInitializeWia</B></A></TD>
<TD width=47%>Initializes the WIA minidriver.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%><A HREF="minidrv_3dex.htm"><B>IWiaMiniDrv::drvInitItemProperties</B></A></TD>
<TD width=47%>Initializes driver item properties for each item in an application item tree.</TD>
</TR>
</TABLE><BR>



<H4><A NAME="ddk_deleting_items_si"></A>Deleting Items</H4>

<TABLE>

<TR VALIGN="top">
<TH align=left width=53%>Method</TH>
<TH align=left width=47%>Description</TH>
</TR>

<TR VALIGN="top">
<TD width=53%><A HREF="minidrv_4f55.htm"><B>IWiaMiniDrv::drvDeleteItem</B></A></TD>
<TD width=47%>Deletes a driver item.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%><A HREF="minidrv_7kq1.htm"><B>IWiaMiniDrv::drvFreeDrvItemContext</B></A></TD>
<TD width=47%>Frees a device-specific context.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%><A HREF="minidrv_0azt.htm"><B>IWiaMiniDrv::drvUnInitializeWia</B></A></TD>
<TD width=47%>Releases device resources associated with an application item tree.</TD>
</TR>
</TABLE><BR>



<H4><A NAME="ddk_enumerating_device_capabilities_si"></A>Enumerating Device Capabilities</H4>

<TABLE>

<TR VALIGN="top">
<TH align=left width=53%>Method</TH>
<TH align=left width=47%>Description</TH>
</TR>

<TR VALIGN="top">
<TD width=53%><A HREF="minidrv_3ctl.htm"><B>IWiaMiniDrv::drvGetCapabilities</B></A></TD>
<TD width=47%>Reports the events and commands supported by a WIA minidriver.</TD>
</TR>
</TABLE><BR>



<H4><A NAME="ddk_enumerating_image_formats_si"></A>Enumerating Image Formats</H4>

<TABLE>

<TR VALIGN="top">
<TH align=left width=53%>Method</TH>
<TH align=left width=47%>Description</TH>
</TR>

<TR VALIGN="top">
<TD width=53%><A HREF="minidrv_23ah.htm"><B>IWiaMiniDrv::drvGetWiaFormatInfo</B></A></TD>
<TD width=47%>Gets supported device formats and media types.</TD>
</TR>
</TABLE><BR>



<H4><A NAME="ddk_issuing_device_commands_si"></A>Issuing Device Commands</H4>

<TABLE>

<TR VALIGN="top">
<TH align=left width=53%>Method</TH>
<TH align=left width=47%>Description</TH>
</TR>

<TR VALIGN="top">
<TD width=53%><A HREF="minidrv_5549.htm"><B>IWiaMiniDrv::drvDeviceCommand</B></A></TD>
<TD width=47%>Issues a command to an imaging device.</TD>
</TR>
</TABLE><BR>



<H4><A NAME="ddk_locking_and_unlocking_a_device_si"></A>Locking and Unlocking a Device</H4>

<TABLE>

<TR VALIGN="top">
<TH align=left width=53%>Method</TH>
<TH align=left width=47%>Description</TH>
</TR>

<TR VALIGN="top">
<TD width=53%><A HREF="minidrv_2gbt.htm"><B>IWiaMiniDrv::drvLockWiaDevice</B></A></TD>
<TD width=47%>Locks access to an imaging device.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%> <A HREF="minidrv_84vd.htm"><B>IWiaMiniDrv::drvUnLockWiaDevice</B></A></TD>
<TD width=47%>Unlocks access to an imaging device.</TD>
</TR>
</TABLE><BR>



<H4><A NAME="ddk_notifying_a_device_of_an_event_si"></A>Notifying a Device of an Event</H4>

<TABLE>

<TR VALIGN="top">
<TH align=left width=53%>Method</TH>
<TH align=left width=47%>Description</TH>
</TR>

<TR VALIGN="top">
<TD width=53%><A HREF="minidrv_41ex.htm"><B>IWiaMiniDrv::drvNotifyPnpEvent</B></A></TD>
<TD width=47%>Indicates a WIA minidriver’s response to a Plug and Play event.</TD>
</TR>
</TABLE><BR>



<H4><A NAME="ddk_obtaining_device_error_strings_si"></A>Obtaining Device Error Strings</H4>

<TABLE>

<TR VALIGN="top">
<TH align=left width=53%>Method</TH>
<TH align=left width=47%>Description</TH>
</TR>

<TR VALIGN="top">
<TD width=53%><A HREF="minidrv_0n8p.htm"><B>IWiaMiniDrv::drvGetDeviceErrorStr</B></A></TD>
<TD width=47%>Maps a device error value to a string.</TD>
</TR>
</TABLE><BR>



<H4><A NAME="ddk_reading_and_storing_item_properties_si"></A>Reading and Storing Item Properties</H4>

<TABLE>

<TR VALIGN="top">
<TH align=left width=53%>Method</TH>
<TH align=left width=47%>Description</TH>
</TR>

<TR VALIGN="top">
<TD width=53%><A HREF="minidrv_4co9.htm"><B>IWiaMiniDrv::drvReadItemProperties</B></A></TD>
<TD width=47%>Reads driver item properties.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%><A HREF="minidrv_3d0p.htm"><B>IWiaMiniDrv::drvValidateItemProperties</B></A></TD>
<TD width=47%>Validates driver item properties.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%><A HREF="minidrv_7quh.htm"><B>IWiaMiniDrv::drvWriteItemProperties</B></A></TD>
<TD width=47%>Writes driver item properties to the device (if needed).</TD>
</TR>
</TABLE><BR>



<H4><A NAME="ddk_transferring_data_si"></A>Transferring Data</H4>

<TABLE>

<TR VALIGN="top">
<TH align=left width=53%>Method</TH>
<TH align=left width=47%>Description</TH>
</TR>

<TR VALIGN="top">
<TD width=53%><A HREF="minidrv_1dpl.htm"><B>IWiaMiniDrv::drvAcquireItemData</B></A></TD>
<TD width=47%>Transfers data from a driver item to the WIA service.</TD>
</TR>
</TABLE><BR>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: IWiaMiniDrv%20COM%20Interface"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
