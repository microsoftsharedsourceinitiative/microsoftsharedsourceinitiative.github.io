<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Transferring Data to a WIA Application</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Transferring Data to a WIA Application">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Still&nbsp;Image&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_transferring_data_to_a_wia_application_si"></A>Transferring Data to a WIA Application</H1>

<P>When an application initiates a data transfer, the WIA service calls the <A HREF="minidrv_1dpl.htm"><B>IWiaMiniDrv::drvAcquireItemData</B></A> method to perform the transfer. This method is responsible for acquiring data from the device and sending that data back to the application using the <A HREF="callback_0hpl.htm"><B>IWiaMiniDrvCallback::MiniDrvCallback</B></A> method. </P>

<P>The WIA minidriver should be able to handle two types of data transfers: file and memory. To determine which type of transfer the application initiated, the minidriver should read the <A HREF="wia_proptable_4uy1.htm">WIA_IPA_TYMED</A> property value or check the <B>tymed</B> member of the <A HREF="wiastrct_8ckp.htm">MINIDRV_TRANSFER_CONTEXT</A> structure. (This is valid only if the WIA minidriver called the <A HREF="wiasfncs_34q1.htm"><B>wiasGetImageInformation</B></A> service function first.) The <B>wiasGetImageInformation</B> service function automatically reads the WIA_IPA_TYMED property and assigns the value to the <B>tymed</B> member of the MINIDRV_TRANSFER_CONTEXT structure.</P>

<P>The preferred way is for the WIA minidriver to read the WIA_IPA_TYMED property value. This guarantees that the minidriver is performing the proper type of acquisition.</P>

<P>This section covers the following topics:</P>

<P class=indent1><A HREF="wia_db_trans_4otl.htm">Understanding TYMED</A></P>

<P class=indent1><A HREF="wia_db_trans_9u3t.htm">Allocating Memory for Data</A></P>

<P class=indent1><A HREF="wia_db_trans_2ckp.htm">Canceling a Data Transfer</A></P>

<P class=indent1><A HREF="wia_db_trans_7fe1.htm">Canceling Pending I/O Operations</A></P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Transferring%20Data%20to%20a%20WIA%20Application"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
