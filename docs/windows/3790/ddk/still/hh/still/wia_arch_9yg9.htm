<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Property Contexts</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Property Contexts">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Still&nbsp;Image&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="ddk_property_contexts_si"></A>Property Contexts</H2>

<P>A property context provides a convenient way for a minidriver to identify a number of properties it is interested in during the validation of those properties. Using a property context, a minidriver can quickly determine whether any of the identified properties are being changed. The minidriver then passes the property context to one of the WIA service library functions (<A HREF="wiasfncs_9m7d.htm"><B>wiasGetChangedValueFloat</B></A>, for example), which uses the context to determine whether an application is changing a property's value. </P>

<P>The WIA approach to validation is that when an application changes a property, any dependent properties should also be updated. If, however, the application is also changing dependent properties, you can simply check the top-level property to determine whether its new value is valid. The WIA service library functions that are concerned with property validation use this principle to decide when they should update dependent properties, and when they should just check for validity.</P>

<P>Context for a set of properties is maintained in a <A HREF="wiastrct_6jzd.htm">WIA_PROPERTY_CONTEXT</A> structure, which contains three members: the number of properties in the property context, a pointer to an array of property identifiers (PROPIDs), and a pointer to an array of BOOL values. The arrays are maintained in parallel (that is, the property whose property identifier is at index <I>N</I> in the property identifier array is associated with the BOOL value at the same index in the BOOL array). </P>

<P>The minidriver calls the WIA service library function, <A HREF="wiasfncs_8hex.htm"><B>wiasCreatePropContext</B></A>, to allocate memory and fill in the values for a property context. Other WIA service library functions, such as <A HREF="wiasfncs_9m7d.htm"><B>wiasGetChangedValueFloat</B></A>, use a property context to determine when a property's values should be updated.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Property%20Contexts"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
