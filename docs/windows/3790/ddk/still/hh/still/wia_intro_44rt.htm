<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>WIA Core Components</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="WIA Core Components">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Still&nbsp;Image&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_wia_core_components_si"></A>WIA Core Components</H1>

<P>The WIA components for Windows®&nbsp;XP and Windows&nbsp;Me are shown in the following figure.</P>

<P><IMG SRC="images/stiwhist.gif" ALT="" BORDER=0></P>

<P><B>Windows XP/Windows Me Core Components</B></P>

<P>The WIA Service (<I>wiaservc.dll</I>) is hosted by a generic host called <I>svchost.exe</I> in Windows&nbsp;XP and <I>stimon.exe</I> in Windows&nbsp;Me. <I>Wiaservc.dll</I> communicates with one or more user-mode still image drivers (labeled USD1, USD2, and USD3 in the figure), each of which communicates with a particular type of kernel-mode driver. Windows&nbsp;XP and Windows&nbsp;Me provide three types of bus abstraction: USB, SCSI, and serial ( <I>usbscan.sys</I>, <I>scsiscan.sys</I>, and <I>serscan.sys</I>).</P>

<P>On the client side, an application can be either a TWAIN-compatible application (see <A HREF="wia_drv_scan_7h2h.htm">Support for TWAIN-Compatible Applications</A>) or a WIA application. A TWAIN application calls into the Data Source Manager, which in turn calls into <I>wiadss.dll</I>, a translation component that communicates with an instance of <I>sti.dll</I>. <I>Sti.dll</I> is a stub that communicates with the WIA service. In contrast, a WIA application makes calls directly to <I>sti.dll</I>. </P>

<P>Windows 98 and Windows 2000 do not support WIA. Their STI core components can be seen on <A HREF="stillimg_363t.htm">Windows 98 Core Components</A> and <A HREF="stillimg_2qzt.htm">Windows 2000 Core Components</A>.</P>

<P></P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: WIA%20Core%20Components"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
