<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>WIA Driver Services Library</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="WIA Driver Services Library">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Still&nbsp;Image&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="ddk_wia_driver_services_library_si"></A>WIA Driver Services Library</H2>

<P>The WIA driver services library contains functions that a WIA minidriver can call for assistance in performing the following tasks: </P>

<P class=indent1><A HREF="#ddk_building_and_maintaining_an_item_tree_si">Building and maintaining an item tree</A>.</P>

<P class=indent1><A HREF="#ddk_logging_error_and_trace_messages_si">Logging error and trace messages</A>.</P>

<P class=indent1><A HREF="#ddk_reading_and_storing_an_item_s_properties_si">Reading and storing an item's properties</A>.</P>

<P class=indent1><A HREF="#ddk_updating_and_transferring_data_si">Updating and transferring data</A>. </P>

<P>A WIA minidriver calls most of these functions from its <A HREF="minidrv_9961.htm"><B>IWiaMiniDrv</B> interface</A> methods as needed. Each WIA minidriver, however, must call the <A HREF="wiasfncs_49ex.htm"><B>wiasCreateDrvItem</B></A> function in the <A HREF="minidrv_4mg9.htm"><B>IWiaMiniDrv::drvInitializeWia</B></A> method to create driver items. Each successful call to a <B>wiasCreateDrvItem</B> function creates an <B>IWiaDrvItem</B> item object, which is used in the minidriver's item tree. Several <A HREF="drvitem_62ll.htm"><B>IWiaDrvItem</B> interface</A> methods have a parameter of type <B>IWiaDrvItem</B>, including the <A HREF="drvitem_06y1.htm"><B>IWiaDrvItem::AddItemToFolder</B></A>, <A HREF="drvitem_6drd.htm"><B>IWiaDrvItem::GetFirstChildItem</B></A>, <A HREF="drvitem_7ju1.htm"><B>IWiaDrvItem::GetNextSiblingItem</B></A>, and <A HREF="drvitem_1ns9.htm"><B>IWiaDrvItem::GetParentItem</B></A>. Also, the <A HREF="wiasfncs_9e7d.htm"><B>wiasGetDrvItem</B></A> function has a parameter of this type. </P>

<P>The driver services library provides the following functions: </P>



<H4><A NAME="ddk_building_and_maintaining_an_item_tree_si"></A>Building and Maintaining an Item Tree</H4>

<TABLE>

<TR VALIGN="top">
<TH align=left width=42%>Function</TH>
<TH align=left width=58%>Description</TH>
</TR>

<TR VALIGN="top">
<TD width=42%><A HREF="wiasfncs_8kkp.htm"><B>wiasCreateChildAppItem</B></A></TD>
<TD width=58%>Creates a new application item and inserts it as a child of the specified (parent) item.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><A HREF="wiasfncs_49ex.htm"><B>wiasCreateDrvItem</B></A></TD>
<TD width=58%>Creates an <B>IWiaDrvItem</B> object.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><A HREF="wiasfncs_5s4p.htm"><B>wiasGetChildrenContexts</B></A></TD>
<TD width=58%>Retrieves an array of item contexts belonging to the current item's children.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><A HREF="wiasfncs_5odl.htm"><B>wiasGetContextFromName</B></A> </TD>
<TD width=58%>Retrieves the item context for an item name.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><A HREF="wiasfncs_9e7d.htm"><B>wiasGetDrvItem</B></A></TD>
<TD width=58%>Retrieves a driver item.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><A HREF="wiasfncs_8xwp.htm"><B>wiasGetRootItem</B></A> </TD>
<TD width=58%>Retrieves the root item context of a specified WIA item.</TD>
</TR>
</TABLE><BR>



<H4><A NAME="ddk_logging_error_and_trace_messages_si"></A>Logging Error and Trace Messages</H4>

<TABLE>

<TR VALIGN="top">
<TH align=left width=48%>Function</TH>
<TH align=left width=52%>Description</TH>
</TR>

<TR VALIGN="top">
<TD width=48%><A HREF="wiasfncs_4i7d.htm"><B>wiasCreateLogInstance</B></A></TD>
<TD width=52%>Creates an instance of a logging object.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%><A HREF="wiasfncs_0wtl.htm"><B>wiasDebugError</B></A></TD>
<TD width=52%>Prints a debug error string in the device manager debug console. The output color is always red. This function is provided for compatibility only. Writers of new WIA drivers are encouraged to use <A HREF="iwialog_3wrt.htm"><B>WIAS_LERROR</B></A> instead.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%><A HREF="wiasfncs_7b1l.htm"><B>wiasDebugTrace</B></A></TD>
<TD width=52%>Prints a debug trace string in the device manager debug console. This function is provided for compatibility only. Writers of new WIA drivers are encouraged to use <A HREF="iwialog_0azt.htm"><B>WIAS_LTRACE</B></A> instead.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%><A HREF="wiasfncs_6tyh.htm"><B>wiasFormatArgs</B></A></TD>
<TD width=52%>Formats an argument list into a packaged string for logging.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%><A HREF="wiasfncs_64kp.htm"><B>wiasPrintDebugHResult</B></A></TD>
<TD width=52%>Prints an HRESULT string on the device manager debug console. This function is provided for compatibility only. Writers of new WIA drivers are encouraged to use <A HREF="iwialog_5xgp.htm"><B>WIAS_LHRESULT</B></A> instead.</TD>
</TR>
</TABLE><BR>



<H4><A NAME="ddk_reading_and_storing_an_item_s_properties_si"></A>Reading and Storing an Item's Properties</H4>

<TABLE>

<TR VALIGN="top">
<TH align=left width=42%>Function</TH>
<TH align=left width=58%>Description</TH>
</TR>

<TR VALIGN="top">
<TD width=42%><A HREF="wiasfncs_8hex.htm"><B>wiasCreatePropContext</B></A></TD>
<TD width=58%>Allocates a property context to indicate which of an item's properties are changing.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><A HREF="wiasfncs_4t9l.htm"><B>wiasFreePropContext</B></A></TD>
<TD width=58%>Releases the memory occupied by a WIA_PROPERTY_CONTEXT structure.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><A HREF="wiasfncs_9m7d.htm"><B>wiasGetChangedValueFloat</B></A></TD>
<TD width=58%>Determines whether a property with a floating point value has been changed by an application.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><A HREF="wiasfncs_55pl.htm"><B>wiasGetChangedValueGuid</B></A></TD>
<TD width=58%>Determines whether a property with a GUID value has been changed by an application.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><A HREF="wiasfncs_0ai1.htm"><B>wiasGetChangedValueLong</B></A></TD>
<TD width=58%>Determines whether a property with a long integer value has been changed by an application.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><A HREF="wiasfncs_5dbd.htm"><B>wiasGetChangedValueStr</B></A></TD>
<TD width=58%>Determines whether a property with a string value has been changed by an application.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><A HREF="wiasfncs_2815.htm"><B>wiasGetItemType</B></A></TD>
<TD width=58%>Indicates a root or child item.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><A HREF="wiasfncs_05rd.htm"><B>wiasGetPropertyAttributes</B></A> </TD>
<TD width=58%>Retrieves the access flags and valid values for a set of properties.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><A HREF="wiasfncs_290p.htm"><B>wiasIsPropChanged</B></A></TD>
<TD width=58%>Tests whether the specified property has been changed by an application.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><A HREF="wiasfncs_20bt.htm"><B>wiasReadMultiple</B></A></TD>
<TD width=58%>Reads multiple properties from a WIA item.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><A HREF="wiasfncs_8ld5.htm"><B>wiasReadPropBin</B></A></TD>
<TD width=58%>Reads a single binary property from a WIA item.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><A HREF="wiasfncs_8ca1.htm"><B>wiasReadPropFloat</B></A></TD>
<TD width=58%>Retrieves a floating point property value from a WIA item.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><A HREF="wiasfncs_0x49.htm"><B>wiasReadPropGuid</B></A></TD>
<TD width=58%>Retrieves a GUID property value from a WIA item.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><A HREF="wiasfncs_61wp.htm"><B>wiasReadPropLong</B></A></TD>
<TD width=58%>Retrieves a long integer property value from a WIA item.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><A HREF="wiasfncs_4u21.htm"><B>wiasReadPropStr</B></A></TD>
<TD width=58%>Retrieves a string property value from a WIA item.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><A HREF="wiasfncs_7odl.htm"><B>wiasSetItemPropAttribs</B></A></TD>
<TD width=58%>Sets the access flags and valid values for an item's set of properties.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><A HREF="wiasfncs_2qeh.htm"><B>wiasSetItemPropNames</B></A></TD>
<TD width=58%>Writes property names to item properties.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><A HREF="wiasfncs_5yjt.htm"><B>wiasSetPropChanged</B></A></TD>
<TD width=58%>Modifies a property context to indicate that a property is being changed.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><A HREF="wiasfncs_4zop.htm"><B>wiasSetPropertyAttributes</B></A> </TD>
<TD width=58%>Sets the access flags and property values of an item's properties.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><A HREF="wiasfncs_9jft.htm"><B>wiasSetValidFlag</B></A></TD>
<TD width=58%>Sets the valid values for a WIA_PROP_FLAG property.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><A HREF="wiasfncs_28tl.htm"><B>wiasSetValidListFloat</B></A></TD>
<TD width=58%>Sets the valid values for a WIA_PROP_LIST property of type sub-VT_R4.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><A HREF="wiasfncs_1rft.htm"><B>wiasSetValidListGuid</B></A></TD>
<TD width=58%>Sets the valid values for a WIA_PROP_LIST property of sub-type VT_CLSID.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><A HREF="wiasfncs_6w89.htm"><B>wiasSetValidListLong</B></A></TD>
<TD width=58%>Sets the valid values for a WIA_PROP_LIST property of type sub-VT_I4.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><A HREF="wiasfncs_7i5l.htm"><B>wiasSetValidListStr</B></A></TD>
<TD width=58%>Sets the valid values for a WIA_PROP_LIST property of type sub-VT_BSTR.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><A HREF="wiasfncs_7x9l.htm"><B>wiasSetValidRangeFloat</B></A></TD>
<TD width=58%>Specifies the range of valid values for a WIA_PROP_RANGE property of sub-type VT_R4.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><A HREF="wiasfncs_4so9.htm"><B>wiasSetValidRangeLong</B></A></TD>
<TD width=58%>Specifies the range of valid values for a WIA_PROP_RANGE property of sub-type VT_I4.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><A HREF="wiasfncs_6yll.htm"><B>wiasUpdateValidFormat</B></A></TD>
<TD width=58%>Updates the valid format of the property context for the current minidriver.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><A HREF="wiasfncs_5smh.htm"><B>wiasValidateItemProperties</B></A></TD>
<TD width=58%>Validates a list of simple item properties against their current valid values.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><A HREF="wiasfncs_64a1.htm"><B>wiasWriteMultiple</B></A></TD>
<TD width=58%>Writes multiple property values to a WIA item (the properties may be of different types).</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><A HREF="wiasfncs_3cfd.htm"><B>wiasWritePropBin</B></A></TD>
<TD width=58%>Writes a single binary property value to a WIA item.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><A HREF="wiasfncs_1d49.htm"><B>wiasWritePropFloat</B></A></TD>
<TD width=58%>Writes a floating point property value to a WIA item.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><A HREF="wiasfncs_512h.htm"><B>wiasWritePropGuid</B></A></TD>
<TD width=58%>Writes a GUID property value to a WIA item.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><A HREF="wiasfncs_05ux.htm"><B>wiasWritePropLong</B></A></TD>
<TD width=58%>Writes a long integer property value to a WIA item.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><A HREF="wiasfncs_9l49.htm"><B>wiasWritePropStr</B></A></TD>
<TD width=58%>Writes a string property value to a WIA item.</TD>
</TR>
</TABLE><BR>



<H4><A NAME="ddk_updating_and_transferring_data_si"></A>Updating and Transferring Data</H4>

<TABLE>

<TR VALIGN="top">
<TH align=left width=42%>Function</TH>
<TH align=left width=58%>Description</TH>
</TR>

<TR VALIGN="top">
<TD width=42%><A HREF="wiasfncs_3usp.htm"><B>wiasDownSampleBuffer</B></A></TD>
<TD width=58%>Takes in a buffer of pixel data and downsamples it to the specified size.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><A HREF="wiasfncs_34q1.htm"><B>wiasGetImageInformation</B></A></TD>
<TD width=58%>Retrieves transfer context information from an item.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><A HREF="wiasfncs_6uuh.htm"><B>wiasParseEndorserString</B></A></TD>
<TD width=58%>Parses an endorser string, replacing WIA service-defined and vendor-defined tokens in the string with values associated with the tokens.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><A HREF="wiasfncs_4ch5.htm"><B>wiasSendEndOfPage</B></A></TD>
<TD width=58%>Calls the client callback routine during a data transfer, sending the current total page count.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><A HREF="wiasfncs_9dm1.htm"><B>wiasUpdateScanRect</B></A></TD>
<TD width=58%>Updates the scanning area sizes of the scanning device.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><A HREF="wiasfncs_1ovd.htm"><B>wiasWriteBufToFile</B></A></TD>
<TD width=58%>Writes the contents of a temporary page buffer to an image file.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><A HREF="wiasfncs_77hl.htm"><B>wiasWritePageBufToFile</B></A></TD>
<TD width=58%>Writes the contents of a temporary page buffer to an image file. Use this function to write a page to a multipage TIFF file.</TD>
</TR>
</TABLE><BR>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: WIA%20Driver%20Services%20Library"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
