<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Registry Entries for Still Image Devices</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Registry Entries for Still Image Devices">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Still&nbsp;Image&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="ddk_registry_entries_for_still_image_devices_si"></A>Registry Entries for Still Image Devices</H2>

<P>Microsoft STI makes use of several registry entries, some of which can be modified by vendor-supplied components.</P>



<H4><A NAME="ddk_vendor_modifiable_registry_values_si"></A>Vendor-Modifiable Registry Values</H4>

<P>The following table lists predefined registry value names and their meanings. Constants are defined in <I>stireg.h</I>. A value must be assigned to "TwainDS" if the device supports the Still Image <A HREF="stillimg_4x49.htm">push model</A>. Values for the other names are optional.</P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=21%>Constant</TH>
<TH align=left width=31%>Value Name String</TH>
<TH align=left width=48%>Definition</TH>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%>STI_DEVICE_VALUE_ICM_PROFILE</TD>
</TR>

<TR VALIGN="top">
<TD width=21%>&nbsp;</TD>
<TD width=31%>"ICMProfile"</TD>
<TD width=48%>REG_MULTI_SZ type containing names of ICM profiles for the device.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%>STI_DEVICE_VALUE_ISIS_NAME</TD>
</TR>

<TR VALIGN="top">
<TD width=21%>&nbsp;</TD>
<TD width=31%>"ISISDriverName"</TD>
<TD width=48%>REG_SZ type containing the device's ISIS driver name, such as "epson.pwx".</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%>STI_DEVICE_VALUE_TIMEOUT</TD>
</TR>

<TR VALIGN="top">
<TD width=21%>&nbsp;</TD>
<TD width=31%>"PollTimeout"</TD>
<TD width=48%>REG_DWORD type representing the time-out value, in milliseconds, that should be used when polling the device. The default value is 1000 (1 second).</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%>STI_DEVICE_VALUE_TWAIN_NAME</TD>
</TR>

<TR VALIGN="top">
<TD width=21%>&nbsp;</TD>
<TD width=31%>"TwainDS"</TD>
<TD width=48%>REG_SZ type containing the displayable name of the device's TWAIN data source, such as "HP PictureScan 3.0".</TD>
</TR>
</TABLE><BR>

<P>Clients of the <B>StillImage</B> COM interface should call <A HREF="stifnc_1icp.htm"><B>IStillImage::SetDeviceValue</B></A> and <A HREF="stifnc_1xrd.htm"><B>IStillImage::GetDeviceValue</B></A> to reference the registry. Still Image minidrivers can call the Win32® registry API, specifying the registry key received by the minidriver's <A HREF="stifnc_0lrd.htm"><B>IStiUSD::Initialize</B></A> method. Values for predefined registry entries can also be set from within <A HREF="stillimg_8qax.htm">INF files for still image devices</A>.</P>

<H4>Customized Registry Values</H4>

<P>Still image applications and minidrivers can also store customized, device-specific values in the registry. For example, user selections obtained from customized property sheet pages could be stored under a "UserSettings" subkey.</P>

<P>Additionally, values for customized registry entries can be set from within <A HREF="stillimg_8qax.htm">INF files for still image devices</A> by including a <B>DeviceData</B> entry.</P>



<H4><A NAME="ddk_non_modifiable_registry_entries_si"></A>Nonmodifiable Registry Entries</H4>

<P>The following table lists registry entries that should not be modified by vendor software.</P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=32%>Registry Key</TH>
<TH align=left width=68%>Definition</TH>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><B>HKLM\SYSTEM\CurrentControlSet\Control\StillImage\Logging\STICLI</B></TD>
</TR>

<TR VALIGN="top">
<TD width=32%>&nbsp;</TD>
<TD width=68%>Specifies which vendor-generated messages are written to the still image log file. Can be any combination of the following bit masks:
<P>0x1&nbsp;&nbsp;&nbsp;&nbsp;informational messages<BR>
0x2&nbsp;&nbsp;&nbsp;&nbsp;warning messages<BR>
0x4&nbsp;&nbsp;&nbsp;&nbsp;error messages</P>

<P>See <A HREF="stifnc_5dex.htm"><B>IStillImage::WriteToErrorLog</B></A>.</P>
</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><B>HKLM\SYSTEM\CurrentControlSet\Control\StillImage\Logging\STIMON</B></TD>
</TR>

<TR VALIGN="top">
<TD width=32%>&nbsp;</TD>
<TD width=68%>Specifies which Event Monitor messages are written to the still image log file. Can be any combination of the following bit masks:
<P>0x1&nbsp;&nbsp;&nbsp;&nbsp;informational messages<BR>
0x2&nbsp;&nbsp;&nbsp;&nbsp;warning messages<BR>
0x4&nbsp;&nbsp;&nbsp;&nbsp;error messages</P>
</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><B>HKLM\SYSTEM\CurrentControlSet\Control\Class\{6BDD1FC6-810F-11D0-BEC7-08002BE2092F}</B></TD>
</TR>

<TR VALIGN="top">
<TD width=32%>&nbsp;</TD>
<TD width=68%>Contains information about installed still image devices.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><B>HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\StillImage\Registered Applications</B></TD>
</TR>

<TR VALIGN="top">
<TD width=32%>&nbsp;</TD>
<TD width=68%>Contains a list of registered imaging applications.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><B>HKLM\SYSTEM\CurrentControlSet\Control\DeviceClass\{6bdd1fc6-810f-11d0-bec7-08002be2092f}</B></TD>
</TR>

<TR VALIGN="top">
<TD width=32%>&nbsp;</TD>
<TD width=68%>Contains information about installed still image device interfaces.</TD>
</TR>
</TABLE><BR>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Registry%20Entries%20for%20Still%20Image%20Devices"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
