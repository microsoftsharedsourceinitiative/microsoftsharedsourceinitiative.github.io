<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Windows 98 Core Components</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Windows 98 Core Components">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Still&nbsp;Image&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="ddk_windows_98_core_components_si"></A>Windows 98 Core Components</H2>

<P>On Windows 98, the Still Image core components are as shown in the following figure.</P>

<P><IMG SRC="images/stiwin98.gif" ALT="" BORDER=0></P>

<P><B>Windows 98 Core Components</B></P>

<P>On the server side, three core components communicate with <I>sti.dll</I>: <I>stimon.exe</I>, <I>sti_ci.dll</I>, and <I>sticpl.cpl</I>. These components are, respectively, the still image event monitor, the class installer, and the Scanners and Cameras Control Panel application. <I>Sti_ci.dll</I> is invoked only when a new still image device is installed or removed, and <I>sticpl.cpl</I> is invoked only to do configuration chores.</P>

<P><I>Stimon.exe</I> processes events and communicates with <I>sti.dll</I>, which in turn communicates with one or more user-mode still image drivers (USDs), which are labeled USD1, USD2, and USD3 on the left side of this figure. Each of the user-mode drivers communicates with one type of kernel-mode driver, depending on the device's bus connection. For a USB device, the user-mode still image driver communicates with <I>usbscn9x.sys</I> for composite usb devices and <I>usbscan.sys </I>for noncomposite usb devices; for a SCSI device, the user-mode driver communicates with both <I>scsiscan.sys</I> and <I>scsimap.sys</I>.</P>

<P>On the client application side, an IHV must supply a TWAIN data source, which is shown in the preceding figure as <I>vendor.ds</I>, a generic name for this component. The TWAIN data source is a component of the TWAIN Scanning architecture, and communicates with an instance of <I>sti.dll</I> on the client side. In turn, <I>sti.dll</I> communicates with a user-mode still image driver (USD1 in the figure), which communicates with one of the kernel-mode drivers discussed earlier.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Windows%2098%20Core%20Components"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
