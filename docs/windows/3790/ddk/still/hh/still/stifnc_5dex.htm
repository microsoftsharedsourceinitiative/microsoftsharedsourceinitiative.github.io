<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>IStillImage::WriteToErrorLog</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="IStillImage::WriteToErrorLog">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Still&nbsp;Image&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_istillimage_writetoerrorlog_si"></A>IStillImage::WriteToErrorLog</H1>

<P>The <B>IStillImage::WriteToErrorLog </B>method writes a message to the Still Image error log.</P>

<PRE class=syntax><B>HRESULT
  WriteToErrorLog(</B>
    <B>DWORD</B>  <I>dwMessageType</I><B>,</B>
    <B>LPCWSTR</B>  <I>pszMessage</I>
    <B>);</B></PRE>

<H4>Parameters</H4>

<DL>
<DT><I>dwMessageType</I></DT>

<DD>Caller-supplied constant value representing the message type. The following values are defined in <I>sti.h</I>:

<P>STI_TRACE_INFORMATION<BR>
STI_TRACE_WARNING<BR>
STI_TRACE_ERROR
</DD>

<DT><I>pszMessage</I></DT>

<DD>Caller-supplied pointer to the message string to be written to the log file.
</DD>
</DL>

<H4>Return Value</H4>

<P>If the operation succeeds, the method returns S_OK. Otherwise, it returns one of the STIERR-prefixed error codes defined in <I>stierr.h</I>.</P>

<H4>Headers</H4>

<P>Declared in <I>sti.h</I>. Include <I>sti.h</I>.</P>

<H4>Comments</H4>

<P>The Still Image error log file is named <I>sti_trace.log</I> and is located in the Windows directory. Registry values determine which still image error types (informational, warning, or error) are written to the error log (see <A HREF="stillimg_8pih.htm#ddk_non_modifiable_registry_entries_si">Non-Modifiable Registry Entries</A>).</P>

<P>Error messages should be reserved for critical error conditions, such as device hardware failures. Informational messages can be used for your own debugging purposes. Logged messages aren't visible to users, but they might be used by a support engineer to help debug a user's problems.</P>

<P>Before calling <B>IStillImage::WriteToErrorLog</B>, clients of the <B>IStillImage</B> COM interface must call <A HREF="stifnc_6otl.htm"><B>IStillImage::StiCreateInstance</B></A> to obtain an <B>IStillImage</B> interface pointer.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: IStillImage::WriteToErrorLog"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
