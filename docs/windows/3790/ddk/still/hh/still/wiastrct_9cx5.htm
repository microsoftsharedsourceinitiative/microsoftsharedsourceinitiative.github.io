<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>TWAIN_CAPABILITY</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="TWAIN_CAPABILITY">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Still&nbsp;Image&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_twain_capability_si"></A>TWAIN_CAPABILITY</H1>

<P>The TWAIN_CAPABILITY structure holds information used when a TWAIN-compatible application communicates with a WIA driver.</P>

<PRE class=syntax>typedef struct _TWAIN_CAPABILITY {
  LONG  lSize;
  LONG  lMSG;
  LONG  lCapID;
  LONG  lConType;
  LONG  lRC;
  LONG  lCC;
  LONG  lDataSize;
  BYTE  Data[1];
} TWAIN_CAPABILITY,*PTWAIN_CAPABILITY;</PRE>

<H4>Members</H4>

<DL>
<DT><B>lSize</B></DT>

<DD>Specifies the size, in bytes, of the TWAIN_CAPABILITY structure.</DD>

<DT><B>lMSG</B></DT>

<DD>Specifies the particular TWAIN message, which can be one of the following values: 

<TABLE>

<TR VALIGN="top">
<TH align=left width=48%>Value</TH>
<TH align=left width=52%>Meaning</TH>
</TR>

<TR VALIGN="top">
<TD width=48%>MSG_GET</TD>
<TD width=52%>Get a capability.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>MSG_GETCURRENT</TD>
<TD width=52%>Get the current capability.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>MSG_GETDEFAULT</TD>
<TD width=52%>Get the default capability.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>MSG_RESET</TD>
<TD width=52%>Reset the capability.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>MSG_SET</TD>
<TD width=52%>Set a capability.</TD>
</TR>
</TABLE><BR>

</DD>

<DT><B>lCapID</B></DT>

<DD>Specifies the ID of the capability to set or get.</DD>

<DT><B>lConType</B></DT>

<DD>Specifies the capability's container type.</DD>

<DT><B>lRC</B></DT>

<DD>Specifies the TWAIN return code. This value can be on of the following:

<TABLE>

<TR VALIGN="top">
<TH align=left width=48%>Value</TH>
<TH align=left width=52%>Meaning</TH>
</TR>

<TR VALIGN="top">
<TD width=48%>TWRC_FAILURE</TD>
<TD width=52%>The capability specified by the <B>lCapID</B> member is not supported.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>TWRC_SUCCESS</TD>
<TD width=52%>The capability specified by the <B>lCapID</B> member is supported.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>Other TWRC_XXX return code</TD>
<TD width=52%>See the <B>Comments</B> section.</TD>
</TR>
</TABLE><BR>

</DD>

<DT><B>lCC</B></DT>

<DD>Specifies the TWAIN condition code. This value can be one of the following:

<TABLE>

<TR VALIGN="top">
<TH align=left width=48%>Value</TH>
<TH align=left width=52%>Meaning</TH>
</TR>

<TR VALIGN="top">
<TD width=48%>TWCC_BUMMER</TD>
<TD width=52%>The operation failed for an unknown reason.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>TWCC_SUCCESS</TD>
<TD width=52%>The operation was successful.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>TWCC_XXX</TD>
<TD width=52%>See the <B>Comments</B> section.</TD>
</TR>
</TABLE><BR>

</DD>

<DT><B>lDataSize</B></DT>

<DD>Specifies the size, in bytes of the data in the <B>Data</B> array.</DD>

<DT><B>Data</B></DT>

<DD>Is an array that contains the capability data. The actual size, in bytes, of the array is indicated by the <B>lDataSize</B> member.
</DD>
</DL>

<H4>Headers</H4>

<P>Declared in <I>wiatwcmp.h</I>. Include <I>wiatwcmp.h</I>.</P>

<H4>Comments</H4>

<P>A TWAIN-capable application communicates with a WIA driver by way of the TWAIN compatibility later to find out whether the driver has any private capabilities, and if so, what they are. A TWAIN_CAPABILITY structure is used in this communication. For more information, see <A HREF="wia_drv_scan_7h2h.htm">Support for TWAIN-Compatible Applications</A>. </P>

<P>The TWAIN return codes and control codes are defined in <I>twain.h</I>, which can be obtained from the TWAIN Working Group (http://www.twain.org).</P>

<P>This structure is available in Windows&nbsp;Me and in Windows&nbsp;XP and later.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: TWAIN_CAPABILITY"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
