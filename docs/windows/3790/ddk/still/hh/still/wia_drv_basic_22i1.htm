<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Defining Custom Properties</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Defining Custom Properties">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Still&nbsp;Image&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="ddk_defining_custom_properties_si"></A>Defining Custom Properties</H3>

<P></P>

<P>If it is necessary for the WIA minidriver to define custom properties, the WIA_PRIVATE_DEVPROP property should be used for custom root item properties, and the WIA_PRIVATE_ITEMPROP property should be used for other item properties. These constants are defined in <I>wiadef.h</I>.</P>

<P>The following example code shows definitions for three root item properties. The property ID for the first custom root item property, CUSTOM_ROOT_PROP_1, is defined in terms of WIA_PRIVATE_DEVPROP. Property IDs for additional root item properties are defined in terms of WIA_PRIVATE_DEVPROP + 1, WIA_PRIVATE_DEVPROP + 2, and so on. The pattern can be continued if additional custom root item properties are needed.</P>

<PRE>#define CUSTOM_ROOT_PROP_1 WIA_PRIVATE_DEVPROP
#define CUSTOM_ROOT_PROP_2 (WIA_PRIVATE_DEVPROP + 1) 
#define CUSTOM_ROOT_PROP_3 (WIA_PRIVATE_DEVPROP + 2) 
</PRE>

<P>The next example shows definitions for three custom child item properties and property IDs. The property ID for the first custom child item property, CUSTOM_CHILD_PROP_1, is defined in terms of WIA_PRIVATE_ITEMPROP. Property IDs for additional child item properties are defined in terms of WIA_PRIVATE_ITEMPROP + 1, and so on. As before, the pattern can be continued if more of these custom child item properties are needed.</P>

<PRE>#define CUSTOM_CHILD_PROP_1 WIA_PRIVATE_ITEMPROP
#define CUSTOM_CHILD_PROP_2 (WIA_PRIVATE_ITEMPROP + 1) 
#define CUSTOM_CHILD_PROP_3 (WIA_PRIVATE_ITEMPROP + 2)
</PRE>

<P>Custom WIA properties must have custom property names that are associated with the custom property IDs. The following example code shows definitions for three custom root item property names. (These property names are used with the custom property IDs that were created in a previous example, where the custom property name contained in CUSTOM_ROOT_PROP_1_STR is associated with the custom root item property ID CUSTOM_ROOT_PROP_1.)</P>

<PRE>#define CUSTOM_ROOT_PROP_1_STR L"My First Custom Root Item Property"
#define CUSTOM_ROOT_PROP_2_STR L"My Second Custom Root Item Property"
#define CUSTOM_ROOT_PROP_3_STR L"My Third Custom Root Item Property"
</PRE>

<P class=note><B>Note</B>&nbsp;&nbsp;WIA property names are <I>not</I> localized in multiple languages. This is because WIA properties can be read by applications using the property ID or the property name. If the name is used, it must be a constant, just as the property ID is.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Defining%20Custom%20Properties"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
