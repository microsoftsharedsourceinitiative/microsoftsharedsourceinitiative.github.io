<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>VoiceProfile</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="VoiceProfile">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Modem&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_voiceprofile_mr"></A>VoiceProfile</H1>

<P>The <B>VoiceProfile</B> entry is used by Unimodem to determine the voice modem capabilities of a modem.</P>

<H4>Format</H4>

<P>A single command string of type DWORD.</P>

<H4>Samples</H4>

<P>The following are examples of this entry:</P>

<PRE>    HKR,, VoiceProfile,    1 , 07,a1,02,02
Or:    HKR,, VoiceProfile,    1, 27,03,00,02</PRE>

<P>Or:</P>

<PRE>    HKR,, VoiceProfile,    1, 25,12,00,02</PRE>

<H4>Note</H4>

<P>The ProCalc tool should be used to create the voice profile entry. For more information about ProCalc, see <A HREF="modem7_89ev.htm">Creating Voice Modem INF File Entries with ProCalc</A>. </P>

<P>The bits in the <B>VoiceProfile</B> DWORD are set as follows:</P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=75%>Description</TH>
<TH align=left width=25%>Bit value</TH>
</TR>

<TR VALIGN="top">
<TD width=75%>Identifies a voice modem (should always be set).</TD>
<TD width=25%>0x00000001</TD>
</TR>

<TR VALIGN="top">
<TD width=75%>Modem has some element of a TAPI phone device. For example, it can play audio to the handset or report handset hookswitch events.</TD>
<TD width=25%>0x00000002</TD>
</TR>

<TR VALIGN="top">
<TD width=75%>Modem has a speakerphone phone device.</TD>
<TD width=25%>0x00000004</TD>
</TR>

<TR VALIGN="top">
<TD width=75%>Modem will use serial wave driver to play audio to the handset and line.</TD>
<TD width=25%>0x00000020</TD>
</TR>

<TR VALIGN="top">
<TD width=75%>Dial string must always end with <B>DialSuffix</B> in voice mode.</TD>
<TD width=25%>0x00000040</TD>
</TR>

<TR VALIGN="top">
<TD width=75%>Modem does not support Caller ID.</TD>
<TD width=25%>0x00000080</TD>
</TR>

<TR VALIGN="top">
<TD width=75%>Modem speaker volume can be changed using multimedia mixer.</TD>
<TD width=25%>0x00000100</TD>
</TR>

<TR VALIGN="top">
<TD width=75%>Force blind dialing after dial-tone detection. long dial strings are broken up into two or more dial strings. If the modem tries to detect the dial tone every time the dial command is issued, this bit should be set.</TD>
<TD width=25%>0x00000200</TD>
</TR>

<TR VALIGN="top">
<TD width=75%><B>Speakerphone</B> state must be reset after recording from line.</TD>
<TD width=25%>0x00000400</TD>
</TR>

<TR VALIGN="top">
<TD width=75%><B>Speakerphone</B> state must be reset after playing from line.</TD>
<TD width=25%>0x00000800</TD>
</TR>

<TR VALIGN="top">
<TD width=75%>Modem does not report distinctive ring (required setting).</TD>
<TD width=25%>0x00001000</TD>
</TR>

<TR VALIGN="top">
<TD width=75%>Modem supports distinctive ringing with ring duration (DRON and DROF). Ignored if modem does not support distinctive ringing. (Ignore in Windows 2000 and later versions).</TD>
<TD width=25%>0x00002000</TD>
</TR>

<TR VALIGN="top">
<TD width=75%>If distinctive ringing is enabled, the first ring reported by modem may not be correct. Unimodem will not report the first ring. (This is not supported in Windows 2000 and later versions.)</TD>
<TD width=25%>0x00004000</TD>
</TR>

<TR VALIGN="top">
<TD width=75%>Modem does not report the first ring when distinctive ringing is enabled. (This is not supported in Windows 2000 and later versions.)</TD>
<TD width=25%>0x00008000</TD>
</TR>

<TR VALIGN="top">
<TD width=75%>The modem reports silence DLE.</TD>
<TD width=25%>0x00010000</TD>
</TR>

<TR VALIGN="top">
<TD width=75%>Modem does not support DTMF generation while in voice mode. </TD>
<TD width=25%>0x00020000</TD>
</TR>

<TR VALIGN="top">
<TD width=75%>Modem does not monitor DTMF digits while in voice mode. </TD>
<TD width=25%>0x00040000</TD>
</TR>

<TR VALIGN="top">
<TD width=75%>UART baud rate is set before issuing <B>StartPlay</B> or <B>StartRecord</B> commands. If this bit is not set, UART baud rate is set after the <B>StartPlay</B> or <B>StartRecord</B> command.</TD>
<TD width=25%>0x00080000</TD>
</TR>

<TR VALIGN="top">
<TD width=75%>UART baud rate is reset after the <B>StopPlay</B> or <B>StopRecord</B> command is issued.</TD>
<TD width=25%>0x00100000</TD>
</TR>

<TR VALIGN="top">
<TD width=75%>Modem keeps handset disconnected from modem while in voice mode. If this bit is set, Unimodem displays "Talk/Drop" dialog during outgoing calls. Unimodem will not allow the line to be opened as Owner/InteractiveVoice.</TD>
<TD width=25%>0x00200000</TD>
</TR>

<TR VALIGN="top">
<TD width=75%>The speakerphone cannot be muted. <B>Speakerphone</B> can be ONHOOK or MICSPEAKER.</TD>
<TD width=25%>0x00400000</TD>
</TR>

<TR VALIGN="top">
<TD width=75%>Sierra chipset Voice Modem.</TD>
<TD width=25%>0x00800000</TD>
</TR>

<TR VALIGN="top">
<TD width=75%>Enable for voice modem use on Windows&nbsp;2000 and later versions of the operating system.</TD>
<TD width=25%>0x02000000</TD>
</TR>
</TABLE><BR>

<P class=note><B>Note</B>&nbsp;&nbsp;<B>VOICEPROF_SET_BAUD_BEFORE_WAVE&nbsp;&nbsp;&nbsp; 0x00080000</B></P>

<P>This bit indicates the DTE should adjust the baud rate before issuing the <B>StartPlay</B>/<B>StartRecord</B> commands. If the bit is disabled or cleared, then the baud rate will be adjusted after these commands are issued. Usually this bit is set for Rockwell chipset modems.</P>

<P>Distinctive Ring is not supported by Windows 2000 and later versions, therefore the bit value of 0x00001000 is required.</P>

<P>The <B>VoiceProfile</B> bit (0x02000000) is for Windows&nbsp;2000 and later versions of the operating system. This bit must also be used in conjunction with the following voice entries that are specific to Windows&nbsp;2000 and later versions of the operating system:</P>

<P class=indent1><A HREF="modemref3_196a.htm">XformID (NT Wavedriver)</A></P>

<P class=indent1><A HREF="modemref3_1quq.htm">BaudRate (NT Wavedriver)</A></P>

<P class=indent1><A HREF="modemref3_58aa.htm">XformModule (NT Wavedriver)</A></P>

<P class=indent1><A HREF="modemref3_7ir6.htm">WaveHardwareID (NT Wavedriver)</A></P>

<P class=indent1><A HREF="modemref3_71ki.htm">WaveDevices (NT Wavedriver)</A></P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: VoiceProfile"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
