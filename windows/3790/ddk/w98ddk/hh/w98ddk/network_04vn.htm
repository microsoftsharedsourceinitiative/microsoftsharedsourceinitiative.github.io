<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>WNetEnumResource</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_3223"></A>WNetEnumResource</H1>

<P>Perform an enumeration based on handle returned by <B>WNetOpenEnum</B>. </P>

<PRE>DWORD WNetEnumResource (
    HANDLE hEnum,
    LPDWORD lpcCount,
    LPVOID lpBuffer,
    LPDWORD lpBufferSize
    );
 </PRE>

<DL>
<DT><I>hEnum</I> </DT>

<DD>This must be a handle obtained from <B>WNetOpenEnum</B> call. </DD>

<DT><I>lpcCount</I> </DT>

<DD>Specifies the number of entries requested. It may be 0xFFFFFFFF to request as many as possible. On successful call, this location will receive the number of entries actually read. </DD>

<DT><I>lpBuffer</I> </DT>

<DD>A pointer to the buffer to receive the enumeration result, which are returned as an array of <B>NETRESOURCE</B> entries. </DD>

<DT><I>lpBufferSize</I> </DT>

<DD>This specifies the size of the buffer passed to the function call. If the buffer is too small to receive even one entry, this variable receives the required size of the buffer. </DD>
</DL>

<UL>
	<LI>WN_SUCCESS if the call is successful, the caller should continue to call <B>WNetEnumResource</B> to continue the enumeration. </LI>
</UL>

<TABLE>

<TR VALIGN="top">
<TD width=43%>WN_NO_MORE_ENTRIES </TD>
<TD width=57%>no more entries found (the contents of the return buffer is undefined). 
<P>Other error codes include: </P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WN_MORE_DATA </TD>
<TD width=57%>the buffer is too small even for one entry </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WN_BAD_HANDLE </TD>
<TD width=57%><I>hEnum</I> is not a valid handle. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WN_FUNCTION_BUSY </TD>
<TD width=57%>The MPR or NP is busy (possibly initializing). The caller should retry. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WN_NO_NETWORK </TD>
<TD width=57%>network is not present. This condition is checked for before <I>hEnum</I> is tested for validity. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WN_EXTENDED_ERROR </TD>
<TD width=57%>a network specific error occurred. <B>WNetGetLastError</B> should be called to obtain a description of the error. </TD>
</TR>
</TABLE><BR>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: WNetEnumResource"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
