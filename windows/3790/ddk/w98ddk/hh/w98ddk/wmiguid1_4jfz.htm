<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>IRP_MN_REGINFO</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_wmiguid1_irp_mn_reginfo"></A>IRP_MN_REGINFO</H1>

<P>The driver receives an IRP_MN_REGINFO to query for registration or registration update information. If the <B>ProviderId</B> passed is that of the device, then the driver should check <B>DataPath</B> to determine if registration or update information is being requested. </P>

<P>If <B>DataPath</B> is set to WMIREGISTER, then registration information is being queried. If it is set to WMIUPDATE, then registration update information is being queried. The driver should then fill the buffer passed in <B>Buffer</B> with one or more <B>WMIREGINFO</B> structures. If <B>BufferSize</B> passed is less than the size needed for all of the queried information, then <B>Buffer</B><I> </I>should be filled with a DWORD specifying the size needed and an STATUS_BUFFFER_TOO_SMALL error returned.</P>

<H4>Members </H4>

<DL>
<DT><B>ProviderId</B> </DT>

<DD>Contains the WMI provider ID of the device that should respond to this request.</DD>

<DT><B>DataPath</B> </DT>

<DD>Contains the value WMIREGISTER or WMIUPDATE.</DD>

<DT><B>BufferSize</B> </DT>

<DD>Contains the maximum size available in <B>Buffer</B> to which the provider can write its registration information. </DD>

<DT><B>Buffer</B> </DT>

<DD>Points to a buffer that the data provider should use to fill in the registration information (<B>WMIREGINFO</B> structure).
</DD>
</DL>

<H4>Return Value</H4>

<P class=indent1>Returns STATUS_SUCCESS or STATUS_BUFFER_TOO_SMALL.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: IRP_MN_REGINFO"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
