<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Using ASPI for Win32 - An Overview</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="_pss_4123"></A>Using ASPI for Win32 - An Overview</H2>

<P>The ASPI manager for Win32 is implemented as a Dynamic Link Library (DLL) called wnaspi32.dll. ASPI function calls can be used to retrieve information about installed SCSI host adapters and devices, and to execute SCSI I/O requests. The ASPI for Win32 layer is fully reentrant, supporting multitasking and multithreaded operations. To use ASPI for Win32, the following two functions must be imported from wnaspi32.dll into the client's Win32 application. </P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=28%>Function </TH>
<TH align=left width=72%>Description </TH>
</TR>

<TR VALIGN="top">
<TD width=28%>GetASPI32SupportInfo </TD>
<TD width=72%>This function returns the number of SCSI host adapters installed and ensures that the ASPI manager is initialized properly. Clients must call this function once at initialization time before the SendASPI32Command function can be accessed. </TD>
</TR>

<TR VALIGN="top">
<TD width=28%>SendASPI32Command </TD>
<TD width=72%>This function handles requests for SCSI I/O. </TD>
</TR>
</TABLE><BR>

<P>The following SCSI I/O command codes are defined within the SendASPI32Command: </P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=28%>Value </TH>
<TH align=left width=72%>Meaning </TH>
</TR>

<TR VALIGN="top">
<TD width=28%>SC_HA_INQUIRY </TD>
<TD width=72%>Get information about installed host adapters, including the number of installed adapters. </TD>
</TR>

<TR VALIGN="top">
<TD width=28%>SC_GET_DEV_TYPE </TD>
<TD width=72%>Get information about installed SCSI devices. </TD>
</TR>

<TR VALIGN="top">
<TD width=28%>SC_EXEC_SCSI_CMD </TD>
<TD width=72%>Execute SCSI I/O. </TD>
</TR>

<TR VALIGN="top">
<TD width=28%>SC_ABORT_SRB </TD>
<TD width=72%>Abort an outstanding I/O request. </TD>
</TR>

<TR VALIGN="top">
<TD width=28%>SC_RESET_DEV </TD>
<TD width=72%>Reset an individual SCSI target. </TD>
</TR>

<TR VALIGN="top">
<TD width=28%>SC_GET_DISK_INFO </TD>
<TD width=72%>Get information on disk type SCSI devices. (Not used with Windows NT/2000) </TD>
</TR>
</TABLE><BR>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Using%20ASPI%20for%20Win32%20-%20An%20Overview"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
