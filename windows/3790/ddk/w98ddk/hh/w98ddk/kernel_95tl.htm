<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Controlling Virtual Machine Execution</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="_pss_1529"></A>Controlling Virtual Machine Execution</H3>

<P>The <B>Close_VM</B> and <B>Nuke_VM</B> services terminate the specified virtual machine. <B>Close_VM</B> gives all virtual devices an opportunity to clean up before the virtual machine terminates by first broadcasting the <B>Close_VM_Notify</B> message to all virtual devices. By comparison, <B>Nuke_VM</B> does not broadcast any notifications before terminating the virtual machine. A virtual device should use <B>Nuke_VM</B> only to terminate a virtual machine that has not terminated normally and does not respond to <B>Close_VM</B>. </P>

<P>The VMM maintains a suspend count for each non-system virtual machine. The execution of a non-system virtual machine is suspended whenever its suspend count is greater than zero. Calling <B>Suspend_VM</B> increments the suspend count; calling Resume_VM decrements it. (As noted previously, this sense of the word "suspend" when applied to virtual machines is different from the sense when applied to threads.) </P>

<P>A virtual device receives the <B>VM_Suspend</B> control message when <B>Suspend_VM</B> changes a virtual machine's suspend count from 0 to 1. It receives the <B>VM_Resume</B> control message when <B>Resume_VM</B> changes the count from 1 to 0. A virtual device can prevent the virtual machine from resuming by setting the carry flag in response to <B>VM_Resume</B>. A virtual device cannot prevent a virtual machine from being suspended. The <B>No_Fail_Resume_VM</B> service is similar to <B>Resume_VM</B> except that it doesn't allow a virtual device to prevent a virtual machine from resuming. </P>

<H4>See Also</H4>

<P><B>Close_VM</B>, <B>No_Fail_Resume_VM</B>, <B>Nuke_VM</B>, <B>Suspend_VM</B>, <B>Resume_VM</B>, <B>VM_Resume</B>, <B>VM_Suspend</B> </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Controlling%20Virtual%20Machine%20Execution"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
