<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Using Control Panel Extensions</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_151"></A>Using Control Panel Extensions</H1>

<P>A control-panel extension is an OLE 2 server DLL. You must supply a device-information (INF) file that copies your DLL to the Windows \SYSTEM directory and creates two registry keys, one that defines the extension's globally unique identifier (GUID), and the other that declares the GUID as a control-panel extension. The INF file format and the registry keys are described in more detail later in this topic. For an example of a control-panel extension, including source files, see the CPLX directory in the Windows 95 DDK. </P>

<P>Some of Control Panel applications in Windows 95 can be extended by adding property-sheet pages or by making interface changes in existing property-sheet pages. This is an alternative to developing an entirely new Control Panel. Using Control Panel extensions has the following advantages: 

<UL>
	<LI>Enables an IHV to develop a user interface for the unique characteristics of a device without having to develop an entirely new Control Panel. </LI>

	<LI>Enables Windows 95 users to find all the settable characteristics of a device in Control Panel that already exists for that device; a user is more likely to find an additional property-sheet page in the Display Control Panel , for example, than they are to find an entirely new Control Panel. Adding a new Control Panel also changes the pattern of displayed Control Panel icons from what the user is accustomed to. </LI>
</UL>

<P>When no existing Control Panel addresses your needs, you can create your own Control Panel. (For example, this could be necessary for BIOS setup interfaces.) For information about creating your own Control Panel, see Control Panel Applications in the Win32® Programmer's Reference. </P>

<P>As mentioned earlier, not all of Control Panel applications in Windows 95 can be extended by adding property-sheet pages or by making interface changes in existing property-sheet pages. The following table lists the standard Control Panels and describes their extensibility: </P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=41%>Control Panel </TH>
<TH align=left width=59%>Extensibility </TH>
</TR>

<TR VALIGN="top">
<TD width=41%>Accessibility </TD>
<TD width=59%>Not extensible. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>Add New Hardware </TD>
<TD width=59%>An application can add classes and devices to lists, using a .INF file. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>Add/Remove Program </TD>
<TD width=59%>Net administrators can add a list of central company software to be installed by setting a registry key and creating a data file on a common server. This procedure is documented in the Resource Kit. 
<P>The Install/Uninstall property sheet contains a list of software that can be uninstalled by Windows. An application that uses the uninstall utility of the InstallShield application will be included in this list. InstallShield is included with the Windows 95 SDK. For more information, see the InstallShield documentation. </P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=41%>Date/Time </TD>
<TD width=59%>Not extensible. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>Display </TD>
<TD width=59%>An application can add property sheet pages, using the <B>IShellPropSheetExt::AddPage</B> interface and adding a Controls Folder\Display key to the registry. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>Joystick </TD>
<TD width=59%>Not extensible. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>Keyboard </TD>
<TD width=59%>Although the Speed page is replaceable, it should not be necessary to do so. Replacing this page can affect the accuracy of existing Help files. 
<P></P>

<P>An application can add property sheet pages, using the <B>IShellPropSheetExt::AddPage</B> interface and adding a Controls Folder\Keyboard key to the registry. </P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=41%>Modems </TD>
<TD width=59%>Not extensible. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>Mouse </TD>
<TD width=59%>Although the Motion and Button pages are replaceable, it should not be necessary to do so. Replacing these pages can affect the accuracy of existing Help files. 
<P>An application can add property sheet pages, using the <B>IShellPropSheetExt::AddPage</B> interface and adding a Controls Folder\Mouse key to the registry. </P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=41%>Multimedia </TD>
<TD width=59%>Not extensible. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>Network </TD>
<TD width=59%>Most network drivers and software can fully specify their installation requirements and files by using network .INF files. For more information about network .INF files, see Network Driver Installer in the DDK. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>Passwords </TD>
<TD width=59%>An application can add property sheet pages, using the <B>IShellPropSheetExt::AddPage</B> interface and adding a Controls Folder\Passwords key to the registry. For more information, see Passwords Control Panel in the Windows 95 Programming Guide. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>PCMCIA </TD>
<TD width=59%>Not extensible. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>Power Management </TD>
<TD width=59%>An application can add property sheet pages, using the <B>IShellPropSheetExt::AddPage</B> interface and adding a Controls Folder\Power key to the registry </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>Regional Settings </TD>
<TD width=59%>Not extensible. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>Sounds </TD>
<TD width=59%>Not extensible. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>System </TD>
<TD width=59%>Not extensible. </TD>
</TR>
</TABLE><BR>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Using%20Control%20Panel%20Extensions"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
