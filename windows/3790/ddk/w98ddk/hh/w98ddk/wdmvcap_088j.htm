<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Capture, Preview, and Still Categories</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="_wdmvcap_capture_preview_and_still_categories"></A>Capture, Preview, and Still Categories</H3>

<P>The capture, preview, and still stream Categories are almost identical in terms of data formats and stream characteristics.</P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=43%>Category/PinName</TH>
<TH align=left width=57%>Description</TH>
</TR>

<TR VALIGN="top">
<TD width=43%>PINNAME_VIDEO_CAPTURE</TD>
<TD width=57%>Capture Category output pins provide a stream of compressed or uncompressed digital video. This stream is typically used for writing movies to disk, video conferencing, and for image analysis.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>PINNAME_VIDEO_PREVIEW</TD>
<TD width=57%>Preview Category output pins provide a stream of usually uncompressed digital video. The stream is typically used to view the video stream on the local monitor, in either RGB or YUV formats that can be directly displayed by DirectDraw. In resource-limited situations, capture drivers should prioritize the preview stream lower than the capture stream.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>PINNAME_VIDEO_STILL</TD>
<TD width=57%>Still Category output pins are used with dual-mode cameras that are capable of producing both a capture stream and a still image stream that is often of higher quality than the capture stream. The still image stream includes the ability to externally or internally trigger acquisition of an image.</TD>
</TR>
</TABLE><BR>

<P class=note><B>Note</B>&nbsp;&nbsp;Since many cameras produce only a single output stream, the DirectShow SDK includes a Smart Tee filter that splits a single stream into a Capture and a Preview stream. Therefore, cameras that produce only a single stream should not internally duplicate their data streams to produce a preview stream.</P>

<P>The following table lists the common characteristics of Capture, Preview, and Still streams. </P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=28%>Name</TH>
<TH align=left width=72%>Characteristic</TH>
</TR>

<TR VALIGN="top">
<TD width=28%><B>KS Datarange</B></TD>
<TD width=72%>KS_DATARANGE_VIDEO (frames only)<BR>
KS_DATARANGE_VIDEO2 (fields or frames)</TD>
</TR>

<TR VALIGN="top">
<TD width=28%><B>KS Dataformat</B></TD>
<TD width=72%>KS_DATAFORMAT_VIDEO (frames only)<BR>
KS_DATAFORMAT_VIDEO2 (fields or frames)</TD>
</TR>

<TR VALIGN="top">
<TD width=28%><B>KS MajorFormat</B></TD>
<TD width=72%>KSDATAFORMAT_TYPE_VIDEO</TD>
</TR>

<TR VALIGN="top">
<TD width=28%><B>KS SubFormat (typical)</B></TD>
<TD width=72%>RGB16, RGB24, UYVY, JPEG, …</TD>
</TR>

<TR VALIGN="top">
<TD width=28%><B>KS Specifier</B></TD>
<TD width=72%>KSDATAFORMAT_SPECIFIER_VIDEOINFO (frames only)<BR>
KSDATAFORMAT_SPECIFIER_VIDEOINFO2 (fields or frames)</TD>
</TR>

<TR VALIGN="top">
<TD width=28%><B>Extended Header Size</B></TD>
<TD width=72%>KS_FRAME_INFO</TD>
</TR>

<TR VALIGN="top">
<TD width=28%><B>Required Property Sets</B></TD>
<TD width=72%>KSPROPSETID_Connection<BR>
PROPSETID_VIDCAP_DROPPEDFRAMES</TD>
</TR>

<TR VALIGN="top">
<TD width=28%><B>Required Events</B></TD>
<TD width=72%>None</TD>
</TR>

<TR VALIGN="top">
<TD width=28%><B>DS majortype</B></TD>
<TD width=72%>MEDIATYPE_Video</TD>
</TR>

<TR VALIGN="top">
<TD width=28%><B>DS formattype</B></TD>
<TD width=72%>FORMAT_VideoInfo (frames only)<BR>
FORMAT_VideoInfo2 (fields or frames)</TD>
</TR>
</TABLE><BR>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Capture,%20Preview,%20and%20Still%20Categories"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
