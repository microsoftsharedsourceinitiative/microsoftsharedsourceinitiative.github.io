<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Creating a version resource</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Creating a version resource">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="ddk_creating_a_version_resource_me"></A>Creating a version resource </H2>

<P>You can use the following template to create a version resource for your VxD file </P>

<P>/********************************************************************/</P>

<P>/* Version control data */</P>

<P>/********************************************************************/</P>

<P>#include &lt;version.h&gt;</P>

<P>#define VER_FILETYPE VFT_VXD</P>

<P>#define VER_FILESUBTYPE DEVICE_ID</P>

<P>#define VER_COMPANYNAME_STR "Company Name, Inc.\0"</P>

<P>#define VER_FILEDESCRIPTION_STR "Sample VxD\0"</P>

<P>#define VER_INTERNALNAME_STR "Sample\0"</P>

<P>#define VER_LEGALCOPYRIGHT_YEARS "1993-1995\0"</P>

<P>#define VER_ORIGINALFILENAME_STR "SAMPLE.VXD\0"</P>

<P>#include &lt;common.ver&gt;</P>

<P>In the example, DEVICE_ID is the VxD's Device ID or UNDEFINED_DEVICE_ID (defined in inc32\vmm.h) for dynaload VxDs. Use the resource compiler (rc.exe) to compile the above (the include files version.h and common.ver are in the inc16 include file subdirectory) and adrc2vxd to add it to your VxD. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Creating%20a%20version%20resource"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
