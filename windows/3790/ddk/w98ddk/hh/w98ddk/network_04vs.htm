<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>WNetAddConnection</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_3228"></A>WNetAddConnection</H1>

<P>This function allows the caller to redirect (connect) a local device to a network resource. If successful, the connection will be made persistent. </P>

<PRE>DWORD WNetAddConnection(
    LPTSTR lpRemoteName,
    LPTSTR lpPassword,
    LPTSTR lpLocalName
    );
 </PRE>

<DL>
<DT><I>lpRemoteName</I> </DT>

<DD>Specifies the network resource to connect to. This is limited to MAX_PATH. </DD>

<DT><I>lpPassword</I> </DT>

<DD>Specifies the password to be used in making the connection. 

<P>The NULL value or string may be passed in to indicate that the caller wants the network to use the best password(s) it has available (such as no password, a default password, or an internally cached password). 
</DD>

<DT><I>lpLocalName</I> </DT>

<DD>This should contain the name of a local device to be redirected, such as "F:" or "LPT1". The string is treated in a case insensitive manner, and may be the empty string (or NULL) to indicate the connection to the network resource is to be made without a device redirection (i.e., deviceless connection). </DD>
</DL>

<UL>
	<LI>WN_SUCCESS if the call is successful. Other error codes include: </LI>
</UL>

<TABLE>

<TR VALIGN="top">
<TD width=43%>ERROR_BAD_DEV_TYPE </TD>
<TD width=57%>The device type and the resource type do not match. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WN_BAD_NETNAME </TD>
<TD width=57%><I>lpRemoteName</I> is not acceptable to any NP </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WN_BAD_LOCALNAME </TD>
<TD width=57%><I>lpLocalName</I> is invalid. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WN_BAD_PASSWORD </TD>
<TD width=57%>invalid password, or the connection requires additional authentication not provided by the caller (for example, a user name) </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WN_ALREADY_CONNECTED </TD>
<TD width=57%><I>lpLocalName</I> is already connected to a network drive or is to a local drive that is already in use locally (e.g. is used for a hard drive or RAM drive). </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WN_ACCESS_DENIED </TD>
<TD width=57%>access denied (user may need to log on) </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WN_NO_NETWORK </TD>
<TD width=57%>network is not present </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WN_CANNOT_OPEN_PROFILE </TD>
<TD width=57%>Unable to open the user profile to process persistent connections. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WN_BAD_PROFILE </TD>
<TD width=57%>The user profile is in an incorrect format. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WN_FUNCTION_BUSY </TD>
<TD width=57%>The MPR or NP is busy (possibly initializing). The caller should retry. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WN_NO_NET_OR_BAD_PATH </TD>
<TD width=57%>the operation could not be handled either because a network component is not started or the specified name could not be handled. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WN_EXTENDED_ERROR </TD>
<TD width=57%>a network specific error occurred. <B>WNetGetLastError</B> should be called to obtain a description of the error. </TD>
</TR>
</TABLE><BR>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: WNetAddConnection"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
