<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>DiGetClassDevsEx</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="DiGetClassDevsEx">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_212"></A>DiGetClassDevsEx</H1>

<P>Returns a list of DEVICE_INFO structures for all of the installed devices of a specified class. </P>

<PRE class=syntax><B>RETERR
  DiGetClassDevsEx(
</B>    <B>LPLPDEVICE</B>_<B>INFO</B>  <I>lplpdi</I><B>,</B>
    <B>LPCSTR</B>  <I>lpszClassName</I><B>,</B>
    <B>LPSTR</B>  <I>lpszEnumerator</I><B>,</B>
    <B>HWND</B>  <I>hwndParent</I><B>,</B>
    <B>int</B>  <I>iFlags</I>
<B>    );</B></PRE>

<H4>Return Value</H4>

<P>Returns OK if successful, otherwise an ERR_DI_xxx error code will be returned. </P>

<H4>Parameters</H4>

<DL>
<DT><I>lplpdi</I> </DT>

<DD>Pointer to a pointer to a DEVICE_INFO structure. This pointer receives the pointer to the beginning of the list of DEVICE_INFO structures created by this function. </DD>

<DT><I>lpszClassName</I> </DT>

<DD>If non-null, the class name to use when creating the list of devices. </DD>

<DT><I>lpszEnumerator</I> </DT>

<DD>If specified this API will retrieve devices created by the specified enumerator. If NULL then this functions works like DiGetClassDevs. For example. this parameter could specify ROOT, and only device in the ENUM\ROOT branch would be returned. </DD>

<DT><I>hwndParent</I> </DT>

<DD>If non-null, the window handle of the top level window use for any U/I using the resulting DEVICE_INFO structures. </DD>

<DT><I>iFlags</I> </DT>

<DD>Control options for building the device list. 

<TABLE>

<TR VALIGN="top">
<TD width=43%>DIGCF_PRESENT </TD>
<TD width=57%>Return only devices which are present. This flag is only valid if Config Manager is running and has created devnodes for the installed devices. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>DIGCF_ALLCLASSES </TD>
<TD width=57%>Return a list of installed devices for all classes. If set, this flags will cause lpszClassName to be ignored. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>DIGCF_PROFILE </TD>
<TD width=57%>Return only devices which are present in the current configuration. </TD>
</TR>
</TABLE><BR>


</DD>
</DL>

<H4>Comments</H4>

<P>This function build a list of device that have been previously installed. This function uses the HKLM\ENUM branch of the registry to build its list. </P>

<H4>See Also</H4>

<P><B>DiGetClassDevs</B> </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: DiGetClassDevsEx"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
