<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>RnaOpenMac</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_3431"></A>RnaOpenMac</H1>

<PRE>DWORD
WINAPI RnaOpenMac(HANDLE hConn, HANDLE * lphMAC,
   LPMAC_OPEN lpmo, DWORD dwSize, HANDLE hEvent)
 </PRE>

<P>This function is called by an SMM to request RNA to load the MAC and open the adapter port. The MAC is not activated to any protocol on a successful return. The SMM still needs to activate the MAC and the protocol using a private DeviceIOCTL call. 

<DL>
<DT><I>hConn</I> </DT>

<DD>The RNA connection handle. </DD>

<DT><I>lphMAC</I> </DT>

<DD>An address to a HANDLE buffer to receive a handle to the loaded MAC. The handle can be used as the device handle for a DeviceIOCTL call in the future. </DD>

<DT><I>lpmo</I> </DT>

<DD>An address to a MAC_OPEN data structure to receive the information of the adapter port on a successful return. </DD>

<DT><I>dwSize</I> </DT>

<DD>The size of the buffer that we get, need to verify that this is large enough to hold the MAC_OPEN data structure. </DD>

<DT><I>hEvent</I> </DT>

<DD>A handle to an event to request for an asynchronous operation. The MAC is required to signal the event if the event is not NULL. If it is NULL, the MAC must perform the operation synchronously. </DD>
</DL>

<UL>
	<LI>SUCCESS or one of the following error codes: </LI>
</UL>

<TABLE>

<TR VALIGN="top">
<TD width=43%><B>ERROR_INVALID_HANDLE</B> </TD>
<TD width=57%>The RNA connection handle is invalid. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%><B>ERROR_INVALID_PORT_HANDLE</B> </TD>
<TD width=57%>The RNA connection handle is invalid. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%><B>ERROR_NO_MAC_FOR_PORT</B> </TD>
<TD width=57%>The MAC driver cannot be found or opened. </TD>
</TR>
</TABLE><BR>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: RnaOpenMac"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
