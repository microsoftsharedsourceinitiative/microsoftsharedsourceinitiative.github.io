<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Password Provider Registration</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_3378"></A>Password Provider Registration</H1>

<P>Password providers must register themselves in the registry to be installed. Every password provider must have a provider name, which should be short and does not appear in any UI. This name is used as the <I>lpProvider</I> parameter in API calls to identify which password provider to call. The provider's installer must create the following key in the registry: </P>

<PRE>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\PwdProvider\&lt;provider name&gt;
 </PRE>

<P>In this key, the following values must be set: </P>

<PRE>ProviderPath=&lt;file name of provider dll&gt;
Description=&lt;description string for UI&gt;
ChangePassword=&lt;exported name of PPChangePassword function&gt;
GetPasswordStatus=&lt;exported name of PPGetPasswordStatus function&gt;
 </PRE>

<P>Additionally, the following value may optionally be set: </P>

<P>NetworkProvider=01 00 00 00 (REG_BINARY). This identifies the password provider as a network provider, which means that the password will not appear in the list unless the DLL is already loaded. This allows network providers to register themselves as password providers, but not appear in UI unless their network is installed and running. </P>

<P>An example registry section is as follows: </P>

<PRE>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\PwdProvider\SCRSAVE
ProviderPath=password.cpl
Description="Windows Screen Saver"
ChangePassword="PPChangePassword"
GetPasswordStatus="PPGetPasswordStatus"
 </PRE>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Password%20Provider%20Registration"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
