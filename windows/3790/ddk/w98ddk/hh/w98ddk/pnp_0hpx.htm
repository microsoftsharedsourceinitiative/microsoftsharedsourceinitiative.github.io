<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Plug and Play and PCMCIA</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_3665"></A>Plug and Play and PCMCIA</H1>

<P>This documentation describes the architecture of PCMCIA in Windows 95 and its interaction with the Plug and Play environment. It addresses the three major aspects of PCMCIA: PC cards, device drivers for those cards, and PCMCIA system software. The Plug and Play framework enables tighter integration and better support of the dynamic nature of the PCMCIA interface. In this framework, a PCMCIA adapter will be controlled by the PCMCIA bus enumerator (PCCARD.386). PCCARD incorporates the Card Services functions as well as the PCMCIA bus enumeration and configuration functions. </P>

<P>The primary goal of PCMCIA in Windows 95 is to configure PC cards so that any Plug and Play device driver can be used to control the device, without any special provisions for PCMCIA. Another goal of the system is to support PCMCIA 2.<I>x</I> Card Services Clients and Drivers and to provide an environment for 32-bit protected mode Card Services clients, which may be required to support PC cards and their drivers. </P>

<P>The tighter integration of PCMCIA with the operating system eliminates the need for the guesswork which Card Services otherwise uses to find which resources are available in a given system. The PCMCIA enumerator also enables automatic device installation via the Windows Device Installer. Since configuration management is actually done by Configuration Manager, resources are allocated and reclaimed dynamically. This enables the easy addition of static devices and support for new scenarios such as hot or warm docking. The PCMCIA bus enumerator uses the information tuples described in this documentation to identify the card, load the correct device driver, and indicate all the possible configurations to Configuration Manager. Configuration Manager dynamically assigns a valid configuration based on this information. </P>

<P>To support true Plug and Play functionality, PC cards must fully support the identification and configuration tuples described in this documentation. </P>

<P>Device drivers must be modified to support the Windows 95 dynamic loading mechanism and the Plug and Play configuration functions. Since Windows 95 Plug and Play seamlessly configures devices in the system, it enables card vendors to write a single driver for the ISA, EISA, PCI and PCMCIA implementations of a given I/O card. Protected mode Card Services clients will be supported in Windows 95 as well, but will not have the same level of flexibility as Windows 95 Plug and Play drivers. This documentation describes three different types of PC card drivers which will be supported in Windows 95. </P>

<P>The following diagram illustrates how Card Services is integrated into the Windows 95 Plug and Play framework. Card Services is incorporated with the PCMCIA bus enumerator in the PCCARD module. This module interacts with Configuration Manager and the registry when a card is inserted or removed. </P>

<P><IMG SRC="images/05_01.gif" ALT="" BORDER=0></P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Plug%20and%20Play%20and%20PCMCIA"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
