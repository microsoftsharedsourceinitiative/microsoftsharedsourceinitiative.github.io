<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>IFSMgr_SetupFailedConnection</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="_pss_4456"></A>IFSMgr_SetupFailedConnection</H3>

<PRE>IFSMgr_SetupFailedConnection(
 pioreq pir,
 unsigned long * pProId
 )
 </PRE>

<P>This service is called for VxDs that try to emulate network services when the network provider is not available. Typically, this kind of service would be used by VxDs that provide remote networking capabilities. It provides the VxD an opportunity to fake a connection after all registered net providers have been unable to connect to the resource. 

<DL>
<DT><I>pir</I> </DT>

<DD>Supplies pointer to the IOREQ structure. The fields in the IOREQ are setup exactly the same as for the FS_ConnectNetResource FSD API. Please refer to Section 8.5.3 for details. </DD>

<DT><I>pProId</I> </DT>

<DD>Supplies the pointer to a variable in which the VxD that provides the connection fills in its provider id. </DD>
</DL>

<UL>
	<LI>This is the same as the value in <I>ir_error</I>. </LI>
</UL>

<TABLE>

<TR VALIGN="top">
<TD width=34%><B>IOREQ Structure:</B> 
<P>This structure should be filled in with the same return values as the FS_ConnectNetResource API. Please refer to Section 8.5.3 for details. </P>
</TD>
<TD width=66%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=34%><I>pProId</I> </TD>
<TD width=66%>Returns the provider ID of the VxD that provides the connection. If the VxD is unable to provide the connection, it should not update this field. </TD>
</TR>
</TABLE><BR>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: IFSMgr_SetupFailedConnection"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
