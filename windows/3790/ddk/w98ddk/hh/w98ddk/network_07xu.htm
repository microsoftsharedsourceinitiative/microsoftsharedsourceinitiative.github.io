<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>NPGetConnectionPerformance</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_3302"></A>NPGetConnectionPerformance</H1>

<P>This function returns information about the expected performance of a connection used to access a network resource. The request can be only for a network resource to which there is currently a connection. </P>

<P>The information returned can be an estimate only. Note that if the network cannot obtain information about the resource on the network, then it can return information about the network adapter and its associated performance, setting <I>dwFlags </I>accordingly. </P>

<PRE>DWORD NPGetConnectionPerformance(
  LPTSTR lpRemoteName,
  LPNETCONNECTINFOSTRUCT lpNetConnectInfo
  );
 </PRE>

<DL>
<DT><I>lpRemoteName</I> </DT>

<DD>Contains the remote name for a resource for which a connection exists. </DD>

<DT><I>lpNetConnectInfo</I> </DT>

<DD>This is a pointer to a <B>NETCONNECTINFOSTRUCT </B>structure which is filled in by the NP if the provider has a connection to the network resource. With the exception of the <I>cbStructure </I>field, all other fields are zero filled before Mpr.dll passes the request on to the NPs, and the provider has to write to fields only for which it has information available. Also, for rate values, one means that the performance is better than can be represented in the unit. </DD>
</DL>

<UL>
	<LI>WN_SUCCESS if the call is successful. Otherwise, an error code is returned, which may include: </LI>
</UL>

<TABLE>

<TR VALIGN="top">
<TD width=43%>WN_BAD_LOCALNAME </TD>
<TD width=57%><I>lpLocalName</I> is invalid. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WN_NOT_CONNECTED </TD>
<TD width=57%><I>lpRemoteName </I>not a connected network resource. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WN_NO_NETWORK </TD>
<TD width=57%>The network is not present. </TD>
</TR>
</TABLE><BR>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: NPGetConnectionPerformance"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
