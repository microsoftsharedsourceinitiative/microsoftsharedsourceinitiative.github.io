<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>NPGetUser</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_3291"></A>NPGetUser</H1>

<P>This is used to determine either the current default user name, or the user identification used to establish a network connection. </P>

<PRE>DWORD NPGetUser(
  LPTSTR lpName,
  LPTSTR lpUserID,
  LPDWORD lpBufferSize
  );
 </PRE>

<DL>
<DT><I>lpName</I> </DT>

<DD>Contains the name of the redirected local device the caller is interested in, or a network name that the user has made a connection to. This may be the empty string if the caller is interested in the name of the user currently logged on to the system. If a network name is passed in, and the user is connected to that resource using different names, it is possible that a provider cannot resolve which user identification to return. In this case the provider may make an arbitrary choice amongst the possible responses. </DD>

<DT><I>lpUserID</I> </DT>

<DD>Points to a buffer to receive the user profile name. This is an identification string that the user made to establish the connection (for example, a user name, or group name). Whenever possible, this string should contain sufficient information to reestablish the connection with a call to NPAddConnection without posting a dialog box when a valid password is supplied. </DD>

<DT><I>lpBufferSize</I> </DT>

<DD>This is used to specify the size of the buffer passed in, in bytes. If the call fails because the buffer is not big enough, this location will be used to return the required buffer size. </DD>
</DL>

<UL>
	<LI>WN_SUCCESS if the call is successful. This status should be returned if <I>lpName</I> is asking for the network logon name and the network does not provide a network-wide log on to the user (the user must log on to each server individually). Otherwise, an error code is returned. which may include: </LI>
</UL>

<TABLE>

<TR VALIGN="top">
<TD width=43%>WN_NOT_LOGGED_ON </TD>
<TD width=57%>The user is not logged on to the network. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WN_NOT_CONNECTED </TD>
<TD width=57%><I>lpName</I> not a redirected device nor a connected network name. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WN_NOT_SUPPORTED </TD>
<TD width=57%><I>lpName</I> is a pointer to an empty string and the NP does not provide the capability for network-wide log on. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WN_MORE_DATA </TD>
<TD width=57%>The buffer is too small. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WN_NO_NETWORK </TD>
<TD width=57%>Network is not present. </TD>
</TR>
</TABLE><BR>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: NPGetUser"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
