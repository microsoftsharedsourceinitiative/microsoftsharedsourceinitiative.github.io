<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Hardware Profile Detection</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="_pss_3640"></A>Hardware Profile Detection</H3>

<P>Hardware profile detection determines the computer's hardware profile. Although most desktop computers will have only one hardware profile, dockable portables typically have one hardware profile for the undocked state and another for each dock to which they connect. </P>

<P>Hardware profile detection runs before the CONFIG.SYS file is executed during MS-DOS startup. Hardware profile detection combines interrupt checksums, BIOS COM/LPT data, BIOS machine identification data, Plug and Play BIOS Docking Station data, and, if possible, docking station data which is unique to each OEM and builds a 2 byte value known as the current hardware profile (or the current configuration). </P>

<P>Each hardware profile has a "friendly name." If the current hardware profile's friendly name exactly matches a top-level menu item in a multi-configured CONFIG.SYS file, that menu item or submenu is automatically selected. </P>

<P>The registry uses the current hardware profile to point the predefined key HKEY_CURRENT_CONFIG to the correct location (subsidiary to the predefined key HKEY_LOCAL_MACHINE). For example, if the current hardware profile were 0x5107, HKEY_CURRENT_CONFIG would be initialized to HKEY_LOCAL_MACHINE\CONFIG\5107. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Hardware%20Profile%20Detection"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
