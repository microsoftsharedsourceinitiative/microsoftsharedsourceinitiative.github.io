<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>GetPrinterDriver</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_3943"></A>GetPrinterDriver</H1>

<PRE>BOOL GetPrinterDriver(
HANDLE  hPrinter,   /* printer object                        */
LPTSTR  lpszEnv,    /* address of environment                */
DWORD   dwLevel,    /* structure level                       */
LPBYTE  lpbDrvInfo, /* address of structure array            */
DWORD   cbBuf,      /* size, in bytes, of array              */
LPDWORD lpdwNeeded  /* addr. of variable with count of bytes */
                    /* retrieved (or required)               */
);
 </PRE>

<P>Retrieves driver data for the specified printer. 

<UL>
	<LI>If the function succeeds, the return value is TRUE; otherwise, it is FALSE. To get extended error information, use the <B>GetLastError</B> function. </LI>
</UL>

<TABLE>

<TR VALIGN="top">
<TD width=24%><I>hPrinter</I> </TD>
<TD width=76%>Identifies the printer for which to retrieve driver data. </TD>
</TR>

<TR VALIGN="top">
<TD width=24%><I>lpszEnv</I> </TD>
<TD width=76%>Points to a null-terminated string that specifies the environment. For example, "Windows 96 x86" specifies Windows 96 running on an Intel(r) 80386 or 80486 processor. If this string is NULL, the current environment of the caller/client (not of the destination/server) is used. </TD>
</TR>

<TR VALIGN="top">
<TD width=24%><I>dwLevel</I> </TD>
<TD width=76%>Specifies the version of the structure to which <I>lpbDrvInfo</I> points. This value must be either 1 or 2. </TD>
</TR>

<TR VALIGN="top">
<TD width=24%><I>lpbDrvInfo</I> </TD>
<TD width=76%>Points to either a <B>DRIVER_INFO_1</B> or a <B>DRIVER_INFO_2</B> structure. If <I>dwLevel</I> is 1, this array receives a <B>DRIVER_INFO_1</B> structure; if <I>dwLevel</I> is 2, this array receives a <B>DRIVER_INFO_2</B> structure. </TD>
</TR>

<TR VALIGN="top">
<TD width=24%><I>cbBuf</I> </TD>
<TD width=76%>Specifies the size, in bytes, of the array at which <I>lpbDrvInfo</I> points. </TD>
</TR>

<TR VALIGN="top">
<TD width=24%><I>lpdwNeeded</I> </TD>
<TD width=76%>Points to a value that specifies the number of bytes copied if the function succeeds or the number of bytes required if <I>cbBuf</I> is too small. </TD>
</TR>
</TABLE><BR>

<P>The printer handle <I>hPrinter</I> is obtained by calling the <B>OpenPrinter</B> function. </P>

<P>The <B>DRIVER_INFO_2</B> structure contains a full path and file name that specifies the location of the printer driver. An application can use the path and file name to load a printer driver by calling the <B>LoadLibrary</B> function and supplying the path and file name as the single argument. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: GetPrinterDriver"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
