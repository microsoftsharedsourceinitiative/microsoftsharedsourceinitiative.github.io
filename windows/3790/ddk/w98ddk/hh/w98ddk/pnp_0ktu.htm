<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>CONFIGMG_Query_Remove_SubTree</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="_pss_3752"></A>CONFIGMG_Query_Remove_SubTree</H3>

<PRE>CONFIGRET CONFIGMG_Query_Remove_SubTree(DEVNODE dnAncestor, ULONG ulFlags)
 </PRE>

<P>Checks whether a device node and its progeny can be removed. 

<UL>
	<LI>Returns CR_SUCCESS if the function is successful. Otherwise, the return value can be CR_INVALID_DEVNODE, CR_INVALID_FLAG, CR_REMOVE_VETOED, or CR_NOT_SYSTEM_VM. </LI>
</UL>

<DL>
<DT><I>dnAncestor</I> </DT>

<DD>The root of the subtree whose removal is being queried. </DD>

<DT><I>ulFlags</I> </DT>

<DD>Must be zero. 
</DD>
</DL>

<P>If the hardware can only detect removal, the enumerator should call <B>CONFIGMG_Remove_SubTree</B>; this is problematic, because it does not give applications the opportunity to close their files. If the hardware has an indication that the user wants to remove it (that is, if it is software-eject capable), the enumerator should follow the steps shown in this example: </P>

<PRE>if (CM_Query_Remove_Subtree(dnDevNode, 0)==CR_SUCCESS)
     CM_Remove_SubTree(dnDevNode, 0);
 </PRE>

<H4>See Also</H4>

<P><B>CONFIGMG_Remove_Subtree</B> </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: CONFIGMG_Query_Remove_SubTree"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
