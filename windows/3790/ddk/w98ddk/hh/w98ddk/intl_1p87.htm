<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Generating Messages</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_897"></A>Generating Messages</H1>

<P>The IMEs need to generate IME messages. When the IME starts a conversion, the IME must generate the WM_IME_STARTCOMPOSITION message. If the IME changes the composition string, the IME must generate the WM_IME_COMPOSITION message. The events from IMEs are realized as generating messages to the window that is associated with the input context. Basically, the IMEs use the <I>lpdwTransKey</I> buffer that is provided by the parameter of the <B>ImeToAsciiEx</B> function to generate the message. The IME puts the messages into the <I>lpdwTransKey</I> buffer when <B>ImeToAsciiEx</B> is called. Even if <B>ImeToAsciiEx</B> is not called, the IME can generate the message to the window that is associated with the input context by using the message buffer of the input context. The input context has the message buffer as a handle of a memory block. The IME puts the messages into the memory block that is provided by the handle of the message buffer. Then, the IME calls <B>ImmGenerateMessage</B>. The <B>ImmGenerateMessage</B> function sends the messages that are stored in the message buffer to the proper window. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Generating%20Messages"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
