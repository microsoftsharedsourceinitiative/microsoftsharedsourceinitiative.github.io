<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Configuration Services</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="_pss_11"></A>Configuration Services</H3>

<P>You can use VCOMM services to configure a communications resource and initialize its receive and transmit queues. The <B>_DCB</B> (device control block) structure specifies the configuration settings for a communications resource - for example, the baud rate, the number of data bits per byte, and the number of stop bits per byte. Additional fields specify parity, handshaking options, and special characters used for handshaking or for signaling events. </P>

<P>When you open a communications resource, the port driver initializes it using a default configuration. You can determine the current configuration by calling the <B>_VCOMM_GetCommState</B> service, that fills in a <B>_DCB</B> structure. Before configuring the communications resource, you can determine which settings it supports by calling the <B>_VCOMM_GetCommProperties</B> service; this service fills in a <B>_COMMPROP</B> structure. To configure the communications resource, call the <B>_VCOMM_SetCommState</B> service. </P>

<P>To initialize the receive and transmit queues for a communications resource, call the <B>_VCOMM_SetupComm</B> service. The previous state of the receive queue is returned in the specified <B>_QSB</B> structure. If you do not call this service, the port driver uses default queues. The <B>_COMMPROP</B> structure specifies the default and maximum sizes of the receive and transmit queues. Note that port drivers for some devices, such as LPT ports, do not use queues. </P>

<H4>See Also</H4>

<P><B>_COMMPROP</B>, <B>_DCB</B>, <B>_QSB</B>, <B>_VCOMM_GetCommProperties</B>, <B>_VCOMM_GetCommState</B>, <B>_VCOMM_SetCommState</B>, <B>_VCOMM_SetupComm</B> </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Configuration%20Services"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
