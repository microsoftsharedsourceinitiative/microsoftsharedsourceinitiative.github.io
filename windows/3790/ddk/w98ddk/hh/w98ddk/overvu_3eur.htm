<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Required Printer Driver Functions</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Required Printer Driver Functions">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="_mdag_required_printer_driver_functions"></A>Required Printer Driver Functions</H3>

<P>All Windows printer drivers must support 24 required functions that are called by Windows GDI. These functions initialize the device, return device data, set the printer mode, and generate output. The following sections briefly describe these functions. For more information about these functions, see the Microsoft Windows Device Driver Adaptation Guide. </P>

<H4>Initialization Functions</H4>

<P>The initialization functions start and stop print jobs, allocate memory for a driver's data structures, deallocate memory that was used by a driver's data structures, and so on. The following table briefly describes each function.</P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=48%>Function</TH>
<TH align=left width=52%>Description</TH>
</TR>

<TR VALIGN="top">
<TD width=48%><B>Control</B></TD>
<TD width=52%>The <B>Control</B> function performs device-dependent operations such as starting a print job, canceling a print job, processing a new band of bitmap data, and so on.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>Disable</B></TD>
<TD width=52%>The <B>Disable</B> function deallocates memory used by the printer driver's data structures, and unloads the driver from memory if no other device contexts (DCs) exist for this device.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>Enable</B></TD>
<TD width=52%>The <B>Enable</B> function allocates memory for and initializes the members within the driver's PDEVICE data structure. This data structure contains device-dependent data and device-state information.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>WEP</B></TD>
<TD width=52%>The <B>WEP</B> (Windows Exit Program) function signals that the driver DLL will be removed from memory, or signals that Windows is shutting down.</TD>
</TR>
</TABLE><BR>

<H4>Information Functions</H4>

<P>The information functions retrieve color, font, pen, and brush information for a printer. The following table briefly describes each function.</P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=48%>Function</TH>
<TH align=left width=52%>Description</TH>
</TR>

<TR VALIGN="top">
<TD width=48%><B>ColorInfo</B></TD>
<TD width=52%>The <B>ColorInfo</B> function translates physical colors to logical colors and logical colors to physical colors. </TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>DevGetCharWidth</B></TD>
<TD width=52%>The <B>DevGetCharWidth</B> function returns width values for characters in a given printer font. </TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>DeviceBitmap</B></TD>
<TD width=52%>The <B>DeviceBitmap</B> function is not supported in the current release of Windows. It must be implemented as a stub function. </TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>EnumDFonts</B></TD>
<TD width=52%>The <B>EnumDFonts</B> function enumerates the fonts available on a printer.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>EnumObj</B></TD>
<TD width=52%>The <B>EnumObj</B> function enumerates the pens and brushes (if any) which are available on a printer.</TD>
</TR>
</TABLE><BR>

<H4>Output Functions</H4>

<P>The output functions render output on a printer. The following table briefly describes each function.</P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=48%>Function</TH>
<TH align=left width=52%>Description</TH>
</TR>

<TR VALIGN="top">
<TD width=48%><B>DevBitBlt</B></TD>
<TD width=52%>The <B>DevBitBlt</B> function sets pels on a page of printer paper. These pels correspond to bits in a source bitmap.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>DevExtTextOut</B></TD>
<TD width=52%>The <B>DevExtTextOut</B> function renders text as well as a background pattern.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>Output</B></TD>
<TD width=52%>The <B>Output</B> function renders a shape on a page of printer paper.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>Pixel</B></TD>
<TD width=52%>The <B>Pixel</B> function sets a single pel on a page of printer paper.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>ScanLR</B></TD>
<TD width=52%>The <B>ScanLR</B> function sets pels that appear on a single row or scan.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>StrBlt</B></TD>
<TD width=52%>The <B>StrBlt</B> function renders scaled bitmaps.</TD>
</TR>
</TABLE><BR>

<H4>Attribute Functions</H4>

<P>The attribute functions initialize data structures for the printer driver. The following table briefly describes each function.</P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=48%>Function</TH>
<TH align=left width=52%>Description</TH>
</TR>

<TR VALIGN="top">
<TD width=48%><B>RealizeObject</B></TD>
<TD width=52%>The <B>RealizeObject</B> function initializes a data structure for the specified pen, brush, font, and so on.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>SetAttribute</B></TD>
<TD width=52%>The <B>SetAttribute</B> function is not supported in the current release of Windows. It must be implemented as a stub function.</TD>
</TR>
</TABLE><BR>

<H4>Printer-Mode Functions</H4>

<P>The printer-mode functions display special dialog boxes. The following table briefly describes each function.</P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=48%>Function</TH>
<TH align=left width=52%>Description</TH>
</TR>

<TR VALIGN="top">
<TD width=48%>DeviceMode</TD>
<TD width=52%>The <B>DeviceMode</B> function displays a dialog box that allows a user to select printer options such as paper size, paper orientation, output quality, and so on.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>ExtDeviceMode</TD>
<TD width=52%>The <B>ExtDeviceMode</B> function also displays a dialog box that allows a user to select printer options such as paper size, paper orientation, output quality, and so on. Printer drivers written for Windows 3.x and later versions support this function.</TD>
</TR>
</TABLE><BR>

<H4>Printer-Escape Functions</H4>

<P>The printer-escape functions support device-specific operations. The following table briefly describes these functions.</P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=48%>Function</TH>
<TH align=left width=52%>Description</TH>
</TR>

<TR VALIGN="top">
<TD width=48%><B>AbortDoc</B></TD>
<TD width=52%>The <B>AbortDoc</B> escape function signals the abnormal cancellation of a print job.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>BandInfo</B></TD>
<TD width=52%>The <B>BandInfo</B> escape function returns information about a band of bitmap data.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>EndDoc</B></TD>
<TD width=52%>The <B>EndDoc</B> escape function signals the end of a print job.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>NextBand</B></TD>
<TD width=52%>The <B>NextBand</B> escape function prints a band of bitmap data.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>QueryEscSupport</B></TD>
<TD width=52%>The <B>QueryEscSupport</B> escape function specifies whether the driver supports a specified escape.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>SetAbortDoc</B></TD>
<TD width=52%>The <B>SetAbortDoc</B> escape function calls an application's cancellation procedure.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>StartDoc</B></TD>
<TD width=52%>The <B>StartDoc</B> escape function signals the beginning of a print job.</TD>
</TR>
</TABLE><BR>

<P>The previous list of printer escapes is a list of escapes supported by the Microsoft Windows Universal Printer Driver (UNIDRV.DLL). It is not a comprehensive list of all Windows escape functions. Most of the escape functions now have equivalent Windows API functions with Windows 3.1. The escapes are supported for backward compatibility, but application developers are encouraged to start using the new API calls.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Required%20Printer%20Driver%20Functions"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
