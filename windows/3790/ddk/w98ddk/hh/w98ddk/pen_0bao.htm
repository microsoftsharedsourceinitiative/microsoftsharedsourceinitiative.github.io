<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Pen Device Support Components</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_3440"></A>Pen Device Support Components</H1>

<P>The Windows pen device driver supports digitizing pen hardware from various manufacturers, and is a Unidriver. The pen calibration application enables the user to calibrate a digitizer by touching targets on the digitizer; the calibration information obtained is used by the driver in reporting pen position coordinates to Windows. The executable pen device support components are listed in the following table. </P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=33%>Component </TH>
<TH align=left width=33%>Filename </TH>
<TH align=left width=34%>Description </TH>
</TR>

<TR VALIGN="top">
<TD width=33%>Virtual device driver, VxD </TD>
<TD width=33%>VPENDC.VXD </TD>
<TD width=34%>Part of the pen Unidriver. A 32-bit virtual device driver with ring 0 privilege. Contains the pen device interrupt service routine. </TD>
</TR>

<TR VALIGN="top">
<TD width=33%>Pen driver </TD>
<TD width=33%>PENC.DRV </TD>
<TD width=34%>Part of the pen Unidriver. A 16-bit installable device driver with ring 3 privilege. Handles messages from the Pen Services for Windows 95 system component (PENWIN.DLL) and other clients. </TD>
</TR>

<TR VALIGN="top">
<TD width=33%>Pen driver interface </TD>
<TD width=33%>PENUI.DLL </TD>
<TD width=34%>Part of the pen Unidriver. Provides a user interface for configuring the pen Unidriver. </TD>
</TR>

<TR VALIGN="top">
<TD width=33%>Pen calibration application </TD>
<TD width=33%>PENCAL.DLL </TD>
<TD width=34%>An application that extends the capability of the Pen icon in the Windows 95 Control Panel by providing a user interface for calibrating the pen device. </TD>
</TR>
</TABLE><BR>

<P>The terms <I>pen Unidriver</I> and <I>pen device driver</I> describe the combination of all three components. <I>Pen system</I> refers to the pen services of Microsoft Windows 95 provided by the PENWIN.DLL library. </P>

<P>After the Microsoft Windows 95 Device Driver Kit (DDK) is installed, the source code for the sample pen Unidriver components are in sub directories under the directory \PEN\SAMPLES. The virtual pen driver source code is in the \PEN\SAMPLES\VPEND sub directory, the pen driver source code is in the \PEN\SAMPLES\PEN sub directory, the pen driver interface source code is in the \PEN\SAMPLES\PENUI subdirectory, and the calibration application source code is in the \PEN\SAMPLES\PENCAL sub directory. The common header files for all the components are in \PEN\INC. </P>

<P>The Unidriver architecture allows the original equipment manufacturer (OEM) to quickly create a custom pen device driver tailored for a specific device. The OEM developer need only remove unnecessary portions from the code and optionally modify or enhance other portions. </P>

<P>Regardless of the pen driver an OEM develops, the OEM must ensure that its hardware supports the documented procedures of the pen Unidriver. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Pen%20Device%20Support%20Components"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
