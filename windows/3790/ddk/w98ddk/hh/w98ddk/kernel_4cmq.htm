<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>SHELL_GetVMInfo</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_2092"></A>SHELL_GetVMInfo</H1>

<PRE>include shell.inc
mov ebx, Handle   ; virtual machine handle
VxDcall SHELL_GetVMInfo

mov [hwnd], dx    ; WinOldAp window handle for VM
mov [Flags], eax  ; flags for virtual machine 
 </PRE>

<P>Retrieves PIF information settings for a virtual machine. This service is only available for Windows version 3.1 and later. Uses EAX, ECX, EDI, EDX, ESI, and Flags. 

<UL>
	<LI>Sets the DX register to the handle of the WinOldAp window corresponding to the VM and sets the EAX register to one or more of these flag values: </LI>
</UL>

<TABLE>

<TR VALIGN="top">
<TD width=35%>SGVMI_ALTENTERdis </TD>
<TD width=65%>ALT+ENTER is reserved. </TD>
</TR>

<TR VALIGN="top">
<TD width=35%>SGVMI_ALTESCdis </TD>
<TD width=65%>ALT+ESC is reserved. </TD>
</TR>

<TR VALIGN="top">
<TD width=35%>SGVMI_ALTPRTSCdis </TD>
<TD width=65%>ALT+PRTSC is reserved. </TD>
</TR>

<TR VALIGN="top">
<TD width=35%>SGVMI_ALTSPACEdis </TD>
<TD width=65%>ALT+SPACEBAR is reserved. </TD>
</TR>

<TR VALIGN="top">
<TD width=35%>SGVMI_ALTTABdis </TD>
<TD width=65%>ALT+TAB is reserved. </TD>
</TR>

<TR VALIGN="top">
<TD width=35%>SGVMI_ClsExit </TD>
<TD width=65%>Close on exit enabled. </TD>
</TR>

<TR VALIGN="top">
<TD width=35%>SGVMI_CTRLESCdis </TD>
<TD width=65%>CTRL+ESC is reserved. </TD>
</TR>

<TR VALIGN="top">
<TD width=35%>SGVMI_EMS_Lock </TD>
<TD width=65%>EMS hands locked. </TD>
</TR>

<TR VALIGN="top">
<TD width=35%>SGVMI_FastPaste </TD>
<TD width=65%>Allow fast paste enabled. </TD>
</TR>

<TR VALIGN="top">
<TD width=35%>SGVMI_HasHotKey </TD>
<TD width=65%>Has a shortcut key. </TD>
</TR>

<TR VALIGN="top">
<TD width=35%>SGVMI_NoHMA </TD>
<TD width=65%>No HMA. </TD>
</TR>

<TR VALIGN="top">
<TD width=35%>SGVMI_Polling </TD>
<TD width=65%>Polling detection enabled. </TD>
</TR>

<TR VALIGN="top">
<TD width=35%>SGVMI_PRTSCdis </TD>
<TD width=65%>PRTSC is reserved. </TD>
</TR>

<TR VALIGN="top">
<TD width=35%>SGVMI_V86_Lock </TD>
<TD width=65%>V86 memory locked. </TD>
</TR>

<TR VALIGN="top">
<TD width=35%>SGVMI_Windowed </TD>
<TD width=65%>The virtual machine runs in a window. </TD>
</TR>

<TR VALIGN="top">
<TD width=35%>SGVMI_XMS_Lock </TD>
<TD width=65%>XMS hands locked. </TD>
</TR>
</TABLE><BR>

<P>The undefined bits in the EAX register are reserved. Do not depend on them being zero. The high 16 bits of the EDX register are reserved. 

<DL>
<DT><I>Handle</I> </DT>

<DD>Handle of the virtual machine to examine. 
</DD>
</DL>

<P>This service is not valid until after all virtual devices have processed the <B>Create_VM</B> message. This service if called during a <B>Create_VM</B> message will not return proper PIF information. The ECX, EDX, ESI, and EDI register contents are reserved. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: SHELL_GetVMInfo"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
