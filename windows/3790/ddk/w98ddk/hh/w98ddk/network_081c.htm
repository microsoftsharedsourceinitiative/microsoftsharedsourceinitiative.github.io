<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Navigating Up from an Enumeration</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="_pss_3320"></A>Navigating Up from an Enumeration</H2>

<P>The enumeration tree can be navigated down from a resource by opening an enumeration upon a resource, as described above. To enumerate up from a resource, the <B>NPGetResourceInformation</B> function is called to obtain information about the resource, followed by the <B>NPGetResourceParent</B> function described below to obtain the name and type of the parents. </P>

<P><B>NPNetGetResourceInformation</B> should determine if the resource actually is for the network, although it may not be currently accessible or fully valid. </P>

<P>For example: if the resource is \\<I>server</I>\<I>share</I> and <I>dwType</I> specifies a disk, then the provider should ensure that the server <I>server</I> exists on the network, but does not have to validate <I>share</I>. If the resource is \\<I>server</I>\<I>share</I> and <I>dwType</I> is not specified The function should not do purely syntactical checking as this will produce incorrect results when two networks are running on the client and the provider doing syntactic checking is called first. </P>

<P><B>NPGetResourceParent</B> is typically called for names that were returned by the same NP from a call to <B>NPEnumResource</B>. However, the NP implementation should not assume that the name passed in is valid or references an existing network resource. If the resource syntactically has a parent, then this can be returned, whether or not the parent actually exists. The <I>lpProvider</I> field is filled in by the provider to indicate which behavior the provider is exhibiting. Note, however, the special case where the parent object is the network, where syntactic checking should be avoided if some checking (such as service advertising) can be done to correctly determine the provider. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Navigating%20Up%20from%20an%20Enumeration"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
