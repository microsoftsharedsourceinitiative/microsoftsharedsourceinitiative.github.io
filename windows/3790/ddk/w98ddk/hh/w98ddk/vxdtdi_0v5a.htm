<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>TdiQueryInformation</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_vxdtdi_tdiqueryinformation"></A>TdiQueryInformation</H1>

<P>The <B>TdiQueryInformation</B> function is called through the <B>TdiQueryInformationEntry</B> pointer in the <B>TdiDispatchTable</B> structure. </P>

<PRE class=syntax><B>TDI_STATUS
  TdiQueryInformation( PTDI_REQUEST Request, 
    uint  </B><I>QueryType</I><B>, </B>
<B>    PNDIS_BUFFER  </B><I>Buffer</I><B>, </B>
<B>    uint  *</B><I>BufferSize</I><B>, </B>
<B>    uint  </B><I>IsConn</I>
<B>    );</B></PRE>

<H4>Parameters</H4>

<DL>
<DT><I>QueryType</I> </DT>

<DD>Indicates which information is being queried. The following values are supported.

<TABLE>

<TR VALIGN="top">
<TH align=left width=48%>Value</TH>
<TH align=left width=52%>Description</TH>
</TR>

<TR VALIGN="top">
<TD width=48%>TDI_QUERY_PROVIDER_INFO</TD>
<TD width=52%>Queries the transport about provider information. A structure of type <B>TDI_PROVIDER_INFO</B> (see TDI.H) will be copied into the buffer chain pointed to by <I>Buffer</I>.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>TDI_QUERY_ADDRESS_INFO</TD>
<TD width=52%>Queries the transport about the local transport of an address object or connection. The query is for a connection if <I>IsConn</I> is TRUE (nonzero), and for an address object if <I>IsConn</I> is FALSE (zero). The address object or connection being queried is specified by Request-&gt;<I>Handle</I>. A structure of type <B>TDI_ADDRESS_INFO</B> (see TDI.H) will be copied into the buffer chain pointed to by <I>Buffer</I>.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>TDI_QUERY_CONNECTION_INFO</TD>
<TD width=52%>Queries MSTCP for information about the connection identified by Request-&gt;Handle.<I>ConnectionContext</I>. A structure of type <B>TDI_CONNECTION_INFO</B> (see TDI.H) will be copied into the buffer chain pointed to by <I>Buffer</I>.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>TDI_QUERY_PROVIDER_STATISTICS</TD>
<TD width=52%>Queries the transport for certain statistics. Not all the defined statistics are kept by MSTCP. A structure of type <B>TDI_PROVIDER_STATISTICS</B> (see TDI.H) will be copied into the buffer chain pointed to by <I>Buffer.</I></TD>
</TR>
</TABLE><BR>


</DD>

<DT><I>Buffer</I> </DT>

<DD>Points to an <B>NDIS_BUFFER</B> chain into which the information is copied.</DD>

<DT><I>BufferSize</I> </DT>

<DD>Points to the size of the input buffer chain in bytes. On return, <I>BufferSize</I> is set to the size of the information copied into <I>Buffer</I>. If the <B>NDIS_BUFFER</B> chain pointed to by <I>Buffer</I> is too small to contain the requested data, only the amount that fits is copied and TDI_BUFFER_OVERFLOW is returned.</DD>

<DT><I>IsConn</I> </DT>

<DD>Boolean used to provide additional information for the TDI_QUERY_ADDRESS_INFO call. If <I>IsConn</I> is nonzero, than information about a connection is returned. If <I>IsConn</I> is zero, information about an address object is returned.
</DD>
</DL>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: TdiQueryInformation"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
