<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>FS_FileDateTime</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="_pss_4380"></A>FS_FileDateTime</H3>

<PRE>FS_FileDateTime(
 PIOREQ pir
 )
 </PRE>

<P>The file modification date and time is set and retrieved through <B>FS_FileDateTime</B>. This routine handles the INT 21h function: 57h. 

<DL>
<DT><I>ir_rh</I> </DT>

<DD>Supplies handle to disk volume or network resource that contains the file. </DD>

<DT><I>ir_fh</I> </DT>

<DD>Supplies FSD file handle. </DD>

<DT><I>ir_sfn</I> </DT>

<DD>Supplies system file number. </DD>

<DT><I>ir_flags</I> </DT>

<DD>Supplies desired command type to perform. 

<TABLE>

<TR VALIGN="top">
<TD width=34%><B>Command Type Values:</B> 
<P>One of the following types will be specified. </P>
</TD>
<TD width=66%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TH align=left width=34%>Value </TH>
<TH align=left width=66%>Meaning </TH>
</TR>

<TR VALIGN="top">
<TD width=34%>GET_MODIFY_DATETIME </TD>
<TD width=66%>Get the file modification date and time. </TD>
</TR>

<TR VALIGN="top">
<TD width=34%>SET_MODIFY_DATETIME </TD>
<TD width=66%>Set the file modification date and time. </TD>
</TR>

<TR VALIGN="top">
<TD width=34%>GET_LAST_ACCESS_DATETIME </TD>
<TD width=66%>Get the last access date and time for the file. </TD>
</TR>

<TR VALIGN="top">
<TD width=34%>SET_LAST_ACCESS_DATETIME </TD>
<TD width=66%>Set the last access date and time for the file. </TD>
</TR>

<TR VALIGN="top">
<TD width=34%>GET_CREATION_DATE_TIME </TD>
<TD width=66%>Get the creation date and time for the file. </TD>
</TR>

<TR VALIGN="top">
<TD width=34%>SET_CREATION_DATE_TIME </TD>
<TD width=66%>Set the creation date and time for the file. </TD>
</TR>
</TABLE><BR>

</DD>

<DT><I>ir_dostime</I> </DT>

<DD>Supplies new date and time for file on all the set commands. The date and time is in DOS format. For SET_LAST_ACCESS_DATETIME, the time field may be zero indicating that last access time is not supported. </DD>

<DT><I>ir_options</I> </DT>

<DD>Supplies the 10 millisecond intervals for additional precision for the creation time. This field is valid only on the SET_CREATION_DATE_TIME command. </DD>

<DT><I>ir_user</I> </DT>

<DD>Supplies user ID for this request. </DD>

<DT><I>ir_pid</I> </DT>

<DD>Supplies process ID for this request. 

<TABLE>

<TR VALIGN="top">
<TD width=34%><I>ir_error</I> </TD>
<TD width=66%>Returns status of the operation (zero  if no error, the error code otherwise). </TD>
</TR>

<TR VALIGN="top">
<TD width=34%><I>ir_dostime</I> </TD>
<TD width=66%>Returns current file date and time on all the get commands. The date and time is in DOS format. For GET_LAST_ACCESS_DATETIME, if only the date is supported, the time field should be set to zero. </TD>
</TR>

<TR VALIGN="top">
<TD width=34%><I>ir_options</I> </TD>
<TD width=66%>Returns the 10 millisecond interval on the GET_CREATION_DATE_TIME. </TD>
</TR>
</TABLE><BR>


</DD>
</DL>

<P>Any fields that are not supported will have an input value if zero. If the FSD does not support any of the date and time fields it should return zero and not fail the call. The creation time has additional precision over the normal DOS time of 2-second intervals - it gives a precision up to 10 milliseconds, the new parameter specifying the number of 10 millisecond intervals beyond the 2 second precision already stored in the DOS time. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: FS_FileDateTime"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
