<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>ImeToAsciiEx</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_999"></A>ImeToAsciiEx</H1>

<PRE>UINT ImeToAsciiEx(UINT uVirKey, UINT uScanCode, 
    CONST LPBYTE lpbKeyState, LPDWORD lpdwTransBuf, UINT fuState, 
    HIMC hIMC)
 </PRE>

<P>Translates messages using the IME conversion engine associated with the given input context. </P>

<P>The return value is the number of messages. If the number is greater than the length of the translated message buffer, the translated message buffer is not large enough. The system looks into the <B>hMsgBuf</B> to get the translation messages. </P>

<DL>
<DT><I>uVirKey</I> </DT>

<DD>Virtual key code to be translated. When the property bit IME_PROP_KBD_CHAR_FIRST is on, the upper byte of the virtual key is the aid character code. </DD>

<DT><I>uScanCode</I> </DT>

<DD>Hardware scan code of the key to be translated. </DD>

<DT><I>lpbKeyState</I> </DT>

<DD>Address of a 256-byte array that contains the current keyboard state. The IME should not modify the keyboard state. </DD>

<DT><I>lpdwTransBuf</I> </DT>

<DD>Address of a double word buffer to receive the translated result. The format is [Length of the pass in translated message buffer] [Message1] [wParam1] [lParam1] {[Message2] [wParam2] [lParam2]{...{...{...}}}}. </DD>

<DT><I>fuState</I> </DT>

<DD>Active menu flag. </DD>

<DT><I>hIMC</I> </DT>

<DD>Handle of the input context. 
</DD>
</DL>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: ImeToAsciiEx"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
