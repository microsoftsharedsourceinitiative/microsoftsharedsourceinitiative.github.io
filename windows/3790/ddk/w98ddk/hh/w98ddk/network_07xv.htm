<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>NETCONNECTINFOSTRUCT</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_3303"></A>NETCONNECTINFOSTRUCT</H1>

<PRE>typedef struct _NETCONNECTINFOSTRUCT {
  DWORD cbStructure;
  DWORD dwFlags;
  DWORD dwSpeed;  
  DWORD dwDelay;
  DWORD dwOptDataSize;
} NETCONNECTINFOSTRUCT. *LPNETCONNECTINFOSTRUCT;
 </PRE>

<DL>
<DT><I>cbStructure</I> </DT>

<DD>The size of the <B>NETCONNECTINFOSTRUCT </B>structure in bytes. This is filled in by the caller to indicate the size of the structure passed in. The NP should leave this field unchanged, and can assume that the structure is large enough to contain all fields up to and including <I>dwOptDataSize</I>. </DD>

<DT><I>dwFlags</I> </DT>

<DD>This is a bit mask, which may have any of the following bits set: 

<TABLE>

<TR VALIGN="top">
<TD width=43%>WNCON_FORNETCARD </TD>
<TD width=57%>If set, information is being returned for the performance of the network card being used for the connection, in the absence of having information about the actual connection. If clear, information is being returned for the current connection with the resource, with any routing degradation being taken into consideration. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WNCON_NOTROUTED </TD>
<TD width=57%>If clear, the connection may be going through routers that limit performance. Consequently, if WNCON_FORNETCARD is set, actual performance may be much less than the information returned. If WNCON_NOTROUTED is set, the connection is not being routed. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WNCON_SLOWLINK </TD>
<TD width=57%>If set, the connection is known at some point to be over a medium that is typically slow (such as a modem using a normal quality phone line). Providers that return a value in <I>dwSpeed</I> do not have to set this bit. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WNCON_DYNAMIC </TD>
<TD width=57%>If set, some of the information being returned is being dynamically recalculated, and reissuing this request upon the connection may return different, more current, information. </TD>
</TR>
</TABLE><BR>

</DD>

<DT><I>dwSpeed</I> </DT>

<DD>The speed of the media to the network resource in units of 100 bps (for example, a 1,200 baud point to point link returns 12). </DD>

<DT><I>dwDelay</I> </DT>

<DD>The delay introduced by the network when sending information (the time between starting sending data and the time that it starts being received) in units of a millisecond. This is in addition to any latency that was incorporated into the calculation of <I>dwSpeed</I>, so the value returned will be 0 for accessing most resources. </DD>

<DT><I>dwOptDataSize</I> </DT>

<DD>A recommendation for the size of data in bytes that is most efficiently sent through the network when an application makes a single request to the network resource. For example, for a disk network resource, this value might be 2048 or 512 when writing a block of data. 
</DD>
</DL>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: NETCONNECTINFOSTRUCT"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
