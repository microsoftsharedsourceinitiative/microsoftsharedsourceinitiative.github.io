<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>IFSMgr_GetLockState</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="_pss_4524"></A>IFSMgr_GetLockState</H3>

<PRE>IFSMgr_GetLockState(
 unsigned long Drive,
 unsigned long * pLockType,
 unsigned long * pLockFlags,
 unsigned long * pLockOwner
 )
 </PRE>

<P>This service returns information about volume locks on a given drive. 

<DL>
<DT><I>Drive</I> </DT>

<DD>Supplies the zero-based drive number to query the volume lock information for. </DD>

<DT><I>pLockType</I> </DT>

<DD>Supplies a pointer to the variable to contain the type of volume lock in effect. </DD>

<DT><I>pLockFlags</I> </DT>

<DD>Supplies a pointer to the variable to contain flags for the volume lock in effect. </DD>

<DT><I>pLockOwner</I> </DT>

<DD>Supplies a pointer to the variable to contain the process ID of the process owning the volume lock. </DD>
</DL>

<UL>
	<LI>Returns zero if success, error code if failure. </LI>
</UL>

<TABLE>

<TR VALIGN="top">
<TD width=43%><I>pLockType</I> </TD>
<TD width=57%>Returns the current lock level in effect. The lock level can take on the values listed in the following. </TD>
</TR>
</TABLE><BR>

<TABLE>

<TR VALIGN="top">
<TD width=34%><B>Lock Type Values:</B> </TD>
<TD width=66%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TH align=left width=34%>Value </TH>
<TH align=left width=66%>Meaning </TH>
</TR>

<TR VALIGN="top">
<TD width=34%><B>-1</B> </TD>
<TD width=66%>This indicates that no lock is currently in effect. </TD>
</TR>

<TR VALIGN="top">
<TD width=34%><B>0</B> </TD>
<TD width=66%>This indicates that a Level 0 lock is currently in effect. </TD>
</TR>

<TR VALIGN="top">
<TD width=34%><B>1</B> </TD>
<TD width=66%>This indicates that a Level 1 lock is currently in effect. </TD>
</TR>

<TR VALIGN="top">
<TD width=34%><B>2</B> </TD>
<TD width=66%>This indicates that a Level 2 lock is currently in effect. </TD>
</TR>

<TR VALIGN="top">
<TD width=34%><B>3</B> </TD>
<TD width=66%>This indicates that a Level 3 lock is currently in effect. </TD>
</TR>
</TABLE><BR>

<TABLE>

<TR VALIGN="top">
<TD width=34%><I>pLockFlags</I> </TD>
<TD width=66%>Returns flags operative for the current lock level, if any. </TD>
</TR>
</TABLE><BR>

<TABLE>

<TR VALIGN="top">
<TD width=34%><B>Lock Flag Values:</B> </TD>
<TD width=66%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TH align=left width=34%>Value </TH>
<TH align=left width=66%>Meaning </TH>
</TR>

<TR VALIGN="top">
<TD width=34%>LOCKP_ALLOW_WRITES </TD>
<TD width=66%>Indicates that the volume lock taken allows writes to happen while it is in effect. If this flag is not set and a volume lock is in effect, the volume lock does not allow writes to happen. This flag is not valid for a Level 0 lock, it is valid on all other lock levels. </TD>
</TR>

<TR VALIGN="top">
<TD width=34%>LOCKP_FAIL_MEM_MAPPING </TD>
<TD width=66%>Indicates that memory-mapping operations cannot be done while the volume lock is effect. If this flag is not set and a volume lock is in effect, memory-mappings are allowed while the volume lock is operative. This flag is not valid for a Level 0 lock, it is valid on all other lock levels. </TD>
</TR>

<TR VALIGN="top">
<TD width=34%>LOCKP_LOCK_FOR_FORMAT </TD>
<TD width=66%>Indicates that the volume is locked for a format operation. This flag is valid only when the lock level is 0. If this flag is not and a Level 0 lock is in effect, the volume is not locked for formatting. </TD>
</TR>
</TABLE><BR>

<TABLE>

<TR VALIGN="top">
<TD width=34%><I>pLockOwner</I> </TD>
<TD width=66%>Returns the process ID of the process owning the lock. Note that this is an internally generated process ID and does not refer to any specific data structure. It is purely to be used for identification purposes without any interpretations done on it. </TD>
</TR>
</TABLE><BR>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: IFSMgr_GetLockState"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
