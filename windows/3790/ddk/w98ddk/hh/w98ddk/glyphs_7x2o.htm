<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>EngineGetGlyphBmp</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="EngineGetGlyphBmp">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_glyphs_enginegetglyphbmp"></A>EngineGetGlyphBmp</H1>

<P>The <B>EngineGetGlyphBmp</B> function retrieves a bitmap for the glyph specified by the given character and font.</P>

<PRE class=syntax><B>WORD
  EngineGetGlyphBmp(
</B>    <B>LPPDEVICE</B> <I>lpDestDev,</I>
    <B>LPFONTINFO</B> <I>lpFont,</I>
    <B>WORD</B> <I>ch,</I>
    <B>WORD</B> <I>wQueryType,</I>
    <B>LPSTR</B> <I>lpBits,</I>
    <B>DWORD</B> <I>dwSizeBmp,</I>
    <B>LPBITMAPMETRICS</B> <I>lpbmm</I>
<B>    );</B></PRE>

<H4>Parameters</H4>

<DL>
<DT><I>lpDestDev</I> </DT>

<DD>Points to a PDEVICE or PBITMAP structure specifying the device or bitmap for which the physical object is created.</DD>

<DT><I>lpFont</I></DT>

<DD>Points to a FONTINFO structure specifying the font containing the glyph. This structure must have been previously filled using the <A HREF="glyphs_2bjo.htm"><B>EngineRealizeFont</B></A> function.</DD>

<DT><I>ch</I></DT>

<DD>Specifies the character value of the glyph to retrieve. </DD>

<DT><I>wQueryType</I></DT>

<DD>Specifies whether to retrieve the glyph as a bitmap. This parameter can be one of the following values.

<TABLE>

<TR VALIGN="top">
<TH align=left width=48%>Value</TH>
<TH align=left width=52%>Description</TH>
</TR>

<TR VALIGN="top">
<TD width=48%>FD_QUERY_CHARIMAGE</TD>
<TD width=52%>Retrieves bitmap. The bitmap is a monochrome bitmap with scan lines aligned on 32-bit boundaries. If the glyph bitmap is greater than 64k bytes, the scan lines may straddle segment boundaries. That is, this function does not attempt to align scan lines on segment boundaries. The width of the glyph may be less than the bitmap itself. If this is the case, any extra bits at the end of each scan line are undefined. </TD>
</TR>

<TR VALIGN="top">
<TD width=48%>FD_QUERY_BITMAPMETRICS</TD>
<TD width=52%>Retrieves bitmap metrics. </TD>
</TR>
</TABLE><BR>

</DD>

<DT><I>lpBits</I></DT>

<DD>Points to the buffer to receive the glyph bitmap. </DD>

<DT><I>dwSizeBmp</I></DT>

<DD>Specifies the size, in bytes, of the buffer to receive the glyph bitmap. If the bitmap is larger than the buffer, the function returns an error. </DD>

<DT><I>lpbmm</I></DT>

<DD>Points to a BITMAPMETRICS structure that receives the width, height, and position of the bitmap relative to the character origin. 
</DD>
</DL>

<H4>Return Value</H4>

<P>The <B>EngineGetGlyphBmp</B> function returns the actual number of bytes copied to the buffer. If an error occurs or the buffer is too small, the function returns zero.</P>

<H4>Comments</H4>

<P>The given font (specified by <I>lpFont</I>) must be the current engine font. That is, it must have been previously set using the <A HREF="glyphs_6gac.htm"><B>EngineSetFontContext</B></A> function.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: EngineGetGlyphBmp"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
