<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>NPGetHomeDirectory</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_3330"></A>NPGetHomeDirectory</H1>

<P>This function is used to determine the home or personal directory associated with a user's account on a given network. Since the user's home directory is a typical place to store their User Profile (per-user registry settings), the directory should be one which the user (and network administrators) can write to, but which other users cannot write to. </P>

<PRE>DWORD NPGetHomeDirectory(
  LPTSTR lpDirectory,
  LPDWORD lpBufferSize
  );
 </PRE>

<DL>
<DT><I>lpDirectory</I> </DT>

<DD>Points to a buffer to receive the directory path. This will be either in UNC or drive-relative form, whichever is supported by the network. </DD>

<DT><I>lpBufferSize</I> </DT>

<DD>This is used to specify the size of the buffer passed in. If the call fails because the buffer is not big enough, this location is used to return the required buffer size. </DD>
</DL>

<UL>
	<LI>WN_SUCCESS if the call is successful. Otherwise, <B>GetLastError</B> should be called for extended error information. </LI>
</UL>

<TABLE>

<TR VALIGN="top">
<TD width=43%>WN_NOT_LOGGED_ON </TD>
<TD width=57%>The user is not logged on to this network. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WN_NOT_SUPPORTED </TD>
<TD width=57%>The network does not support home directories, or the user does not have a home directory. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WN_MORE_DATA </TD>
<TD width=57%>The buffer is too small. </TD>
</TR>
</TABLE><BR>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: NPGetHomeDirectory"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
