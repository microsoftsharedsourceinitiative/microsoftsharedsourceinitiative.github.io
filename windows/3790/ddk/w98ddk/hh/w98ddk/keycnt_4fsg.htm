<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>ANSI Characters</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="_pss_2190"></A>ANSI Characters</H2>

<P>Windows and Windows applications call the <B>ToAsciiEx</B> function to translate virtual-key codes to ANSI characters. The keyboard driver translate these key codes by checking the state of the virtual-shift keys (such as the VK_SHIFT, VK_CONTROL, and VK_MENU) and mapping the virtual-key code and shift state to the appropriate character. For example, on most U.S. keyboards if the VK_SHIFT key is up, the VK_2 virtual key code maps to the number 2 (ANSI 50); if VK_SHIFT is down, VK_2 maps to the at sign (@) (ANSI 64). For foreign-language keyboards, the keyboard also checks for a previously typed dead key before translating the virtual-key code. </P>

<P>Windows passes the address of the key-state array to the <B>ToAsciiEx</B> function, giving the keyboard driver access to the current state of all virtual keys including the shift keys. The key-state array also contains the shift state of the mouse buttons (that is, the corresponding virtual-key codes VK_LBUTTON, VK_RBUTTON, VK_CANCEL, and VK_MBUTTON). </P>

<P>The keyboard driver must provide keyboard layouts to map virtual keys to ANSI characters. Since the meaning of a virtual key depends on the state of the shift keys, the driver should provide layouts for each possible shift-key combination (for example, no shift key, VK_SHIFT, VK_CONTROL, and VK_MENU and VK_CONTROL combined). Windows does not require that all virtual keys map to ANSI characters for all shift-key combinations. Therefore, not all keyboard layouts need to map the complete virtual-key set. </P>

<H4>See Also</H4>

<P><B>ToAsciiEx</B> </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: ANSI%20Characters"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
