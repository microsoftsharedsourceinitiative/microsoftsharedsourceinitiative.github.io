<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Return Values for Registry Services</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="_pss_1523"></A>Return Values for Registry Services</H2>

<P>The following list of error values is not comprehensive. It is included here to give you an idea of the kinds of errors to expect. Future versions of Windows may return new error codes, or return slightly different error codes under analogous circumstances. </P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=33%>Value </TH>
<TH align=left width=67%>Meaning </TH>
</TR>

<TR VALIGN="top">
<TD width=33%>ERROR_SUCCESS </TD>
<TD width=67%>The function was successful. </TD>
</TR>

<TR VALIGN="top">
<TD width=33%>ERROR_NO_MORE_ITEMS </TD>
<TD width=67%>There are no more keys or values to enumerate. </TD>
</TR>

<TR VALIGN="top">
<TD width=33%>ERROR_MORE_DATA </TD>
<TD width=67%>Passed in buffer is not large enough to hold the entire value. </TD>
</TR>

<TR VALIGN="top">
<TD width=33%>ERROR_FILE_NOT_FOUND </TD>
<TD width=67%>The specified key was not found in the registry database. </TD>
</TR>

<TR VALIGN="top">
<TD width=33%>ERROR_KEY_DELETED </TD>
<TD width=67%>HKEY passed to service has been deleted since it was opened. </TD>
</TR>

<TR VALIGN="top">
<TD width=33%>ERROR_CANTOPEN ERROR_CANTREAD </TD>
<TD width=67%>Aliases of ERROR_FILE_NOT_FOUND for 16 bit code. </TD>
</TR>

<TR VALIGN="top">
<TD width=33%>ERROR_ACCESS_DENIED </TD>
<TD width=67%>Attempt to write to a key for which code does not have write access. </TD>
</TR>

<TR VALIGN="top">
<TD width=33%>ERROR_OUTOFMEMORY </TD>
<TD width=67%>Insufficient memory to open the registry key or insufficient memory to load the required data from the registry file. </TD>
</TR>
</TABLE><BR>

<P>The following may be returned when calling the registry services incorrectly: </P>

<TABLE>

<TR VALIGN="top">
<TD width=33%>ERROR_BADKEY </TD>
<TD width=67%>The subkey string contains an invalid character or the handle identifying the key is invalid. </TD>
</TR>

<TR VALIGN="top">
<TD width=33%>ERROR_LOCK_FAILED </TD>
<TD width=67%>Registry reentered while blocked by same process. </TD>
</TR>

<TR VALIGN="top">
<TD width=33%>ERROR_INVALID_PARAMETER </TD>
<TD width=67%>Parameter is required and not specified, an invalid pointer or otherwise not valid. </TD>
</TR>
</TABLE><BR>

<P>The following indicate a system problem. The system contains procedures for recovering from these errors, mostly involving rebooting: </P>

<TABLE>

<TR VALIGN="top">
<TD width=33%>ERROR_BADDB ERROR_REGISTRY_CORRUPT </TD>
<TD width=67%>Registry data structures corrupt. </TD>
</TR>

<TR VALIGN="top">
<TD width=33%>ERROR_REGISTRY_IO_FAILED </TD>
<TD width=67%>The registry file cannot be found or it was already opened by another application. A full disk or problem reading or writing to the disk may also cause this error. </TD>
</TR>
</TABLE><BR>

<P>When an HKEY is specified as an input parameter, it must be an HKEY returned from one of the registry services or one of the following predefined keys: </P>

<TABLE>

<TR VALIGN="top">
<TD width=89%>HKEY_CLASSES_ROOT </TD>
<TD width=11%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=89%>HKEY_CURRENT_USER </TD>
<TD width=11%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=89%>HKEY_LOCAL_MACHINE </TD>
<TD width=11%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=89%>HKEY_USERS </TD>
<TD width=11%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=89%>HKEY_CURRENT_CONFIG </TD>
<TD width=11%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=89%>HKEY_DYN_DATA </TD>
<TD width=11%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P>Of the predefined key values, only HKEY_LOCAL_MACHINE and HKEY_DYN_DATA are available to VxDs during initialization time. The entire registry space can only be accessed after VxD initialization is complete. </P>

<P>The key names are in OEM character set with some variations. Prior to completion of VxD initialization, all key names referenced must not contain any characters in the extended character set (character whose value is greater than 127). After VxD initialization, the entire character set is available. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Return%20Values%20for%20Registry%20Services"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
