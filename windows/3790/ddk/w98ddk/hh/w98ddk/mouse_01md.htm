<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Cursor Callback Function</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="_pss_3105"></A>Cursor Callback Function</H2>

<P>A cursor VxD must register itself with VMOUSE. This provides VMOUSE with information about the VxD, including the address of the VxD's cursor callback function. VMOUSE calls the VxD's callback function whenever an event occurs in the system that affects the appearance or position of the cursor. VMOUSE also calls the callback function to retrieve information about the cursor support provided by the VxD. Although the cursor callback function can have any name, the name <B>CursorProc</B> is used for convenience throughout this section. </P>

<P>Every cursor VxD must provide a set of 12 functions. VMOUSE directs the VxD to perform a function.by calling the <B>CursorProc</B> function, passing the identifier of the function in the EAX register. VMOUSE also passes the handle of the current VM in the EBX register. The contents of the other registers depend on the function, as does the return value. The remaining sections of this section describe the required functions. </P>

<P>A cursor VxD registers itself in response to the Device_Init message sent by the virtual machine manager (VMM) during VxD initialization. The VxD fills a <B>CURSORPROCINFO </B>structure and passes the address of the structure to VMOUSE by using the <B>VMD_Set_Cursor_Proc</B> service. VMOUSE stores the information provided in the <B>CURSORPROCINFO</B> structure. </P>

<P>See also <B>CursorProc</B>, <B>CURSORPROCINFO</B>, <B>VMD_Set_Cursor_Proc</B> </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Cursor%20Callback%20Function"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
