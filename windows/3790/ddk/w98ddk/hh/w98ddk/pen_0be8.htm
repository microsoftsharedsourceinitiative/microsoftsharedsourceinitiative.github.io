<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Required Pen Driver Messages</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="_pss_3460"></A>Required Pen Driver Messages</H2>

<P>The pen driver must support a minimum set of required messages, which are listed in the table below. </P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=41%>Message </TH>
<TH align=left width=59%>Description </TH>
</TR>

<TR VALIGN="top">
<TD width=41%>DRV_CLOSE </TD>
<TD width=59%>Sent by the <B>CloseDriver</B> Windows function to close the driver. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>DRV_CONFIGURE </TD>
<TD width=59%>Requests the driver to display its configuration dialog box. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>DRV_DISABLE </TD>
<TD width=59%>Sent when the system unloads the pen driver. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>DRV_ENABLE </TD>
<TD width=59%>Sent when the system loads the pen driver. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>DRV_FREE </TD>
<TD width=59%>Sent when the system unloads the pen driver. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>DRV_INSTALL </TD>
<TD width=59%>Informs the pen driver it should install itself on the system. The driver records the information the system needs at startup so that the next time Windows starts, the pen driver will be loaded. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>DRV_LOAD </TD>
<TD width=59%>Sent to the pen driver when it is first loaded. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>DRV_OPEN </TD>
<TD width=59%>Sent from the <B>OpenDriver</B> Windows function. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>DRV_QUERYCONFIGURE </TD>
<TD width=59%>Checks if the driver provides a configuration dialog box. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>DRV_REMOVE </TD>
<TD width=59%>Informs the pen driver it should uninstall itself from the system. The driver removes the information it recorded at startup and the references that the system uses to load the driver. The next time Windows starts, the pen driver will not be loaded. </TD>
</TR>
</TABLE><BR>

<P>Note that a fully functioning pen driver also supports the DRV_SetEntryPoints and DRV_RemoveEntryPoints messages. However, the pen driver can be used like a mouse driver, updating the pen cursor location, without supporting these two messages. </P>

<P>The pen driver must handle the standard messages that are sent to any installable Windows driver. Many of these standard messages have a counterpart message with a reverse effect-DRV_CLOSE is the counterpart of DRV_OPEN, for example. The following sections briefly describe the effects of each of the standard message pairs. At the end of this section, a table lists all the DRV_ messages recognized by the pen driver and gives a summary description of each message. For more complete descriptions of each of these required standard messages, see the "Reference" section. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Required%20Pen%20Driver%20Messages"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
