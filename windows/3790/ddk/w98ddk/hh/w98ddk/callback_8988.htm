<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>FilterGraphics Function Syntax</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="FilterGraphics Function Syntax">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="_mdag_filtergraphics_function_syntax"></A>FilterGraphics Function Syntax</H2>

<P>The FilterGraphics function has the following syntax:</P>

<PRE>short FAR PASCAL FilterGraphics(lpdv, lpBuf, len)
LPBYTE  lpdv;  /* points to private data required */
              /* by the Universal Printer Driver. */
LPSTR   lpBuf; /* points to buffer of graphics data. */
WORD    len;   /* length of buffer in bytes. */</PRE>

<P>The following list provides a brief description of the parameters.</P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=50%>Parameter</TH>
<TH align=left width=50%>Description</TH>
</TR>

<TR VALIGN="top">
<TD width=50%>lpdv</TD>
<TD width=50%>Points to private data required by the Universal Printer Driver. The FilterGraphics function passes this pointer as an argument to the CBFilterGraphics function which is exported by the Universal Printer Driver.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>lpBuf</TD>
<TD width=50%>Points to the len parameter (which contains the length of the buffer of graphics data in bytes).</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>len</TD>
<TD width=50%>Specifies the length of the buffer to which the lpBuf parameter points.</TD>
</TR>
</TABLE><BR>

<P>The return value specifies the number of bytes of processed data if the function is successful.</P>

<P>Prior to returning, the FilterGraphics function must call the WriteSpoolBuf function which is exported by the Universal Printer Driver. This function has the following syntax:</P>

<PRE>short FAR PASCAL WriteSpoolBuf(lpdv, lpNewBuf, newlen)
LPBYTE  lpdv;       /* points to private data. */
LPSTR   lpNewBuf;   /* points to buffer of altered graphics data. */
WORD    newlen;     /* length of buffer in bytes. */</PRE>

<P>The following list provides a brief description of each parameter.</P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=50%>Parameter</TH>
<TH align=left width=50%>Description</TH>
</TR>

<TR VALIGN="top">
<TD width=50%>lpdv</TD>
<TD width=50%>Points to private data which was originally supplied by the Universal Printer Driver.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>lpNewBuf</TD>
<TD width=50%>Points to the len parameter (which contains the length of the buffer of graphics data in bytes). This new graphics data was prepared by the FilterGraphics function.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>len</TD>
<TD width=50%>Specifies the length of the buffer to which the lpNewBuf parameter points.</TD>
</TR>
</TABLE><BR>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: FilterGraphics%20Function%20Syntax"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
