<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>AddJob</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_3935"></A>AddJob</H1>

<PRE>BOOL AddJob(
    HANDLE hPrinter,    /* handle of printer object          */
    DWORD cLevel,       /* data-structure level              */
    LPBYTE pData,       /* address of data-structure array   */
    DWORD cbBuf,        /* count of bytes in array           */
    LPDWORD pcbNeeded,  /* address of variable that contains */
                        /* count of bytes required           */
);
 </PRE>

<P>Returns the full path name of a file that can be used to store a print job. 

<UL>
	<LI>If the function succeeds, the return value is TRUE; otherwise, it is FALSE. To get extended error information, use the <B>GetLastError</B> function. </LI>
</UL>

<TABLE>

<TR VALIGN="top">
<TD width=24%><I>hPrinter</I> </TD>
<TD width=76%>Identifies the printer for which the print job is intended. </TD>
</TR>

<TR VALIGN="top">
<TD width=24%><I>cLevel</I> </TD>
<TD width=76%>Specifies the version of the structure to which <I>pData</I> points. The value of this parameter must be 1. </TD>
</TR>

<TR VALIGN="top">
<TD width=24%><I>pData</I> </TD>
<TD width=76%>Points to a<B>n ADDJOB_INFO_1</B> structure. </TD>
</TR>

<TR VALIGN="top">
<TD width=24%><I>cbBuf</I> </TD>
<TD width=76%>Specifies the size, in bytes, of the buffer pointed to by <I>pData</I>. </TD>
</TR>

<TR VALIGN="top">
<TD width=24%><I>pcbNeeded</I> </TD>
<TD width=76%>Points to a variable that will be updated with the number of bytes copied or the number of bytes required. If <I>cbBuf</I> is less than the required number of bytes, <I>pcbNeeded</I> specifies the number of bytes required; if <I>cbBuf</I> is large enough, <I>pcbNeeded</I> specifies the number of bytes copied. </TD>
</TR>
</TABLE><BR>

<P>The file name returned in the <B>ADDJOB_INFO_1</B> structure can be opened with the <B>CreateFile</B> function. Once the file is opened, data can be written to the file by calling the <B>WriteFile</B> function. </P>

<P>The job identifier returned in the <B>ADDJOB_INFO_1</B> structure can be passed to the <B>SetJob</B> and <B>ScheduleJob</B> functions in order to control the print job. </P>

<P>The <B>AddJob</B> and <B>ScheduleJob</B> functions are not currently required for basic printing, but should be supported if at all possible. Currently, Windows 95 uses <B>StartDocPrinter</B> and <B>EndDocPrinter</B> for job submission and scheduling. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: AddJob"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
