<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>MCI_GETDEVCAPS</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_2570"></A>MCI_GETDEVCAPS</H1>

<P>Used to obtain static information about a device. All devices must respond to this message. The parameters and flags available for this message depend on the selected device. Information is returned in the <B>dwReturn</B> member of the structure identified by <I>lpCapsParms</I>. 

<UL>
	<LI>Returns zero if successful. Otherwise, it returns an MCI error code. </LI>
</UL>

<DL>
<DT>DWORD <I>lParam1</I> </DT>

<DD>The following standard and command-specific flags apply to all devices: 

<TABLE>

<TR VALIGN="top">
<TD width=45%>MCI_NOTIFY </TD>
<TD width=55%>Specifies that MCI should post the <B>MM_MCINOTIFY</B> message when this command completes. The window to receive this message is specified in the <B>dwCallback</B> member of the structure identified by <I>lpCapsParms</I>. </TD>
</TR>

<TR VALIGN="top">
<TD width=45%>MCI_WAIT </TD>
<TD width=55%>Specifies that the query operation should finish before MCI returns control to the application. </TD>
</TR>

<TR VALIGN="top">
<TD width=45%>MCI_GETDEVCAPS_ITEM </TD>
<TD width=55%>Specifies that the <B>dwItem</B> member of the structure identified by <I>lpCapsParms</I> contains a constant specifying which device capability to obtain. The following constants define which capability to return in the <B>dwReturn</B> member of the structure: </TD>
</TR>

<TR VALIGN="top">
<TD width=45%>MCI_GETDEVCAPS_CAN_EJECT </TD>
<TD width=55%>The <B>dwReturn</B> member is set to TRUE if the device can eject the media; otherwise, it is set to FALSE. </TD>
</TR>

<TR VALIGN="top">
<TD width=45%>MCI_GETDEVCAPS_CAN_PLAY </TD>
<TD width=55%>The <B>dwReturn</B> member is set to TRUE if the device can play the media; otherwise, it is set to FALSE. &lt;pIf a device specifies TRUE, it implies the device supports <B>MCI_PAUSE</B> and <B>MCI_STOP</B> as well as <B>MCI_PLAY</B>. </TD>
</TR>

<TR VALIGN="top">
<TD width=45%>MCI_GETDEVCAPS_CAN_RECORD </TD>
<TD width=55%>The <B>dwReturn</B> member is set to TRUE if the device supports recording; otherwise, it is set to FALSE. 
<P>If a device specifies TRUE, it implies the device supports <B>MCI_PAUSE</B> and <B>MCI_STOP</B> as well as <B>MCI_RECORD</B>. </P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=45%>MCI_GETDEVCAPS_CAN_SAVE </TD>
<TD width=55%>The <B>dwReturn</B> member is set to TRUE if the device can save a file; otherwise, it is set to FALSE. </TD>
</TR>

<TR VALIGN="top">
<TD width=45%>MCI_GETDEVCAPS_COMPOUND_DEVICE </TD>
<TD width=55%>The <B>dwReturn</B> member is set to TRUE if the device uses device elements; otherwise, it is set to FALSE. </TD>
</TR>

<TR VALIGN="top">
<TD width=45%>MCI_GETDEVCAPS_DEVICE_TYPE </TD>
<TD width=55%>The <B>dwReturn</B> member is set to one of the following values indicating the device type: </TD>
</TR>
</TABLE><BR>



<TABLE>

<TR VALIGN="top">
<TD width=100%>MCI_DEVTYPE_ANIMATION</TD>
</TR>

<TR VALIGN="top">
<TD width=100%>MCI_DEVTYPE_CD_AUDIO</TD>
</TR>

<TR VALIGN="top">
<TD width=100%>MCI_DEVTYPE_DAT</TD>
</TR>

<TR VALIGN="top">
<TD width=100%>MCI_DEVTYPE_DIGITAL_VIDEO</TD>
</TR>

<TR VALIGN="top">
<TD width=100%>MCI_DEVTYPE_OTHER</TD>
</TR>

<TR VALIGN="top">
<TD width=100%>MCI_DEVTYPE_OVERLAY</TD>
</TR>

<TR VALIGN="top">
<TD width=100%>MCI_DEVTYPE_SCANNER</TD>
</TR>

<TR VALIGN="top">
<TD width=100%>MCI_DEVTYPE_SEQUENCER</TD>
</TR>

<TR VALIGN="top">
<TD width=100%>MCI_DEVTYPE_VIDEODISC</TD>
</TR>

<TR VALIGN="top">
<TD width=100%>MCI_DEVTYPE_VIDEOTAPE</TD>
</TR>

<TR VALIGN="top">
<TD width=100%>MCI_DEVTYPE_WAVEFORM_AUDIO</TD>
</TR>
</TABLE><BR>



<TABLE>

<TR VALIGN="top">
<TD width=45%>MCI_GETDEVCAPS_HAS_AUDIO </TD>
<TD width=55%>The <B>dwReturn</B> member is set to TRUE if the device has audio output; otherwise, it is set to FALSE. </TD>
</TR>

<TR VALIGN="top">
<TD width=45%>MCI_GETDEVCAPS_HAS_VIDEO </TD>
<TD width=55%>The <B>dwReturn</B> member is set to TRUE if the device has video output; otherwise, it is set to FALSE. For example, the member is set to TRUE for devices that support the animation or videodisc command set. </TD>
</TR>

<TR VALIGN="top">
<TD width=45%>MCI_GETDEVCAPS_USES_FILES </TD>
<TD width=55%>The <B>dwReturn</B> member is set to TRUE if the device requires a filename as its element name; otherwise, it is set to FALSE. 
<P>Only compound devices use files. </P>
</TD>
</TR>
</TABLE><BR>

</DD>

<DT>LPMCI_GETDEVCAPS_PARMS <I>lParam2</I> </DT>

<DD>Specifies a far pointer to the <B>MCI_GETDEVCAPS_PARMS</B> structure. (Devices with extended command sets might replace this structure with a device-specific structure.) 
</DD>
</DL>

<H4>Animation Extensions</H4>

<P>The following extensions for <I>lParam1</I>apply to animation devices: </P>

<TABLE>

<TR VALIGN="top">
<TD width=46%>MCI_GETDEVCAPS_ITEM </TD>
<TD width=54%>Specifies that the <B>dwItem</B> member of the structure identified by <I>lParam2</I> contains a constant specifying which device capability to obtain. The following additional device-capability constants are defined for animation devices and specify which value to return in the <B>dwReturn</B> member of the structure: </TD>
</TR>

<TR VALIGN="top">
<TD width=46%>MCI_ANIM_GETDEVCAPS_CAN_REVERSE </TD>
<TD width=54%>The <B>dwReturn</B> member is set to TRUE if the device can play in reverse; otherwise, it is set to FALSE. </TD>
</TR>

<TR VALIGN="top">
<TD width=46%>MCI_ANIM_GETDEVCAPS_CAN_STRETCH </TD>
<TD width=54%>The <B>dwReturn</B> member is set to TRUE if the device can stretch the image to fill the frame; otherwise, it is set to FALSE. </TD>
</TR>

<TR VALIGN="top">
<TD width=46%>MCI_ANIM_GETDEVCAPS_FAST_RATE </TD>
<TD width=54%>The <B>dwReturn</B> member is set to the standard fast play rate in frames per second. </TD>
</TR>

<TR VALIGN="top">
<TD width=46%>MCI_ANIM_GETDEVCAPS_MAX_WINDOWS </TD>
<TD width=54%>The <B>dwReturn</B> member is set to the maximum number of windows that the device can handle simultaneously. </TD>
</TR>

<TR VALIGN="top">
<TD width=46%>MCI_ANIM_GETDEVCAPS_NORMAL_RATE </TD>
<TD width=54%>The <B>dwReturn</B> member is set to the normal rate of play in frames per second. </TD>
</TR>

<TR VALIGN="top">
<TD width=46%>MCI_ANIM_GETDEVCAPS_PALETTES </TD>
<TD width=54%>The <B>dwReturn</B> member is set to TRUE if the device can return a palette handle; otherwise, it is set to FALSE. </TD>
</TR>

<TR VALIGN="top">
<TD width=46%>MCI_ANIM_GETDEVCAPS_SLOW_RATE </TD>
<TD width=54%>The <B>dwReturn</B> member is set to the standard slow play rate in frames per second. </TD>
</TR>
</TABLE><BR>

<P>Note that <I>lParam2</I> specifies a far pointer to the <B>MCI_GETDEVCAPS_PARMS</B> structure. </P>

<H4>Videodisc Extensions</H4>

<P>The following extensions for <I>lParam1</I>apply to videodisc devices: </P>

<TABLE>

<TR VALIGN="top">
<TD width=46%>MCI_GETDEVCAPS_ITEM </TD>
<TD width=54%>Specifies that the <B>dwItem</B> member of the structure identified by <I>lParam2</I> contains a constant specifying which device capability to obtain. The following additional device-capability constants are defined for videodisc devices and specify which value to return in the <B>dwReturn</B> member of the structure: </TD>
</TR>

<TR VALIGN="top">
<TD width=46%>MCI_VD_GETDEVCAPS_CAN_REVERSE </TD>
<TD width=54%>The <B>dwReturn</B> member is set to TRUE if the videodisc player can play in reverse; otherwise, it is set to FALSE. </TD>
</TR>

<TR VALIGN="top">
<TD width=46%>&nbsp;</TD>
<TD width=54%>Some players can play CLV discs in reverse as well as CAV discs. </TD>
</TR>

<TR VALIGN="top">
<TD width=46%>MCI_VD_GETDEVCAPS_FAST_RATE </TD>
<TD width=54%>The <B>dwReturn</B> member is set to the standard fast play rate in frames per second. </TD>
</TR>

<TR VALIGN="top">
<TD width=46%>MCI_VD_GETDEVCAPS_NORMAL_RATE </TD>
<TD width=54%>The <B>dwReturn</B> member is set to the normal play rate in frames per second. </TD>
</TR>

<TR VALIGN="top">
<TD width=46%>MCI_VD_GETDEVCAPS_SLOW_RATE </TD>
<TD width=54%>The <B>dwReturn</B> member is set to the slow play rate in frames per second. </TD>
</TR>

<TR VALIGN="top">
<TD width=46%>MCI_VD_GETDEVCAPS_CLV </TD>
<TD width=54%>Indicates the information requested applies to CLV format discs. By default, the capabilities apply to the current disc. </TD>
</TR>

<TR VALIGN="top">
<TD width=46%>MCI_VD_GETDEVCAPS_CAV </TD>
<TD width=54%>Indicates the information requested applies to CAV format discs. By default, the capabilities apply to the current disc. </TD>
</TR>
</TABLE><BR>

<P>Note that <I>lParam2</I> specifies a far pointer to the <B>MCI_GETDEVCAPS_PARMS</B> structure. </P>

<H4>Video Overlay Extensions</H4>

<P>The following extensions for <I>lParam1</I> apply to video overlay devices: </P>

<TABLE>

<TR VALIGN="top">
<TD width=46%>MCI_GETDEVCAPS_ITEM </TD>
<TD width=54%>Specifies that the <B>dwItem</B> member of the structure identified by <I>lParam2</I> contains a constant specifying which device capability to obtain. The following additional device-capability constants are defined for video overlay devices and specify which value to return in the <B>dwReturn</B> member of the structure: </TD>
</TR>

<TR VALIGN="top">
<TD width=46%>MCI_OVLY_GETDEVCAPS_CAN_FREEZE </TD>
<TD width=54%>The <B>dwReturn</B> member is set to TRUE if the device can freeze the image; otherwise, it is set to FALSE. </TD>
</TR>

<TR VALIGN="top">
<TD width=46%>MCI_OVLY_GETDEVCAPS_CAN_STRETCH </TD>
<TD width=54%>The <B>dwReturn</B> member is set to TRUE if the device can stretch the image to fill the frame; otherwise, it is set to FALSE. </TD>
</TR>

<TR VALIGN="top">
<TD width=46%>MCI_OVLY_GETDEVCAPS_MAX_WINDOWS </TD>
<TD width=54%>The <B>dwReturn</B> member is set to the maximum number of windows that the device can handle simultaneously. </TD>
</TR>
</TABLE><BR>

<P>Note that <I>lParam2</I> specifies a far pointer to the <B>MCI_GETDEVCAPS_PARMS</B> structure. </P>

<H4>Waveform Audio Extensions</H4>

<P>The following extended flag for <I>lParam1</I> applies to waveform audio devices: </P>

<TABLE>

<TR VALIGN="top">
<TD width=46%>MCI_GETDEVCAPS_ITEM </TD>
<TD width=54%>Specifies that the <B>dwItem</B> member of the structure identified by <I>lParam2</I> contains a constant specifying which device capability to obtain. The following additional device-capability constants are defined for waveform audio devices and specify which value to return in the <B>dwReturn</B> member of the structure: </TD>
</TR>

<TR VALIGN="top">
<TD width=46%>MCI_WAVE_GETDEVCAPS_INPUT </TD>
<TD width=54%>The <B>dwReturn</B> member is set to the total number of waveform input (recording) devices. </TD>
</TR>

<TR VALIGN="top">
<TD width=46%>MCI_WAVE_GETDEVCAPS_OUTPUT </TD>
<TD width=54%>The <B>dwReturn</B> member is set to the total number of waveform output (playback) devices. </TD>
</TR>
</TABLE><BR>

<P>Note that <I>lParam2</I> specifies a far pointer to the <B>MCI_GETDEVCAPS_PARMS</B> structure. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: MCI_GETDEVCAPS"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
