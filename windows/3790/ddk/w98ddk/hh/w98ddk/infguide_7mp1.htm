<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Update Autoexec.bat (UpdateAutoBat)</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Update Autoexec.bat (UpdateAutoBat)">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="ddk_update_autoexec.bat_updateautobat__me"></A>Update Autoexec.bat (UpdateAutoBat)</H3>

<PRE>[update-autoexec-section]
CmdAdd=command-name[,command-parameters]
CmdDelete=command-name
PrefixPath=ldid[,ldid]
RemOldPath=ldid[,ldid]
TmpDir=ldid[,subdir]
UnSet=env-var-name</PRE>

<P>Provides commands to manipulate lines in the AUTOEXEC.BAT file. The section name, update-autoexec-section-name, must appear in the UpdateAutoBat item in an Install section of the INF file.</P>

<P>Not all item types shown in the syntax above are needed or required in an Update Autoexec.bat section. The section can contain as many CmdAdd, CmdDelete and UnSet items as needed, but only one PrefixPath, RemOldPath and TmpDir items can be used in an INF file. The syntax and meaning of each of the item types is described later in this topic.</P>

<P>The installer processes all CmdDelete items before any CmdAdd items.</P>

<H4>CmdAdd</H4>

<P>CmdAdd=command-name[,"command-parameters"]</P>

<P>Adds the given command and optional command parameters to the AUTOEXEC.BAT file, at the end of the file.

<DL>
<DT><I>command-name</I></DT>

<DD>Name of an executable file, with or without an extension. If the file name is also defined in the SourceDisksFiles and DestinationDirs sections of the INF file, the installer adds the appropriate path to the file name before writing it to the AUTOEXEC.BAT file.</DD>

<DT><I>command-parameters</I></DT>

<DD>A string enclosed in double quotation marks or a replaceable string like %String1% or %Myparam%, where the strings that replace %String1% and %Myparam% are defined in the Strings section of the INF file. The installer appends the string to the command-name before appending the line to the end of the AUTOEXEC.BAT file. The format of this line is dependent on the command line requirements of the given executable file.
</DD>
</DL>

<H4>CmdDelete</H4>

<P>CmdDelete=command-name</P>

<P>Deletes any lines from AUTOEXEC.BAT that include the given command name. The installer searches for and deletes any occurrence of the given name that has a file name extension of .exe, .com, and .bat.

<DL>
<DT><I>command-name</I></DT>

<DD>Name of an executable file without an extension.
</DD>
</DL>

<H4>PrefixPath</H4>

<P>PrefixPath=ldid[,ldid]...</P>

<P>Appends the path associated with the given LDID to the path command.

<DL>
<DT><I>ldid</I></DT>

<DD>Can be any of the predefined LDID values or a new value defined in the INF file. For a definition of all the predefined LDID values, see <A HREF="infguide_5ew5.htm">DestinationDirs</A>.
</DD>
</DL>

<H4>RemOldPath</H4>

<P>RemOldPath=ldid[,ldid]</P>

<P>Removes the path associated with the given LDID from the path command. For example, if the user installs the new version of Windows into c:\newwin and has an old copy of Windows in c:\windows, the following INF file item removes c:\windows from the path environmental variable:</P>

<P>RemOldPath=10

<DL>
<DT><I>ldid</I></DT>

<DD>Can be any of the predefined LDID values or a new value defined in the INF file. For a definition of all the predefined LDID values, see <A HREF="infguide_5ew5.htm">DestinationDirs</A>.
</DD>
</DL>

<H4>TmpDir</H4>

<P>TmpDir=ldid[,subdir]</P>

<P>Creates a temporary directory within the directory given by the LDID, if it does not already exist.

<DL>
<DT><I>ldid</I></DT>

<DD>Can be any of the predefined LDID values or a new value defined in the INF file. For a definition of all the predefined LDID values, see <A HREF="infguide_5ew5.htm">DestinationDirs</A>.</DD>

<DT><I>subdir</I></DT>

<DD>A path name. If ldid\subdir does not already exist, it is created.
</DD>
</DL>

<H4>UnSet</H4>

<P>UnSet=env-var-name</P>

<P>Removes any set command from the AUTOEXEC.BAT file that includes the given environment variable name.

<DL>
<DT><I>env-var-name</I></DT>

<DD>Name of an environment variable.
</DD>
</DL>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Update%20Autoexec.bat%20(UpdateAutoBat)"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
