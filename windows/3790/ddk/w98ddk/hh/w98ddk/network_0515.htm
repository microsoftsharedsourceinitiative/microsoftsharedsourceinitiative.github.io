<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Logoff</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="_pss_3259"></A>Logoff</H3>

<P>When log off is occurring, all applications are shut down. They receive the same messages that they would receive when the system is shut down: <B>WM_QUERYENDSESSION</B> followed by <B>WM_ENDSESSION</B>. The <I>lParam</I> parameter has the <B>EWX_REALLYLOGOFF</B> bit set indicating that this is a log off, not a shutdown. The messages are sent through <B>BroadcastSystemMessage</B>, so they are received by all top-level windows, installable drivers, and VxDs. </P>

<P>Most ordinary applications are not affected by log on and log off, beyond the ordinary implications of active connections being disconnected and open files being closed. The primary purpose of this message is for network-specific applications which maintain internal state based on the current log on. For example, an application which receives messages from other stations might need to delete a NetBIOS name when the user logs off. </P>

<P>A service process that needs to stay running when the user logs off can call the <B>RegisterServiceProcess</B> API to make itself exempt from the automatic shutdown of all applications at logoff time. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Logoff"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
