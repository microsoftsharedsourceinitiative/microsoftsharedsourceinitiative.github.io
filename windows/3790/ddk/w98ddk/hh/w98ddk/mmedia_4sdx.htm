<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>MCI_STATUS</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_2585"></A>MCI_STATUS</H1>

<P>Used to obtain information about an MCI device. All devices respond to this message. The parameters and flags available for this message depend on the selected device. Information is returned in the <B>dwReturn</B> member of the structure identified by <I>lpStatus</I>. 

<UL>
	<LI>Returns zero if successful. Otherwise, it returns an MCI error code. </LI>
</UL>

<DL>
<DT>DWORD <I>lParam1</I> </DT>

<DD>The following standard and command-specific flags apply to all devices: 

<TABLE>

<TR VALIGN="top">
<TD width=40%>MCI_NOTIFY </TD>
<TD width=60%>Specifies that MCI should post the <B>MM_MCINOTIFY</B> message when this command completes. The window to receive this message is specified in the <B>dwCallback</B> member of the structure identified by <I>lpStatus</I>. </TD>
</TR>

<TR VALIGN="top">
<TD width=40%>MCI_WAIT </TD>
<TD width=60%>Specifies that the status operation should finish before MCI returns control to the application. </TD>
</TR>

<TR VALIGN="top">
<TD width=40%>MCI_STATUS_ITEM </TD>
<TD width=60%>Specifies that the <B>dwItem</B> member of the structure identified by <I>lpStatus</I> contains a constant specifying which status item to obtain. The following constants define which status item to return in the <B>dwReturn</B> member of the structure: </TD>
</TR>

<TR VALIGN="top">
<TD width=40%>MCI_STATUS_CURRENT_TRACK </TD>
<TD width=60%>The <B>dwReturn</B> member is set to the current track number. MCI uses continuous track numbers. </TD>
</TR>

<TR VALIGN="top">
<TD width=40%>MCI_STATUS_LENGTH </TD>
<TD width=60%>The <B>dwReturn</B> member is set to the total media length. </TD>
</TR>

<TR VALIGN="top">
<TD width=40%>MCI_STATUS_MODE </TD>
<TD width=60%>The <B>dwReturn</B> member is set to the current mode of the device. The modes include the following: </TD>
</TR>
</TABLE><BR>



<TABLE>

<TR VALIGN="top">
<TD width=100%>MCI_MODE_NOT_READY</TD>
</TR>

<TR VALIGN="top">
<TD width=100%>MCI_MODE_OPEN</TD>
</TR>

<TR VALIGN="top">
<TD width=100%>MCI_MODE_PAUSE</TD>
</TR>

<TR VALIGN="top">
<TD width=100%>MCI_MODE_PLAY</TD>
</TR>

<TR VALIGN="top">
<TD width=100%>MCI_MODE_RECORD</TD>
</TR>

<TR VALIGN="top">
<TD width=100%>MCI_MODE_STOP</TD>
</TR>

<TR VALIGN="top">
<TD width=100%>MCI_MODE_SEEK</TD>
</TR>
</TABLE><BR>



<TABLE>

<TR VALIGN="top">
<TD width=40%>MCI_STATUS_NUMBER_OF_TRACKS </TD>
<TD width=60%>The <B>dwReturn</B> member is set to the total number of playable tracks. </TD>
</TR>

<TR VALIGN="top">
<TD width=40%>MCI_STATUS_POSITION </TD>
<TD width=60%>The <B>dwReturn</B> member is set to the current position. </TD>
</TR>

<TR VALIGN="top">
<TD width=40%>MCI_STATUS_READY </TD>
<TD width=60%>The <B>dwReturn</B> member is set to TRUE if the device is ready; otherwise, it is set to FALSE. </TD>
</TR>

<TR VALIGN="top">
<TD width=40%>MCI_STATUS_TIME_FORMAT </TD>
<TD width=60%>The <B>dwReturn</B> member is set to the current time format of the device. The time formats include: </TD>
</TR>
</TABLE><BR>



<TABLE>

<TR VALIGN="top">
<TD width=100%>MCI_FORMAT_BYTES</TD>
</TR>

<TR VALIGN="top">
<TD width=100%>MCI_FORMAT_FRAMES</TD>
</TR>

<TR VALIGN="top">
<TD width=100%>MCI_FORMAT_HMS</TD>
</TR>

<TR VALIGN="top">
<TD width=100%>MCI_FORMAT_MILLISECONDS</TD>
</TR>

<TR VALIGN="top">
<TD width=100%>MCI_FORMAT_MSF</TD>
</TR>

<TR VALIGN="top">
<TD width=100%>MCI_FORMAT_SAMPLES</TD>
</TR>

<TR VALIGN="top">
<TD width=100%>MCI_FORMAT_TMSF</TD>
</TR>
</TABLE><BR>



<TABLE>

<TR VALIGN="top">
<TD width=40%>MCI_STATUS_START </TD>
<TD width=60%>Obtains the starting position of the media. To get the starting position, combine this flag with MCI_STATUS_ITEM and set the <B>dwItem</B> member of the structure identified by <I>lpStatus</I> to MCI_STATUS_POSITION. </TD>
</TR>

<TR VALIGN="top">
<TD width=40%>MCI_TRACK </TD>
<TD width=60%>Indicates a status track parameter is included in the <B>dwTrack</B> member of the structure identified by <I>lpStatus</I>. You must use this flag with the MCI_STATUS_POSITION or MCI_STATUS_LENGTH constants. 
<P>When used with MCI_STATUS_POSITION, MCI_TRACK obtains the starting position of the specified track. </P>

<P>When used with MCI_STATUS_LENGTH, MCI_TRACK obtains the length of the specified track. MCI uses continuous track numbers. </P>
</TD>
</TR>
</TABLE><BR>

</DD>

<DT>LPMCI_STATUS_PARMS <I>lParam2</I> </DT>

<DD>Specifies a far pointer to the <B>MCI_STATUS_PARMS</B> structure. (Devices with extended command sets might replace this structure with a device-specific structure.) 
</DD>
</DL>

<H4>Animation Extensions </H4>

<P>The following extensions for <I>lParam1</I> apply to animation devices: </P>

<TABLE>

<TR VALIGN="top">
<TD width=33%>MCI_STATUS_ITEM </TD>
<TD width=67%>Specifies that the <B>dwItem</B> member of the structure identified by <I>lParam2</I> contains a constant specifying which status item to obtain. The following additional status constants are defined for animation devices and indicate which item to return in the <B>dwReturn</B> member of the structure: </TD>
</TR>
</TABLE><BR>

<TABLE>

<TR VALIGN="top">
<TD width=52%>MCI_ANIM_STATUS_FORWARD </TD>
<TD width=48%>The <B>dwReturn</B> member is set to TRUE if playing forward; otherwise, it is set to FALSE. </TD>
</TR>

<TR VALIGN="top">
<TD width=52%>MCI_ANIM_STATUS_HPAL </TD>
<TD width=48%>The <B>dwReturn</B> member is set to the handle of the movie palette. </TD>
</TR>

<TR VALIGN="top">
<TD width=52%>MCI_ANIM_STATUS_HWND </TD>
<TD width=48%>The <B>dwReturn</B> member is set to the handle of the playback window. </TD>
</TR>

<TR VALIGN="top">
<TD width=52%>MCI_ANIM_STATUS_SPEED </TD>
<TD width=48%>The <B>dwReturn</B> member is set to the animation speed, in frames per second. </TD>
</TR>
</TABLE><BR>

<TABLE>

<TR VALIGN="top">
<TD width=33%>MCI_STATUS_MEDIA_PRESENT </TD>
<TD width=67%>The <B>dwReturn</B> member is set to TRUE if the media is inserted in the device; otherwise, it is set to FALSE. </TD>
</TR>
</TABLE><BR>

<P>Note that <I>lParam2</I> specifies a far pointer to the <B>MCI_STATUS_PARMS</B> structure. </P>

<H4>CD Audio Extensions </H4>

<P>The following extensions for <I>lParam1</I> applies to CD audio devices: </P>

<TABLE>

<TR VALIGN="top">
<TD width=33%>MCI_STATUS_ITEM </TD>
<TD width=67%>Specifies that the <B>dwItem</B> member of the structure identified by <I>lParam2</I> contains a constant specifying which status item to obtain. The following additional status constants are defined for CD audio devices and indicate which item to return in the <B>dwReturn</B> member of the structure: </TD>
</TR>

<TR VALIGN="top">
<TD width=33%>MCI_STATUS_MEDIA_PRESENT </TD>
<TD width=67%>The <B>dwReturn</B> member is set to TRUE if the media is inserted in the device; otherwise, it is set to FALSE. </TD>
</TR>
</TABLE><BR>

<P>Note that <I>lParam2</I> specifies a far pointer to the <B>MCI_STATUS_PARMS</B> structure. This parameter replaces the standard default parameter structure. </P>

<H4>MIDI Sequencer Extensions </H4>

<P>The following extensions for <I>lParam1</I> apply to sequencers: </P>

<TABLE>

<TR VALIGN="top">
<TD width=33%>MCI_STATUS_ITEM </TD>
<TD width=67%>Specifies that the <B>dwItem</B> member of the structure identified by <I>lParam2</I> contains a constant specifying which status item to obtain. The following additional status constants are defined for sequencers and indicate which item to return in the <B>dwReturn</B> member of the structure: </TD>
</TR>

<TR VALIGN="top">
<TD width=33%>MCI_SEQ_STATUS_DIVTYPE </TD>
<TD width=67%>The <B>dwReturn</B> member is set to one of the following values indicating the current division type of a sequence: 
<P>MCI_SEQ_DIV_PPQN</P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>&nbsp;</TD>
<TD width=67%>MCI_SEQ_DIV_SMPTE_24</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>&nbsp;</TD>
<TD width=67%>MCI_SEQ_DIV_SMPTE_25</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>&nbsp;</TD>
<TD width=67%>MCI_SEQ_DIV_SMPTE_30</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>&nbsp;</TD>
<TD width=67%>MCI_SEQ_DIV_SMPTE_30DROP</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>MCI_SEQ_STATUS_MASTER </TD>
<TD width=67%>The <B>dwReturn</B> member is set to the synchronization type used for master operation. </TD>
</TR>

<TR VALIGN="top">
<TD width=33%>MCI_SEQ_STATUS_OFFSET </TD>
<TD width=67%>The <B>dwReturn</B> member is set to the current SMPTE offset of a sequence. </TD>
</TR>

<TR VALIGN="top">
<TD width=33%>MCI_SEQ_STATUS_PORT </TD>
<TD width=67%>The <B>dwReturn</B> member is set to the MIDI device ID for the current port used by the sequence. </TD>
</TR>

<TR VALIGN="top">
<TD width=33%>MCI_SEQ_STATUS_SLAVE </TD>
<TD width=67%>The <B>dwReturn</B> member is set to the synchronization type used for slave operation. </TD>
</TR>

<TR VALIGN="top">
<TD width=33%>MCI_SEQ_STATUS_TEMPO </TD>
<TD width=67%>The <B>dwReturn</B> member is set to the current tempo of a MIDI sequence in beats-per-minute for PPQN files, or frames-per-second for SMPTE files. </TD>
</TR>

<TR VALIGN="top">
<TD width=33%>MCI_STATUS_MEDIA_PRESENT </TD>
<TD width=67%>The <B>dwReturn</B> member is set to TRUE if the media for the device is present; otherwise, it is set to FALSE. </TD>
</TR>
</TABLE><BR>

<P>Note that <I>lParam2</I> specifies a far pointer to the <B>MCI_STATUS_PARMS</B> structure. This parameter replaces the standard default parameter structure. </P>

<H4>Videodisc Extensions </H4>

<P>The following additional flags for <I>lParam1</I> apply to videodisc devices: </P>

<TABLE>

<TR VALIGN="top">
<TD width=33%>MCI_STATUS_ITEM </TD>
<TD width=67%>Specifies that the <B>dwItem</B> member of the structure identified by <I>lParam2</I> contains a constant specifying which status item to obtain. The following additional status constants are defined for videodisc devices and indicate which item to return in the <B>dwReturn</B> member of the structure: </TD>
</TR>

<TR VALIGN="top">
<TD width=33%>MCI_STATUS_MEDIA_PRESENT </TD>
<TD width=67%>The <B>dwReturn</B> member is set to TRUE if the media is inserted in the device; otherwise, it is set to FALSE. </TD>
</TR>

<TR VALIGN="top">
<TD width=33%>MCI_VD_STATUS_DISC_SIZE </TD>
<TD width=67%>The <B>dwReturn</B> member is set to the size of the loaded disc in inches (8 or 12). </TD>
</TR>

<TR VALIGN="top">
<TD width=33%>MCI_VD_STATUS_FORWARD </TD>
<TD width=67%>The <B>dwReturn</B> member is set to TRUE if playing forward; otherwise, it is set to FALSE. </TD>
</TR>

<TR VALIGN="top">
<TD width=33%>MCI_VD_STATUS_MEDIA_TYPE </TD>
<TD width=67%>The <B>dwReturn</B> member is set to the media type of the inserted media. The following media types can be returned: 
<P>MCI_VD_MEDIA_CAV</P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>&nbsp;</TD>
<TD width=67%>MCI_VD_MEDIA_CLV</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>&nbsp;</TD>
<TD width=67%>MCI_VD_MEDIA_OTHER</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>MCI_STATUS_MODE </TD>
<TD width=67%>The <B>dwReturn</B> member is set to the current mode of the device. All devices can return the following constants to indicate the current mode: 
<P>MCI_MODE_NOT_READY</P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>&nbsp;</TD>
<TD width=67%>MCI_MODE_PAUSE</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>&nbsp;</TD>
<TD width=67%>MCI_MODE_PLAY</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>&nbsp;</TD>
<TD width=67%>MCI_MODE_STOP</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>&nbsp;</TD>
<TD width=67%>MCI_VD_MODE_PARK </TD>
</TR>

<TR VALIGN="top">
<TD width=33%>&nbsp;</TD>
<TD width=67%>The <B>dwReturn</B> member is set to park if the disc is parked. Not all videodisc devices support this flag. </TD>
</TR>

<TR VALIGN="top">
<TD width=33%>MCI_VD_STATUS_SIDE </TD>
<TD width=67%>The <B>dwReturn</B> member is set to 1 or 2 to indicate which side of the disc is loaded. Not all videodisc devices support this flag. </TD>
</TR>

<TR VALIGN="top">
<TD width=33%>MCI_VD_STATUS_SPEED </TD>
<TD width=67%>The <B>dwReturn</B> member is set to the play speed in frames per second. </TD>
</TR>
</TABLE><BR>

<P>Note that <I>lParam2</I> specifies a far pointer to the <B>MCI_STATUS_PARMS</B> structure. This parameter replaces the standard default parameter structure. </P>

<H4>Waveform Audio Extensions </H4>

<P>The following additional flags for <I>lParam1</I> apply to waveform audio devices: </P>

<TABLE>

<TR VALIGN="top">
<TD width=33%>MCI_STATUS_ITEM </TD>
<TD width=67%>Specifies that the <B>dwItem</B> member of the structure identified by <I>lParam2</I> contains a constant specifying which status item to obtain. The following additional status constants are defined for waveform audio devices and indicate which item to return in the <B>dwReturn</B> member of the structure: </TD>
</TR>

<TR VALIGN="top">
<TD width=33%>MCI_STATUS_MEDIA_PRESENT </TD>
<TD width=67%>The <B>dwReturn</B> member is set to TRUE if the media is inserted in the device; otherwise, it is set to FALSE. </TD>
</TR>

<TR VALIGN="top">
<TD width=33%>MCI_WAVE_INPUT </TD>
<TD width=67%>The <B>dwReturn</B> member is set to the wave input device used for recording. If no device is in use and no device has been explicitly set, then the error return is MCI_WAVE_INPUTUNSPECIFIED. </TD>
</TR>

<TR VALIGN="top">
<TD width=33%>MCI_WAVE_OUTPUT </TD>
<TD width=67%>The <B>dwReturn</B> member is set to the wave output device used for playing. If no device is in use and no device has been explicitly set, then the error return is MCI_WAVE_OUTPUTUNSPECIFIED. </TD>
</TR>

<TR VALIGN="top">
<TD width=33%>MCI_WAVE_STATUS_AVGBYTESPERSEC </TD>
<TD width=67%>The <B>dwReturn</B> member is set to the current bytes per second used for playing, recording, and saving. </TD>
</TR>

<TR VALIGN="top">
<TD width=33%>MCI_WAVE_STATUS_BITSPERSAMPLE </TD>
<TD width=67%>The <B>dwReturn</B> member is set to the current bits per sample used for playing, recording, and saving. </TD>
</TR>

<TR VALIGN="top">
<TD width=33%>MCI_WAVE_STATUS_BLOCKALIGN </TD>
<TD width=67%>The <B>dwReturn</B> member is set to the current block alignment used for playing, recording, and saving. </TD>
</TR>

<TR VALIGN="top">
<TD width=33%>MCI_WAVE_STATUS_CHANNELS </TD>
<TD width=67%>The <B>dwReturn</B> member is set to the current channel count used for playing, recording, and saving. </TD>
</TR>

<TR VALIGN="top">
<TD width=33%>MCI_WAVE_FORMATTAG </TD>
<TD width=67%>The <B>dwReturn</B> member is set to the current format tag used for playing, recording, and saving. </TD>
</TR>

<TR VALIGN="top">
<TD width=33%>MCI_WAVE_STATUS_LEVEL </TD>
<TD width=67%>The <B>dwReturn</B> member is set to the current record or playback level. The value is returned as an 8- or 16-bit value, depending on the sample size used. The right or mono channel level is returned in the low-order word. The left channel level is returned in the high-order word. </TD>
</TR>

<TR VALIGN="top">
<TD width=33%>MCI_WAVE_STATUS_SAMPLESPERSEC </TD>
<TD width=67%>The <B>dwReturn</B> member is set to the current samples per second used for playing, recording, and saving. </TD>
</TR>
</TABLE><BR>

<P>Note that <I>lParam2</I> specifies a far pointer to the <B>MCI_STATUS_PARMS</B> structure. </P>

<H4>Video Overlay Extensions </H4>

<P>The following additional flags for <I>lParam1</I> apply to video overlay devices: </P>

<TABLE>

<TR VALIGN="top">
<TD width=36%>MCI_OVLY_STATUS_HWND </TD>
<TD width=64%>The <B>dwReturn</B> member is set to the handle of the window associated with the video overlay device. </TD>
</TR>

<TR VALIGN="top">
<TD width=36%>MCI_STATUS_ITEM </TD>
<TD width=64%>Specifies that the <B>dwItem</B> member of the structure identified by <I>lParam2</I> contains a constant specifying which status item to obtain. The following additional status constants are defined for video overlay devices and indicate which item to return in the <B>dwReturn</B> member of the structure: </TD>
</TR>

<TR VALIGN="top">
<TD width=36%>MCI_STATUS_MEDIA_PRESENT </TD>
<TD width=64%>The <B>dwReturn</B> member is set to TRUE if the media is inserted in the device; otherwise, it is set to FALSE. </TD>
</TR>
</TABLE><BR>

<P>Note that <I>lParam2</I> specifies a far pointer to the <B>MCI_STATUS_PARMS</B> structure. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: MCI_STATUS"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
