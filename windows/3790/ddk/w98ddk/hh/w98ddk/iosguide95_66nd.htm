<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>DVT (Driver Vector Table)</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="DVT (Driver Vector Table)">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="ddk_dvt_driver_vector_table__si"></A>DVT (Driver Vector Table)</H3>

<P>One per driver or VSD; these are chained together in descending LGN number.</P>

<P>Use .IDDVT from debugger for list (using the debug version of IOS.VXD)</P>

<TABLE border=1 frame=box rules=all>

<TR VALIGN="top">
<TD width=6%><B>Offset</B></TD>
<TD width=39%>
<PRE><B>Element</B></PRE>
</TD>
<TD width=55%><B>Comments</B></TD>
</TR>

<TR VALIGN="top">
<TD width=6%><B><CODE>02</CODE></B></TD>
<TD width=39%><B><CODE>ULONG&nbsp;&nbsp;&nbsp;&nbsp;DVT_next_dvt</CODE></B></TD>
<TD width=55%>Pointer to next DVT.</TD>
</TR>

<TR VALIGN="top">
<TD width=6%><B><CODE>06</CODE></B></TD>
<TD width=39%><B><CODE>USHORT&nbsp;&nbsp;&nbsp;&nbsp;DVT_device_cnt</CODE></B></TD>
<TD width=55%>Count of devices (DCBs) added/accepted.</TD>
</TR>

<TR VALIGN="top">
<TD width=6%><B><CODE>08</CODE></B></TD>
<TD width=39%><B><CODE>PVOID&nbsp;&nbsp;&nbsp;&nbsp;DVT_aer</CODE></B></TD>
<TD width=55%>Driver's Async Event Routine (entry point for IOS AEP_… calls).</TD>
</TR>

<TR VALIGN="top">
<TD width=6%><B><CODE>0C</CODE></B></TD>
<TD width=39%><B><CODE>ULONG&nbsp;&nbsp;&nbsp;&nbsp;DVT_ddb</CODE></B></TD>
<TD width=55%>First DDB for this DVT.</TD>
</TR>

<TR VALIGN="top">
<TD width=6%><B><CODE>10</CODE></B></TD>
<TD width=39%><B><CODE>ULONG&nbsp;&nbsp;&nbsp;&nbsp;DVT_ddb_init</CODE></B></TD>
<TD width=55%>First DDB for this DVT when first created during initialization (used by IOS to manage DDBs for all DVTs).</TD>
</TR>

<TR VALIGN="top">
<TD width=6%><B><CODE>14</CODE></B></TD>
<TD width=39%><B><CODE>CHAR&nbsp;&nbsp;&nbsp;&nbsp;DVT_ascii_name[DVT_NAME_LEN]</CODE></B></TD>
<TD width=55%>Name of driver including extension, e.g. esdi_506.pdr.</TD>
</TR>

<TR VALIGN="top">
<TD width=6%><B><CODE>24</CODE></B></TD>
<TD width=39%><B><CODE>CHAR&nbsp;&nbsp;&nbsp;&nbsp;DVT_create_date[DVT_DATE_LEN]</CODE></B></TD>
<TD width=55%>(Optional) date of creation.</TD>
</TR>

<TR VALIGN="top">
<TD width=6%><B><CODE>2C</CODE></B></TD>
<TD width=39%><B><CODE>CHAR&nbsp;&nbsp;&nbsp;&nbsp;DVT_create_time[DVT_TIME_LEN]</CODE></B></TD>
<TD width=55%>(Optional) time of creation.</TD>
</TR>

<TR VALIGN="top">
<TD width=6%><B><CODE>34</CODE></B></TD>
<TD width=39%><B><CODE>CHAR&nbsp;&nbsp;&nbsp;&nbsp;DVT_rev_level[DVT_REV_LEN]</CODE></B></TD>
<TD width=55%>(Optional) revision level of driver.</TD>
</TR>

<TR VALIGN="top">
<TD width=6%><B><CODE>38</CODE></B></TD>
<TD width=39%><B><CODE>ULONG&nbsp;&nbsp;&nbsp;&nbsp;DVT_feature_code</CODE></B></TD>
<TD width=55%>Feature code. See Listing 3.</TD>
</TR>

<TR VALIGN="top">
<TD width=6%><B><CODE>3C</CODE></B></TD>
<TD width=39%><B><CODE>USHORT&nbsp;&nbsp;&nbsp;&nbsp;DVT_if_requirements</CODE></B></TD>
<TD width=55%>Reserved. Not currently used.</TD>
</TR>

<TR VALIGN="top">
<TD width=6%><B><CODE>3E</CODE></B></TD>
<TD width=39%><B><CODE>BYTE&nbsp;&nbsp;&nbsp;&nbsp;DVT_bus_type</CODE></B></TD>
<TD width=55%>I/O bus type.
<P><CODE>DVT_BT_ESDI    0x00  // ESDI or ESDI emulator</CODE></P>

<P>DVT_BT_SCSI    0x01  // SCSI or SCSI emulator</P>

<P><CODE>DVT_BT_FLOPPY  0x02  // FLOPPY</CODE></P>

<P><CODE>DVT_BT_SMART   0x03  // smart device</CODE></P>

<P><CODE>DVT_BT_ABIOS   0x04  // ABIOS or ABIOS emulator</CODE></P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=6%><B><CODE>3F</CODE></B></TD>
<TD width=39%><B><CODE>ULONG&nbsp;&nbsp;&nbsp;&nbsp;DVT_reference_data</CODE></B></TD>
<TD width=55%>Reference data passed using DRP_reference_data when this driver registers using IOS_Register.</TD>
</TR>

<TR VALIGN="top">
<TD width=6%><B><CODE>43</CODE></B></TD>
<TD width=39%><B><CODE>CHAR&nbsp;&nbsp;&nbsp;&nbsp;DVT_first_drive</CODE></B></TD>
<TD width=55%>Reserved. Not currently used.</TD>
</TR>

<TR VALIGN="top">
<TD width=6%><B><CODE>44</CODE></B></TD>
<TD width=39%><B><CODE>CHAR&nbsp;&nbsp;&nbsp;&nbsp;DVT_current_lgn</CODE></B></TD>
<TD width=55%>Load group number assigned to this driver.</TD>
</TR>

<TR VALIGN="top">
<TD width=6%><B><CODE>45</CODE></B></TD>
<TD width=39%><B><CODE>ULONG&nbsp;&nbsp;&nbsp;&nbsp;DVT_LoadHandle</CODE></B></TD>
<TD width=55%>Contains the Vxd's load handle (from VXDLDR_LoadDevice) if we loaded the driver; else 0.</TD>
</TR>

<TR VALIGN="top">
<TD width=6%><B><CODE>49</CODE></B></TD>
<TD width=39%><B><CODE>CHAR&nbsp;&nbsp;&nbsp;&nbsp;DVT_scsi_max_target</CODE></B></TD>
<TD width=55%>SCSI: max target reported by SCSI (AEP_bi_i_max_target / MaximumNumberOfTargets).</TD>
</TR>

<TR VALIGN="top">
<TD width=6%><B><CODE>4A</CODE></B></TD>
<TD width=39%><B><CODE>CHAR&nbsp;&nbsp;&nbsp;&nbsp;DVT_scsi_max_lun</CODE></B></TD>
<TD width=55%>SCSI: max LUN supported for SCSI (set to 0x7 by SCSIPORT).</TD>
</TR>

<TR VALIGN="top">
<TD width=6%><B><CODE>4B</CODE></B></TD>
<TD width=39%><B><CODE>PVOID&nbsp;&nbsp;&nbsp;&nbsp;DVT_entry_point</CODE></B></TD>
<TD width=55%>SCSI: _PELDR_GetEntryPoint’s entry point into NT SCSI miniport driver.</TD>
</TR>

<TR VALIGN="top">
<TD width=6%><B><CODE>4F</CODE></B></TD>
<TD width=39%><B><CODE>UCHAR&nbsp;&nbsp;&nbsp;&nbsp;DVT_init_count</CODE></B></TD>
<TD width=55%>Number of successful AEP_INITIALIZE calls (port drivers only). If zero upon init completion, IOS will deregister this port driver.</TD>
</TR>
</TABLE><BR>

<H3>DDB (Driver Data Block)</H3>

<TABLE border=1 frame=box rules=all>

<TR VALIGN="top">
<TD width=6%><B>Offset</B></TD>
<TD width=39%>
<PRE><B>Element</B></PRE>
</TD>
<TD width=55%><B>Comments</B></TD>
</TR>

<TR VALIGN="top">
<TD width=6%><B>00</B></TD>
<TD width=39%><B><CODE>ULONG&nbsp;&nbsp;&nbsp;&nbsp;DDB_phys_addr</CODE></B></TD>
<TD width=55%>Physical address of DDB.</TD>
</TR>

<TR VALIGN="top">
<TD width=6%><B>04</B></TD>
<TD width=39%><B><CODE>ULONG&nbsp;&nbsp;&nbsp;&nbsp;DDB_Next_DDB</CODE></B></TD>
<TD width=55%>Next DDB on dvt_DDB chain.</TD>
</TR>

<TR VALIGN="top">
<TD width=6%><B>08</B></TD>
<TD width=39%><B><CODE>ULONG&nbsp;&nbsp;&nbsp;&nbsp;DDB_Next_DDB_init</CODE></B></TD>
<TD width=55%>Next DDB on dvt_DDB_init chain (used by IOS to manage DDBs for all DVTs).</TD>
</TR>

<TR VALIGN="top">
<TD width=6%><B>0C</B></TD>
<TD width=39%><B><CODE>ULONG&nbsp;&nbsp;&nbsp;&nbsp;DDB_dcb_ptr</CODE></B></TD>
<TD width=55%>Pointer to first DCB owned by this DDB.</TD>
</TR>

<TR VALIGN="top">
<TD width=6%><B>10</B></TD>
<TD width=39%><B><CODE>UCHAR&nbsp;&nbsp;&nbsp;&nbsp;DDB_number_buses</CODE></B></TD>
<TD width=55%>Number of buses supported by the adapter.</TD>
</TR>

<TR VALIGN="top">
<TD width=6%><B>11</B></TD>
<TD width=39%><B><CODE>UCHAR&nbsp;&nbsp;&nbsp;&nbsp;DDB_ios_flags</CODE></B></TD>
<TD width=55%>IOS private flags - read only for non-IOS.</TD>
</TR>

<TR VALIGN="top">
<TD width=6%><B>12</B></TD>
<TD width=39%><B><CODE>USHORT&nbsp;&nbsp;&nbsp;&nbsp;DDB_sig</CODE></B></TD>
<TD width=55%>DWORD padding (also DDB signature for asserting).</TD>
</TR>

<TR VALIGN="top">
<TD width=6%><B>14</B></TD>
<TD width=39%><B><CODE>PDVT&nbsp;&nbsp;&nbsp;&nbsp;DDB_dvt</CODE></B></TD>
<TD width=55%>Pointer to this DDB's DVT.</TD>
</TR>

<TR VALIGN="top">
<TD width=6%><B>18</B></TD>
<TD width=39%><B><CODE>DEVNODE DDB_devnode_ptr</CODE></B></TD>
<TD width=55%>Pointer to Plug and Play device node for device.</TD>
</TR>

<TR VALIGN="top">
<TD width=6%><B>1C</B></TD>
<TD width=39%><B><CODE>PDDB_ACPI_BLOCK  DDB_pAcpiBlock </CODE></B></TD>
<TD width=55%>(Win98/Me. IDE ACPI support. NULL if IDE is not behind ACPI).</TD>
</TR>
</TABLE><BR>

<P>_DDB_ACPI_BLOCK </P>

<P>(pointed to by DDB_pAcpiBlock above)</P>

<TABLE border=1 frame=box rules=all>

<TR VALIGN="top">
<TD width=6%><B>Offset</B></TD>
<TD width=39%>
<PRE><B>Element</B></PRE>
</TD>
<TD width=55%><B>Comments</B></TD>
</TR>

<TR VALIGN="top">
<TD width=6%><B><CODE>00</CODE></B></TD>
<TD width=39%><B><CODE>TIMINGMODEEX  DDB_ACPI_TimingMode</CODE></B></TD>
<TD width=55%>Future use (all fields in debug dump that begin with “tm_”).</TD>
</TR>

<TR VALIGN="top">
<TD width=6%><B><CODE>14</CODE></B></TD>
<TD width=39%><B><CODE>BYTE  DDB_ACPI_bPowerState</CODE></B></TD>
<TD width=55%>Current ACPI Power State (e. g. CM_POWERSTATE_D0).</TD>
</TR>

<TR VALIGN="top">
<TD width=6%><B><CODE>15</CODE></B></TD>
<TD width=39%><B><CODE>BYTE  DDB_ACPI_bIdeLevel</CODE></B></TD>
<TD width=55%>IDE compliance level.</TD>
</TR>

<TR VALIGN="top">
<TD width=6%><B><CODE>16</CODE></B></TD>
<TD width=39%><B><CODE>WORD  DDB_ACPI_wSig</CODE></B></TD>
<TD width=55%>Signature (0x5043).</TD>
</TR>

<TR VALIGN="top">
<TD width=6%>&nbsp;</TD>
<TD width=39%><B>(Each of the following arrays contain two elements, to accommodate both primary and secondary IDE controller)</B></TD>
<TD width=55%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=6%><B><CODE>18</CODE></B></TD>
<TD width=39%><B><CODE>ULONG  DDB_ACPI_hTaskFile[2]</CODE></B></TD>
<TD width=55%>Future use.</TD>
</TR>

<TR VALIGN="top">
<TD width=6%><B><CODE>20</CODE></B></TD>
<TD width=39%><B><CODE>ULONG  DDB_ACPI_dwEidLength[2]</CODE></B></TD>
<TD width=55%>Length of ATA EID structure.</TD>
</TR>

<TR VALIGN="top">
<TD width=6%><B><CODE>28</CODE></B></TD>
<TD width=39%><B><CODE>ULONG  DDB_ACPI_dwEid[2]</CODE></B></TD>
<TD width=55%>Future use.</TD>
</TR>

<TR VALIGN="top">
<TD width=6%><B><CODE>30</CODE></B></TD>
<TD width=39%><B><CODE>ULONG  DDB_ACPI_dwTaskFileLength[2]</CODE></B></TD>
<TD width=55%>Future use.</TD>
</TR>

<TR VALIGN="top">
<TD width=6%><B><CODE>38</CODE></B></TD>
<TD width=39%><B><CODE>ULONG  DDB_ACPI_dwTaskFile[2]</CODE></B></TD>
<TD width=55%>Future use.</TD>
</TR>
</TABLE><BR>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: DVT%20(Driver%20Vector%20Table)"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
