<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Begin_Service_Table</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_1701"></A>Begin_Service_Table</H1>

<PRE>include vmm.inc

Begin_Service_Table DeviceName
Begin_Service_Table DeviceName, DefSegment
 </PRE>

<P>Marks the start of the service table for a virtual device. A virtual device uses the service table to export the names and addresses of its services. Other virtual devices can use the <B>VxDCall</B> macro to call these services. 

<UL>
	<LI>No return value. </LI>
</UL>

<DL>
<DT><I>DeviceName</I></DT>

<DD>Name of the virtual device. This name is used to create a macro, named <I>DeviceName</I><B>_Service</B>, that is used in the table to define each exported service. For more information about the macro, see below. </DD>

<DT><I>DefSegment</I></DT>

<DD>Not used with Windows95 VxDs. This parameter exists solely for compatibility with Windows 3.1 VxDs. 
</DD>
</DL>

<P>A virtual device exports its services by defining the symbol <B>Create_</B><I>DeviceName</I><B>_Service_Table</B> before using the <B>Begin_Service_Table</B> macro. Virtual devices that call these service also use the <B>Begin_Service_Table</B> macro but must <I>not</I> define the <B>Create_</B><I>DeviceName</I><B>_Service_Table</B> symbol. </P>

<P>The complete service table has the following form: </P>

<P><B>Begin_Service_Table</B> <I>DeviceName</I></P>

<P><I>DeviceName</I><B>_Service</B> <I>Procedure</I>, <I>LocalSeg</I></P>

<P>. </P>

<P>. </P>

<P>. </P>

<P><B>End_Service_Table</B> <I>DeviceName</I></P>

<P>The <I>DeviceName</I><B>_Service</B> macro, created by <B>Begin_Service_Table</B>, adds the specified service to the table. A table may have any number of these macros. </P>

<P>The <I>Procedure</I> parameter specifies the name of the service to add to the table. If RESERVED is given, the macro reserves an entry in the table instead of adding a procedure. </P>

<P>The <I>LocalSeg</I> parameter specifies which segment contains the procedure. This parameter is optional and exists for compatibility with Windows 3.1. You shouldn't need to provide a local segment. </P>

<H4>See Also</H4>

<P><B>End_Service_Table</B>, <B>VxD_LOCKED_DATA_SEG</B> </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Begin_Service_Table"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
