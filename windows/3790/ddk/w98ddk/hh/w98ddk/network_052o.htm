<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Network Provider SPI</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_3260"></A>Network Provider SPI</H1>

<P>The WinNet application programming interface (API) was introduced in Microsoft(r) Windows(r) version 3.0 to provide a generic network interface for the Windows shell and system utilities, providing an interface which is generally available across many networks. It was used only by Windows, and was not documented for third-party application developers. Major categories of functionality included making and breaking network connections, and printing. </P>

<P>In Windows for Workgroups 3.1, support was added so that two networks could coexist, each with their own implementation of the WinNet API. This was achieved by adding an extra layer of routing software that was used when two networks were running. </P>

<P>In Windows NT/Windows 2000, the layer of routing software (the Multiple Provider Router, or MPR) was made mandatory, even for one network. The layer contains the network-independent APIs that are generally available to all application writers and are documented in the Win32 API Specification. Making the layer mandatory simplifies writing the networking software for a specific network to interface to Windows (the network provider, or NP software). </P>

<P>Features that are common to all networks are implemented once in the MPR, which reduces the code base of each NP and ensures common behavior between networks. For example, NPs do not implement persistent connections. This feature is implemented in the MPR and is entirely transparent to an NP. </P>

<P>In Windows 95, the same approach is taken as in Windows NT/Windows 2000. Extensions have been added to the Windows NT/Windows 2000 interfaces to provide a greater level of integration between the shell, the desktop, and the networks. Particular features that are more tightly integrated are network browsing, viewing network specific information, and connecting to networks. </P>

<P>The set of interfaces that a network vendor implements in the NP to interface to Windows is the network service provider interface (SPI). Applications do not call these SPIs directly. Instead, the Win32 functions they call are routed by the MPR to the SPIs of the appropriate provider. </P>

<P>In summary, in Windows 95 each network implements a provider, and Windows handles communicating with all the providers present to provide an integrated network interface to the user. The integration is handled by the MPR Windows component, which is implemented as a DLL. The MPR calls an NP through the SPIs implemented by the NP. </P>

<P>This documentation describes how a network vendor should implement the SPIs in an NP to integrate its network into Windows 95. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Network%20Provider%20SPI"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
