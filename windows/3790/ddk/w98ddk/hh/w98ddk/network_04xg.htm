<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>WNetGetConnection</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_3234"></A>WNetGetConnection</H1>

<P>This function is used to determine the name of the network resource associated with a local device. </P>

<PRE>DWORD WNetGetConnection(
    LPTSTR lpLocalName,
    LPTSTR lpRemoteName,
    LPDWORD lpBufferSize
    );
 </PRE>

<DL>
<DT><I>lpLocalName</I> </DT>

<DD>Contains the name of the local device the caller is interested in. </DD>

<DT><I>lpRemoteName</I> </DT>

<DD>Points to a buffer to receive the remote name used to make the connection. </DD>

<DT><I>lpBufferSize</I> </DT>

<DD>This is used to specify the size of the buffer passed in. If the call fails because the buffer is not big enough, this location will be used to return the required buffer size. </DD>
</DL>

<UL>
	<LI>WN_SUCCESS if the call is successful. Other error codes include: </LI>
</UL>

<TABLE>

<TR VALIGN="top">
<TD width=43%>WN_BAD_LOCALNAME </TD>
<TD width=57%><I>lpLocalName</I> is invalid </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WN_NOT_CONNECTED </TD>
<TD width=57%><I>lpLocalName</I> not a redirected device </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WN_MORE_DATA </TD>
<TD width=57%>the buffer is too small </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WN_CONNECTION_CLOSED </TD>
<TD width=57%>the device is not currently connected, but it is a persistent connection. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WN_FUNCTION_BUSY </TD>
<TD width=57%>The MPR or NP is busy (possibly initializing). The caller should retry. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WN_NO_NETWORK </TD>
<TD width=57%>network is not present </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WN_EXTENDED_ERROR </TD>
<TD width=57%>a network specific error occurred. <B>WNetGetLastError</B> should be called to obtain a description of the error. </TD>
</TR>
</TABLE><BR>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: WNetGetConnection"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
