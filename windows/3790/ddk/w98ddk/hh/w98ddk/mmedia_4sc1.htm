<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>MCI_INFO</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_2571"></A>MCI_INFO</H1>

<P>Obtains string information from a device. All devices respond to this message. The parameters and flags available for this message depend on the selected device. Information is returned in the <B>lpstrReturn</B> member of the structure identified by <I>lpInfo</I>. The <B>dwReturnSize</B> member specifies the buffer length for the return data. 

<UL>
	<LI>Returns zero if successful. Otherwise, it returns an MCI error code. </LI>
</UL>

<DL>
<DT>DWORD <I>lParam1</I> </DT>

<DD>The following standard and command-specific flags apply to all devices: 

<TABLE>

<TR VALIGN="top">
<TD width=25%>MCI_NOTIFY </TD>
<TD width=75%>Specifies that MCI should post the <B>MM_MCINOTIFY</B> message when this command completes. The window to receive this message is specified in the <B>dwCallback</B> member of the structure identified by <I>lpInfo</I>. </TD>
</TR>

<TR VALIGN="top">
<TD width=25%>MCI_WAIT </TD>
<TD width=75%>Specifies that the query operation should finish before MCI returns control to the application. </TD>
</TR>

<TR VALIGN="top">
<TD width=25%>MCI_INFO_PRODUCT </TD>
<TD width=75%>Obtains a description of the hardware associated with a device. Devices should supply a description that identifies both the driver and the hardware used. </TD>
</TR>
</TABLE><BR>

</DD>

<DT>LPMCI_INFO_PARMS <I>lParam2</I> </DT>

<DD>Specifies a far pointer to the <B>MCI_INFO_PARMS</B> structure. (Devices with extended command sets might replace this structure with a device-specific structure.) 
</DD>
</DL>

<H4>Animation Extensions</H4>

<P>The following additional flags for <I>lParam1</I>apply to animation devices: </P>

<TABLE>

<TR VALIGN="top">
<TD width=28%>MCI_INFO_FILE </TD>
<TD width=72%>Obtains the filename of the current file. This flag is only supported by devices that return TRUE to the MCI_GETDEVCAPS_USES_FILES query. </TD>
</TR>

<TR VALIGN="top">
<TD width=28%>MCI_ANIM_INFO_TEXT </TD>
<TD width=72%>Obtains the window caption. </TD>
</TR>
</TABLE><BR>

<P>Note that <I>lParam2</I>specifies a far pointer to the <B>MCI_INFO_PARMS</B> structure. </P>

<H4>Video Overlay Extensions</H4>

<P>The following additional flags for <I>lParam1</I>apply to video overlay devices: </P>

<TABLE>

<TR VALIGN="top">
<TD width=28%>MCI_INFO_FILE </TD>
<TD width=72%>Obtains the filename of the current file. This flag is only supported by devices that return TRUE to the MCI_GETDEVCAPS_USES_FILES query. </TD>
</TR>

<TR VALIGN="top">
<TD width=28%>MCI_OVLY_INFO_TEXT </TD>
<TD width=72%>Obtains the caption of the window associated with the overlay device. </TD>
</TR>
</TABLE><BR>

<P>Note that <I>lParam2</I> specifies a far pointer to the <B>MCI_INFO_PARMS</B> structure. </P>

<H4>Waveform Audio Extensions</H4>

<P>The following additional flags for <I>lParam1</I> apply to waveform audio devices: </P>

<TABLE>

<TR VALIGN="top">
<TD width=28%>MCI_INFO_FILE </TD>
<TD width=72%>Obtains the filename of the current file. This flag is supported by devices that return TRUE to the MCI_GETDEVCAPS_USES_FILES query. </TD>
</TR>

<TR VALIGN="top">
<TD width=28%>MCI_WAVE_INPUT </TD>
<TD width=72%>Obtains the product name of the current input. </TD>
</TR>

<TR VALIGN="top">
<TD width=28%>MCI_WAVE_OUTPUT </TD>
<TD width=72%>Obtains the product name of the current output. </TD>
</TR>
</TABLE><BR>

<P>Note that <I>lParam2</I> specifies a far pointer to the <B>MCI_INFO_PARMS</B> structure. </P>

<P>If an application requests return-string information and it does not supply a buffer large enough to hold it, your device driver should fill the buffer and truncate the string. Return MCIERR_PARAM_OVERFLOW to indicate the information in the buffer was truncated. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: MCI_INFO"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
