<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>PQUERYHANDLER</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="_pss_3858"></A>PQUERYHANDLER</H3>

<PRE>typedef VMMREGRET (_cdecl *PQUERYHANDLER)(PVOID pvKeyContext, 
      PVALCONTEXT pvalcontextValues, DWORD cvalcontextValues, 
      PBYTE pbData, DWORD* pcbData, DWORD dwReserved);
 </PRE>

<P>This is the type definition for the provider, or handler function. 

<DL>
<DT><I>pvKeyContext</I> </DT>

<DD>This is the key context; it is an input paramater that lets the provider know which key is being queried, if this handler function handles multiple keys. </DD>

<DT><I>pvalcontextValues</I> </DT>

<DD>This is an array of <B>val_context</B> structures; one structure per value. Parts of the <B>val_context</B> structure are input parameters, and parts are output parameters - please see the comments for the <B>val_context</B> structure. </DD>

<DT><I>cvalcontextValues</I> </DT>

<DD>This is the number of <B>val_context</B> structures in the array of the previous argument; it is an input parameter. </DD>

<DT><I>pbData</I> </DT>

<DD>This is a buffer, supplied by the registry to the provider, in which the provider stores the value or values that are queried. If the registry is keeping track of the value lengths, this buffer should always be large enough. </DD>

<DT><I>pcbData</I> </DT>

<DD>A pointer to the length of the <I>pbData </I>buffer. On input, it contains the size of the available buffer. On output, it should contain the size of the buffer that is actually used / filled. </DD>

<DT><I>dwReserved</I> </DT>

<DD>Reserved. 
</DD>
</DL>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: PQUERYHANDLER"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
