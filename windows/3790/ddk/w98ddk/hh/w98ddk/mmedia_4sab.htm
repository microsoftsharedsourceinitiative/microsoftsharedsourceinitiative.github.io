<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>MCI_CLOSE</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_2563"></A>MCI_CLOSE</H1>

<P>Releases access to a device or device element. All devices respond to this message. MMSYSTEM translates this message to the DRV_CLOSE and MCI_CLOSE_DRIVER messages sent to the device driver. 

<UL>
	<LI>Returns zero if successful. Otherwise, it returns an MCI error code. </LI>
</UL>

<DL>
<DT>DWORD <I>lParam1</I> </DT>

<DD>The following flags apply to all devices: 

<TABLE>

<TR VALIGN="top">
<TD width=18%>MCI_NOTIFY </TD>
<TD width=82%>Specifies that MCI should post the <B>MM_MCINOTIFY</B> message when this command completes. The window to receive this message is specified in the <B>dwCallback</B> member of the structure identified by <I>lpDefault</I>. Device drivers should send <B>MM_MCINOTIFY</B> just before returning from MCI_CLOSE_DRIVER. </TD>
</TR>

<TR VALIGN="top">
<TD width=18%>MCI_WAIT </TD>
<TD width=82%>Specifies that the close operation should finish before MCI returns control to the application. </TD>
</TR>
</TABLE><BR>

</DD>

<DT>LPMCI_GENERIC_PARMS <I>lParam2</I> </DT>

<DD>Specifies a far pointer to the <B>MCI_GENERIC_PARMS</B> structure. (Devices with extended command sets might replace this structure with a device-specific structure.) 
</DD>
</DL>

<P>Exiting an application without closing any MCI devices it has opened can leave the device opened and not accessible. Your application should explicitly close each device or device element when it is finished with it. MCI unloads the device when all instances of the device or all device elements are closed. </P>

<H4>See Also</H4>

<P>MCI_CLOSE_DRIVER, MCI_OPEN, MCI_OPEN_DRIVER </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: MCI_CLOSE"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
