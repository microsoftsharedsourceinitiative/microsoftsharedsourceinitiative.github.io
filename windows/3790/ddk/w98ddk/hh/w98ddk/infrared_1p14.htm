<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Step 5. Using the IR Communications Software to Experiment with Your IR Device</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="_pss_858"></A>Step 5. Using the IR Communications Software to Experiment with Your IR Device</H2>

<P>You can test your VxD by experimenting with changing the speeds at which your dongles transmit and receive. You can use the baud rate negotiation logic that is built into the IR communications software. When two dongles recognize each other, they start communicating at 9600 baud and then tryout higher speeds until the highest baud rate each dongle is capable of is reached. By changing the values in the baud rate mask in the <B>type_Init</B> function of your OEMDONGL.C source code between sessions, you can experiment with higher and higher baud rates in each communications session between your two dongles. </P>

<P>For example, here is one experimental scenario: 

<OL>
	<LI>Set the baud rate mask to 9600 baud in OEMDONGL.C by editing the SpeedMask constant. For example, if your dongle type is "RED88" then you could edit the following line of code in OEMDONGL.C to look like this: 
<PRE>#define RED88_SPEEDMASK      0x00000002
 </PRE>
</LI>

	<LI>Rebuild your version of OEMDONGL.VXD. </LI>

	<LI>Reinstall IR Communications for Windows 95 on each machine that has your IR dongle attached. </LI>

	<LI>With the two dongles facing each other and less than 3 feet apart, run the IR Monitor application on each machine. The two dongles will recognize each other and negotiate a communication speed of 9600 baud. </LI>

	<LI>Set the baud rate mask to include the next highest baud rate both dongles are capable of. For example, if the two dongles are capable of 19200 baud as well as 9600 baud, edit the line of code to look like this: 
<PRE>#define RED88_SPEEDMASK      0x00000006
 </PRE>
</LI>

	<LI>Repeat steps B through D so the dongles can negotiate the jump from 9600 to 19200 baud. </LI>
</OL>

<P>You can use this same process to try the dongles at other baud rates all the way up to 115200, if they are capable of it. The bit pattern settings in the baud rate capabilities mask for all these baud rates are shown in <I>Adapting the type_Init Function</I>. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Step%205.%20Using%20the%20IR%20Communications%20Software%20to%20Experiment%20with%20Your%20IR%20Device"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
