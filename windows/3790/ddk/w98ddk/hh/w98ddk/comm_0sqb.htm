<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Event Services</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="_pss_13"></A>Event Services</H3>

<P>A VCOMM client can receive notifications when communications events occur or when the receive and transmit queues pass specified thresholds. To receive notifications for events, call the <B>_VCOMM_EnableCommNotification</B> service. To receive notifications when queue thresholds are reached, call the <B>_VCOMM_SetReadCallback</B> and <B>_VCOMM_SetWriteCallback</B> services. All three services register client-defined callback functions with the port driver. For information about the callback functions, see the description of the <B>CommNotifyProc</B> function. </P>

<P>You receive notifications for communications events only if the events are enabled. To enable events, call the <B>_VCOMM_SetCommEventMask</B> service; this service specifies the event mask and, optionally, the address of the event variable. The <I>event mask</I> is a 32-bit variable that specifies the combination of enabled events. The <I>event variable</I> is a 32-bit variable that specifies the enabled events that were detected; the port driver updates the event variable at interrupt time when events occur. To determine which enabled events have occurred, call the <B>_VCOMM_GetCommEventMask</B> service; this service retrieves the detected events and clears the corresponding bits in the event variable. </P>

<P>If a hardware handshaking signal causes a notification, the parameters for <B>CommNotifyProc</B> identify the signal that changed but not the current state of the signal. To determine the current state of the clear to send (CTS), data set ready (DSR), receive line signal detect (RLSD), and ring signals, call the <B>_VCOMM_GetModemStatus</B> service. </P>

<H4>See Also</H4>

<P><B>CommNotifyProc</B>, <B>_VCOMM_EnableCommNotification</B>, <B>_VCOMM_GetCommEventMask</B>, <B>_VCOMM_GetModemStatus</B>, <B>_VCOMM_SetCommEventMask</B>, <B>_VCOMM_SetReadCallback</B>, <B>_VCOMM_SetWriteCallback</B> </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Event%20Services"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
