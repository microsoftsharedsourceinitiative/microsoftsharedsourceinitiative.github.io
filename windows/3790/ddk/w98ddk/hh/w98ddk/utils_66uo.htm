<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>ADRC2VXD</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="_pss_4700"></A>ADRC2VXD</H2>

<P>The ADRC2VXD command allows you to append a resource onto a VxD file. You can use this command to add version information to your VxDs. </P>

<H4>Syntax</H4>

<P><B>adrc2vxd</B> <I>vxdname</I> <I>resfilename</I> </P>

<H4>Parameters</H4>

<TABLE>

<TR VALIGN="top">
<TD width=21%><I>vxdname</I> </TD>
<TD width=79%>Specifies the VxD filename </TD>
</TR>

<TR VALIGN="top">
<TD width=21%><I>resfilename</I> </TD>
<TD width=79%>Specifies the resource file name. </TD>
</TR>
</TABLE><BR>

<H4>Examples</H4>

<P>The following example appends the resource <B>version.res</B> onto the VxD <B>vtestd.vxd</B> </P>

<PRE>adrc2vxd vtestd.vxd version.res
 </PRE>



<H4><A NAME="_pss_4701"></A>Creating a version resource</H4>

<P>You can use the following template to create a version resource for your VxD file </P>

<PRE>/********************************************************************/
/*        Version control data                                      */
/********************************************************************/
#include &lt;version.h&gt;

#define VER_FILETYPE                    VFT_VXD
#define VER_FILESUBTYPE                 DEVICE_ID
#define VER_COMPANYNAME_STR             "Company Name, Inc.\0"
#define VER_FILEDESCRIPTION_STR         "Sample VxD\0"
#define VER_INTERNALNAME_STR            "Sample\0"
#define VER_LEGALCOPYRIGHT_YEARS        "1993-1995\0"
#define VER_ORIGINALFILENAME_STR        "SAMPLE.VXD\0"

#include &lt;common.ver&gt;
 </PRE>

<P>In the example, <B>DEVICE_ID</B> is the VxD's Device ID or UNDEFINED_DEVICE_ID (defined in <B>inc32\vmm.h</B>) for dynaload VxDs. Use the resource compiler (<B>rc.exe</B>) to compile the preceding (the include files <B>version.h</B> and <B>common.ver</B> are in the <B>inc16</B> include file subdirectory) and <B>adrc2vxd</B> to add it to your VxD. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: ADRC2VXD"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
