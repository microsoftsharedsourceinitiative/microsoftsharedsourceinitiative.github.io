<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>File Format of IME</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_913"></A>File Format of IME</H1>

<P>The IMEs need to specify the following members correctly: </P>

<P>The <B>dwFileVersionMS</B> member must be specified in root block of the version information. The upper word is the major Windows version of this IME, the lower word is the minor version. </P>

<P>The <B>dwProductVersionMS</B> member must be specified in the root block of the version information. The upper word is the major version of this IME, the lower word is the minor version. </P>

<P>The <B>dwFileOS</B> member must be set to VOS__WINDOWS32 for a Windows 95 IME. </P>

<P>The <B>dwFileType</B> member must be specified in the root block of the version information. The value is VFT_DRV. </P>

<P>The <B>dwFileSubtype</B> member must be specified in the root block of the version information. The value is VFT2_DRV_INPUTMETHOD. </P>

<P>The <B>FileDescription</B> member is specified in the language-specific block of the version information. This should include the IME name and the version. This string is for display purposes and is limited to 32 TCHARs (this limit may be extended in a future version of Windows). </P>

<P>The <B>ProductName</B> is specified in the language-specific block of version information. </P>

<P>The code page (character set identifier) and language identifier are specified in the variable information block of the version information resource. If many code pages (character set identifier) and language identifiers are specified in the block, the first code page is the IME used to show the text, and the first language identifier is the language for this IME. </P>

<P>The file name of IME is 8.3 in Windows 95-FE. A Windows 95 IME must be a 32-bit DLL. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: File%20Format%20of%20IME"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
