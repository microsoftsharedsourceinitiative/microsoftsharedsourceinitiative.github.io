<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Creating a Printer Driver</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_3865"></A>Creating a Printer Driver</H1>

<P>Printer drivers are just one component of the Windows 95 printer subsystem. The architecture of the Windows 95 printer subsystem is best shown as a scenario in which each printer subsystem component contributes to moving a print job started by an application to a local printer or a network printer. Several such scenarios are presented in <I>Typical Printing Process Scenario Using a Raw Spool File</I>, <I>Typical Printing Process Scenario Using an EMF Spool File</I>, and <I>Typical Printing Process Scenario Using an EMF Spool File</I>. </P>

<P>As shown in the typical printing process scenarios, the primary function of a Windows 95 printer driver is to handle requests from GDI. In most cases, you will be able to write a printer mini driver, which is easier to do than writing a driver that contains all the code necessary to carry out all the GDI requests. </P>

<P>Microsoft provides in the Windows 95 DDK a printer driver called the <I>Universal Printer Driver</I> (<I>Unidriver</I>), which is capable of performing most GDI requests, such as printing text, rendering bitmaps, or advancing a page. Instead of developing code to support all the functions GDI supports, a printer vendor writes a <I>mini driver</I> that exports entry points that accept the GDI requests and then calls the Unidriver code to carry out the request. A mini driver also contains data that defines unique characteristics of the vendor's printer, which the Unidriver uses to adapt its actions to different printers. </P>

<P>For more information about writing a mini driver, see <I>About Printer Minidrivers</I>. </P>

<P>The Windows 95 Unidriver supports most types of printers and Microsoft provides generic printer drivers for the printer types not supported by the Unidriver. The types of printers not supported by the Unidriver are shown in the following table, along with the name of the Microsoft-provided printer driver that does support each of these printer types. </P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=33%>Printer Type </TH>
<TH align=left width=33%>Approximate Number of Printer Models of That Type </TH>
<TH align=left width=34%>File Name of Microsoft-Provided Drivers </TH>
</TR>

<TR VALIGN="top">
<TD width=33%>Color Deskjets </TD>
<TD width=33%>A handful. </TD>
<TD width=34%>DESKJETC.DRV </TD>
</TR>

<TR VALIGN="top">
<TD width=33%>Plotters </TD>
<TD width=33%>A dozen or so. </TD>
<TD width=34%>HPPLOT.DRV </TD>
</TR>

<TR VALIGN="top">
<TD width=33%>PostScript </TD>
<TD width=33%>Numerous </TD>
<TD width=34%>PSCRIPT.DRV </TD>
</TR>
</TABLE><BR>

<P>If your color desk jet, plotter, and/or Postscript printer is compatible with the Microsoft-provided driver, then you will not have to write a printer driver because you can install the Microsoft-provided driver to support your color desk jet printer, plotter or PostScript printer. </P>

<P>If you are developing an advanced, next-generation printer, which is incompatible with the Windows 95 Unidriver or PSCRIPT.DRV, DESKJETC.DRV, or HPPLOT.DRV, then you will have to create a printer driver that fully implements all of the functions required by GDI. Documentation for doing this will be provided on the MSDN CD-ROM after initial shipment of the Windows 95 DDK. Some guidelines for developing a complete printer driver (instead of developing a minidriver that works with the Windows 95 Unidriver) are given in <I>What's New for Printer Drivers in Windows 95</I>. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Creating%20a%20Printer%20Driver"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
