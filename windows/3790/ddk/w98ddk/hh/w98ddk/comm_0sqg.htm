<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>VCOMM Open - Matching Names to Drivers</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="_pss_18"></A>VCOMM Open - Matching Names to Drivers</H2>

<P>When VCOMM receives a call to open a device, it receives a string from the client which identifies the device to open. This is either a PortName string or a FriendlyName string. VCOMM searches the list of devices it has been called to load, attempting to match the string against their hardware key PortName and FriendlyName values. </P>

<P>If VCOMM matches the string to a device's PortName (for example, "COM1"), it will load the port driver VxD specified by that device's PortDriver value (for example, "serial.vxd"). Similarly, if VCOMM matches on FriendlyName (for example, "Hayes compatible modem"), it will load the port driver VxD specified by that device's FriendlyDriver key (for example, "unimodem.vxd"). In the FriendlyName case, if FriendlyDriver is not present, VCOMM will use the PortDriver instead. If no match is found, VCOMM fails the open call. </P>

<P>If the port driver is already loaded, VCOMM increments the open count for the driver. When a port is closed, VCOMM decrements the driver's open count. When a driver's open count reaches 0, it is unloaded from memory. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: VCOMM%20Open%20-%20Matching%20Names%20to%20Drivers"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
