<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Polling Routine</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="_pss_2735"></A>Polling Routine</H3>

<P>The POLL.ASM assembly language file contains a single routine, Poll, that interrogates the joystick for button press and coordinate information. Poll sets four global variables, wXpos, wYpos, wZpos, and wButtons to the coordinate and button values. The Poll function either polls the <I>x</I> and <I>y</I> axes or polls the <I>z</I> axis; for a three-dimensional joystick, IBMJOY.C calls Poll twice. </P>

<P>The Poll function is defined as follows: </P>

<PRE>extern UINT PASCAL Poll(UINT id, int zOnly)
 </PRE>

<P>The <I>id</I> parameter identifies the joystick number. The <I>zOnly</I> parameter identifies whether the <I>z</I> axis is being polled and if so, which axis of the second joystick interface is acting as the <I>z</I> axis. The <I>zOnly</I> parameter has one of the following values: </P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=12%>Value </TH>
<TH align=left width=88%>Description </TH>
</TR>

<TR VALIGN="top">
<TD width=12%> 0 </TD>
<TD width=88%>Poll <I>x</I> and <I>y</I> axes </TD>
</TR>

<TR VALIGN="top">
<TD width=12%>-1 </TD>
<TD width=88%>Poll <I>z</I> axis using the <I>x</I> axis of the second joystick interface </TD>
</TR>

<TR VALIGN="top">
<TD width=12%>1 </TD>
<TD width=88%>Poll <I>z</I> axis using the <I>y</I> axis of the second joystick interface </TD>
</TR>
</TABLE><BR>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Polling%20Routine"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
