<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Importing Services</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="_pss_4735"></A>Importing Services</H3>

<P>A virtual device can import services from another virtual device by including the virtual device's service table declaration. In such cases, the service table declaration must <I>not</I> be preceded with the device-specific symbol (as described in the previous section). For example, a virtual device that includes the file VSAMPLED.INC, which contains the service table declaration for VSAMPLED services, can call those services. A virtual device calls VMM services using the <B>VMMCall</B> macro, and calls virtual device services using the <B>VxDCall</B> macro. </P>

<P>Depending on a computer's configuration, a virtual device may fail to load when Windows starts. This means a virtual device that uses services provided by another virtual device must verify that the other virtual device services are available before calling them. To verify the services, the calling virtual device must attempt to call the <B>Get_Version</B> service of the virtual device providing the services. If the virtual device has not been loaded, the VMM sets the carry flag and returns zero in the AX register. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Importing%20Services"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
