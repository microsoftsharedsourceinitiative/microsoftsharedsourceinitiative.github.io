<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Sending Pen Device Data to Windows</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="_pss_3456"></A>Sending Pen Device Data to Windows</H2>

<P>When the Pen Services for Windows 95 system component (PENWIN.DLL) loads and initializes the pen driver, the system component registers an entry point with the driver. At each pen hardware interrupt, the pen driver receives a packet of pen data from the virtual pen driver, as described below. It then calls the registered entry point, passing the pen data on to Windows. </P>

<P>Windows uses the pen data in one of the following ways, depending upon whether the pen is currently in writing mode or is functioning as a mouse: 

<UL>
	<LI>If the pen is in writing mode, Windows displays <I>ink</I> on the screen corresponding to the new pen location. This creates a visible trail of pixels that simulates ink dropped by a real pen. </LI>

	<LI>If the pen is functioning as a mouse, Windows requests the display driver to update the position of the pen cursor. </LI>
</UL>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Sending%20Pen%20Device%20Data%20to%20Windows"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
