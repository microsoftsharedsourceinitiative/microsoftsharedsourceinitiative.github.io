<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Sample Port Monitor</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_3979"></A>Sample Port Monitor</H1>

<P>The default port monitor provided by Microsoft in Windows 95 is part of the spooler subsystem DLL. If you need to develop another port monitor, you need to package it as a separate DLL callable by the spooler subsystem. The Reference section of this section names the APIs that your DLL needs to export to be called by the spooler subsystem, and defines the members of the data structures the spooler subsystem uses to share information with a port monitor. </P>

<P>Only two APIs have to be exported by a port monitor such that they appear in the .DEF file for the monitor: <B>InitializeMonitorEx</B> and <B>DllEntryPoint</B>. The <B>InitializeMonitorEx</B> code loads the addresses (function pointers) of the other port monitor functions that the local print provider calls. For an example, see the <B>InitializeMonitorEx</B> function code in the sample port monitor code provided with the Windows 95 DDK. All the functions that the local print provider expects to call through the function pointer table are defined in the reference section. </P>

<P>The sample port monitor code is located in the SAMPLES directory after you install the Windows 95 DDK. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Sample%20Port%20Monitor"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
