<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>CHECK_SCREEN_SWITCH_OK (Function 43)</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="_pss_652"></A>CHECK_SCREEN_SWITCH_OK (Function 43)</H3>

<H4>Call With</H4>

<P>EAX: Contains -1 if running in a known VESA mode. </P>

<P>EBX: Contains the VM handle (always the Windows VM). </P>

<P>ECX: Contains the video mode number (if known). </P>

<P>EBP: Points to the Windows VM's Client Registers. </P>

<H4>Return Values</H4>

<P>CY indicates that the hi-res application may not be switched away from. NC indicates that it is safe to switch away from the hi-res application. </P>

<H4>Remarks</H4>

<P>The Main VDD calls this routine whenever a user presses ALT-ENTER or ALT-TAB to switch away from a full-screen MS-DOS prompt. The mini-VDD should determine if it knows how to restore this mode. If it is a VESA mode or standard VGA mode, the Main VDD knows how to restore it and unless the mini-VDD has special considerations, it should return NC. Otherwise, it should return CY causing the system to beep to alert the user that the hi-res VM cannot be switched away from. This notification is not given if a user presses CTRL-ALT-DEL to terminate a full-screen application. In this case, no save of the screen is attempted and it will be impossible to restore the screen if the user tries to switch back. In this case, if the user tries to switch back, the system terminates the application. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: CHECK_SCREEN_SWITCH_OK%20(Function%2043)"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
