<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Destroy_VM</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_1772"></A>Destroy_VM</H1>

<PRE>include vmm.inc

mov     ebx, VMHandle
mov     eax, Destroy_VM
VMMCall System_Control
 </PRE>

<P>Notifies the virtual device that the system is about to destroy the virtual machine. Virtual devices typically remove any data associated with the specified virtual machine. The virtual device may use all general registers and flags. 

<UL>
	<LI>This message cannot be failed. The virtual device must return carry clear. </LI>
</UL>

<DL>
<DT><I>VMHandle</I></DT>

<DD>Handle of the virtual machine about to be destroyed. 
</DD>
</DL>

<P>The <B>Destroy_VM</B> message is sent to all virtual devices in initialization order. </P>

<P>The virtual device must <I>not</I> call the <B>Simulate_Int</B> or <B>Exec_Int</B> service in the specified virtual machine. </P>

<P>Considerable time can elapse between receipt of the <B>VM_Not_Executeable</B> message and this message. Once all virtual devices return from the <B>Destroy_VM</B> and <B>Destroy_VM2</B> messages, the virtual machine is destroyed and the handle becomes invalid. </P>

<H4>See Also</H4>

<P><B>Create_VM</B>, <B>Destroy_VM2</B>, <B>VM_Not_Executeable</B> </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Destroy_VM"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
