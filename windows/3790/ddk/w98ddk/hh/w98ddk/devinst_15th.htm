<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>DiCallClassInstaller</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="DiCallClassInstaller">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_205"></A>DiCallClassInstaller</H1>

<P>Call the appropriate class installer with the specified installer function. </P>

<PRE class=syntax><B>RETERR
  DiCallClassInstaller(
   DI_FUNCTIONS</B>  <I>diFctn</I><B>,</B>
<B>   LPDEVICE_INFO</B>  <I>lpdi</I>
<B>   );</B></PRE>

<H4>Return Value</H4>

<P>Returns OK if successful, otherwise an ERR_DI_xxx error code will be returned. </P>

<H4>Parameters</H4>

<DL>
<DT><I>diFctn</I> </DT>

<DD>Class installer function to call. This can be one of the following: 

<TABLE>

<TR VALIGN="top">
<TD width=43%>DIF_SELECTDEVICE </TD>
<TD width=57%>Select a driver to be installed for the device. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>DIF_INSTALLDEVICE </TD>
<TD width=57%>Install the driver for the device. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>DIF_PROPERTIES </TD>
<TD width=57%>Display a properties dialog for the device. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>DIF_REMOVE </TD>
<TD width=57%>Remove the device. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>DIF_FIRSTTIMESETUP </TD>
<TD width=57%>Perform first time setup initialization. This message is sent during the first boot of Windows 95 and contains only class information. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>DIF_SELECTCLASSDRIVERS </TD>
<TD width=57%>Select drivers for all devices of the class specified by the lpdi. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>DIF_VALIDATECLASSDRIVERS </TD>
<TD width=57%>Ensure all devices of the class specified by the lpdi are ready to be installed. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>DIF_INSTALLCLASSDRIVERS </TD>
<TD width=57%>Install drivers for all devices of the class specified by the lpdi. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>DIF_CALCDISKSPACE </TD>
<TD width=57%>Compute the amount of disk space required by drivers for the device. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>DIF_DESTROYPRIVATEDATA </TD>
<TD width=57%>Destroy any private date referenced by the lpdi-&gt;dwClassInstallReserved. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>DIF_MOVEDEVICE </TD>
<TD width=57%>The device is being moved to a new location in HKLM\ENUM. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>DIF_DETECT </TD>
<TD width=57%>Detect any devices of class specified by the lpdi. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>DIF_INSTALLWIZARD </TD>
<TD width=57%>Add any pages necessary to the New Device Wizard for the class specified by the lpdi. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>DIF_DESTROYWIZARDDATA </TD>
<TD width=57%>Destroy any private data allocated due to a DIF_INSTALLWIZARD message. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>DIF_PROPERTYCHANGE </TD>
<TD width=57%>The device's properties are changing. The device is being enabled, disabled, or has had a resource change. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>DIF_DETECTVERIFY </TD>
<TD width=57%>The class installer should verify any devices it previously detected. Non verified devices should be removed. </TD>
</TR>

<TR VALIGN="top">
<TD width=43%>DIF_INSTALLDEVICEFILES </TD>
<TD width=57%>The class installer should only install the driver files for the selected device. </TD>
</TR>
</TABLE><BR>

</DD>

<DT><I>lpdi</I> </DT>

<DD>Pointer to a DEVICE_INFO structure for the device who's class installer is to be called. 
</DD>
</DL>

<H4>Comments</H4>

<P>This function will attempt to load and call the class installer for the class listed in the lpdi-&gt;szClassName field. If there is no class installer, or the class installer returns ERR_DI_DO_DEFAULT, then this function will call a default procedure for the specified class installer function. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: DiCallClassInstaller"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
