<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>DrvSetPrinterData</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Windows&nbsp;98/Me:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="_pss_3907"></A>DrvSetPrinterData</H1>

<PRE>DWORD DrvSetPrinterData(LPSTR lpPrinter, LPSTR lpProfile, 
    DWORD lpType, LPBYTE lpPrinterData, DWORD dwSize)
 </PRE>

<P>Enables a printer driver to store data in the registry. The data can be stored under a unique key to be retrieved later. Typically used to store data from the extended <B>DEVMODE</B> structure in the registry. 

<UL>
	<LI>Returns ERROR_SUCCESS, if successful; otherwise, returns one of the following error codes: ERROR_INVALID_PARAMETER, ERROR_INVALID_PRINTER_NAME, ERROR_MORE_DATA, or ERROR_INVALID_DATA (for the meaning of these error codes, see the winerror.h documentation). </LI>
</UL>

<TABLE>

<TR VALIGN="top">
<TD width=41%><I>lpPrinter</I> </TD>
<TD width=59%>Friendly name that identifies the printer device. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%><I>lpProfile</I> </TD>
<TD width=59%>Name of profile under which to save data. Note that setting this parameter to INT_PD_DEFAULT_DEVMODE (which is defined in PRINT.H), the default DEVMODE is used. Private profile data can be used by passing the <I>lpProfile</I> parameter from <B>ExtDeviceMode</B> (it is non-NULL) as this parameter. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%><I>lpType</I> </TD>
<TD width=59%>Type of data being stored. Use REG_BINARY for binary data (see the Win32 SDK for other registry data type descriptions). </TD>
</TR>

<TR VALIGN="top">
<TD width=41%><I>lpPrinterData</I> </TD>
<TD width=59%>Far pointer to location of data to be saved. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%><I>dwSize</I> </TD>
<TD width=59%>Buffer size at the location pointed to by the <I>lpPrinterData</I> parameter. </TD>
</TR>
</TABLE><BR>

<P>Printer drivers are strongly encouraged to use this functionality to store all printer driver settings and to avoid using INI files wherever possible. </P>

<P>Printer drivers may obtain the model name of the device, typically required by the device driver, by calling the <B>DrvGetPrinterData</B> function with the <I>lpProfile</I> parameter set to INT_PD_DEFAULT_MODEL. </P>

<P>If the data has the REG_SZ, REG_MULTI_SZ, or REG_EXPAND_SZ types, then the size of the data returned to the location pointed to by the <I>lpPrinterData</I> parameter will include the terminating NULL character. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: DrvSetPrinterData"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
