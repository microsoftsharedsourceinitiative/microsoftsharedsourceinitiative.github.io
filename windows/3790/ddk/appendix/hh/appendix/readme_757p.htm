<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>What's new in Windows 98/Windows 2000 IMM/IME</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="What's new in Windows 98/Windows 2000 IMM/IME">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Appendix:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_supp_what_s_new_in_windows_98_windows_2000_imm_ime"></A>What's new in Windows 98/Windows 2000 IMM/IME</H1>

<P>The Windows(R) 98 and Windows 5.0 IMM/IME architecture retains the Windows(R) 95/Windows NT(R) 4.0 design with some improvements to better support intelligent IME development and integration of IME with Windows. These changes are listed here.</P>

<P class=note><B>Note</B>&nbsp;&nbsp;The Platform SDK provides IME API documentation for application development. For information on IME development, refer to the Microsoft Windows NT Device Driver Kit documentation.</P>

<H1>New IME function for applications</H1>

<P>The following new IME functions allow applications to communicate with IMM/IME:

<UL>
	<LI>ImmAssociateContextEx</LI>

	<LI>ImmDisableIME</LI>

	<LI>ImmGetImeMenuItems</LI>
</UL>

<H1>New functions for IME developers</H1>

<P>The following new functions allow IMEs to communicate with IMM and applications:

<UL>
	<LI>ImmRequestMessage</LI>

	<LI>ImeGetImeMenuItems</LI>
</UL>

<H1>Supporting reconversion</H1>

<P>This is a new IME feature that allows you to re-convert a string that has already been inserted into the application's document. </P>

<P>This function will help intelligent IMEs to get more information about the converted result and improve conversion accuracy and performance.</P>

<H1>Adding IME menu items into the Context menu of the system Pen icon </H1>

<P>This new feature provides a way for IMEs to insert the IME menu items into the Context menu of System Pen Icon in System Tray.</P>

<H1>New bits and values for IME</H1>

<P>The following new bits support new conversion modes:

<UL>
	<LI>IME_CMODE_FIXED</LI>

	<LI>IME_SMODE_CONVERSATION</LI>

	<LI>IME_PROP_COMPLETE_ON_UNSELECT</LI>
</UL>

<H1>Edit control enhancement for IME</H1>

<P>Through the two new edit control messages (EM_SETIMESTATUS and EM_GETIMESTATUS), applications can manage IME status for edit controls. </P>

<H1>IME-related actions for SystemParametersInfo</H1>

<P>New uiAction for SystemParametersInfo SPI_GET/SETSHOWIMEUI are added into Windows 98 and Windows 2000. These new SPI_xx parameters are used to show or hide the IME status bar. It is a system global switch. </P>

<H1>Two New IMR messages</H1>

<P>IMR_QUERYCHARPOSITION and IMR_DOCUMENTFEED are added to Windows 98 and Windows 2000.</P>

<P>When an IME needs the information about the coordinate of a character in the composition string, the IME can send IMR_QUERYCHARPOSITION to the application.</P>

<P>With IMR_DOCUMENTFEED, an IME can get the document context from the applicationand use it for advanced intelligent conversion. </P>

<H1>64-bit compliant</H1>

<P>Two new structures (TRANSMSG and TRANSMSGLIST) are added into IMM32. They areused by INPUTCONTEXT and ImeToAsciiEx to receive IME translated message. </P>

<H1>IME_PROP_ACCEPT_WIDE_VKEY</H1>

<P>This new property is added into Windows 2000 so IME can handle the injectedUnicode by SendInput API. ImeProcessKey and ImeToAsciiEx APIs are updated to handle injected Unicode as well. The injected Unicode can be used by applicationand handwriting programs to put Unicode strings into input queue. </P>

<P></P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: What's%20new%20in%20Windows%2098%2FWindows%202000%20IMM%2FIME"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
