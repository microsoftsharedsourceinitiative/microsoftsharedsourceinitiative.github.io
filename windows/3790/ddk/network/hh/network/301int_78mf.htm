<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Introduction to Intermediate Drivers</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Introduction to Intermediate Drivers">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Network&nbsp;Devices&nbsp;and&nbsp;Protocols:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_introduction_to_intermediate_drivers_ng"></A>Introduction to Intermediate Drivers</H1>

<P>NDIS driver stacks must include miniport drivers and protocol drivers and can also include intermediate drivers. Since intermediate drivers are optional, you must understand the relationships between miniport drivers, protocol drivers, and NDIS before addressing intermediate drivers. </P>

<P>Miniport drivers control NIC devices and communicate with the lower edge of protocol drivers. Protocol drivers implement protocols, such as TCP/IP, and are above the miniport drivers in the driver stack. NDIS provides services to simplify development and maintenance of  miniport drivers and protocol drivers. </P>

<P>The relationships between miniport drivers, protocol drivers and NDIS are illustrated in the following figure.</P>

<P><IMG SRC="images/ndisdrvr.gif" ALT="" BORDER=0></P>

<P><B>Relationships Between NDIS, Miniport Drivers, and Protocol Drivers</B></P>

<P>NDIS miniport drivers and protocol drivers are bound together through standard NDIS interfaces. </P>

<P>NDIS intermediate drivers include a protocol driver interface at their lower edge and a miniport driver interface at their upper edge. The intermediate driver's protocol interface allows it to load above a driver with a miniport driver interface. Therefore, intermediate drivers can load above miniport drivers or other intermediate drivers. The intermediate driver's miniport interface allows it to load below a driver with a protocol lower edge interface. Therefore, intermediate drivers can load below protocol drivers or below other intermediate drivers.</P>

<P>The relationships between miniport drivers, protocol drivers, intermediate drivers and NDIS are illustrated in the following figure.</P>

<P><IMG SRC="images/intdriver.gif" ALT="" BORDER=0></P>

<P><B>Intermediate Driver in the NDIS Driver Stack</B></P>

<P>The intermediate driver miniport interface is called a virtual miniport. It is virtual in that it does not control a physical device directly. Instead, it relies on an underlying miniport driver to communicate with the physical device.</P>

<P>Bindings between the intermediate driver and other drivers are called external bindings. NDIS controls external bindings. The upper edge of the virtual miniport binds with the next-higher driver, which can be a protocol driver or another intermediate driver. The lower edge of the intermediate driver protocol binds to the next lower driver, which can be another intermediate driver or an underlying miniport driver.</P>

<P>The lower edge of the virtual miniport and the upper edge of the intermediate driver protocol do not require external bindings. Instead, the intermediate driver binds its virtual miniport and its protocol internally. These internal bindings, which are implementation specific, are not controlled by NDIS. </P>

<P>The following figure illustrates the internal bindings between the virtual miniport and the intermediate driver protocol.</P>

<P><IMG SRC="images/intbindings.gif" ALT="" BORDER=0></P>

<P><B>Intermediate Driver Internal Bindings</B></P>

<P>There are two types of NDIS intermediate drivers: filter intermediate drivers and MUX intermediate drivers. The following topics describe these driver types.</P>

<P class=indent1><A HREF="301int_6m3r.htm">NDIS Filter Intermediate Drivers</A></P>

<P class=indent1><A HREF="301int_31if.htm">NDIS MUX Intermediate Drivers</A></P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Introduction%20to%20Intermediate%20Drivers"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
