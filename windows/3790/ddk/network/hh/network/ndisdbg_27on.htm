<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Setting Debugging Options in the Network Class Installer</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Setting Debugging Options in the Network Class Installer">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Network&nbsp;Devices&nbsp;and&nbsp;Protocols:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="ddk_setting_debugging_options_in_the_network_class_installer_ng"></A>Setting Debugging Options in the Network Class Installer</H2>

<P>The network class installer (<I>Netdi.dll</I>) is the class installer for all network components for Windows&nbsp;Me. During installation, <I>Netdi.dll</I> produces diagnostic information in the <I>NetLog.txt</I> log file in the operating system's root directory. The checked version of <I>Netdi.dll</I> can emit extensive diagnostic information to the debugger, if a debugger is installed on the target computer. You can also set a debugging option so that <I>Netdi.dll</I> emits diagnostic information to the <I>NetLog.txt</I> file in addition to the debugger. You can set debugging options in <I>Netdi.dll</I> by setting values for the following entries under the <B>HKLM\Software\Microsoft\Windows\CurrentVersion\Network</B> registry key:</P>

<PRE>DisableEmitToDebugger (DWORD)
EnableLogging (DWORD)
ShowSelectBestCompat (DWORD)
ShowSelectedDriver (DWORD)</PRE>

<P>The following describes these debugging options:

<DL>
<DT><B>DisableEmitToDebugger</B></DT>

<DD>If set to 1, debug output is not sent to the debugger. The default value is zero.</DD>

<DT><B>EnableLogging</B></DT>

<DD>If set to 1, debug output is also appended to the <I>NetLog.txt</I> log file. By default, logging is disabled.</DD>

<DT><B>ShowSelectBestCompat</B></DT>

<DD>If set to 1 (enabled), <I>Netdi.dll</I> produces a dialog box that shows the compatible driver list during driver selection of a selected device. Device node and INF file information is shown for the most compatible and other compatible drivers. This option is available only in checked versions of <I>Netdi.dll</I>. By default, this option is disabled.</DD>

<DT><B>ShowSelectedDriver</B></DT>

<DD>If set to 1 (enabled), <I>Netdi.dll</I> produces a dialog box that is similar to the one produced with the <B>ShowSelectBestCompat</B> option when driver selection completes for a device. This option is available only in checked versions of <I>Netdi.dll</I>. By default, this option is disabled.
</DD>
</DL>

<P>Also, if you are analyzing a network installation problem during the installation or upgrade to Windows&nbsp;Me, the checked version of <I>Netdi.dll</I> can be placed in the same directory as all the other <I>.cab</I> files for Windows&nbsp;Me. This private copy of <I>Netdi.dll</I> overrides the retail copy found in the .cab file. Because a debugger is not available during an installation or upgrade, diagnostic information is automatically sent to the <I>NetLog.txt</I> file.</P>

<P class=note><B>Note</B>&nbsp;&nbsp;You must disable System File Protection (SFP) before you copy the checked version of <I>Netdi.dll</I> to the Windows\System directory of the target computer; otherwise, the original copy is silently restored. To ensure that SFP is disabled, either start from the Microsoft® Windows® Me startup floppy or start Windows&nbsp;Me in safe mode. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Setting%20Debugging%20Options%20in%20the%20Network%20Class%20Installer"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
