<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Specifying the NDIS Version Number</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Specifying the NDIS Version Number">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Network&nbsp;Devices&nbsp;and&nbsp;Protocols:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="ddk_specifying_the_ndis_version_number_ng"></A>Specifying the NDIS Version Number</H3>

<P>The <B>MajorNdisVersion</B> and <B>MinorNdisVersion</B> members in the NDIS_MINIPORT_CHARACTERISTICS structure specify the NDIS version that is compatible with the miniport driver. Valid NDIS versions numbers are 5.1, 5.0, 4.0, or 3.0. The current version is 5.1. NDIS continues to support legacy miniport drivers written for versions 4.0, and 3.0. </P>

<P>Note that the NDIS version number, in addition to being included in NDIS_MINIPORT_CHARACTERISTICS, must also be specified when the miniport driver source code is compiled. The following shows the appropriate compiler directives to embed at the start of a miniport driver's source code if the driver uses a version 5.1 NDIS_MINIPORT_CHARACTERISTICS structure:</P>

<PRE>#define NDIS_MINIPORT_DRIVER
#define NDIS51_MINIPORT   1 
#include &lt;ndis.h&gt;  // AFTER preceding directives</PRE>

<P>The following directive specifies the NDIS driver version:</P>

<P><B>#define NDISXX_MINIPORT</B></P>

<P>where XX is the NDIS version number.</P>

<P>This define statement must appear before the <B>#include</B> &lt;<I>ndis.h</I>&gt; statement. </P>

<P>Instead of using the preceding compiler directives, the same driver can set the following build directive in its <I>sources</I> file:</P>

<PRE>... 
C_FLAGS=$(C_FLAGS) -DNDIS_MINIPORT_DRIVER -DNDIS50_MINIPORT_DRIVER
...</PRE>

<P>The NDIS version specified in the NDIS_MINIPORT_CHARACTERISTICS structure must be consistent with the compiler or build directives set for the miniport driver.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Specifying%20the%20NDIS%20Version%20Number"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
