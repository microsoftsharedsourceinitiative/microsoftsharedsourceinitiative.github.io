<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>CO_AF_TAPI_SAP</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="CO_AF_TAPI_SAP">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Network&nbsp;Devices&nbsp;and&nbsp;Protocols:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_co_af_tapi_sap_nr"></A>CO_AF_TAPI_SAP</H1>

<P>The CO_AF_TAPI_SAP structure specifies TAPI service access point (SAP) information.</P>

<PRE class=syntax>typedef struct _CO_AF_TAPI_SAP
{
  IN  ULONG  ulLineID;
  IN  ULONG  ulAddressID;
  IN  ULONG  ulMediaModes;
} CO_AF_TAPI_SAP, *PCO_AF_TAPI_SAP;</PRE>

<H4>Members</H4>

<DL>
<DT><B>ulLineID</B></DT>

<DD>Specifies a zero-based line identifier. If the call manager or MCM driver does not support per-line capabilities, the client sets <B>ulLineID</B> to CO_TAPI_LINE_ID_UNSPECIFIED.</DD>

<DT><B>ulAddressID</B></DT>

<DD>Specifies a zero-based address identifier on the line specified by <B>ulLineID</B>. If the call manager or MCM driver does not support per-address capabilities, the client sets <B>ulAddressID</B> to CO_TAPI_ADDRESS_ID_UNSPECIFIED.</DD>

<DT><B>ulMediaModes</B></DT>

<DD>Specifies the media mode of the information stream of the call as one or more of the following LINEMEDIAMODE_constants:

<DL>
<DT><B>LINEMEDIAMODE_UNKNOWN</B></DT>

<DD>A media stream exists but its mode is currently unknown and may become known later. This corresponds to a call with an unclassified media type. In typical analog telephony environments, the media mode of an incoming call may be unknown until after the call has been answered and the media stream has been filtered to make a determination. 

<P>If the <B>LINEMEDIAMODE_UNKNOWN</B> flag is set, other media flags can also be set. This signifies that the media is unknown but that it is likely to be one of the other indicated media modes.
</DD>

<DT><B>LINEMEDIAMODE_INTERACTIVEVOICE</B></DT>

<DD>The presence of voice energy on the call, and the call is treated as an interactive call with humans on both ends. </DD>

<DT><B>LINEMEDIAMODE_AUTOMATEDVOICE</B></DT>

<DD>The presence of voice energy on the call, and the voice is locally handled by an automated application. </DD>

<DT><B>LINEMEDIAMODE_DATAMODEM</B></DT>

<DD>A data modem session on the call. </DD>

<DT><B>LINEMEDIAMODE_G3FAX</B></DT>

<DD>A group 3 fax is being sent or received over the call. </DD>

<DT><B>LINEMEDIAMODE_G4FAX</B></DT>

<DD>A group 4 fax is being sent or received over the call. </DD>

<DT><B>LINEMEDIAMODE_TDD</B></DT>

<DD>A TDD (telecommunication device for the deaf) session on the call. </DD>

<DT><B>LINEMEDIAMODE_DIGITALDATA</B></DT>

<DD>Digital data is being sent or received over the call. </DD>

<DT><B>LINEMEDIAMODE_TELETEX</B></DT>

<DD>A teletex session on the call. (Teletex is one of the telematic services.)</DD>

<DT><B>LINEMEDIAMODE_VIDEOTEX</B></DT>

<DD>A videotex session on the call. (Videotex is one the telematic services.) </DD>

<DT><B>LINEMEDIAMODE_TELEX</B></DT>

<DD>A telex session on the call. (Telex is one of the telematic services.) </DD>

<DT><B>LINEMEDIAMODE_MIXED</B></DT>

<DD>A mixed session on the call. (Mixed is one of the ISDN telematic services.)</DD>

<DT><B>LINEMEDIAMODE_ADSI</B></DT>

<DD>An ADSI (Analog Display Services Interface) session on the call. </DD>

<DT><B>LINEMEDIAMODE_VOICEVIEW</B></DT>

<DD>The media mode of the call is VoiceView.
</DD>
</DL>
</DD>
</DL>

<H4>Headers</H4>

<P>Declared in <I>ndis.h</I>. Include <I>ndis.h</I>.</P>

<H4>Comments</H4>

<P>A client that uses the services of a call manager or integrated MCM driver that supports the CO_ADDRESS_FAMILY_TAPI_PROXY address family specifies TAPI SAP parameters in a <A HREF="#ddk_co_af_tapi_sap_nr">CO_AF_TAPI_SAP</A> structure. The client overlays this structure on CO_SAP.<B>Sap</B>[], specifies the SAP type in CO_SAP.<B>SapType</B>, and specifies the length of the Sap[] array in CO_SAP.<B>SapLength</B>. The client passes the <A HREF="105nstru_6pki.htm">CO_SAP</A> structure to <A HREF="103ndisx_22nm.htm"><B>NdisClRegisterSap</B></A> when registering a SAP with a call manager or an MCM driver.</P>

<H4>See Also</H4>

<P><A HREF="105nstru_6pki.htm">CO_SAP</A>, <A HREF="105nstru_5zw2.htm">CO_SPECIFIC_PARAMETERS</A>, <A HREF="103ndisx_22nm.htm"><B>NdisClRegisterSap</B></A>, <A HREF="104tdlow_2faq.htm"><I>ProtocolClRegisterSapComplete</I></A>, <A HREF="104tdlow_3kky.htm"><I>ProtocolCmRegisterSap</I></A></P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: CO_AF_TAPI_SAP"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
