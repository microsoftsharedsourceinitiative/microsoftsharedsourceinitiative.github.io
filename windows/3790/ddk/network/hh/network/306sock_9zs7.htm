<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>WSH DLL Function Summary</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="WSH DLL Function Summary">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Network&nbsp;Devices&nbsp;and&nbsp;Protocols:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_wsh_dll_function_summary_ng"></A>WSH DLL Function Summary</H1>

<P>This summarizes the set of <B>WSH</B><I>Xxx</I> functions that every WSH DLL must export. Each supplier of a new transports can implement these functions in a corresponding WSH DLL according to the features supported by each transport. Windows Sockets treats all WSH DLLs as trusted code. Consequently, any bug in a <B>WSH</B><I>Xxx</I> function manifests itself as bug(s) in Windows Sockets.</P>

<P>The following summarizes the set of functions that must be exported by any transport-specific WSH DLL:</P>

<P class=indent1><A HREF="37wshfun_4pki.htm"><B>WSHEnumProtocols</B></A> returns a list of protocols (Windows Sockets PROTOCOL_INFO structures) that the WSH DLL supports. </P>

<P class=indent1><A HREF="37wshfun_5lyq.htm"><B>WSHGetSockAddrType</B></A> parses a socket address. </P>

<P class=indent1><A HREF="37wshfun_1wxe.htm"><B>WSHGetSocketInformation</B></A> is called whenever <B>getsockopt</B> is passed an option that Windows Sockets does not explicitly support.</P>

<P class=indent1><A HREF="37wshfun_57jm.htm"><B>WSHGetWildCardSockAddr</B></A> is called when Windows Sockets needs to perfom an “automatic” bind of a socket.</P>

<P class=indent1><A HREF="37wshfun_0prm.htm"><B>WSHGetWinsockMapping</B></A> returns information about the address family, socket type, and protocol parameter triples supported by the WSH DLL.</P>

<P class=indent1><A HREF="37wshfun_0b5e.htm"><B>WSHNotify</B></A> is called to notify the helper DLL of a state transition.</P>

<P class=indent1><A HREF="37wshfun_7egi.htm"><B>WSHOpenSocket</B></A> is called when a socket is opened.</P>

<P class=indent1><A HREF="37wshfun_3piq.htm"><B>WSHSetSocketInformation</B></A> is called whenever <B>setsockopt</B> is passed an option that Windows Sockets does not explicitly support.</P>

<P>To support the new Windows Sockets 2 extensions for leaf/root sockets, socket groups, and logical representation of sockets, the following optional functions should be implemented:</P>

<P class=indent1><A HREF="37wshfun_2goi.htm"><B>WSHAddressToString</B></A> returns a logical string representation of a socket address that can be used for display purposes.</P>

<P class=indent1><A HREF="37wshfun_1jea.htm"><B>WSHGetBroadcastSockaddr</B></A> obtains a valid broadcast address for a socket.</P>

<P class=indent1><A HREF="37wshfun_1k36.htm"><B>WSHGetProviderGuid</B></A> returns the GUID that identifies the protocols supported by a helper DLL.</P>

<P class=indent1><A HREF="37wshfun_7che.htm"><B>WSHGetWSAProtocolInfo</B></A> returns a pointer to protocol information for the protocol(s) supported by a helper DLL. This function is only used during setup.</P>

<P class=indent1><A HREF="37wshfun_5she.htm"><B>WSHIoctl</B></A> obtains information or performs actions based on a unique control code.</P>

<P class=indent1><A HREF="37wshfun_2s8i.htm"><B>WSHJoinLeaf</B></A> performs any protocol-specific actions that must be taken to add a socket to a multipoint session.</P>

<P class=indent1><A HREF="37wshfun_9jle.htm"><B>WSHOpenSocket2</B></A> performs the protocol-specific actions for creating a new socket. If this function is exported, it replaces the <B>WSHOpenSocket</B> function.</P>

<P class=indent1><A HREF="37wshfun_8rci.htm"><B>WSHStringToAddress</B></A> converts a logical string representation of a socket address to a SOCKADDR structure.</P>

<P>For more detailed information about these <B>WSH</B><I>Xxx</I> functions, see <A HREF="37wshfun_3v8y.htm">Windows Sockets Helper Functions</A>. </P>

<P></P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: WSH%20DLL%20Function%20Summary"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
