<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Writing an NDIS Intermediate Driver</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Writing an NDIS Intermediate Driver">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Network&nbsp;Devices&nbsp;and&nbsp;Protocols:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_writing_an_ndis_intermediate_driver_ng"></A>Writing an NDIS Intermediate Driver</H1>

<P>This section provides some basic information to help you start writing an NDIS intermediate driver. To write an NDIS intermediate driver you must understand the NDIS miniport driver and protocol driver operations and functions. </P>

<P>See also the Passthru and MUX intermediate driver samples in the DDK. These samples provide basic examples of a filter intermediate driver and an n-to-one MUX intermediate driver that you can adapt to your specific needs.</P>

<P>The virtual miniport of an NDIS intermediate driver must be deserialized. Deserialized drivers serialize the operation of their own <I>MiniportXxx</I> functions and queue internally all incoming send packets instead of relying on NDIS to perform these operations. This results in significantly better full-duplex performance, provided that the driver's critical sections (code that can be executed by only one thread at a time) are kept small. For more information on deserialized drivers, see <A HREF="201ndis_81gn.htm">Deserialized NDIS Miniport Drivers</A>.</P>

<P>An NDIS intermediate driver can support only connectionless communication at its virtual miniport. At its protocol interface, however, an NDIS intermediate driver can support either connectionless communication or connection-oriented communication. For more information about connection-oriented communication, see <A HREF="401condis_8cfb.htm">Connection-Oriented NDIS</A>.</P>

<P>An intermediate driver is typically layered above one or more NDIS miniport drivers and below a transport driver. Intermediate drivers can also be layered with other intermediate drivers. The NDIS 5.1 packet-stacking interface allows an intermediate driver to be layered with other intermediate drivers while limiting performance penalties associated with packet management.</P>

<P>The following topics provide additional information about writing NDIS intermediate drivers:</P>

<P class=indent1><A HREF="301int_6qxz.htm">MUX and Filter Intermediate Driver Differences</A></P>

<P class=indent1><A HREF="301int_27af.htm">Intermediate Driver Platform-Specific Differences</A></P>

<P class=indent1><A HREF="301int_50fb.htm">Intermediate Driver DriverEntry Function</A></P>

<P class=indent1><A HREF="301int_51bb.htm">Dynamic Binding in an Intermediate Driver</A></P>

<P class=indent1><A HREF="301int_8kbr.htm">Intermediate Driver Query and Set Operations</A></P>

<P class=indent1><A HREF="301int_955z.htm">Intermediate Driver Packet Management</A></P>

<P class=indent1><A HREF="301int_09k7.htm">Restrictions on Intermediate Drivers</A></P>

<P class=indent1><A HREF="301int_1yav.htm">Receiving Data in an Intermediate Driver</A></P>

<P class=indent1><A HREF="301int_6gyv.htm">Transmitting Packets Through an Intermediate Driver</A></P>

<P class=indent1><A HREF="301int_2gkn.htm">Handling PnP Events and PM Events in an Intermediate Driver</A></P>

<P class=indent1><A HREF="301int_8xk7.htm">Intermediate Driver Reset Operations</A></P>

<P class=indent1><A HREF="301int_7cdj.htm">Status Indications in an Intermediate Driver</A></P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Writing%20an%20NDIS%20Intermediate%20Driver"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
