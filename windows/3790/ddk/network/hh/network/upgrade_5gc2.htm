<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>NetUpgradeAddSection</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="NetUpgradeAddSection">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Network&nbsp;Devices&nbsp;and&nbsp;Protocols:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_netupgradeaddsection_nr"></A>NetUpgradeAddSection</H1>

<P>This function is <B>obsolete</B> for Windows XP (SP1 and later), Windows Server 2003, and later operating systems.</P>

<P><B>NetUpgradeAddSection</B> adds a section to the AnswerFile.</P>

<PRE class=syntax><B>LONG __stdcall
  NetUpgradeAddSection(
    IN PCWSTR</B>  <I>szSectionName</I>
    <B>);</B></PRE>

<H4>Parameters</H4>

<DL>
<DT><I>szSectionName</I></DT>

<DD>Name of the section to add to the AnswerFile.
</DD>
</DL>

<H4>Return Value</H4>

<P><B>NetUpgradeAddSection</B> can return one of the following:

<DL>
<DT>ERROR_SUCCESS</DT>

<DD>Specified section was added to the AnswerFile.</DD>

<DT>ERROR_INVALID_PARAMETER</DT>

<DD>Parameter<I> szSectionName </I>is invalid.
</DD>
</DL>

<P>Any other return value indicates a fatal error.</P>

<H4>Headers</H4>

<P>Declared in <I>OemUpGex.h</I>. Include <I>OemUpGex.h</I>. </P>

<H4>Comments</H4>

<P>A network migration DLL calls <B>NetUpgradeAddSection</B> in the context of its <B>DoPreUpgradeProcessing</B> function to add a section name to the AnswerFile (<I>winnt.sif</I>). NetSetup uses the AnswerFile during the operating system upgrade to migrate network components to upgraded operating system.</P>

<P>Typically, a network migration DLL calls <B>NetUpgradeAddSection</B> to add a component <I>OEM-section</I> to the AnswerFile. A component <I>OEM-section</I> has the following format:</P>

<P class=indent1>params.<I>post-upgrade-ID</I>.OemSection</P>

<P class=indent1>where </P>

<P class=indent1><I>post-upgrade-ID</I> is the Windows&nbsp;2000 or later <I>hw-id</I> of the network component to be upgraded.</P>

<P>A network migration DLL can add other sections to the AnswerFile. For example, the DLL can add a section to be run by NetSetup after the upgrade operating system is installed. This section could contain an <B>AddReg</B> directive that references an <I>Add-registry-section</I> added by the network migration DLL.</P>

<P>To add an entry to an AnswerFile section that it has created, the network migration DLL calls <B>NetUpgradeAddLineToSection</B>.</P>

<H4>See Also</H4>

<P><A HREF="upgrade_5kaa.htm"><B>DoPreUpgradeProcessing</B></A>, <A HREF="upgrade_1n5e.htm"><B>NetUpgradeAddLineToSection</B></A></P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: NetUpgradeAddSection"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
