<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Token Ring Operational Characteristics</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Token Ring Operational Characteristics">
<META NAME="MS-HKWD" CONTENT="OID_802_5_PERMANENT_ADDRESS">
<META NAME="MS-HKWD" CONTENT="OID_802_5_CURRENT_ADDRESS">
<META NAME="MS-HKWD" CONTENT="OID_802_5_CURRENT_FUNCTIONAL">
<META NAME="MS-HKWD" CONTENT="OID_802_5_CURRENT_GROUP">
<META NAME="MS-HKWD" CONTENT="OID_802_5_LAST_OPEN_STATUS">
<META NAME="MS-HKWD" CONTENT="OID_802_5_CURRENT_RING_STATUS">
<META NAME="MS-HKWD" CONTENT="OID_802_5_CURRENT_RING_STATE">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Network&nbsp;Devices&nbsp;and&nbsp;Protocols:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_token_ring_operational_characteristics_nr"></A>Token Ring Operational Characteristics</H1>

<P>The following chart summarizes the OIDs used to get or set Token Ring operational characteristics for NDIS drivers and NICs.</P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=15%>Length</TH>
<TH align=left width=7%>Q</TH>
<TH align=left width=7%>S</TH>
<TH align=left width=71%>Name</TH>
</TR>

<TR VALIGN="top">
<TD width=15%>6</TD>
<TD width=7%>M</TD>
<TD width=7%>&nbsp;</TD>
<TD width=71%><A HREF="#ddk_oid_802_5_permanent_address_nr">OID_802_5_PERMANENT_ADDRESS</A>  <BR>
Permanent station address</TD>
</TR>

<TR VALIGN="top">
<TD width=15%>6</TD>
<TD width=7%>M</TD>
<TD width=7%>&nbsp;</TD>
<TD width=71%><A HREF="#ddk_oid_802_5_current_address_nr">OID_802_5_CURRENT_ADDRESS</A>  <BR>
Current station address</TD>
</TR>

<TR VALIGN="top">
<TD width=15%>4</TD>
<TD width=7%>M</TD>
<TD width=7%>M</TD>
<TD width=71%><A HREF="#ddk_oid_802_5_current_functional_nr">OID_802_5_CURRENT_FUNCTIONAL</A>  <BR>
Current functional address</TD>
</TR>

<TR VALIGN="top">
<TD width=15%>4</TD>
<TD width=7%>M</TD>
<TD width=7%>M</TD>
<TD width=71%><A HREF="#ddk_oid_802_5_current_group_nr">OID_802_5_CURRENT_GROUP</A>  <BR>
Current group address</TD>
</TR>

<TR VALIGN="top">
<TD width=15%>4</TD>
<TD width=7%>M</TD>
<TD width=7%>&nbsp;</TD>
<TD width=71%><A HREF="#ddk_oid_802_5_last_open_status_nr">OID_802_5_LAST_OPEN_STATUS</A>  <BR>
Last open status</TD>
</TR>

<TR VALIGN="top">
<TD width=15%>4</TD>
<TD width=7%>M</TD>
<TD width=7%>&nbsp;</TD>
<TD width=71%><A HREF="#ddk_oid_802_5_current_ring_status_nr">OID_802_5_CURRENT_RING_STATUS</A>  <BR>
Current ring status</TD>
</TR>

<TR VALIGN="top">
<TD width=15%>4</TD>
<TD width=7%>M</TD>
<TD width=7%>&nbsp;</TD>
<TD width=71%><A HREF="#ddk_oid_802_5_current_ring_state_nr">OID_802_5_CURRENT_RING_STATE</A>  <BR>
Current ring state</TD>
</TR>
</TABLE><BR>

<P>The following describes each of the OID_<I>XXX</I> listed in the preceding chart more fully. </P>



<H3><A NAME="ddk_oid_802_5_permanent_address_nr"></A>OID_802_5_PERMANENT_ADDRESS</H3>

<P>The address of the NIC encoded in the hardware.</P>



<H3><A NAME="ddk_oid_802_5_current_address_nr"></A>OID_802_5_CURRENT_ADDRESS</H3>

<P>The address the NIC is currently using.</P>

<P>The network management software cannot set the current station address using the NDIS library. It must set the address as a configuration parameter.</P>



<H3><A NAME="ddk_oid_802_5_current_functional_nr"></A>OID_802_5_CURRENT_FUNCTIONAL</H3>

<P>The functional address enabled on the NIC for packet reception.</P>

<P>When the underlying driver initializes its NIC, it resets the functional address to zero. NDIS also initializes the packet filter so that a protocol does not receive functional address packets. </P>

<P>To receive a functional address packet, a bound protocol must later set the packet filter to include the NDIS_PACKET_TYPE_FUNCTIONAL flag. At any time, it can disable packet reception by canceling this flag. The order in which the protocol enables reception for functional address packets is unimportant.</P>



<H3><A NAME="ddk_oid_802_5_current_group_nr"></A>OID_802_5_CURRENT_GROUP</H3>

<P>The group address enabled on the NIC for packet reception.</P>



<H3><A NAME="ddk_oid_802_5_last_open_status_nr"></A>OID_802_5_LAST_OPEN_STATUS</H3>

<P>The last open error status returned for a protocol’s call to <A HREF="103ndisx_9koi.htm"><B>NdisOpenAdapter</B></A>. </P>

<P>If the open succeeded, a status code other than NDIS_STATUS_OPEN_FAILED was returned for the most recent open of the target NIC, so the value returned for this query should be zero.</P>



<H3><A NAME="ddk_oid_802_5_current_ring_status_nr"></A>OID_802_5_CURRENT_RING_STATUS</H3>

<P>The last ring status indicated with an NDIS_RING_<I>XXX</I> status code, which can be any of the following values:<BR>
NDIS_RING_SIGNAL_LOSS<BR>
NDIS_RING_HARD_ERROR<BR>
NDIS_RING_SOFT_ERROR<BR>
NDIS_RING_TRANSMIT_BEACON<BR>
NDIS_RING_LOBE_WIRE_FAULT<BR>
NDIS_RING_AUTO_REMOVAL_ERROR<BR>
NDIS_RING_REMOVE_RECEIVED<BR>
NDIS_RING_COUNTER_OVERFLOW<BR>
NDIS_RING_SINGLE_STATION<BR>
NDIS_RING_RING_RECOVERY</P>



<H3><A NAME="ddk_oid_802_5_current_ring_state_nr"></A>OID_802_5_CURRENT_RING_STATE</H3>

<P>The state of the NIC driver with respect to entering the ring, as one of the following:

<DL>
<DT><B>NdisRingStateOpened</B></DT>

<DD>Specifies an open ring.</DD>

<DT><B>NdisRingStateClosed</B></DT>

<DD>Specifies a closed ring.</DD>

<DT><B>NdisRingStateOpening</B></DT>

<DD>Specifies a ring that is opening.</DD>

<DT><B>NdisRingStateClosing</B></DT>

<DD>Specifies a ring that is closing.</DD>

<DT><B>NdisRingStateOpenFailure</B></DT>

<DD>Specifies a failure of a ring open operation.</DD>

<DT><B>NdisRingStateRingFailure</B></DT>

<DD>Specifies a failure of the ring.
</DD>
</DL>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Token%20Ring%20Operational%20Characteristics"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
