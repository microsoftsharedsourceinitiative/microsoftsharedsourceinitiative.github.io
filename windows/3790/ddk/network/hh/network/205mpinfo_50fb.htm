<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Customized OIDs and Status Indications</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Customized OIDs and Status Indications">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Network&nbsp;Devices&nbsp;and&nbsp;Protocols:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="ddk_customized_oids_and_status_indications_ng"></A>Customized OIDs and Status Indications</H2>

<P>A driver writer can create a custom OID or miniport driver status indication that NDIS maps to a custom GUID created by the writer. NDIS registers the custom GUID with WMI on behalf of the miniport driver so that WMI clients can query or set the OID or receive the custom status indication.</P>

<P>NDIS obtains a miniport driver's custom OIDs or status indications by querying the miniport driver after the miniport driver has completed initialization. To obtain such information, NDIS queries a connectionless miniport driver <A HREF="22genoid_58j6.htm">OID_GEN_SUPPORTED_GUIDS</A> and a connection-oriented miniport driver with <A HREF="211cooid_95de.htm">OID_GEN_CO_SUPPORTED_GUIDS</A>.</P>

<P>The query to OID_GEN_(CO_)SUPPORTED_GUIDS returns an array of NDIS_GUID structures to NDIS. Each NDIS_GUID structure maps a custom GUID to a custom OID or custom status indication. As described in <A HREF="205mpinfo_5lnr.htm">Filling in an NDIS_GUID Structure</A>, a major portion of the work involved in supporting custom OIDs and status indications is filling in NDIS_GUID structures. As described in <A HREF="205mpinfo_2faf.htm">Including a MOF File</A>, the other major task is to create a MOF file that describes the GUID and to compile this file with the miniport driver.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Customized%20OIDs%20and%20Status%20Indications"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
