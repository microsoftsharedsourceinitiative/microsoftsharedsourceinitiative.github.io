<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Installing Intermediate Drivers</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Installing Intermediate Drivers">
</HEAD>
<BODY TOPMARGIN="0">
<DIV STYLE="display:none;">
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_inf_copyinf_directive_dr">
</OBJECT>
</DIV>


<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Network&nbsp;Devices&nbsp;and&nbsp;Protocols:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_installing_intermediate_drivers_ng"></A>Installing Intermediate Drivers</H1>

<P>Intermediate drivers require two INF files. One of the INF files defines the installation parameters for the protocol lower edge. The other INF file defines the installation parameters for the virtual miniport upper edge.</P>

<P>The protocol INF file is the primary INF file. After the protocol lower edge is installed, the virtual miniport upper edge is installed, based upon references to the miniport INF that are defined in the protocol INF.</P>

<P>On Windows 2000 you can use a notify object or a custom setup application to copy the miniport INF file to the system INF directory. For Windows 2000 SP2 and later versions you should use the<A HREF="JavaScript:hhobj_1.Click()"> INF <B>CopyINF </B>directive</A> in the protocol INF to copy the miniport INF. For more information about the notify object and copying INF files, see <A HREF="301int_5ief.htm">Intermediate Driver Notify Object</A>.</P>

<P>The system-supplied device setup class for the protocol lower edge is <B>NetService</B> for filter intermediate drivers and <B>NetTrans</B> for MUX intermediate drivers. The driver class for the virtual miniport is always <B>Net</B>. </P>

<P>In addition to the INF files, you must also provide a notify object with a MUX intermediate driver. The notify object is optional for filter intermediate drivers. </P>

<P>The virtual miniport device is always removed from the user interface by using the <B>ExcludeFromSelect</B> directive. Therefore, the user only sees the protocol and installs the protocol from the protocol INF file. </P>

<P class=note><B>Note</B>&nbsp;&nbsp;The <B>ExcludeFromSelect</B> directive does not remove the virtual device from the <B>Connections</B> dialog box. However, the NCF_HIDDEN flag in the miniport INF file <I>DDInstall</I> section’s <B>Characteristics</B> entry prevents the virtual miniport from being displayed in any part of the user interface, including the <B>Connections</B> dialog box.</P>

<P>This section provides information about intermediate INF files and notify objects. This information is described in the following topics:</P>

<P class=indent1><A HREF="301int_90br.htm">Intermediate Driver UpperRange And LowerRange INF File Entries</A></P>

<P class=indent1><A HREF="301int_546f.htm">Filter Intermediate Driver Installation</A></P>

<P class=indent1><A HREF="301int_67l3.htm">MUX Intermediate Driver Installation</A></P>

<P class=indent1><A HREF="301int_5ief.htm">Intermediate Driver Notify Object</A></P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Installing%20Intermediate%20Drivers"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
