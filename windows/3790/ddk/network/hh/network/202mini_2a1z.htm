<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>NDIS-Supplied DMA-Related Functions</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="NDIS-Supplied DMA-Related Functions">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Network&nbsp;Devices&nbsp;and&nbsp;Protocols:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="ddk_ndis_supplied_dma_related_functions_ng"></A>NDIS-Supplied DMA-Related Functions</H2>

<P>A miniport driver calls NDIS functions for direct memory access (DMA) operations between the host and the NIC. For example, miniport drivers allocate and manage virtual memory buffers in the host for DMA transfers. The following table summarizes functions provided by the NDIS Library that allow the drivers to allocate, construct, and inspect such buffers. </P>

<P>The following table describes the DMA-related functions supplied by NDIS.</P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=23%>Function</TH>
<TH align=left width=77%>Definition</TH>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><A HREF="103ndisx_44j6.htm"><B>NdisMAllocateMapRegisters</B></A></TD>
</TR>

<TR VALIGN="top">
<TD width=23%>&nbsp;</TD>
<TD width=77%>Allocates map registers for use with bus-master DMA devices.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><A HREF="103ndisx_1ywi.htm"><B>NdisMAllocateSharedMemory</B></A></TD>
</TR>

<TR VALIGN="top">
<TD width=23%>&nbsp;</TD>
<TD width=77%>Allocates memory to be shared between the system and a bus-master DMA NIC. It is called during driver initialization at IRQL = PASSIVE_LEVEL.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><A HREF="103ndisx_3fg2.htm"><B>NdisMAllocateSharedMemoryAsync</B></A></TD>
</TR>

<TR VALIGN="top">
<TD width=23%>&nbsp;</TD>
<TD width=77%>Called at raised IRQL, such as in a miniport driver’s <A HREF="101mini_7s36.htm"><I>MiniportHandleInterrupt</I></A> function to allocate shared memory for a bus-master DMA NIC.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><A HREF="103ndisx_3pbm.htm"><B>NdisMCompleteBufferPhysicalMapping</B></A></TD>
</TR>

<TR VALIGN="top">
<TD width=23%>&nbsp;</TD>
<TD width=77%>Releases the map registers used by a previous call to <B>NdisMStartBufferPhysicalMapping</B> for a bus-master DMA operation. Called only by drivers that call <B>NdisMAllocateMapRegisters</B> during DMA initialization.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><A HREF="103ndisx_00ky.htm"><B>NdisMCompleteDmaTransfer</B></A></TD>
</TR>

<TR VALIGN="top">
<TD width=23%>&nbsp;</TD>
<TD width=77%>Indicates to the NDIS Library that a slave DMA operation has completed.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><A HREF="103ndisx_3nqq.htm"><B>NdisMDeregisterDmaChannel</B></A></TD>
</TR>

<TR VALIGN="top">
<TD width=23%>&nbsp;</TD>
<TD width=77%>Releases a miniport driver’s claim on its DMA channel.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><A HREF="103ndisx_188i.htm"><B>NdisFlushBuffer</B></A></TD>
</TR>

<TR VALIGN="top">
<TD width=23%>&nbsp;</TD>
<TD width=77%>Called by the driver before sending data to the NIC or transferring data from the NIC to ensure coherence between cache memory and host physical memory during bus-master DMA operations.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><A HREF="103ndisx_1l6a.htm"><B>NdisMFreeMapRegisters</B></A></TD>
</TR>

<TR VALIGN="top">
<TD width=23%>&nbsp;</TD>
<TD width=77%>Frees map registers for bus-master DMA that were previously allocated by <B>NdisMAllocateMapRegisters</B>. </TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><A HREF="103ndisx_9fjm.htm"><B>NdisMFreeSharedMemory</B></A></TD>
</TR>

<TR VALIGN="top">
<TD width=23%>&nbsp;</TD>
<TD width=77%>Frees memory that was previously allocated by <B>NdisMAllocateSharedMemory</B> or <B>NdisMAllocateSharedMemoryAsync</B>. </TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><A HREF="103ndisx_8cqa.htm"><B>NdisMGetDmaAlignment</B></A></TD>
</TR>

<TR VALIGN="top">
<TD width=23%>&nbsp;</TD>
<TD width=77%>Returns the alignment requirements of the DMA system for the NIC. A miniport driver can use this function to determine alignment requirements for DMA buffers that it allocates.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><A HREF="103ndisx_48aa.htm"><B>NdisMInitializeScatterGatherDma</B></A></TD>
</TR>

<TR VALIGN="top">
<TD width=23%>&nbsp;</TD>
<TD width=77%>Reserves system resources for use with DMA devices. </TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><A HREF="103ndisx_2mia.htm"><B>NdisMReadDmaCounter</B></A></TD>
</TR>

<TR VALIGN="top">
<TD width=23%>&nbsp;</TD>
<TD width=77%>Reads the current value of the system DMA controller counter. </TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><A HREF="103ndisx_1gxe.htm"><B>NdisMRegisterDmaChannel</B></A></TD>
</TR>

<TR VALIGN="top">
<TD width=23%>&nbsp;</TD>
<TD width=77%>Sets up a DMA channel for future slave DMA operations. </TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><A HREF="103ndisx_38mq.htm"><B>NdisMSetupDmaTransfer</B></A></TD>
</TR>

<TR VALIGN="top">
<TD width=23%>&nbsp;</TD>
<TD width=77%>Sets up the host system DMA controller for a slave DMA transfer.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><A HREF="103ndisx_3a42.htm"><B>NdisMStartBufferPhysicalMapping</B></A></TD>
</TR>

<TR VALIGN="top">
<TD width=23%>&nbsp;</TD>
<TD width=77%>Creates a physical address mapping for a bus-master DMA operation. Called only by drivers that call <B>NdisMAllocateMapRegisters</B> during DMA initialization.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><A HREF="103ndisx_29rm.htm"><B>NdisMUpdateSharedMemory</B></A></TD>
</TR>

<TR VALIGN="top">
<TD width=23%>&nbsp;</TD>
<TD width=77%>Ensures that data to be read from a shared memory region is up-to-date during bus-master DMA operations.</TD>
</TR>
</TABLE><BR>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: NDIS-Supplied%20DMA-Related%20Functions"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
