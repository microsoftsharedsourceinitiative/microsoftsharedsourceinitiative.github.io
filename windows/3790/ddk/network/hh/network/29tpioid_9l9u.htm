<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>OID_TAPI_SET_STATUS_MESSAGES</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="OID_TAPI_SET_STATUS_MESSAGES">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Network&nbsp;Devices&nbsp;and&nbsp;Protocols:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_oid_tapi_set_status_messages_nr"></A>OID_TAPI_SET_STATUS_MESSAGES</H1>

<P>The OID_TAPI_SET_STATUS_MESSAGES OID requests the miniport driver to allow NDISTAPI to specify which notification messages the miniport driver should generate for events related to status changes for the specified line or any of its addresses. </P>

<P>By default, address-status and line-status reporting is initially disabled for a line. </P>

<P>Support for this request is mandatory. </P>

<P>This request uses an NDIS_TAPI_SET_STATUS_MESSAGES structure, defined as follows:</P>

<PRE class=syntax>typedef struct _NDIS_TAPI_SET_STATUS_MESSAGES { 
  IN ULONG  ulRequestID; 
  IN HDRV_LINE  hdLine; 
  IN ULONG  ulLineStates; 
  IN ULONG  ulAddressStates; 
} NDIS_TAPI_SET_STATUS_MESSAGES, *PNDIS_TAPI_SET_STATUS_MESSAGES; </PRE>

<P>The members of this structure contain the following information:

<DL>
<DT><B>ulRequestID</B></DT>

<DD>Reserved.</DD>

<DT><B>hdLine</B></DT>

<DD>Specifies the miniport driver's handle to the line device.</DD>

<DT><B>ulLineStates</B></DT>

<DD>Specifies a bit array that identifies status changes for which messages should be sent to NDISTAPI. This parameter uses the LINEDEVSTATE constants. For more information, see <I>ndistapi.h</I>. </DD>

<DT><B>ulAddressStates</B></DT>

<DD>Specifies a bit array that identifies which address status changes the miniport driver should monitor to send appropriate notifications to NDISTAPI. The value is an ORed combination of LINEADDRESSSTATE flags. For more information, see <I>ndistapi.h</I>. 
</DD>
</DL>

<P>The <A HREF="101mini_7ng2.htm"><I>MiniportSetInformation</I></A> function can return one of the following:</P>

<P class=indent1>NDIS_STATUS_SUCCESS<BR>
NDIS_STATUS_PENDING<BR>
NDIS_STATUS_TAPI_INVALLINEHANDLE<BR>
NDIS_STATUS_TAPI_INVALLINESTATE<BR>
NDIS_STATUS_TAPI_RESOURCEUNAVAIL<BR>
NDIS_STATUS_FAILURE</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: OID_TAPI_SET_STATUS_MESSAGES"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
