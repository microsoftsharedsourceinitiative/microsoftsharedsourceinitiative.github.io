<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Registry Settings for a Legacy COM Port</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Registry Settings for a Legacy COM Port">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Serial&nbsp;Ports&nbsp;and&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="ddk_registry_settings_for_a_legacy_com_port_kg"></A>Registry Settings for a Legacy COM Port</H2>

<P>This section describes the registry settings that Serial uses with legacy COM ports.</P>

<P>Serial queries these entry values when it enumerates a legacy COM port. If a device-specific entry value is not present, Serial uses a Serial service value.</P>

<P>The registry settings for a legacy COM port are under a corresponding legacy COM port subkey that is under the <B>..\Services\Serial\Parameters </B>key.</P>

<P>The following entry values are the same as described for a Plug and Play COM port:</P>

<P class=indent1><B>ClockRate</B></P>

<P class=indent1><B>PortIndex, Indexed</B></P>

<P class=indent1><B>RxFIFO, TxFIFO</B></P>

<P class=indent1><B>MaskInverted</B></P>

<P class=indent1><B>DisablePort</B></P>

<P class=indent1><B>ForceFifoEnable</B></P>

<P>The following additional entry values are used with legacy COM ports:

<DL>
<DT><B>PortAddress</B></DT>

<DD>The <B>PortAddress</B> entry value specifies the untranslated base I/O address for the COM port control registers. Serial reads this value. The value can not be zero. <B>PortAddress</B> is a REG_DWORD and the default value, set internally by Serial, is zero.</DD>

<DT><B>Interrupt</B></DT>

<DD>The <B>Interrupt</B> entry value specifies the untranslated interrupt vector, as appropriate for the bus type. Serial reads this value. The value can not be zero. <B>Interrupt</B> is a REG_DWORD and the default value, internally set by Serial, is zero.</DD>

<DT><B>DosDevices</B></DT>

<DD>The <B>DosDevices</B> entry value specifies the name of the COM port. The name of a COM port is typically COM<I>&lt;n&gt;.</I> However, a COM port name can be set to any nonNULL string. Serial uses the port name to create a symbolic link to the COM port that is visible in user-mode. <B>DosDevices</B> is a REG_SZ and the default value, set by Serial for the device, is a NULL string.</DD>

<DT><B>InterruptStatus</B></DT>

<DD>The <B>InterruptStatus</B> entry value specifies the raw I/O address for the interrupt status register. Serial reads this value. The value is omitted if the port is a standalone port. The value can not be zero if the port is on multiport device. <B>InterruptStatus</B> is a REG_DWORD and the default value, set internally by Serial, is zero.</DD>

<DT><B>BusNumber</B></DT>

<DD>The <B>BusNumber</B> entry value specifies the system-wide bus number for the bus type. Serial reads this value. <B>BusNumber</B> is a REG_DWORD and the default value is zero.</DD>

<DT><B>BusType</B></DT>

<DD>The <B>BusType</B> entry value specifies the bus type. Serial reads this value. <B>BusType</B> is a REG_DWORD and the default value is determined by Serial during driver initialization.</DD>

<DT><B>InterruptMode</B></DT>

<DD>The <B>InterruptMode</B> entry value specifies the interrupt mode. Serial reads this value. <B>InterruptMode</B> is a REG_DWORD and the default value is CM_RESOURCE_INTERRUPT_LATCHED.</DD>

<DT><B>InterruptLevel</B></DT>

<DD>The <B>InterruptLevel</B> entry value specifies a raw interrupt level value, appropriate for the bus type. Serial reads this value. <B>InterruptLevel</B> is a REG_DWORD and the default value is zero.</DD>

<DT><B>PnPDeviceID</B></DT>

<DD>The <B>PnPDeviceID</B> entry value specifies a Plug and Play device ID for a Plug and Play device. Serial reads this value. <B>PnPDeviceID</B> is a REG_SZ and the default value is a NULL string.</DD>

<DT><B>LegacyDiscovered</B></DT>

<DD>The <B>LegacyDiscovered</B> entry value is a Boolean flag that indicates whether or not Serial has previously reported the device to the Plug and Play Manager. Serial reads and sets this value. If <B>LegacyDiscovered</B> is nonzero, Serial has previously reported the device. Serial does not report the device again. Otherwise, Serial reports the device and sets the entry value to 0x00000001. <B>LegacyDiscovered</B> is a REG_DWORD.
</DD>
</DL>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Registry%20Settings%20for%20a%20Legacy%20COM%20Port"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
