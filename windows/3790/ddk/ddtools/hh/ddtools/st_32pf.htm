<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>WPP Software Tracing</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="WPP Software Tracing">
</HEAD>
<BODY TOPMARGIN="0">
<DIV STYLE="display:none;">
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_wmi_event_tracing_kg">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_wmi_library_support_routines_kr">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_wmiquerytraceinformation_kr">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_wmitracemessage_kr">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_wmitracemessageva_kr">
</OBJECT>
</DIV>


<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Driver&nbsp;Development&nbsp;Tools:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_wpp_software_tracing_tools"></A>WPP Software Tracing</H1>

<P>This section describes how to use the default operation of the <I>Windows software trace preprocessor</I> (WPP) to trace a driver's operation. WPP software tracing is supported on Microsoft® Windows®&nbsp;XP and later.</P>

<P>WPP software tracing in kernel-mode drivers supplements and enhances <A HREF="JavaScript:hhobj_1.Click()">WMI event tracing</A> by adding conventions and mechanisms that simplify tracing a driver's operation. It is an efficient mechanism for user-mode applications and kernel-mode drivers to log real-time binary messages. The logged messages can subsequently be converted to a human-readable trace of the driver's operation.</P>

<P>Logging messages with WPP software tracing is similar to using Windows event logging services. The driver logs a message ID and unformatted binary data in a log file. Subsequently, a postprocessor converts the information in the log file to a human-readable form. However, WPP software tracing supports message formats that are more capable and flexible than that supported by the event logging services. For example, WPP software tracing has built-in support for IP addresses, GUIDs, system IDs, time stamps, and other useful data types. In addition, users can add types relevant to their application.</P>

<P>This section contains the following topics:</P>

<P class=indent1><A HREF="st_33sj.htm">Using WPP Software Tracing in a Driver</A></P>

<P class=indent1><A HREF="st_1dgz.htm">Adding WPP Macros to a Driver</A></P>

<P class=indent1><A HREF="st_62r7.htm">WPP Preprocessor</A></P>

<P class=indent1><A HREF="st_7aib.htm">WPP Utilities and Files</A></P>

<P class=indent1><A HREF="st_4wz7.htm">Sample WPP Software Tracing Code</A></P>

<P class=indent1><A HREF="st_4w6r.htm">WPP Software Tracing Reference</A></P>

<P>For information about the <A HREF="JavaScript:hhobj_2.Click()">WMI library support routines</A> that support WPP software tracing, see:</P>

<P class=indent1><A HREF="JavaScript:hhobj_3.Click()"><B>WmiQueryTraceInformation</B></A></P>

<P class=indent1><A HREF="JavaScript:hhobj_4.Click()"><B>WmiTraceMessage</B></A></P>

<P class=indent1><A HREF="JavaScript:hhobj_5.Click()"><B>WmiTraceMessageVa</B></A></P>

<P>See the Platform SDK documentation for general information about event tracing for Windows, WPP software tracing for user-mode applications, and all the options available with WPP software tracing.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: WPP%20Software%20Tracing"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
