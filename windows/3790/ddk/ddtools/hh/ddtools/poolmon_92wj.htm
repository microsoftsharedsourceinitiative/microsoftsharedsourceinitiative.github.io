<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>PoolMon Display</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="PoolMon Display">
</HEAD>
<BODY TOPMARGIN="0">
<DIV STYLE="display:none;">
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_exallocatepoolwithtag_kr">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_exallocatepoolwithquotatag_kr">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_exallocatepool_kr">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_exallocatepoolwithquota_kr">
</OBJECT>
</DIV>


<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Driver&nbsp;Development&nbsp;Tools:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="ddk_poolmon_display_tools"></A>PoolMon Display</H2>

<P>PoolMon displays columns of data about pool memory allocations in a command window. Use the arrow keys, PAGE UP, and PAGE DOWN keys to scroll through the data. </P>

<P class=note><B>Note</B>&nbsp;&nbsp;To see the entire PoolMon display, the Command Prompt window size must be at least 80 characters wide (width=80) and at least 53 rows high (height=53); and the Command Prompt window buffer must be at least 500 characters wide (width=500) and at least 2000 rows high (height=2000). Otherwise, the display might be truncated. </P>

<P>The following table describes the columns in the PoolMon display.</P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=24%>Column Name</TH>
<TH align=left width=76%>Description</TH>
</TR>

<TR VALIGN="top">
<TD width=24%><B>Tag</B></TD>
<TD width=76%>The 4-byte tag assigned to the pool allocation.</TD>
</TR>

<TR VALIGN="top">
<TD width=24%><B>Type</B></TD>
<TD width=76%>Whether the memory allocations are in paged or nonpaged bytes.</TD>
</TR>

<TR VALIGN="top">
<TD width=24%><B>Allocs</B></TD>
<TD width=76%>The number of allocations.</TD>
</TR>

<TR VALIGN="top">
<TD width=24%><B>( )</B></TD>
<TD width=76%>The change in the number of allocations since the last update.</TD>
</TR>

<TR VALIGN="top">
<TD width=24%><B>Frees</B></TD>
<TD width=76%>The number of free operations.</TD>
</TR>

<TR VALIGN="top">
<TD width=24%><B>( )</B></TD>
<TD width=76%>The change in the number of allocations since the last update.</TD>
</TR>

<TR VALIGN="top">
<TD width=24%><B>Diff</B></TD>
<TD width=76%>The number of allocations minus the number of free operations.</TD>
</TR>

<TR VALIGN="top">
<TD width=24%><B>Bytes</B></TD>
<TD width=76%>The size of the allocations, in bytes used.</TD>
</TR>

<TR VALIGN="top">
<TD width=24%><B>( )</B></TD>
<TD width=76%>The change in the allocation size since the last update.</TD>
</TR>

<TR VALIGN="top">
<TD width=24%><B>Per Alloc</B></TD>
<TD width=76%>The value of Bytes divided by the value of Allocs.</TD>
</TR>

<TR VALIGN="top">
<TD width=24%><B>Mapped_Driver</B></TD>
<TD width=76%>The local drivers (<B>/c</B>) and other commonly used drivers and system components (<B>/g</B>) that assign the pool tag value. This column appears only when you use the <B>/c</B> or <B>/g</B> parameters.</TD>
</TR>
</TABLE><BR>

<P>The following sample PoolMon output is sorted by number of allocations. (To sort your display this way, start PoolMon with the <B>/a</B> parameter.)</P>

<PRE> Memory:  260620K Avail:   96364K  PageFlts:     0   InRam Krnl: 1916K P:17856K
 Commit: 203500K Limit: 640916K Peak: 260632K            Pool N: 8332K P:27220K
 System pool information
 Tag  Type     Allocs            Frees            Diff   Bytes       Per Alloc

 Wait Nonp    3971107 (   0)   3971077 (   0)       30    8456 (     0)    281
 ObSt Nonp    2791258 (   0)   2791258 (   0)        0       0 (     0)      0
 Gxlt Paged   1161638 (   0)   1161630 (   0)        8     864 (     0)    108
 Ustm Paged   1088342 (   0)   1088298 (   0)       44    2464 (     0)     56
 Io   Nonp    1021112 (   1)   1020985 (   1)      127   91912 (     0)    723
 ObSq Paged    967615 (   0)    967615 (   0)        0       0 (     0)      0
 Key  Paged    954821 (   0)    953979 (   0)      842   87528 (     0)    103
 SePa Nonp     680348 (   0)    680321 (   0)       27    3656 (     0)    135
</PRE>

<H4>Update Rate</H4>

<P>PoolMon updates its display every five seconds. You cannot change the update rate.</P>

<H4>Accumulated Values</H4>

<P>The data that PoolMon displays is collected and calculated by Windows whenever pool tagging is enabled. The values for allocations, free operations, and bytes used accumulate from the time that Windows starts, and increase monotonically until Windows is restarted. If a driver or component is started after Windows has already started, the values are accumulated from the last time that the driver or component started and reset only when the driver or system is restarted.</P>

<H4>Interpreting Tag Values</H4>

<P>All pool memory allocations have tags, but they do not all have characteristic tag values. Pool memory allocations have characteristic tag values when the driver that allocates the memory sets the tag value by using <A HREF="JavaScript:hhobj_1.Click()"><B>ExAllocatePoolWithTag</B></A> or <A HREF="JavaScript:hhobj_2.Click()"><B>ExAllocatePoolWithQuotaTag</B></A>. If the driver does not assign a tag value (<A HREF="JavaScript:hhobj_3.Click()"><B>ExAllocatePool</B></A>, <A HREF="JavaScript:hhobj_4.Click()"><B>ExAllocatePoolWithQuota</B></A>), Windows still creates a tag, but it assigns the default tag value None. As a result, you cannot distinguish the statistics for that driver's allocations from that of other pool allocations.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: PoolMon%20Display"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
