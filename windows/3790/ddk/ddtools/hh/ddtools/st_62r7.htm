<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>WPP Preprocessor</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="WPP Preprocessor">
</HEAD>
<BODY TOPMARGIN="0">
<DIV STYLE="display:none;">
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_wmitracemessage_kr">
</OBJECT>
</DIV>


<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Driver&nbsp;Development&nbsp;Tools:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="ddk_wpp_preprocessor_tools"></A>WPP Preprocessor</H2>

<P>This section includes the following topics on the WPP preprocessor:

<UL>
	<LI>Invoking the WPP Preprocessor</LI>

	<LI>WPP Build Process</LI>
</UL>



<H4><A NAME="ddk_invoking_the_wpp_preprocessor_tools"></A>Invoking the WPP Preprocessor</H4>

<P>The WPP preprocessor is integrated with the DDK build environment. To invoke the default operation of the WPP preprocessor, add the following line to the end of the driver's <I>sources</I> file:</P>

<PRE>RUN_WPP= $(sources) -km
</PRE>

<P>Additional preprocessor options can also be specified. For a complete description of the WPP preprocessor's options, see the Platform SDK documentation.</P>



<H4><A NAME="ddk_wpp_build_process_tools"></A>WPP Build Process</H4>

<P>If a driver's <I>sources</I> file contains the RUN_WPP directive, running the DDK's Build utility invokes the WPP preprocessor before compiling the driver files. The WPP build process has the following two steps:

<OL>
	<LI>The WPP preprocessor processes WPP macros in each source file and creates a <I>trace message header file </I>for each source file. The header file is saved in the same directory as the source file with the same name as the source file but with a <I>.tmh</I> extension appended. For example, <I>mydriver.tmh</I> is the header file for <I>mydriver.c</I>. The header file includes macros that add trace format information to a driver's PDB file and, ultimately, result in <A HREF="JavaScript:hhobj_1.Click()"><B>WmiTraceMessage</B></A> calls in the source code. The source code is not directly modified.</LI>

	<LI>After the WPP preprocessor has created the trace message header files, the C preprocessor processes the built-in WPP macros in the trace message header files in a normal manner. </LI>
</OL>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: WPP%20Preprocessor"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
