<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>PoolMon Startup Command</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="PoolMon Startup Command">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Driver&nbsp;Development&nbsp;Tools:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="ddk_poolmon_startup_command_tools"></A>PoolMon Startup Command</H3>

<P>To start PoolMon, type a command at the command line using the following syntax and parameters.</P>

<H4>Syntax</H4>

<PRE class=syntax><B>poolmon</B> [<B>/i</B><I>Tag</I>] [<B>/x</B><I>Tag</I>] [<B>/c</B> [<I>LocalTagFile</I>]] [<B>/g</B> [<I>PoolTagFile</I>]] [<B>/s</B>[<I>TSSessionID</I>]] [ <B>/p | /p /p</B> ] [<B>/e</B>] [<B>/( | /)</B>]  [<B>/t</B> | <B>/a</B>| <B>/f</B>| <B>/d</B> | <B>/b</B>| <B>/m</B>] [<B>/l</B>] [<B>/n</B> [<I>File</I>]] [<B>/? | /h</B>] </PRE>

<H4>Parameters</H4>

<DL>
<DT><B>/i</B></DT>

<DD>Displays only the allocations with the specified pool tag. You can have multiple <B>/i</B> parameters in a PoolMon command. Do not type a space between the <B>/i</B> and the <I>Tag</I> argument.</DD>

<DT><B>/x</B></DT>

<DD>Excludes allocations with the specified tag from the display. You can have multiple <B>/x</B> parameters in a PoolMon command. Do not type a space between the <B>/x</B> and the <I>Tag</I> argument.</DD>

<DT><I>Tag</I></DT>

<DD>Specifies a pool tag or pool tag pattern. Pool tags are case-sensitive. The <I>Tag</I> argument can include an asterisk (<B>*</B>) to represent zero or more instances of any character, or a question mark (<B>?</B>) to represent one instance of any character. Do not begin a tag with an asterisk.</DD>

<DT><B>/c</B></DT>

<DD>Adds a column to the display (Mapped_Driver) listing the drivers on the local computer that assign each tag. </DD>

<DT><I>LocalTagFile</I></DT>

<DD>Specifies the path and file name of a local tag file, a formatted text file that contains a list of the drivers on the local computer, and the tag values that they assign. This file is the data source for the Mapped_Driver column that appears when you use the <B>/c</B> parameter. The default is <I>localtag.txt</I>. 

<P>If you use the <B>/c</B> parameter, but do not specify a value for <I>LocalTagFile</I>, and PoolMon does not find a <I>localtag.txt</I> file in the current directory, PoolMon generates a <I>localtag.txt</I> file by scanning the drivers on the local computer (<I>%SystemRoot%\System32\Drivers\*.sys</I>) .
</DD>

<DT><B>/g</B></DT>

<DD>Adds a column to the display (Mapped_Driver) listing Windows components and commonly used drivers that assign each tag. </DD>

<DT><I>PoolTagFile</I> </DT>

<DD>Specifies the path and file name of a formatted text file that lists the names of Windows components and commonly used drivers and the tag values they assign. This file is the data source for the Mapped_Driver column that appears when you use the <B>/g</B> parameter. 

<P>The default is <I>pooltag.txt</I>, a file provided by Microsoft. <I>Pooltag.txt</I> is included in the Windows DDK.
</DD>

<DT><B>/s</B></DT>

<DD>Displays allocations from the Terminal Services session pools.</DD>

<DT><I>TSSessionID</I></DT>

<DD>Displays only allocations from the specified session pool. Do not type a space between the <B>/s</B> parameter and the <I>TSSessionID</I> argument. </DD>

<DT><B>/p</B> </DT>

<DD>Displays only allocations from the nonpaged pool. </DD>

<DT><B>/p /p </B></DT>

<DD>Displays only allocations from the paged pool. </DD>

<DT><B>/e </B></DT>

<DD>Displays pool totals. The totals appear at the bottom of the display. </DD>

<DT><B>/(</B> or <B>/)</B> </DT>

<DD>Turns on the sort-by-change mode. With <B>/(</B> or <B>/)</B>, PoolMon sorts by the change in a value (allocation, free operations, and bytes), instead of the value. The change in each value is displayed in a parentheses after the value. 

<P>Use with <B>/a</B>, <B>/f</B>, <B>/b</B> or <B>/m</B>. For example, <B>poolmon /a</B> sorts the display by number of allocations, while <B>poolmon /( /a </B>sorts the display by the change in the number of allocations.


<P>The left parenthesis and right parenthesis characters have the same effect and can be used interchangeably.
</DD>

<DT><B>/t</B> </DT>

<DD>Sorts alphabetically by tag name. This is the default.</DD>

<DT><B>/a</B> </DT>

<DD>Sorts tags by the number of allocations.</DD>

<DT><B>/f </B></DT>

<DD>Sorts tags by the number of free operations.</DD>

<DT><B>/d</B> </DT>

<DD>Sorts tags by the difference between bytes allocations and bytes freed. </DD>

<DT><B>/b </B></DT>

<DD>Sorts tags by bytes used. </DD>

<DT><B>/m </B></DT>

<DD>Sorts tags by bytes-per-allocation.</DD>

<DT><B>/l</B></DT>

<DD>Turns highlighting off. By default, PoolMon highlights values that have changed since the last update.</DD>

<DT><B>/n</B> </DT>

<DD>Saves a snapshot of the PoolMon output to a file, instead of displaying it in a command window. You can include other command-line parameters to configure the output. 

<P>Because the snapshot data is static, the columns that show the change in values in the PoolMon display do not appear in a snapshot file.
</DD>

<DT><I>File</I></DT>

<DD>Specifies the name and location of the snapshot file. The default is <I>poolsnap.log</I>.</DD>

<DT><B>/?</B> or <B>/h</B> </DT>

<DD>Displays command-line syntax. The <B>/?</B> and <B>/h</B> parameters have the same effect and can be used interchangeably.

</DD>
</DL>

<H4>Comments</H4>

<P>PoolMon cannot generate a <I>localtag.txt</I> file on the 64-bit version of Windows Server&nbsp;2003. As a result, the <B>/c</B> parameter and its functionality are available only on 32-bit versions of Windows. </P>

<P>You can use the <B>/c</B> and <B>/g</B> parameters in the same command. If you do, the Mapped_Driver column displays data from both the local tag and pool tag files. </P>

<P>You can also use <B>/c</B> and <B>/g</B> to display data from other files in the Mapped_Driver column by specifying a file name and location with either parameter — <B>poolmon&nbsp;/c&nbsp;<I>filename</I></B> or <B>poolcom&nbsp;/g&nbsp;<I>filename</I></B>. In this case, the <B>/c</B> and <B>/g</B> parameters behave identically and can be used interchangeably.</P>

<P>Terminal Services session pool monitoring is available only on Windows Server&nbsp;2003 and later versions of Windows. </P>

<P>The kernel-mode portions of the Win32 subsystem allocate memory from Terminal Services session pools only when the computer is configured as a Terminal Server. Otherwise, Windows allocates pool memory for Terminal Services from the system pool.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: PoolMon%20Startup%20Command"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
