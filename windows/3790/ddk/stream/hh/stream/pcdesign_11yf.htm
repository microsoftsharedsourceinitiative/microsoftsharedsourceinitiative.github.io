<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Preferred Voice-Communications Device ID</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Preferred Voice-Communications Device ID">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Streaming&nbsp;Devices&nbsp;(Video&nbsp;and&nbsp;Audio):&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="ddk_preferred_voice_communications_device_id_ksg"></A>Preferred Voice-Communications Device ID</H3>

<P>In Windows&nbsp;Me, and Windows&nbsp;2000 and later, the Windows multimedia functions <B>waveInMessage</B> and <B>waveOutMessage</B> can retrieve the device ID of the preferred device for voice communications. These two functions get the preferred voice-communication device IDs for wave input and wave output, respectively. Each device ID identifies the wave device that is preferred specifically for voice communications, in contrast to the wave device that is preferred for general wave audio usage. For information on obtaining the device ID of the preferred device for general wave audio, see <A HREF="pcdesign_0ko7.htm">Accessing the Preferred Device ID</A>.</P>

<P>Knowing the preferred voice-communications device can be helpful to application programs that, for example, allow users to select a device to open from a list of two or more devices. Such an application typically needs to indicate which among the devices in the list is the preferred device.</P>

<P>To retrieve the device ID of the current preferred voice-communications device, an application calls the <B>wave<I>Xxx</I>Message</B> function with the message parameter set to the constant <A HREF="aud-prop_30dv.htm">DRVM_MAPPER_CONSOLEVOICECOM_GET</A>.</P>

<P>When calling the <B>waveInMessage</B> or <B>waveOutMessage</B> function with the DRVM_MAPPER_CONSOLEVOICECOM_GET message, specify the device handle as WAVE_MAPPER and cast this value to the appropriate handle type, HWAVEIN or HWAVEOUT. The <B>wave<I>Xxx</I>Message</B> functions accept this value in place of a valid device handle to allow an application to determine the default device ID without first having to open a device.</P>

<P>The DRVM_MAPPER_PREFERRED_GET message is intercepted by the mapper for the target device (<B>waveIn</B> or <B>waveOut</B>). For information about mappers for wave devices, see the Platform SDK documentation.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Preferred%20Voice-Communications%20Device%20ID"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
