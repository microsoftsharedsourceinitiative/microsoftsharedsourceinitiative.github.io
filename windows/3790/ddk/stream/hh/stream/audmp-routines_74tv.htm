<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>IDirectMusicSynth::SetSynthSink</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="IDirectMusicSynth::SetSynthSink">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Streaming&nbsp;Devices&nbsp;(Video&nbsp;and&nbsp;Audio):&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_idirectmusicsynth_setsynthsink_ks"></A>IDirectMusicSynth::SetSynthSink</H1>

<P>The <B>SetSynthSink</B> method establishes the connection of the synth to the wave sink.</P>

<PRE class=syntax><B>HRESULT
  SetSynthSink(
    IDirectMusicSynthSink  *</B><I>pSynthSink</I>
<B>    );</B></PRE>

<H4>Parameters</H4>

<DL>
<DT><I>pSynthSink</I></DT>

<DD>Pointer to the synth sink. This parameter either points to the <A HREF="audmp-routines_0ncj.htm"><B>IDirectMusicSynthSink</B></A> sink object to connect to the synth, or is NULL to disconnect the synth from its current synth sink.
</DD>
</DL>

<H4>Return Value</H4>

<P><B>SetSynthSink</B> returns S_OK if the call was successful. Otherwise, the method returns an appropriate error code. The following table shows some of the possible return status codes.</P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=50%>Error Code</TH>
<TH align=left width=50%>Description</TH>
</TR>

<TR VALIGN="top">
<TD width=50%>E_POINTER</TD>
<TD width=50%>Indicates that a bad pointer was passed in <I>pSynthSink</I>.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>E_FAIL</TD>
<TD width=50%>Indicates that the method failed because it was unable to connect to the <B>IDirectMusicSynthSink</B> object.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>E_OUTOFMEMORY</TD>
<TD width=50%>Indicates that not enough memory is available to establish the connection.</TD>
</TR>
</TABLE><BR>

<H4>Headers</H4>

<P>Declared in <I>dmusics.h</I>. Include <I>dmusics.h</I>.</P>

<H4>Comments</H4>

<P>Before the synthesizer can expose much of its functionality, it must be connected to a wave sink object, which is represented by the <A HREF="audmp-routines_0ncj.htm"><B>IDirectMusicSynthSink</B></A> interface. The <B>IDirectMusicSynth::SetSynthSink</B> method establishes this connection.</P>

<P>The <B>IDirectMusicSynthSink</B> object does the work of actually connecting up to the ultimate audio destination, which might be DirectSound, Win32® wave audio, or some other audio stream. The default implementation sends data to DirectSound.</P>

<P>This approach allows a synthesizer to connect to many different styles of audio out without special code within the synthesizer itself. This makes it very easy to connect one synthesizer implementation to any available wave-out device.</P>

<P>For more information, see the description of the <B>IDirectMusic</B> interface in the Platform SDK documentation.</P>

<P>The <I>pSynthSink</I> parameter follows the <A HREF="pcdesign_1y93.htm">reference-counting conventions for COM objects</A>.</P>

<H4>See Also</H4>

<P><A HREF="audmp-routines_0ncj.htm"><B>IDirectMusicSynthSink</B></A> </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: IDirectMusicSynth::SetSynthSink"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
