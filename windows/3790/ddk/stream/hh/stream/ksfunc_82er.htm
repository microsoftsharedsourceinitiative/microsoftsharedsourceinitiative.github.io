<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>KsHandleSizedListQuery</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="KsHandleSizedListQuery">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Streaming&nbsp;Devices&nbsp;(Video&nbsp;and&nbsp;Audio):&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="ddk_kshandlesizedlistquery_ks"></A>KsHandleSizedListQuery</H3>

<P>The <B>KsHandleSizedListQuery</B> function, depending on the length of the system buffer, returns either the size of the buffer needed, number of entries in the specified data list, or copies the entries themselves. This assumes the structure of KSMULTIPLE_ITEM to be a Size followed by a Count.</P>

<PRE class=syntax><B>KSDDKAPI NTSTATUS NTAPI
  KsHandleSizedListQuery(</B>
    <B>IN PIRP </B> <I>Irp</I><B>,</B>
    <B>IN ULONG </B> <I>DataItemsCount</I><B>,</B>
    <B>IN ULONG</B>  <I>DataItemSize</I><B>,</B>
    <B>IN const VOID</B>*  <I>DataItems</I>
    <B>);</B></PRE>

<H4>Parameters</H4>

<DL>
<DT><I>Irp </I></DT>

<DD>Specifies the IRP with the identifier list request.</DD>

<DT><I>DataItemsCount </I></DT>

<DD>Specifies the number of items in the identifier list.</DD>

<DT><I>DataItemSize </I></DT>

<DD>Specifies the size of a data item.</DD>

<DT><I>DataItems </I></DT>

<DD>Specifies the list of data items.
</DD>
</DL>

<H4>Return Value</H4>

<P>The <B>KsHandleSizedListQuery</B> function returns STATUS_SUCCESS if the number of entries and the data can be copied. If the buffer is larger than the size to store just the size and the count of entries but too small to contain all the entries, the function returns status STATUS_BUFFER_TOO_SMALL.</P>

<H4>Headers</H4>

<P>Declared in <I>ks.h</I>. Include <I>ks.h</I>.</P>

<H4>Comments</H4>

<P>Use the <B>KsHandleSizedListQuery</B> function when implementing properties that are to return information in the multiple item format.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: KsHandleSizedListQuery"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
