<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>IKsDataTypeCompletion::KsCompleteMediaType</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="IKsDataTypeCompletion::KsCompleteMediaType">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Streaming&nbsp;Devices&nbsp;(Video&nbsp;and&nbsp;Audio):&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_iksdatatypecompletion_kscompletemediatype_ks"></A>IKsDataTypeCompletion::KsCompleteMediaType</H1>

<P>The <B>KsCompleteMediaType</B> method completes a partially-specified media type that was first presented to the <B>IAMStreamConfig::SetFormat</B> method.</P>

<PRE class=syntax><B>HRESULT
  KsCompleteMediaType(
    IN     HANDLE  </B><I>FilterHandle</I><B>,
    IN     ULONG  </B><I>PinFactoryId</I><B>,
    IN/OUT AM_MEDIA_TYPE  *</B><I>AmMediaType</I><B>
    );</B> </PRE>

<H4>Parameters</H4>

<DL>
<DT><I>FilterHandle</I></DT>

<DD>Handle to the underlying KS filter.</DD>

<DT><I>PinFactoryId</I></DT>

<DD>Identifier of the pin factory against which the media type is being completed.</DD>

<DT><I>AmMediaType</I></DT>

<DD>Pointer to a AM_MEDIA_TYPE structure that describes the format of the media samples. <B>KsCompleteMediaType</B> receives partially specified media samples, completes the specification, and returns.
</DD>
</DL>

<H4>Return Value</H4>

<P>Returns NOERROR if successful and the media type was completed; otherwise, returns an error code.</P>

<H4>Headers</H4>

<P>Declared in <I>ksproxy.h</I>. Include <I>ksproxy.h</I>. </P>

<H4>Comments</H4>

<P>The <B>KsCompleteMediaType</B> method is primarily used for video media types, in which the <B>biSizeImage</B> member of the <A HREF="vidcapref_2l2r.htm">KS_BITMAPINFOHEADER</A> structure is known only to the driver, because of the private compression formats supported. If required, the data type handler can query the underlying KS filter in order to complete the given media type. </P>

<P>When the proxy creates an instance of the data type handler for purposes of completing a media type, the proxy passes the media type to the <A HREF="ksproxy_7703.htm"><B>IKsDataTypeHandler::KsSetMediaType</B></A> method to first initialize this data type handler to the particular media type. </P>

<P>For more information on <B>IAMStreamConfig::SetFormat</B> and AM_MEDIA_TYPE, see the Platform SDK documentation.</P>

<H4>See Also</H4>

<P><A HREF="ksproxy_7703.htm"><B>IKsDataTypeHandler::KsSetMediaType</B></A>, <A HREF="vidcapref_2l2r.htm">KS_BITMAPINFOHEADER</A> </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: IKsDataTypeCompletion::KsCompleteMediaType"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
