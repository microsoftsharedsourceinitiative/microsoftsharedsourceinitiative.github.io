<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>KsValidateConnectRequest</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="KsValidateConnectRequest">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Streaming&nbsp;Devices&nbsp;(Video&nbsp;and&nbsp;Audio):&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="ddk_ksvalidateconnectrequest_ks"></A>KsValidateConnectRequest</H3>

<P>The <B>KsValidateConnectRequest</B> function validates the structures passed to <B>IRP_MJ_CREATE</B> and returns a pointer to the connection structure and the root file object.</P>

<P>This function can only be called at PASSIVE_LEVEL.</P>

<PRE class=syntax><B>KSDDKAPI NTSTATUS NTAPI
  KsValidateConnectRequest(</B>
    <B>IN PIRP</B>  <I>Irp</I><B>,</B>
    <B>IN ULONG</B>  <I>DescriptorsCount</I><B>,</B>
    <B>IN KSPIN_DESCRIPTOR* </B> <I>Descriptor</I><B>,</B>
    <B>OUT PKSPIN_CONNECT</B>*  <I>Connect</I>
    <B>);</B></PRE>

<H4>Parameters</H4>

<DL>
<DT><I>Irp </I></DT>

<DD>Specifies the IRP handling the create request.</DD>

<DT><I>DescriptorsCount </I></DT>

<DD>Specifies the number of pin descriptors passed.</DD>

<DT><I>Descriptor </I></DT>

<DD>Specifies a pointer to the list of pin descriptors.</DD>

<DT><I>Connect </I></DT>

<DD>Specifies the returned connection structure.
</DD>
</DL>

<H4>Return Value</H4>

<P>The <B>KsValidateConnectRequest</B> function returns STATUS_SUCCESS if successful, or it returns an error.</P>

<H4>Headers</H4>

<P>Declared in <I>ks.h</I>. Include <I>ks.h</I>.</P>

<H4>Comments</H4>

<P>The <B>KsValidateConnectRequest</B> function handles basic connection structure access exceptions and validates the communication requirements, medium, protocol, and basic data format. The validation performed on the data format passed is based on the data range list for the specified pin against which a pin instance is to be created. Validation is successful in three instances: if a range major format is a wildcard, the range major format matches and the range sub-format is a wildcard, or the range major format, range sub-format, and the range specifier all match.</P>

<P>The buffer is passed a copy of the original input buffer, if the originator was not in kernel mode, and is therefore safe to access. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: KsValidateConnectRequest"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
