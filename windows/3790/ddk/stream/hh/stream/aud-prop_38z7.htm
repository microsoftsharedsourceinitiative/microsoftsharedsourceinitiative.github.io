<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>DRV_QUERYDEVICEINTERFACESIZE</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="DRV_QUERYDEVICEINTERFACESIZE">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Streaming&nbsp;Devices&nbsp;(Video&nbsp;and&nbsp;Audio):&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_drv_querydeviceinterfacesize_ks"></A>DRV_QUERYDEVICEINTERFACESIZE</H1>

<P>The DRV_QUERYDEVICEINTERFACESIZE message queries for the size of the buffer required to hold the device-interface name.</P>

<H4>Parameters</H4>

<DL>
<DT><I>dwParam1</I></DT>

<DD>Pointer to buffer size. This parameter points to a ULONG variable into which the function writes the required buffer size in bytes. The size includes storage space for the name string's terminating null. The size is zero if the device ID identifies a device that has no device interface.</DD>

<DT><I>dwParam2</I></DT>

<DD>Unused. Set this parameter to zero.</DD>
</DL>

<H4>Return Value</H4>

<P>The <B><I>xxx</I>Message</B> function returns MMSYSERR_NOERROR if the message is handled successfully. Otherwise, it returns an appropriate error code.</P>

<H4>Headers</H4>

<P>Declared in <I>mmddk.h</I>. Include <I>mmddk.h</I>.</P>

<H4>Comments</H4>

<P>The buffer size retrieved by this message is expressed as a byte count. It specifies the size of the buffer needed to hold the null-terminated Unicode string that contains the device-interface name. The caller allocates a buffer of the specified size and uses the <A HREF="aud-prop_2j3n.htm">DRV_QUERYDEVICEINTERFACE</A> message to retrieve the device-interface name string.</P>

<P>The DRV_QUERYDEVICEINTERFACESIZE message is supported in Windows&nbsp;Me, and Windows&nbsp;2000 and later.</P>

<P>This message is valid only for the <B>waveInMessage</B>, <B>waveOutMessage</B>, <B>midiInMessage</B>, and <B>midiOutMessage</B> functions.</P>

<P>The system intercepts this message and returns the appropriate value without sending the message to the device driver.</P>

<P>For more information, see <A HREF="pcdesign_8cdj.htm">Obtaining a Device Interface Name</A>.</P>

<H4>See Also</H4>

<P><A HREF="aud-prop_2j3n.htm">DRV_QUERYDEVICEINTERFACE</A> </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: DRV_QUERYDEVICEINTERFACESIZE"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
