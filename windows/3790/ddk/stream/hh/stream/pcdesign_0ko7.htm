<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Accessing the Preferred Device ID</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Accessing the Preferred Device ID">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Streaming&nbsp;Devices&nbsp;(Video&nbsp;and&nbsp;Audio):&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="ddk_accessing_the_preferred_device_id_ksg"></A>Accessing the Preferred Device ID</H3>

<P>In Windows&nbsp;Me, and Windows&nbsp;2000 and later, the Windows multimedia functions <B>waveInMessage</B>, <B>waveOutMessage</B>, and <B>midiOutMessage</B> can retrieve the device ID of the preferred device. These three functions get the preferred device IDs for wave input, wave output, and MIDI output, respectively. This information is useful to application programs that, for example, allow users to select a device to open from a list of two or more devices. Such an application typically needs to indicate which among the devices in the list is the preferred device.</P>

<P>To retrieve the device ID of the current preferred audio device, an application calls the <B><I>xxx</I>Message</B> function with the message parameter set to the constant <A HREF="aud-prop_0zw3.htm">DRVM_MAPPER_PREFERRED_GET</A>.</P>

<P>When calling the <B>waveInMessage</B>, <B>waveOutMessage</B>, or <B>midiOutMessage</B> function with the DRVM_MAPPER_PREFERRED_GET message, specify the device handle as WAVE_MAPPER (for <B>waveInMessage</B> or <B>waveOutMessage</B>) or MIDI_MAPPER (for <B>midiOutMessage</B>) and cast this value to the appropriate handle type: HWAVEIN, HWAVEOUT, or HMIDIOUT. The <B><I>xxx</I>Message</B> functions accept this value in place of a valid device handle to allow an application to determine the default device ID without first having to open a device.</P>

<P>The DRVM_MAPPER_PREFERRED_GET message is intercepted by the mapper for the target device (<B>waveIn</B>, <B>waveOut</B>, or <B>midiOut</B>). For information about mappers for wave and MIDI devices, see the Platform SDK documentation.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Accessing%20the%20Preferred%20Device%20ID"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
