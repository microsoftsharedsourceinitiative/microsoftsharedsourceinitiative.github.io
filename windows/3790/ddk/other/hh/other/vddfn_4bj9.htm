<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>RegisterModule</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="RegisterModule">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Other&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_registermodule"></A>RegisterModule</H1>

<P>This BIOS operation call is made from the 16-bit module to register a third party DLL with the BIOS operation manager. This call returns a handle to the 16-bit caller which is used later to dispatch a call to the DLL.</P>

<PRE class=syntax><B>RegisterModule(
    );</B></PRE>

<H4>Parameters</H4>

<DL>
<DT>Client DS:SI</DT>

<DD>ASCIIZ string of DLL name</DD>

<DT>Client ES:DI</DT>

<DD>ASCIIZ string of Initialization Routine in the DLL. (Optional if eS = 0 and DI = 0).</DD>

<DT>Client DS:BX</DT>

<DD>ASCIIZ string to Dispatch routine in the DLL.
</DD>
</DL>

<H4>Return Value</H4>

<P>If successful the client’s carry is cleared and the client’s handle in AX will equal (non Zero). Otherwise, the client carry will be set, and an error code will be returned in AX. </P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=17%>Client AX</TH>
<TH align=left width=83%>Error Code</TH>
</TR>

<TR VALIGN="top">
<TD width=17%>AX = 1</TD>
<TD width=83%>DLL not found.</TD>
</TR>

<TR VALIGN="top">
<TD width=17%>AX = 2</TD>
<TD width=83%>Dispatch routine not found.</TD>
</TR>

<TR VALIGN="top">
<TD width=17%>AX = 3</TD>
<TD width=83%>Initialization routine not found.</TD>
</TR>

<TR VALIGN="top">
<TD width=17%>AX = 4</TD>
<TD width=83%>Insufficient memory available.</TD>
</TR>
</TABLE><BR>

<H4>Comments</H4>

<P><B>RegisterModule</B> will load the DLL specified in DS:SI. The DLL initialization routine is called and the DLL dispatch routine is stored. All calls made from the <B>DispatchCall</B> are sent to this routine.</P>

<H4>See Also</H4>

<P><A HREF="vddfn_94yt.htm"><B>UnRegisterModule</B></A>, <A HREF="vddfn_9ilo.htm"><B>DispatchCall</B></A> </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: RegisterModule"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
