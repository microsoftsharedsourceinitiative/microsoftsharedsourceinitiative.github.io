<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>WIA Minidriver Interfaces</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="WIA Minidriver Interfaces">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Still&nbsp;Image&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="ddk_wia_minidriver_interfaces_si"></A>WIA Minidriver Interfaces</H2>

<P>As previously mentioned, the WIA minidriver is a COM object that implements the standard <B>IUnknown</B> COM interface (described in the Platform SDK documentation) and two additional WIA-specific interfaces, the <B>IStiUSD</B> and <B>IWiaMiniDrv</B> interfaces.</P>

<H4>IStiUSD Interface</H4>

<P>The <B>IStiUSD</B> interface, which is defined in <I>stiusd.h</I>, performs the following actions: 

<UL>
	<LI>Initializes the driver when the WIA service first loads it.</LI>

	<LI>Returns the driver's capabilities to the WIA service, reporting whether the device supports asynchronous device notifications.</LI>

	<LI>Locks and unlocks the device for exclusive use.</LI>
</UL>

<H4>IWiaMiniDrv Interface</H4>

<P>The <B>IWiaMiniDrv</B> interface, which is defined in <I>wiamindr.h</I>, exposes most of the WIA minidriver's functionality. This interface performs the following actions:

<UL>
	<LI>Defines the still image device’s default and current settings.</LI>

	<LI>Defines the still image device’s supported commands and events.</LI>

	<LI>Transfers data from the device to the WIA service (which ultimately passes it on to the calling application).</LI>
</UL>

<P>For additional information about these interfaces, see <A HREF="wia_drv_basic_4xm1.htm">Developing a WIA Driver: Basic Concepts</A>.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: WIA%20Minidriver%20Interfaces"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
