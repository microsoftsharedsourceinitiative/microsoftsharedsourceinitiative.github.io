<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>IStiUSD::LockDevice</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="IStiUSD::LockDevice">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Still&nbsp;Image&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_istiusd_lockdevice_si"></A>IStiUSD::LockDevice</H1>

<P>A still image minidriver's <B>IStiUSD::LockDevice</B> method locks a device for exclusive use by the caller.</P>

<PRE class=syntax><B>STDMETHODIMP
  LockDevice(
    VOID
    );</B></PRE>

<H4>Parameters</H4>

<P>None</P>

<H4>Return Value</H4>

<P>If the operation succeeds, the method should return S_OK. Otherwise, it should return one of the STIERR-prefixed error codes defined in <I>stierr.h</I>.</P>

<H4>Headers</H4>

<P>Declared in <I>stiusd.h</I>. Include <I>stiusd.h</I>.</P>

<H4>Comments</H4>

<P>If you are writing a driver for a device connected to a serial port, you might want to call <B>CreateFile</B> from within the driver's <A HREF="#ddk_istiusd_lockdevice_si"><B>IStiUSD::LockDevice</B></A> method if the device was opened in status mode. This will prohibit other applications from using the port (which might be supporting other devices) while status information is being obtained. For more information, see <A HREF="stillimg_5mll.htm">Transfer Modes</A>.</P>

<H4>See Also</H4>

<P><A HREF="stifnc_5mi1.htm"><B>IStiDevice::LockDevice</B></A> </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: IStiUSD::LockDevice"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
