<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>IWiaDrvItem::UnlinkItemTree</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="IWiaDrvItem::UnlinkItemTree">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Still&nbsp;Image&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_iwiadrvitem_unlinkitemtree_si"></A>IWiaDrvItem::UnlinkItemTree</H1>

<P>The <B>IWiaDrvItem::UnlinkItemTree</B> method unlinks the driver item tree and releases all items in the tree.</P>

<PRE class=syntax><B>HRESULT 
  UnlinkItemTree(
    IN LONG</B>  <I>lFlags</I>
<B>    );</B></PRE>

<H4>Parameters</H4>

<DL>
<DT><I>lFlags</I></DT>

<DD>Indicates how the driver item tree should be unlinked. This parameter must be set to one of the following values. See the Platform SDK documentation for a description of the WIA item type flags.

<TABLE>

<TR VALIGN="top">
<TH align=left width=48%>Value</TH>
<TH align=left width=52%>Meaning</TH>
</TR>

<TR VALIGN="top">
<TD width=48%>WiaItemTypeDeleted</TD>
<TD width=52%>The item is marked as deleted from the tree.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>WiaItemTypeDisconnected</TD>
<TD width=52%>The item represents a disconnected device.</TD>
</TR>
</TABLE><BR>


</DD>
</DL>

<H4>Return Value</H4>

<P>If the method succeeds, it returns S_OK. If the method is called on a nonroot item, it returns E_INVALIDARG. If the method fails for another reason, it returns a standard COM error code.</P>

<H4>Headers</H4>

<P>Declared in <I>wiamindr.h</I>. Include <I>wiamindr.h</I>.</P>

<H4>Comments</H4>

<P>Minidrivers must call this method on the root item in the driver item tree when they want to invalidate the tree. This is typically done when the driver is being unloaded or when the minidriver needs to rebuild the driver item tree.</P>

<P>This method is available in Windows&nbsp;Me and in Windows&nbsp;XP and later.</P>

<P></P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: IWiaDrvItem::UnlinkItemTree"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
