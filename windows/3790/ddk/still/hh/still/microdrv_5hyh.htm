<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Automatic Document Feeder Commands</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Automatic Document Feeder Commands">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Still&nbsp;Image&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_automatic_document_feeder_commands_si"></A>Automatic Document Feeder Commands</H1>

<P>The commands in this section are for microdrivers that support an Automatic Document Feeder (ADF). To report that your microdriver supports an Automatic Document Feeder, set the <B>ADF</B> member in the <A HREF="microdrv_39k9.htm">SCANINFO</A> structure to 1 during the CMD_INITIALIZE command. This will cause the WIA Flatbed driver to add the needed properties for ADF control and use the commands in this section.

<DL>
<DT>CMD_LOAD_ADF</DT>

<DD>Called by the WIA Flatbed driver to load a page into the ADF. If this command does not apply to the device, return E_NOTIMPL.</DD>

<DT>CMD_UNLOAD_ADF</DT>

<DD>Called by the WIA Flatbed driver to unload a page from the ADF. If this command does not apply to the device, return E_NOTIMPL.</DD>

<DT>CMD_GETADFAVAILABLE</DT>

<DD>Called by the WIA Flatbed driver to determine whether an ADF is available for use. If an ADF is available, return S_OK. If this command does not apply to the device, return E_NOTIMPL.</DD>

<DT>CMD_GETADFHASPAPER</DT>

<DD>Called by the WIA Flatbed driver to get the paper status of the device’s ADF. Set the <B>lVal</B> member of the passed <A HREF="microdrv_0ld5.htm">VAL</A> structure to the appropriate status value. (See CMD_ADFGETSTATUS for possible status values.)</DD>

<DT>CMD_GETADFOPEN</DT>

<DD>Same as CMD_GETADFREADY. This command is not currently used by the WIA Flatbed Driver.</DD>

<DT>CMD_GETADFSTATUS</DT>

<DD>Called by the WIA Flatbed driver to get the status of the ADF attached to the device. Set the <B>lVal</B> member of the passed <A HREF="microdrv_0ld5.htm">VAL</A> structure to the appropriate status value. Possible status values are as follows.

<TABLE>

<TR VALIGN="top">
<TH align=left width=48%>Status</TH>
<TH align=left width=52%>Meaning</TH>
</TR>

<TR VALIGN="top">
<TD width=48%>MCRO_ERROR_GENERAL_ERROR</TD>
<TD width=52%>General error.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>MCRO_ERROR_OFFLINE</TD>
<TD width=52%>The ADF or device is offline.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>MCRO_ERROR_PAPER_EMPTY</TD>
<TD width=52%>The ADF has no paper.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>MCRO_ERROR_PAPER_JAM</TD>
<TD width=52%>The ADF has a paper jam.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>MCRO_ERROR_PAPER_PROBLEM</TD>
<TD width=52%>The ADF has a paper problem.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>MCRO_ERROR_USER_INTERVENTION</TD>
<TD width=52%>The user needs to interact with the device.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>MCRO_STATUS_OK</TD>
<TD width=52%>There is no error to report.</TD>
</TR>
</TABLE><BR>

</DD>

<DT>CMD_GETADFUNLOADREADY</DT>

<DD>Called by the WIA Flatbed Driver to determine whether the ADF is ready for a page to be unloaded. If so, return S_OK. If this command does not apply to the device, return E_NOTIMPL.
</DD>
</DL>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Automatic%20Document%20Feeder%20Commands"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
