<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Support for TWAIN-Compatible Applications</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Support for TWAIN-Compatible Applications">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Still&nbsp;Image&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="ddk_support_for_twain_compatible_applications_si"></A>Support for TWAIN-Compatible Applications</H2>

<P>In order to support TWAIN applications with private capabilities, WIA drivers can use a technique known as <I>pass-through</I> functionality. The pass-through mechanism refers to the way a TWAIN-compatible application communicates with a WIA driver, using the Data Source Manager and the TWAIN compatibility layer as intermediaries. It is important to note that TWAIN capability pass-through is supported only in Windows XP and later operating system versions.</P>

<P>All communication between a TWAIN-compatible application and the WIA driver goes first to the Data Source Manager (<I>twain_32.dll</I>), which in turn calls into the TWAIN compatibility layer (<I>wiadss.dll</I>). The TWAIN compatibility layer then calls the <B>IWiaItemExtras::Escape</B> method, which calls the <B>IStiUSD::Escape </B>method. The TWAIN compatibility layer calls only the <B>IWiaItemExtras::Escape </B>method. The driver developer should be concerned only with the device receiving an <B>IStiUSD::Escape</B> call. For more information on <B>IWiaItemExtras::Escape</B>, see the Platform SDK documentation.</P>

<P class=note><B>Note</B>&nbsp;&nbsp;The purpose of TWAIN pass-through functionality is to provide support to driver writers who are making the transition from TWAIN drivers to WIA drivers. It is not intended for the purpose of adding TWAIN features to a WIA driver. If your WIA driver does not require support for TWAIN, you should not add this functionality to your driver.</P>

<P>The following topics are discussed in this section:</P>

<P class=indent1><A HREF="wia_drv_scan_0c6h.htm">Enabling TWAIN Capability Pass-Through in a WIA Driver</A></P>

<P class=indent1><A HREF="wia_drv_scan_68bt.htm">Using the <B>IStiUSD</B> <B>Escape</B> Method</A></P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Support%20for%20TWAIN-Compatible%20Applications"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
