<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>SCANINFO</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="SCANINFO">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Still&nbsp;Image&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_scaninfo_si"></A>SCANINFO</H1>

<P>The SCANINFO structure is used to store and communicate information about a scan acquisition. The WIA Flatbed Driver reads values from the SCANINFO structure, but never writes values. It is the microdriver’s responsibility to set values for the SCANINFO members.</P>

<PRE class=syntax>typedef struct _SCANINFO {
<I>  </I>LONG  ADF;
  LONG  TPA;
  LONG  Endorser;
  LONG  OpticalXResolution;
  LONG  OpticalYResolution;
  LONG  BedWidth;
  LONG  BedHeight;
  RANGEVALUE  IntensityRange;
  RANGEVALUE  ContrastRange;
  LONG  SupportedCompressionType;
  LONG  SupportedDataTypes;
  LONG  WidthPixels;
  LONG  WidthBytes;
  LONG  Lines;
  LONG  DataType;
  LONG  PixelBits;
  LONG  Intensity;
  LONG  Contrast;
  LONG  Xresolution;
  LONG  Yresolution;
  SCANWINDOW  Window;
  LONG  DitherPattern;
  LONG  Negative;
  LONG  Mirror;
  LONG  AutoBack;
  LONG  ColorDitherPattern;
  LONG  ToneMap;
  LONG  Compression;
  LONG  RawDataFormat;
  LONG  RawPixelOrder;
  LONG  bNeedDataAlignment;
  LONG  DelayBetweenRead;
  LONG  MaxBufferSize;
  HANDLE  DeviceIOHandles[MAX_IO_HANDLES];
  LONG  lReserved[MAX_RESERVED];
  VOID  *pMicroDriverContext;
} SCANINFO, *PSCANINFO;</PRE>

<H4>Members</H4>

<DL>
<DT><B>ADF</B></DT>

<DD>Indicates whether the scanner supports an Automatic Document Feeder (ADF). This member can be one of the following values:

<TABLE>

<TR VALIGN="top">
<TH align=left width=18%>Value</TH>
<TH align=left width=82%>Meaning</TH>
</TR>

<TR VALIGN="top">
<TD width=18%>0</TD>
<TD width=82%>The scanner does not support an ADF.</TD>
</TR>

<TR VALIGN="top">
<TD width=18%>1</TD>
<TD width=82%>The scanner supports an ADF.</TD>
</TR>

<TR VALIGN="top">
<TD width=18%>2</TD>
<TD width=82%>The scanner supports an ADF with duplex capability.</TD>
</TR>
</TABLE><BR>

</DD>

<DT><B>TPA</B></DT>

<DD>Indicates whether the scanner supports TPA (TransParency Adapter). The value can be:

<P>0 - not supported


<P>1 - supported
</DD>

<DT><B>Endorser</B></DT>

<DD>Indicates whether the scanner has endorser capabilities. The value can be:

<P>0 - not supported


<P>1 - supported
</DD>

<DT><B>OpticalXResolution</B></DT>

<DD>Specifies the horizontal dpi setting of the scanner optics.</DD>

<DT><B>OpticalYResolution</B></DT>

<DD>Specifies the vertical dpi setting of the scanner optics.</DD>

<DT><B>BedWidth</B></DT>

<DD>Specifies the bed width of the scanner in thousandths of an inch.</DD>

<DT><B>BedHeight</B></DT>

<DD>Specifies the bed height of the scanner in thousandths of an inch.</DD>

<DT><B>IntensityRange</B></DT>

<DD>Specifies the intensity/brightness range values of the scanner.</DD>

<DT><B>ContrastRange</B></DT>

<DD>Specifies the contrast range values of the scanner.</DD>

<DT><B>SupportedCompressionType</B></DT>

<DD>Specifies a mask value of supported compression types. A value of zero indicates that no compression types are supported.</DD>

<DT><B>SupportedDataTypes</B></DT>

<DD>Specifies a mask value of supported data types. A value of zero indicates that no data types are supported. This member can be the bitwise OR of the following.

<TABLE>

<TR VALIGN="top">
<TH align=left width=48%>Value</TH>
<TH align=left width=52%>Meaning</TH>
</TR>

<TR VALIGN="top">
<TD width=48%>SUPPORT_BW</TD>
<TD width=52%>The image is 1 bit-per-pixel black and white.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>SUPPORT_COLOR</TD>
<TD width=52%>The image is 24 bits-per-pixel color.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>SUPPORT_GRAYSCALE</TD>
<TD width=52%>The image is 8 bits-per-pixel grayscale.</TD>
</TR>
</TABLE><BR>

</DD>

<DT><B>WidthPixels</B></DT>

<DD>Specifies the width of the current image in pixels.</DD>

<DT><B>WidthBytes</B></DT>

<DD>Specifies the width of the current image in bytes.</DD>

<DT><B>Lines</B></DT>

<DD>Specifies the height of the current image in pixels.</DD>

<DT><B>DataType</B></DT>

<DD>Specifies the current data type set of the current image. This member can be set to one of the following.

<TABLE>

<TR VALIGN="top">
<TH align=left width=48%>Value</TH>
<TH align=left width=52%>Meaning</TH>
</TR>

<TR VALIGN="top">
<TD width=48%>WIA_DATA_COLOR</TD>
<TD width=52%>The driver supports 24 bit-per-pixel color.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>WIA_DATA_COLOR_DITHER</TD>
<TD width=52%>This value is not supported in the WIA Flatbed driver.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>WIA_DATA_COLOR_THRESHOLD</TD>
<TD width=52%>This value is not supported in the WIA Flatbed driver.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>WIA_DATA_DITHER</TD>
<TD width=52%>This value is not supported in the WIA Flatbed driver.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>WIA_DATA_GRAYSCALE</TD>
<TD width=52%>The driver supports 8 bit-per-pixel grayscale.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>WIA_DATA_THRESHOLD</TD>
<TD width=52%>The driver supports 1 bit-per-pixel black and white.</TD>
</TR>
</TABLE><BR>

</DD>

<DT><B>PixelBits</B></DT>

<DD>Specifies the current bit depth setting of the current image.</DD>

<DT><B>Intensity</B></DT>

<DD>Specifies the current intensity/brightness setting of the scanner.</DD>

<DT><B>Contrast</B></DT>

<DD>Specifies the current contrast setting of the scanner.</DD>

<DT><B>Xresolution</B></DT>

<DD>Specifies the current horizontal resolution setting of the scanner.</DD>

<DT><B>Yresolution</B></DT>

<DD>Specifies the current vertical resolution setting of the scanner.</DD>

<DT><B>Window</B></DT>

<DD>Specifies the current scanner window settings.</DD>

<DT><B>DitherPattern</B></DT>

<DD>Specifies the dither pattern of the scanner.</DD>

<DT><B>Negative</B></DT>

<DD>Specifies whether negative is on or off. The value can be:

<P>0 - off


<P>1 - on
</DD>

<DT><B>Mirror</B></DT>

<DD>Specifies whether mirror is on or off. The value can be:

<P>0 - off


<P>1 - on
</DD>

<DT><B>AutoBack</B></DT>

<DD>Specifies whether AutoBack is on or off. The value can be:

<P>0 - off


<P>1 - on
</DD>

<DT><B>ColorDitherPattern</B></DT>

<DD>Reserved. Set to zero.</DD>

<DT><B>ToneMap</B></DT>

<DD>Reserved. Set to zero.</DD>

<DT><B>Compression</B></DT>

<DD>Specifies whether compression is on or off for the scanner. The value can be:

<P>0 - off


<P>1 - on
</DD>

<DT><B>RawDataFormat</B></DT>

<DD>Specifies the raw data format for the scanner. The value can be:

<P>0 - packed data


<P>1 - planar data
</DD>

<DT><B>RawPixelOrder</B></DT>

<DD>Specifies the pixel order for the scanner. The value can be:

<P>0 - RGB


<P>1 - BGR
</DD>

<DT><B>bNeedDataAlignment</B></DT>

<DD>Specifies whether data alignment is needed for the scanner. The value can be:

<P>0 - false


<P>1 - true
</DD>

<DT><B>DelayBetweenRead</B></DT>

<DD>Specifies the time delay in milliseconds between <A HREF="microdrv_2drd.htm"><B>Scan</B></A> function calls that the scanner can support.</DD>

<DT><B>MaxBufferSize</B></DT>

<DD>Specifies the maximum buffer size in the scanner.</DD>

<DT><B>DeviceIOHandles</B></DT>

<DD>Specifies an array of device I/O handles needed for device communication.</DD>

<DT><B>lReserved</B></DT>

<DD>Specifies an array of reserved bits.</DD>

<DT><B>pMicroDriverContext</B></DT>

<DD>Points to the microdriver's context. <I>This member is defined only for Microsoft</I>®<I> Windows</I>®<I> XP and later</I>. The microdriver allocates the buffer pointed to by this member. The buffer should be allocated in CMD_INITIALIZE, and freed in CMD_UNINITIALIZE. (See <A HREF="microdrv_7r8p.htm">Required Commands</A>.) The WIA Flatbed driver knows nothing of this pointer, and hence will not alter the memory pointed to by this member.
</DD>
</DL>

<H4>Headers</H4>

<P>Declared in <I>wiamicro.h</I>. Include <I>wiamicro.h</I>.</P>

<H4>Comments</H4>

<P>This structure is used as a parameter in the microdriver's <A HREF="microdrv_8209.htm"><B>SetPixelWindow</B></A>, and <A HREF="microdrv_2drd.htm"><B>Scan</B></A> functions.</P>

<P>This structure is available in Windows&nbsp;Me and in Windows&nbsp;XP and later.</P>

<H4>See Also</H4>

<P><A HREF="microdrv_8209.htm"><B>SetPixelWindow</B></A>, <A HREF="microdrv_2drd.htm"><B>Scan</B></A></P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: SCANINFO"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
