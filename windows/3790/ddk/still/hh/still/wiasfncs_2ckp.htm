<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>wiasQueueEvent</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="wiasQueueEvent">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Still&nbsp;Image&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_wiasqueueevent_si"></A>wiasQueueEvent</H1>

<P>The <B>wiasQueueEvent</B> function informs the service that the device generated an event. </P>

<PRE class=syntax><B>HRESULT
</B>  <B>wiasQueueEvent(</B>
    <B>BSTR</B>  <I>bstrDeviceId</I>,
    <B>const GUID</B>  *<I>pEventGUID</I>,
    <B>BSTR</B>  <I>bstrFullItemName</I>
    <B>);</B></PRE>

<H4>Parameters</H4>

<DL>
<DT><I>bstrDeviceId</I></DT>

<DD>Specifies the device ID. This is the value passed to the minidriver in the call to the <A HREF="minidrv_4mg9.htm"><B>IWiaMiniDrv::drvInitializeWia</B></A> method.</DD>

<DT><I>pEventGUID</I></DT>

<DD>Pointer to a buffer that contains the GUID for the event.</DD>

<DT><I>bstrFullItemName</I></DT>

<DD>Specifies the full item name, including path information.
</DD>
</DL>

<H4>Return Value</H4>

<P>On success, the function returns S_OK. If the function fails, it returns a standard COM error or one of the WIA_ERROR_XXX errors (described in the Platform SDK documentation).</P>

<H4>Headers</H4>

<P>Declared in <I>wiamdef.h</I>. Include <I>wiamdef.h</I>.</P>

<H4>Comments</H4>

<P>This method should be used whenever the device must signal that an event of some type occurred. The device does this by placing the event on the event queue. For example, when a camera takes a new picture, it should generate a WIA_EVENT_ITEM_CREATED event after adding a new driver item to its tree. The camera can place this event on the event queue in this way:</P>

<PRE>hr = wiasQueueEvent(bstrMyDeviceId,
                    &amp;WIA_EVENT_ITEM_CREATED,
                    bstrDescriptionString);
</PRE>

<P>See the Platform SDK documentation for a complete list of WIA event identifiers.</P>

<P>This function is available in Windows&nbsp;Me and in Windows&nbsp;XP and later.</P>

<H4>See Also</H4>

<P><A HREF="minidrv_4mg9.htm"><B>IWiaMiniDrv::drvInitializeWia</B></A></P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: wiasQueueEvent"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
