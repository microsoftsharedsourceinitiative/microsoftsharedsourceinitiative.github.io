<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Reading WIA Item Properties by a Driver</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Reading WIA Item Properties by a Driver">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Still&nbsp;Image&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="ddk_reading_wia_item_properties_by_a_driver_si"></A>Reading WIA Item Properties by a Driver</H3>

<P>A WIA minidriver should always use the properties in its own driver item tree as a basis for the current settings. Because the application is reading from and writing to the minidriver's item tree, it will never be out of date. A WIA minidriver should use the following WIA service functions to read from the properties in its driver item tree.

<DL>
<DT><A HREF="wiasfncs_20bt.htm"><B>WiasReadMultiple</B></A></DT>

<DD>Read all WIA property types. This is a general function that allows a WIA driver to read any property existing on a WIA item, including custom properties. It can be used to read multiple properties per call.</DD>

<DT><A HREF="wiasfncs_4u21.htm"><B>wiasReadPropStr</B></A></DT>

<DD>Read WIA properties that are strings (type VT_BSTR).</DD>

<DT><A HREF="wiasfncs_61wp.htm"><B>WiasReadPropLong</B></A></DT>

<DD>Read WIA properties that are four-byte integers (type VT_I4).</DD>

<DT><A HREF="wiasfncs_8ca1.htm"><B>wiasReadPropFloat</B></A></DT>

<DD>Read WIA properties that are four-byte real numbers (type VT_R4).</DD>

<DT><A HREF="wiasfncs_0x49.htm"><B>wiasReadPropGuid</B></A></DT>

<DD>Read WIA properties that are GUIDs (type VT_CLSID).</DD>

<DT><A HREF="wiasfncs_8ld5.htm"><B>wiasReadPropBin</B></A></DT>

<DD>Read WIA properties that are strings of unsigned bytes (type VT_VECTOR | VT_UI1).
</DD>
</DL>

<H4>Reading Legal Values</H4>

<P>A WIA item property contains attributes that define the type of container and access rights. (For further information, see <A HREF="wia_drv_basic_2t2h.htm">Adding WIA Properties to a WIA Item</A>.) The container types are WIA_PROP_NONE, WIA_PROP_LIST, and WIA_PROP_RANGE. The access rights are WIA_PROP_READ and WIA_PROP_RW. During validation of an existing property, a WIA minidriver should check the internal update setting to determine if it should read the valid values. A WIA minidriver should use the <A HREF="wiasfncs_05rd.htm"><B>wiasGetPropertyAttributes</B></A> service function to read the current valid values for its WIA properties. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Reading%20WIA%20Item%20Properties%20by%20a%20Driver"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
