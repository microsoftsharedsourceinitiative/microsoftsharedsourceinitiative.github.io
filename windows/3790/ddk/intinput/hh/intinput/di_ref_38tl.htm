<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>IDirectInputJoyConfig8::OpenAppStatusKey</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="IDirectInputJoyConfig8::OpenAppStatusKey">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Interactive&nbsp;Input&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_idirectinputjoyconfig8_openappstatuskey_di"></A>IDirectInputJoyConfig8::OpenAppStatusKey</H1>

<P>The <B>IDirectInputJoyConfig8::OpenAppStatusKey </B>method opens the root key of the application status registry keys, and obtains a handle to the key as a return parameter. </P>

<PRE class=syntax><B>HRESULT
  IDirectInputJoyConfig8::OpenAppStatusKey(
</B>   <B>PHKEY</B>  <I>phKey</I>
<B>    );</B></PRE>

<H4>Parameters</H4>

<DL>
<DT><I>phKey</I></DT>

<DD>Points to the address of a variable (of type HKEY) that will contain a registry key handle if the method succeeds. See Comments for additional usage details.
</DD>
</DL>

<H4>Return Value</H4>

<P>Returns DI_OK on success; otherwise returns one of the following COM error values: The following error codes are intended to be illustrative and not necessarily comprehensive.

<DL>
<DT>DIERR_INVALIDPARAM</DT>

<DD>One or more parameters was invalid.</DD>

<DT>DIERR_NOTFOUND</DT>

<DD>The key is missing on this system. Applications should proceed as if the key were empty. 
</DD>
</DL>

<H4>Comments</H4>

<P>The registry key handle returned in the <I>phKey</I> parameter can be used with the standard Win32® registry functions. The <I>dinputd.h</I> header file defines the following string constants for use in accessing subkeys and named values contained by the application status root key.

<DL>
<DT><B>Subkey String Contants</B></DT>

<DT>DIRECTINPUT_REGSTR_KEY_LASTAPP </DT>

<DD>Corresponds to the "MostRecentApplication" subkey. This key contains the name of the last application that used DirectInput services.</DD>

<DT>DIRECTINPUT_REGSTR_KEY_LASTMAPAPP </DT>

<DD>Corresponds to the "MostRecentMapperApplication" subkey. This key contains the name of the last application that used DirectInput mapper services, as detected the first time the application calls the <B>IDirectInput8::BuildActionMap</B> method.</DD>

<DT><B>Named Value String Constants</B></DT>

<DT>DIRECTINPUT_REGSTR_VAL_VERSION </DT>

<DD>Corresponds to the "Version" named value, of type REG_BINARY. This value is the DIRECTINPUT_VERSION passed by the application to initialize DirectInput.</DD>

<DT>DIRECTINPUT_REGSTR_VAL_NAME </DT>

<DD>Corresponds to the "Name" named value, of type REG_SZ. This value represents the application file name, in upper-case characters.</DD>

<DT>DIRECTINPUT_REGSTR_VAL_ID</DT>

<DD>Corresponds to the "Id" named value under either DIRECTINPUT_REGSTR_KEY_LASTMAPAPP or DIRECTINPUT_REGSTR_KEY_LASTAPP subkeys. This REG_SZ value is the application ID value. For DirectX® 8.0 applications, this is also the key name of a sibling key specific to this application.</DD>

<DT>DIRECTINPUT_REGSTR_VAL_MAPPER</DT>

<DD>Corresponds to the "UsesMapper" named value, under one of DirectX 8.0 application subkeys of the key opened by <B>IDirectInputJoyConfig::OpenAppStatusKey</B>. This is a REG_BINARY value as a DWORD. It is set to 0 if the application has not used Mapper functionality, or 1 if it has.</DD>

<DT>DIRECTINPUT_REGSTR_VAL_LASTSTART</DT>

<DD>Corresponds to the "MostRecentStart" named value, under either DIRECTINPUT_REGSTR_KEY_LASTMAPAPP or DIRECTINPUT_REGSTR_KEY_LASTAPP subkeys. This REG_BINARY value is a FILETIME structure, which describes the time the key contents were written.
</DD>
</DL>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: IDirectInputJoyConfig8::OpenAppStatusKey"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
