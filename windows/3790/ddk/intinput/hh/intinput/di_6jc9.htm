<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Minidriver-Supplied Callbacks</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Minidriver-Supplied Callbacks">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Interactive&nbsp;Input&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="ddk_minidriver_supplied_callbacks_di"></A>Minidriver-Supplied Callbacks</H2>

<P>Joystick hardware that is not polled or that has nonstandard polling requirements can implement a minidriver (which must be a VxD) that VJoyD loads when a device of that type is in use. VJoyD also calls the minidriver to access position and button information. Joystick minidrivers are not required to provide any interfaces other than processing the standard SYS_DYNAMIC_DEVICE_INIT and SYS_DYNAMIC_DEVICE_EXIT messages when the device is loaded and unloaded, and defining and registering four joystick-specific callbacks. In addition to supporting this original interface, the DirectX 5.0 and later VJoyD also supports an extended interface. The extended interface allows new callbacks to be registered to support polling, force feedback, and hot plugging of joysticks. </P>

<P>On request from <I>Msjstick.drv</I>, VJoyD checks which minidrivers should be loaded and unloaded. <I>Msjstick.drv</I> makes the request for each device it handles and whenever the call to <B>joyConfigChanged</B> is made. <I>Msjstick.drv</I> is initialized for each device it handles during the normal boot sequence, which means that some devices and services may be unavailable to the minidriver at the time it is loaded. Because VJoyD loads minidrivers when they are found to be assigned to a joystick number; not when an application needs to use the device, processing should be kept to a minimum. No background processing, shared resource usage, or large-scale memory allocations should be started simply because the VxD has been loaded. Starting with DirectX 5.0, VJoyD does its initial loading of minidrivers at a later stage in the boot process than the original. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Minidriver-Supplied%20Callbacks"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
