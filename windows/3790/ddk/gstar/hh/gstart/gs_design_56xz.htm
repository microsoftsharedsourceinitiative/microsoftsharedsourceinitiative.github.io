<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Creating Reliable and Secure Drivers</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Creating Reliable and Secure Drivers">
<META NAME="MS-HKWD" CONTENT="Secure Drivers">
<META NAME="MS-HKWD" CONTENT="Reliable Drivers">
<META NAME="MS-HKWD" CONTENT="Security">
<META NAME="MS-HKWD" CONTENT="Reliability">
</HEAD>
<BODY TOPMARGIN="0">
<DIV STYLE="display:none;">
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_driver_information_in_the_registry_dg">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_using_safe_string_functions_kg">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_creating_secure_device_installations_dg">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_creating_reliable_kernel_mode_drivers_kg">
</OBJECT>
</DIV>


<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Getting&nbsp;Started&nbsp;with&nbsp;Windows&nbsp;Drivers:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_creating_reliable_and_secure_drivers_pg"></A>Creating Reliable and Secure Drivers</H1>

<P>Driver reliability and security go hand in hand. That is, the design techniques that create reliable drivers also create drivers that are secure. Secure drivers help protect the system from malicious attacks.</P>

<P>The most important rule to follow when creating code that will execute in either user mode or kernel mode is the following:</P>

<P class=proch><B>Don't trust the runtime environment.</B></P>

<P>In other words, don't assume you will always know which components will call your driver. Suppose you initially design a software component to operate in a seemingly well-defined environment in which a limited number of known, trusted components will call your component. In the future, new and untrusted components might be added to the environment, without your control or knowledge.</P>

<P>Based on the rule that the runtime environment should not be trusted, you should use the following guidelines when creating user-mode or kernel-mode code to support your device:

<UL>
	<LI>Validate input parameters.
<P>Always validate all parameters received from other drivers, from operating system components, and from user-mode applications. Be especially careful of parameters that originate in user-mode applications. Test received values, to ensure that they are within expected ranges. Test the size of input buffers, to ensure that received data is not too large for the driver to handle. Test the size of output buffers, to ensure that the buffers are large enough to hold the data to be written.
</LI>

	<LI>Validate registry contents.
<P>Validate registry contents before using them. Registry contents should always be treated as untrusted, user-modifiable data. For information about using the registry, see <A HREF="JavaScript:hhobj_1.Click()">Driver Information in the Registry</A>.
</LI>

	<LI>Use safe string functions.
<P>When writing code that manipulates text strings, <A HREF="JavaScript:hhobj_2.Click()">use safe string functions</A> instead of the string manipulation functions that are provided by C-language runtime libraries. Safe string functions are available for both user-mode and kernel-mode code, and they accept parameters that enable you to prevent buffer overrun errors.
</LI>

	<LI>Provide secure device installations.
<P>System administrators should be able to control a user's access to a system's devices. This means that, generally, security for drivers should be set in INF files at installation time, instead of in drivers at execution time. For more information, see <A HREF="JavaScript:hhobj_3.Click()">Creating Secure Device Installations</A>.
</LI>
</UL>

<P>For additional guidelines on creating kernel-mode drivers that are reliable and secure, see <A HREF="JavaScript:hhobj_4.Click()">Creating Reliable Kernel-Mode Drivers</A>.</P>

<P>Additionally, see the DDK documentation for device-specific technologies for additional, device-specific, security guidelines.</P>

<P>For more information about developing secure software, and for general information about computer security issues, see the <a href="http://go.microsoft.com/fwlink/?LinkId=11569" target="_blank">Security</A> Web site.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Creating%20Reliable%20and%20Secure%20Drivers"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
