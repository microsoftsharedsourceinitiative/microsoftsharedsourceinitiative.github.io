<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Choosing a Programming Language</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Choosing a Programming Language">
</HEAD>
<BODY TOPMARGIN="0">
<DIV STYLE="display:none;">
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_handling_exceptions_kg">
</OBJECT>
</DIV>


<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Getting&nbsp;Started&nbsp;with&nbsp;Windows&nbsp;Drivers:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_choosing_a_programming_language_pg"></A>Choosing a Programming Language</H1>

<P>For maximum portability, drivers should be written in a high-level language, typically C for kernel-mode drivers, and C or C++ for user-mode drivers. The following are exceptions:

<UL>
	<LI>Audio/Video streaming (AVStream) client minidrivers (Microsoft® DirectX® 8.0, Microsoft® Windows® XP and later versions of the operating system) are typically written in C++.</LI>

	<LI>WDM audio miniport drivers use kernel-mode COM components and are typically written in C++.</LI>

	<LI>Windows Image Acquisition (WIA) drivers, most of which run in user mode, are typically written in C++.</LI>

	<LI>Display drivers are typically written in C. However, the system-supplied Graphics Display Interface (GDI) defines the public portions of its internal data structures as user objects. GDI also defines numerous service routines to manipulate these objects. Display drivers written in C++ can treat these routines as methods on the user object; drivers written in C can call these routines in the usual manner.</LI>
</UL>

<P>Most DDK sample and system-supplied drivers are written in C. In general, driver code should conform to the ANSI C standard, and should avoid depending on anything that the standard describes as "implementation defined." However, driver writers must use structured exception handling.  For more information, see <A HREF="JavaScript:hhobj_1.Click()">Handling Exceptions</A>.</P>

<P>In particular, to write portable drivers, it is best to avoid the following: 

<UL>
	<LI>Dependencies on data types that can vary in size or layout from one platform to another </LI>

	<LI>Calling any standard C run-time library function that maintains state </LI>

	<LI>Calling any standard C run-time library function for which the operating system provides an alternative support routine </LI>
</UL>

<P>To ensure compatibility across hardware platforms, drivers should not contain assembly language code. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Choosing%20a%20Programming%20Language"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
