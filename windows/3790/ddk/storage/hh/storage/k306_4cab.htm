<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>PORT_CONFIGURATION_INFORMATION (STORPORT)</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="PORT_CONFIGURATION_INFORMATION (STORPORT)">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Storage&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_port_configuration_information_storport__kr"></A>PORT_CONFIGURATION_INFORMATION (STORPORT)</H1>

<P>PORT_CONFIGURATION_INFORMATION contains configuration information for an HBA. </P>

<PRE class=syntax>typedef struct _PORT_CONFIGURATION_INFORMATION {
  ULONG  Length;
  ULONG  SystemIoBusNumber;
  INTERFACE_TYPE  AdapterInterfaceType;
  ULONG  BusInterruptLevel;
  ULONG  BusInterruptVector;
  KINTERRUPT_MODE  InterruptMode;
  ULONG  MaximumTransferLength;
  ULONG  NumberOfPhysicalBreaks;
  ULONG  DmaChannel;
  ULONG  DmaPort;
  DMA_WIDTH  DmaWidth;
  DMA_SPEED  DmaSpeed;
  ULONG  AlignmentMask;
  ULONG  NumberOfAccessRanges;
  ACCESS_RANGE  (*AccessRanges)[];
  PVOID  Reserved;
  UCHAR  NumberOfBuses;
  UCHAR  InitiatorBusId[8];
  BOOLEAN  ScatterGather;
  BOOLEAN  Master;
  BOOLEAN  CachesData;
  BOOLEAN  AdapterScansDown;
  BOOLEAN  AtdiskPrimaryClaimed;
  BOOLEAN  AtdiskSecondaryClaimed;
  BOOLEAN  Dma32BitAddresses;
  BOOLEAN  DemandMode;
  BOOLEAN  MapBuffers;
  BOOLEAN  NeedPhysicalAddresses;
  BOOLEAN  TaggedQueueing;
  BOOLEAN  AutoRequestSense;
  BOOLEAN  MultipleRequestPerLu;
  BOOLEAN  ReceiveEvent;
  BOOLEAN  RealModeInitialized;
  BOOLEAN  BufferAccessScsiPortControlled;
  UCHAR  MaximumNumberOfTargets;
  UCHAR  ReservedUchars[2];
  ULONG  SlotNumber;
  ULONG  BusInterruptLevel2;
  ULONG  BusInterruptVector2;
  KINTERRUPT_MODE  InterruptMode2;
  ULONG  DmaChannel2;
  ULONG  DmaPort2;
  DMA_WIDTH  DmaWidth2;
  DMA_SPEED  DmaSpeed2;
  ULONG  DeviceExtensionSize;
  ULONG  SpecificLuExtensionSize;
  ULONG  SrbExtensionSize;
  UCHAR  Dma64BitAddresses;
  BOOLEAN  ResetTargetSupported;
  UCHAR  MaximumNumberOfLogicalUnits;
  BOOLEAN  WmiDataProvider;
  STOR_SYNCHRONIZATION_MODEL SynchronizationModel;
} PORT_CONFIGURATION_INFORMATION, 
  *PPORT_CONFIGURATION_INFORMATION;</PRE>

<H4>Members</H4>

<DL>
<DT><B>Length</B></DT>

<DD>Specifies the size of the PORT_CONFIGURATION_INFORMATION structure, in bytes. For more information, see the <B>Length</B> member of <A HREF="k306_2h4i.htm">PORT_CONFIGURATION_INFORMATION</A>. </DD>

<DT><B>SystemIoBusNumber</B></DT>

<DD>Specifies the system-assigned number of the I/O bus to which the HBA is connected. The STORPORT driver initializes this member. Miniports that work with the STORPORT driver must <I>not</I> modify this member. For more information, see the <B>SystemIoBusNumber</B> member of <A HREF="k306_2h4i.htm">PORT_CONFIGURATION_INFORMATION</A>. </DD>

<DT><B>AdapterInterfaceType</B></DT>

<DD>Identifies the I/O bus interface. The STORPORT driver initializes this member. Miniports that work with the STORPORT driver must <I>not</I> modify this member. For more information, see the <B>AdapterInterfaceType</B> member of <A HREF="k306_2h4i.htm">PORT_CONFIGURATION_INFORMATION</A>. </DD>

<DT><B>BusInterruptLevel</B></DT>

<DD>Specifies the bus-relative interrupt request level. The STORPORT driver initializes this member. Miniports that work with the STORPORT driver must <I>not</I> modify this member. For more information, see the <B>BusInterruptLevel</B> member of <A HREF="k306_2h4i.htm">PORT_CONFIGURATION_INFORMATION</A>. </DD>

<DT><B>BusInterruptVector</B></DT>

<DD>Specifies the bus-relative vector returned by the HBA. The STORPORT driver initializes this member. Miniports that work with the STORPORT driver must <I>not</I> modify this member. For more information, see the <B>BusInterruptVector</B> member of <A HREF="k306_2h4i.htm">PORT_CONFIGURATION_INFORMATION</A>. </DD>

<DT><B>InterruptMode</B></DT>

<DD>Specifies whether the HBA uses <B>LevelSensitive</B> or <B>Latched</B> (sometimes called “edge-triggered”) interrupts. The STORPORT driver initializes this member. Miniports that work with the STORPORT driver must <I>not</I> modify this member. For more information, see the <B>InterruptMode</B> member of <A HREF="k306_2h4i.htm">PORT_CONFIGURATION_INFORMATION</A>. </DD>

<DT><B>MaximumTransferLength</B></DT>

<DD>Specifies the maximum number of bytes the HBA can transfer in a single transfer operation. By default, the value of this member is SP_UNINITIALIZED_VALUE, which indicates an unlimited maximum transfer size. For more information, see the <B>MaximumTransferLength</B> member of <A HREF="k306_2h4i.htm">PORT_CONFIGURATION_INFORMATION</A>. </DD>

<DT><B>NumberOfPhysicalBreaks</B></DT>

<DD>Specifies the maximum number of breaks between address ranges that a data buffer can have for the creation of scatter/gather lists, in other words, the number of scatter/gather list entries the adapter can support minus one. For more information, see the <B>NumberOfPhysicalBreaks</B> member of <A HREF="k306_2h4i.htm">PORT_CONFIGURATION_INFORMATION</A>. </DD>

<DT><B>DmaChannel</B></DT>

<DD>Specifies the DMA channel used by a slave HBA. By default, the value of this member is SP_UNINITIALIZED_VALUE. The STORPORT driver initializes this member. Miniports that work with the STORPORT driver must <I>not</I> modify this member. For more information, see the <B>DmaChannel</B> member of <A HREF="k306_2h4i.htm">PORT_CONFIGURATION_INFORMATION</A>. </DD>

<DT><B>DmaPort</B></DT>

<DD>Specifies the DMA port used by a slave HBA. By default, the value of this member is SP_UNINITIALIZED_VALUE. The STORPORT driver initializes this member. Miniports that work with the STORPORT driver must <I>not</I> modify this member. For more information, see the <B>DmaPort</B> member of <A HREF="k306_2h4i.htm">PORT_CONFIGURATION_INFORMATION</A>. </DD>

<DT><B>DmaWidth</B></DT>

<DD>Specifies the width of DMA transfers if the HBA uses DMA. By default, the value of this member is zero. The STORPORT driver initializes this member. Miniports that work with the STORPORT driver must <I>not</I> modify this member. For more information, see the <B>DmaWidth</B> member of <A HREF="k306_2h4i.htm">PORT_CONFIGURATION_INFORMATION</A>. </DD>

<DT><B>DmaSpeed</B></DT>

<DD>Specifies the DMA data-transfer speed for <B>Eisa</B> HBAs. The STORPORT driver initializes this member. Miniports that work with the STORPORT driver must <I>not</I> modify this member. For more information, see the <B>DmaSpeed</B> member of <A HREF="k306_2h4i.htm">PORT_CONFIGURATION_INFORMATION</A>. </DD>

<DT><B>AlignmentMask</B></DT>

<DD>Contains a mask indicating the alignment restrictions for buffers required by the HBA for transfer operations. Valid mask values are also restricted by characteristics of the memory managers on different versions of Windows. The mask values that are permitted under Windows 95 or Windows 98 are 0 (byte aligned), 1 (word aligned) or 3 (DWORD aligned). Under Windows NT and Windows 2000 the valid mask values are 0 (byte aligned), 1 (word aligned), 3 (DWORD aligned) and 7 (double DWORD aligned). The miniport driver should set this mask if the HBA supports scatter/gather. The same considerations apply to the <B>AlignmentMask</B> member of <A HREF="k306_2h4i.htm">PORT_CONFIGURATION_INFORMATION</A>. </DD>

<DT><B>NumberOfAccessRanges</B></DT>

<DD>Specifies the number of <B>AccessRanges</B> elements in the array, described next. For more information, see the <B>NumberOfAccessRanges</B> member of <A HREF="k306_2h4i.htm">PORT_CONFIGURATION_INFORMATION</A>. </DD>

<DT><B>AccessRanges</B></DT>

<DD>Pointer to an array of <A HREF="k306_1os2.htm">ACCESS_RANGE</A>-type elements. The STORPORT driver initializes this member. Miniports that work with the STORPORT driver must <I>not</I> modify this member. For more information, see the <B>AccessRanges</B> member of <A HREF="k306_2h4i.htm">PORT_CONFIGURATION_INFORMATION</A>. </DD>

<DT><B>Reserved</B></DT>

<DD>Reserved for system use. </DD>

<DT><B>NumberOfBuses</B></DT>

<DD>Specifies the number of buses controlled by the adapter. By default, the value of this member is zero. For more information, see the <B>NumberOfBuses</B> member of <A HREF="k306_2h4i.htm">PORT_CONFIGURATION_INFORMATION</A>. </DD>

<DT><B>InitiatorBusId</B></DT>

<DD>Indicates the initiator bus ID. The STORPORT driver initializes this member. Miniports that work with the STORPORT driver must <I>not</I> modify this member. For more information, see the <B>InitiatorBusId</B> member of <A HREF="k306_2h4i.htm">PORT_CONFIGURATION_INFORMATION</A>. </DD>

<DT><B>ScatterGather</B></DT>

<DD>Indicates, when TRUE, that the HBA supports scatter/gather. The STORPORT driver initializes this member to TRUE, because its miniports must support scatter/gather. Miniports that work with the STORPORT driver must <I>not</I> modify this value. For more information, see the <B>ScatterGather</B> member of <A HREF="k306_2h4i.htm">PORT_CONFIGURATION_INFORMATION</A>. </DD>

<DT><B>Master</B></DT>

<DD>Indicates, when TRUE, that the HBA is a bus master. The STORPORT driver initializes this member to TRUE, because its miniports must support bus-mastering DMA. Miniports that work with the STORPORT driver must <I>not</I> modify this value. For more information, see the <B>Master</B> member of <A HREF="k306_2h4i.htm">PORT_CONFIGURATION_INFORMATION</A>. </DD>

<DT><B>CachesData</B></DT>

<DD>Indicates, when TRUE, that the HBA caches data or maintains cached state on the peripherals. For more information, see the <B>CachesData</B> member of <A HREF="k306_2h4i.htm">PORT_CONFIGURATION_INFORMATION</A>. </DD>

<DT><B>AdapterScansDown</B></DT>

<DD>The STORPORT driver ignores this member. </DD>

<DT><B>AtdiskPrimaryClaimed</B></DT>

<DD>The STORPORT driver does not use this member, and its miniports must not set it. </DD>

<DT><B>AtdiskSecondaryClaimed</B></DT>

<DD>The STORPORT driver does not use this member, and its miniports must not set it. </DD>

<DT><B>Dma32BitAddresses</B></DT>

<DD>Indicates, when TRUE, that the HBA has 32 address lines and can access memory with physical addresses greater than 0x00FFFFFF. The STORPORT driver initializes this member to TRUE, because its miniports must support bus-width DMA. Miniports that work with the STORPORT driver must <I>not</I> modify this value. For more information, see the <B>Dma32BitAddresses</B> member of <A HREF="k306_2h4i.htm">PORT_CONFIGURATION_INFORMATION</A>. </DD>

<DT><B>DemandMode</B></DT>

<DD>Indicates the system DMA controller should be programmed for demand-mode rather than single-cycle operations. The STORPORT driver initializes this member to FALSE, because it does not support slave-mode DMA. Miniports that work with the STORPORT driver must <I>not</I> modify this value. For more information, see the <B>DemandMode</B> member of <A HREF="k306_2h4i.htm">PORT_CONFIGURATION_INFORMATION</A>. </DD>

<DT><B>MapBuffers</B></DT>

<DD>Indicates whether the STORPORT driver maps SRB data buffer addresses to system virtual addresses. For more information, see the <B>MapBuffers</B> member of <A HREF="k306_0e5u.htm">HW_INITIALIZATION_DATA (STORPORT)</A>.</DD>

<DT><B>NeedPhysicalAddresses</B></DT>

<DD>Indicates, when TRUE, that the miniport driver must translate virtual addresses to physical addresses, as required by the HBA. The STORPORT driver initializes this member to TRUE, because its miniports must support scatter/gather lists. Miniports that work with the STORPORT driver must <I>not</I> modify this value. For more information, see the <B>NeedPhysicalAddresses</B> member of <A HREF="k306_2h4i.htm">PORT_CONFIGURATION_INFORMATION</A>. </DD>

<DT><B>TaggedQueueing</B></DT>

<DD>Indicates, when TRUE, that the HBA supports queuing of multiple requests with SCSI tags. The STORPORT driver initializes this member to TRUE, because its miniports must support tagged-queuing. Miniports that work with the STORPORT driver must <I>not</I> modify this value. For more information, see the <B>TaggedQueueing</B> member of <A HREF="k306_2h4i.htm">PORT_CONFIGURATION_INFORMATION</A>. </DD>

<DT><B>AutoRequestSense</B></DT>

<DD>Indicates, when TRUE, that the HBA supports auto request sense. The STORPORT driver initializes this member to TRUE, because its miniports must support auto-request sense. Miniports that work with the STORPORT driver must <I>not</I> modify this value. For more information, see the <B>AutoRequestSense</B> member of <A HREF="k306_2h4i.htm">PORT_CONFIGURATION_INFORMATION</A>. </DD>

<DT><B>MultipleRequestPerLu</B></DT>

<DD>Indicates, when TRUE, that the HBA supports multiple requests per logical unit. The STORPORT driver initializes this member to TRUE, because its miniports must support multiple requests issued to a logical unit at time. Miniports that work with the STORPORT driver must <I>not</I> modify this value. For more information, see the <B>MultipleRequestPerLu</B> member of <A HREF="k306_2h4i.htm">PORT_CONFIGURATION_INFORMATION</A>. </DD>

<DT><B>ReceiveEvent</B></DT>

<DD>The STORPORT driver does not use this member, and its miniports must not set it. </DD>

<DT><B>RealModeInitialized</B></DT>

<DD>The STORPORT driver does not use this member, and its miniports must not set it. </DD>

<DT><B>BufferAccessScsiPortControlled</B></DT>

<DD>The STORPORT driver does not use this member, and its miniports must not set it. </DD>

<DT><B>MaximumNumberOfTargets</B></DT>

<DD>Specifies the number of target peripherals the adapter can control. For more information, see the <B>MaximumNumberOfTargets</B> member of <A HREF="k306_2h4i.htm">PORT_CONFIGURATION_INFORMATION</A>. </DD>

<DT><B>ReservedUchars</B></DT>

<DD>Reserved for system use. </DD>

<DT><B>SlotNumber</B></DT>

<DD>Initialized and reserved for use by the STORPORT driver. Miniports that work with the STORPORT driver must not modify this member.</DD>

<DT><B>BusInterruptLevel2</B></DT>

<DD>Initialized and reserved for use by the STORPORT driver. Miniports that work with the STORPORT driver must not modify this member.</DD>

<DT><B>BusInterruptVector2</B></DT>

<DD>Initialized and reserved for use by the STORPORT driver. Miniports that work with the STORPORT driver must not modify this member.</DD>

<DT><B>InterruptMode2</B></DT>

<DD>Initialized and reserved for use by the STORPORT driver. Miniports that work with the STORPORT driver must not modify this member.</DD>

<DT><B>DmaChannel2</B></DT>

<DD>Initialized and reserved for use by the STORPORT driver. Miniports that work with the STORPORT driver must not modify this member.</DD>

<DT><B>DmaPort2</B></DT>

<DD>Initialized and reserved for use by the STORPORT driver. Miniports that work with the STORPORT driver must not modify this member.</DD>

<DT><B>DmaWidth2</B></DT>

<DD>Initialized and reserved for use by the STORPORT driver. Miniports that work with the STORPORT driver must not modify this member.</DD>

<DT><B>DmaSpeed2</B></DT>

<DD>Initialized and reserved for use by the STORPORT driver. Miniports that work with the STORPORT driver must not modify this member.</DD>

<DT><B>DeviceExtensionSize</B></DT>

<DD>Specifies the size, in bytes, required by the miniport driver for its per-adapter extension. For more information, see the <B>DeviceExtensionSize</B> member of <A HREF="k306_2h4i.htm">PORT_CONFIGURATION_INFORMATION</A>. </DD>

<DT><B>SpecificLuExtensionSize</B></DT>

<DD>Specifies the size, in bytes, required by the miniport driver for its per-logical-unit extension. For more information, see the <B>SpecificLuExtensionSize</B> member of <A HREF="k306_2h4i.htm">PORT_CONFIGURATION_INFORMATION</A>. </DD>

<DT><B>SrbExtensionSize</B></DT>

<DD>Specifies the size, in bytes, required by the miniport driver for its per-request storage. For more information, see the <B>SrbExtensionSize</B> member of <A HREF="k306_2h4i.htm">PORT_CONFIGURATION_INFORMATION</A>. </DD>

<DT><B>Dma64BitAddresses</B></DT>

<DD>Indicates whether the HBA is able to access addresses greater than 4 GB. STORPORT adapters are required to support bus-width DMA. Therefore, on a 64-bit or PAE machine, the STORPORT driver initializes this value to SCSI_DMA64_MINIPORT_SUPPORTED indicating that the adapter can access the full range of addresses. Miniports that work with the STORPORT driver must <I>not</I> modify this value. For more information, see the <B>Dma64BitAddresses</B> member of <A HREF="k306_2h4i.htm">PORT_CONFIGURATION_INFORMATION</A>. </DD>

<DT><B>ResetTargetSupported</B></DT>

<DD>Indicates, when TRUE, that the miniport driver has the ability to reset a target device in response to an SRB_FUNCTION_RESET_DEVICE request from the port driver. For more information, see the <B>ResetTargetSupported</B> member of <A HREF="k306_2h4i.htm">PORT_CONFIGURATION_INFORMATION</A>. </DD>

<DT><B>MaximumNumberOfLogicalUnits</B></DT>

<DD>Specifies the maximum number of logical units per target the HBA can control. For more information, see the <B>MaximumNumberOfLogicalUnits</B> member of <A HREF="k306_2h4i.htm">PORT_CONFIGURATION_INFORMATION</A>.  </DD>

<DT><B>WmiDataProvider</B></DT>

<DD>Indicates, when TRUE, that the miniport responds to Windows Management Instrumentation (WMI) requests. The STORPORT driver initializes this member to TRUE, because its miniports must support WMI. Additionally, miniports for fibre channel adapters are expected to support the SAN Management HBA API through WMI, and miniports for host-based RAID adapters are required to support the RAID Management Interface. 

<P>Miniports that work with the STORPORT driver must <I>not</I> modify this value. For more information, see the <B>WmiDataProvider</B> member of <A HREF="k306_2h4i.htm">PORT_CONFIGURATION_INFORMATION</A>. 
</DD>

<DT><B>SynchronizationModel</B></DT>

<DD>Specifies the I/O synchronization model the miniport driver supports. The possible values are as follows:

<TABLE>

<TR VALIGN="top">
<TH align=left width=60%>Value</TH>
<TH align=left width=40%>Meaning</TH>
</TR>

<TR VALIGN="top">
<TD width=60%><B>StorSynchronizeFullDuplex</B></TD>
<TD width=40%>Full-duplex mode. </TD>
</TR>

<TR VALIGN="top">
<TD width=60%><B>StorSynchronizeHalfDuplex</B></TD>
<TD width=40%>Half-duplex mode. </TD>
</TR>
</TABLE><BR>

</DD>
</DL>

<H4>Headers</H4>

<P>Declared in <I>storport.h</I>. Include <I>storport.h</I>. </P>

<H4>Comments</H4>

<P>When the PnP Manager notifies STORPORT to start a device, the STORPORT driver allocates and initializes this structure, supplies as much HBA-specific configuration information as possible, and passes the structure to the miniport driver's <I>HwStorFindAdapter</I> routine. The STORPORT driver does not support legacy devices. All miniports that work with the STORPORT driver are PnP drivers. Therefore, <I>HwStorFindAdapter</I> does not physically search for the adapter. Its principal function is to initialize the PORT_CONFIGURATION_INFORMATION structure. </P>

<H4>See Also</H4>

<P><A HREF="k306_2h4i.htm">PORT_CONFIGURATION_INFORMATION</A></P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: PORT_CONFIGURATION_INFORMATION%20(STORPORT)"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
