<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>INF DDInstall.Interfaces Section</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="INF DDInstall.Interfaces Section">
</HEAD>
<BODY TOPMARGIN="0">
<DIV STYLE="display:none;">
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_using_guids_in_drivers_kg">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_iosetdeviceinterfacestate_kr">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_ioregisterdeviceinterface_kr">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_adddevice_kr">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_ioregisterdeviceinterface_kr">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_iosetdeviceinterfacestate_kr">
</OBJECT>
</DIV>


<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Device&nbsp;Installation:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_inf_ddinstall.interfaces_section_dr"></A>INF <I>DDInstall</I>.Interfaces Section</H1>

<P><B>[</B><I>install-section-name</I><B>.Interfaces]</B> |<BR>
<B>[</B><I>install-section-name</I><B>.nt.Interfaces]</B> | <BR>
<B>[</B><I>install-section-name</I><B>.ntx86.Interfaces]</B> <BR>
<B>[</B><I>install-section-name</I><B>.ntia64.Interfaces]</B> <BR>
&nbsp;<BR>
<B>AddInterface={</B><I>InterfaceClassGUID</I><B>} </B>[<B>, </B>[<I>reference&nbsp;string</I>] [<B>,</B>[<I>add-interface-section</I>] [<B>,</B><I>flags</I>]]] ...<BR>
[<B>Include=</B><I>filename</I><B>.</B><I>inf</I>[<B>,</B><I>filename2</I><B>.</B><I>inf</I>]...]<BR>
[<B>Needs=</B><I>inf-section-name</I>[<B>,</B><I>inf-section-name</I>]...]<BR>
<B>&nbsp;</B><BR>
<B>&nbsp;</B><BR>
 </P>

<P>Each per-Models <I>DDInstall</I><B>.Interfaces</B> section can have one or more <B>AddInterface</B> directives, depending on how many device interfaces a particular device/driver supports. </P>

<P>To support existing device interfaces, such as any of the system's predefined kernel-streaming interfaces, specify the appropriate <I>InterfaceClassGUID</I> values in this section.</P>

<P>To install a component, such as a class driver, that exports a new class of device interfaces, an INF also must have an <A HREF="inf-format_3o8i.htm">INF <B>InterfaceInstall32</B> section</A>. </P>

<P>For more information about device interfaces, see <A HREF="setup-cls_54kn.htm">Device Interface Classes</A>.</P>

<H4>Directives and Entries</H4>

<DL>
<DT><B>AddInterface={</B><I>InterfaceClassGUID</I><B>}</B> [<B>,</B> [<I>reference&nbsp;string</I>] [<B>,</B>[<I>add-interface-section</I>] [<B>,</B><I>flags</I>]]] ...</DT>

<DD>This directive installs support for a device interface class, designated by the given <I>InterfaceClassGUID</I> value, that the driver exports to higher level components. Usually, it also references an INF-writer-defined <I>add-interface-section</I> elsewhere in the INF file. For detailed information about specifying this directive, see <A HREF="inf-format_3omq.htm">INF <B>AddInterface</B> Directive</A>.</DD>

<DT><B>Include=</B><I>filename</I><B>.</B><I>inf</I>[<B>,</B><I>filename2</I><B>.</B><I>inf</I>]...</DT>

<DD>This optional entry specifies one or more additional system-supplied INF files containing sections needed to register the interface classes supported by this device/driver. If this entry is specified, usually so is a <B>Needs</B> entry. (For further information on the <B>Include</B> entry and restrictions on its use, see <A HREF="create-inf_82g7.htm">Specifying the Source and Target Locations for Device Files</A>.)</DD>

<DT><B>Needs=</B><I>inf-section-name</I>[<B>,</B><I>inf-section-name</I>]...</DT>

<DD>This optional entry specifies the particular sections that must be processed during the installation of this device. Typically, such a named section is a <I>DDInstall</I><B>.Interfaces</B> section within a system-supplied INF file listed in an <B>Include</B> entry. However, it can be any section that is referenced within such a <I>DDInstall</I><B>.Interfaces</B> section of the included INF.

<P><B>Needs</B> entries cannot be nested. (For further information on the <B>Needs</B> entry and restrictions on its use, see <A HREF="create-inf_82g7.htm">Specifying the Source and Target Locations for Device Files</A>.)

</DD>
</DL>

<H4>Comments</H4>

<P>The <I>DDInstall</I> section name<I> </I>must be referenced by a device/models-specific entry under the per-manufacturer <I>Models</I> section of the INF file. For information about using the system-defined <B>.nt</B>, <B>.ntx86</B>, and <B>.ntia64</B> extensions in cross-platform and dual-OS INF files, see <A HREF="create-inf_9xpj.htm">Creating INF Files for Multiple Platforms and Operating Systems</A>. </P>

<P>If a given <B>{</B><I>InterfaceClassGUID</I><B>}</B> is not installed already, the operating system's setup code installs that device interface class in the system. If an INF file installs one or more new device interface classes, it also has an <B>[InterfaceInstall32]</B> section identifying the GUID for the new class..</P>

<P>For more information about how to create a GUID, see <A HREF="JavaScript:hhobj_1.Click()">Using GUIDs in Drivers</A>. For the system-defined interface class GUIDs, see the appropriate system-supplied header, such as <I>ks.h</I> for the kernel-streaming interface class GUIDS. </P>

<P>When a driver is loaded, it must call <A HREF="JavaScript:hhobj_2.Click()"><B>IoSetDeviceInterfaceState</B></A> once for each <B>{</B><I>InterfaceClassGUID</I><B>}</B> value specified in the INF's <I>DDInstall</I><B>.Interfaces</B> section that the driver supports on the underlying device, to enable the interface for runtime use by higher level components. Instead of registering support for a device interface in an INF, a device driver can call <A HREF="JavaScript:hhobj_3.Click()"><B>IoRegisterDeviceInterface</B></A> before making its initial call to <B>IoSetDeviceInterfaceState</B>. Usually, a PnP function or filter driver makes this call from its <A HREF="JavaScript:hhobj_4.Click()"><I>AddDevice</I></A> routine. </P>

<H4>Example</H4>

<P>This example shows the <I>DDInstall</I><B>.NT.Interfaces</B> section in the dual-OS INF file for the system-supplied WDM audio device/driver shown as examples for the <A HREF="inf-format_2k8i.htm">INF <I>DDInstall</I> section</A> and the <A HREF="inf-format_6nle.htm">INF <I>DDInstall</I><B>.Services</B> section</A>.</P>

<PRE>;
; following AddInterface= are all single lines (without 
; backslash line continuators) in the system-supplied INF file
;
[WDMPNPB003_Device.NT.Interfaces]
AddInterface=%KSCATEGORY_AUDIO%,%KSNAME_Wave%,\
  WDM_SB16.Interface.Wave
AddInterface=%KSCATEGORY_AUDIO%,%KSNAME_Topology%,\
  WDM_SB16.Interface.Topology
AddInterface=%KSCATEGORY_AUDIO%,%KSNAME_UART%,\
  WDM_SB16.Interface.UART
AddInterface=%KSCATEGORY_AUDIO%,%KSNAME_FMSynth%,\
  WDM_SB16.Interface.FMSynth
; ...
 
[Strings] ; only immediately preceding %strkey% tokens shown here
%KSCATEGORY_AUDIO% = "{6994ad04-93ef-11d0-a3cc-00a0c9223196}"
KSNAME_Wave = "Wave"
KSNAME_UART = "UART"
KSNAME_FMSynth = "FMSynth" 
KSNAME_Topology = "Topology"
; ...</PRE>

<H4>See Also</H4>

<P><A HREF="inf-format_3omq.htm"><B>AddInterface</B></A>, <A HREF="inf-format_2k8i.htm"><I>DDInstall</I></A>, <A HREF="inf-format_3o8i.htm"><B>InterfaceInstall32</B></A>, <A HREF="JavaScript:hhobj_5.Click()"><B>IoRegisterDeviceInterface</B></A>, <A HREF="JavaScript:hhobj_6.Click()"><B>IoSetDeviceInterfaceState</B></A> </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: INF%20DDInstall.Interfaces%20Section"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
