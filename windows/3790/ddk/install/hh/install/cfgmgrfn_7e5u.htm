<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>CMP_WaitNoPendingInstallEvents</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="CMP_WaitNoPendingInstallEvents">
</HEAD>
<BODY TOPMARGIN="0">
<DIV STYLE="display:none;">
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_session_zero_kg_gly">
</OBJECT>
</DIV>


<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Device&nbsp;Installation:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_cmp_waitnopendinginstallevents_dr"></A>CMP_WaitNoPendingInstallEvents</H1>

<P>The <B>CMP_WaitNoPendingInstallEvents</B> function waits until there are no pending device installation activities for the PnP Manager to perform.</P>

<PRE class=syntax>DWORD WINAPI
CMP_WaitNoPendingInstallEvents(
    IN DWORD dwTimeout
    );</PRE>

<H4>Parameters</H4>

<DL>
<DT><I>dwTimeout</I></DT>

<DD>Specifies a time-out interval, in milliseconds. 

<UL>
	<LI>If <I>dwTimeout</I> is set to zero, the function tests whether there are pending installation events and returns immediately.</LI>

	<LI>If <I>dwTimeout</I> is set to INFINITE (defined in <I>winbase.h</I>), the function's time-out interval never elapses.</LI>

	<LI>For all other <I>dwTimeout</I> values, the function returns when the specified interval elapses, even if there are still pending installation events.</LI>
</UL>
</DD>
</DL>

<H4>Return Value</H4>

<P>The function returns one of the following values (defined in <I>winbase.h</I>):

<DL>
<DT>WAIT_OBJECT_0</DT>

<DD>There are no pending installation activities.</DD>

<DT>WAIT_TIMEOUT</DT>

<DD>The time-out interval elapsed, and installation activities are still pending.</DD>

<DT>WAIT_FAILED</DT>

<DD>The function failed. Call <B>GetLastError</B> for additional error information.
</DD>
</DL>

<H4>Headers</H4>

<P>Defined in <I>cfgmgr32.h</I>. Include <I>cfgmgr32.h</I>. Link with <I>cfgmgr32.dll</I>.</P>

<H4>Comments</H4>

<P>The function waits for an internal event object, which the PnP Manager sets when it determines that no installation activities are pending.</P>

<P>If a non-zero time-out value is specified, then <B>CMP_WaitNoPendingInstallEvents</B> will return either when no installation events are pending or when the time-out period has expired, whichever comes first. This routine is intended to be called only after a user has logged on.</P>

<P>New installation events can occur at any time. This function just indicates that there are no pending installation activities at the moment it is called.</P>

<P>This function is typically used by device installation applications. For more information, see <A HREF="custom-install_7n53.htm">Writing a Device Installation Application</A>.</P>

<P>For Windows&nbsp;XP and earlier versions of the operating system, this function must be called from <A HREF="JavaScript:hhobj_1.Click()">session zero</A>, with administrator privileges. For Windows&nbsp;XP SP1 and later versions, the function can be called from any session, and administrator privileges are not required.</P>

<P>This function is not available on Windows&nbsp;95/98/Me.</P>

<H4>See Also</H4>

<P><A HREF="cfgmgrfn_0pyq.htm"><B>CM_WaitNoPendingInstallEvents</B></A> </P>

<P></P>

<P></P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: CMP_WaitNoPendingInstallEvents"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
