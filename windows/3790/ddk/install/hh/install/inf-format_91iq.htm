<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>INF DelService Directive</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="INF DelService Directive">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Device&nbsp;Installation:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_inf_delservice_directive_dr"></A>INF DelService Directive</H1>

<P><B>[</B><I>DDInstall</I><B>.Services]</B> <BR>
&nbsp;<BR>
<B>DelService=</B><I>ServiceName</I>[<B>,</B>[<I>flags</I>][<B>,</B>[<I>EventLogType</I>][<B>,</B><I>EventName</I>]]]<BR>
 ...<BR>
<B>&nbsp;</B> <BR>
<B>&nbsp;</B> <BR>
</P>

<P>A <B>DelService</B> directive is used in a <I>DDInstall</I><B>.Services</B> section to remove one or more previously installed device/driver services from the target machine. </P>

<H4>Entry Values</H4>

<DL>
<DT><I>ServiceName</I></DT>

<DD>Specifies the name of the service to be removed. 

<P>For a device, this value is usually a generic name for its driver, such as "sermouse," or some such name. 
</DD>

<DT><I>flags</I></DT>

<DD>This optional value is specifies one or more of the following flags, defined in <I>setupapi.h</I>, expressed as a hexadecimal value:

<DL>
<DT><B>0x00000004</B> (SPSVCINST_DELETEEVENTLOGENTRY) </DT>

<DD>An event-log entry (or entries) associated with the given <I>ServiceName</I> should also be removed from the system. </DD>

<DT><B>0x00000200</B> (SPSVCINST_STOPSERVICE) </DT>

<DD>Stop the service before deleting it.</DD>
</DL>
</DD>

<DT><I>EventLogType</I></DT>

<DD>Optionally specifies one of <B>System</B>, <B>Security</B>, or <B>Application</B>. This can be omitted if the event log to be removed is of type <B>System</B>. </DD>

<DT><I>EventName</I></DT>

<DD>Optionally specifies the name for the event log. This can be omitted if it is identical to the given <I>ServiceName</I>. 
</DD>
</DL>

<H4>Comments</H4>

<P>This directive is rarely used. The only services that can be safely deleted are those that were used only in earlier versions of the operating system, and are thus never used for the currently installed version. (For Windows XP and later, you can use the TargetOSVersion decoration to control version-specific installation behavior. See <A HREF="inf-format_816a.htm">INF Manufacturer Section</A>.)</P>

<P>However, by default, event-log information supplied by a particular device driver is not removed from the system on deinstallation, unless the INF for the device/driver explicitly requests the removal (<I>flags</I> or <I>EventName</I>) of the event log along with the removal of the driver services.</P>

<H4>See Also</H4>

<P><A HREF="inf-format_79te.htm"><B>AddService</B></A>, <A HREF="inf-format_6nle.htm"><B><I>DDInstall</I>.Services</B></A>, <A HREF="inf-format_21de.htm"><B>DelReg</B></A> </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: INF%20DelService%20Directive"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
