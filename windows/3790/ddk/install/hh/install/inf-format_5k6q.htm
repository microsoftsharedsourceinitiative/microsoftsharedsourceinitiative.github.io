<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>INF DDInstall.HW Section</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="INF DDInstall.HW Section">
</HEAD>
<BODY TOPMARGIN="0">
<DIV STYLE="display:none;">
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_hardware_key_kg_gly">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_supporting_multifunction_devices_dg">
</OBJECT>
</DIV>


<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Device&nbsp;Installation:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_inf_ddinstall.hw_section_dr"></A>INF <I>DDInstall</I>.HW Section</H1>

<P><B>[</B><I>install-section-name</I><B>.HW]</B> |<BR>
<B>[</B><I>install-section-name</I><B>.nt.HW]</B> |<BR>
<B>[</B><I>install-section-name</I><B>.ntx86.HW]</B> <BR>
<B>[</B><I>install-section-name</I><B>.ntia64.HW]</B> <BR>
&nbsp;<BR>
[<B>AddReg=</B><I>add</I>-<I>registry</I>-<I>section</I>[<B>,</B> <I>add</I>-<I>registry</I>-<I>section</I>]...] ...<BR>
[<B>Include=</B><I>filename</I><B>.</B><I>inf</I>[<B>,</B><I>filename2</I><B>.</B><I>inf</I>]...]<BR>
[<B>Needs=</B><I>inf-section-name</I>[<B>,</B><I>inf-section-name</I>]...]<BR>
[<B>DelReg=</B><I>del</I>-<I>registry</I>-<I>section</I>[<B>,</B> <I>del</I>-<I>registry</I>-<I>section</I>]...] ...<BR>
[<B>BitReg=</B><I>bit-registry-section</I>[<B>,</B><I>bit-registry-section</I>] ...] ...<BR>
<B>&nbsp;</B><BR>
<B>&nbsp;</B><BR>
 </P>

<P><I>DDInstall</I><B>.HW</B> sections are typically used for installing multifunction devices, for installing PnP filter drivers, and for setting up any user-accessible device-specific but driver-independent information in the registry, whether with explicit <B>AddReg</B> directives or with <B>Include</B> and <B>Needs</B> entries.</P>

<H4>Directives and Entries</H4>

<DL>
<DT><B>AddReg=</B><I>add</I>-<I>registry</I>-<I>section</I>[<B>,</B> <I>add</I>-<I>registry</I>-<I>section</I>]...</DT>

<DD>References one or more INF-writer-defined <I>add-registry-section</I>s elsewhere in the INF file for the devices covered by this <I>DDInstall</I><B>.HW</B> section. The <I>add-registry-section</I> typically installs filters and/or stores per-device information in the registry. An <B>HKR</B> specification in such an <I>add-registry-section</I> specifies the device's <A HREF="JavaScript:hhobj_1.Click()">hardware key</A>. For more information, see <A HREF="inf-format_2v02.htm">INF <B>AddReg</B> Directive</A>.</DD>

<DT><B>Include=</B><I>filename</I><B>.</B><I>inf</I>[<B>,</B><I>filename2</I><B>.</B><I>inf</I>]...</DT>

<DD>Specifies one or more additional system-supplied INF files containing sections needed to install this device. If this entry is specified, usually so is a <B>Needs</B> entry. (For further information on the <B>Include</B> entry and restrictions on its use, see <A HREF="create-inf_82g7.htm">Specifying the Source and Target Locations for Device Files</A>).</DD>

<DT><B>Needs=</B><I>inf-section-name</I>[<B>,</B><I>inf-section-name</I>]...</DT>

<DD>Specifies the named sections that must be processed during the installation of this device. Typically, such a named section is a <I>DDInstall</I><B>.HW</B> section within a system-supplied INF file listed in an <B>Include</B> entry. However, it can be any section that is referenced within such a <I>DDInstall</I><B>.HW</B> section of the included INF.

<P><B>Needs</B> entries cannot be nested. (For further information on the <B>Needs</B> entry and restrictions on its use, see <A HREF="create-inf_82g7.htm">Specifying the Source and Target Locations for Device Files</A>).
</DD>

<DT><B>DelReg=</B><I>del</I>-<I>registry</I>-<I>section</I>[<B>,</B> <I>del</I>-<I>registry</I>-<I>section</I>]...</DT>

<DD>References one or more INF-writer-defined <I>delete-registry-section</I>s elsewhere in the INF file for the drivers of the devices covered by this <I>DDInstall</I> section. Such a delete-registry section removes stale registry information for a previously installed device/driver from the target machine. An <B>HKR</B> specification in such a delete-registry section designates the same subkey as for <B>AddReg</B>. 

<P>This directive is rarely used, except in an INF file that upgrades a previous installation of the same devices/models listed in the per-manufacturer per-<I>Models</I> section that defined the name of this <I>DDInstall</I> section. For more information, see <A HREF="inf-format_21de.htm">INF <B>DelReg</B> Directive</A>.
</DD>

<DT><B>BitReg=</B><I>bit-registry-section</I>[<B>,</B><I>bit-registry-section</I>]...</DT>

<DD>Is valid in this section, but almost never used. An <B>HKR</B> specification in a referenced bit-registry section designates the same subkey as for <B>AddReg</B>. For more information, see <A HREF="inf-format_4sj6.htm">INF <B>BitReg</B> Directive</A>.
</DD>
</DL>

<H4>Comments</H4>

<P>The case-insensitive extensions to the <I>install-section-name</I> shown in the formal syntax statement can be inserted into such a <I>DDInstall</I><B>.HW </B>section name in cross-platform and dual-OS INF files. For information about how to use the system-defined <B>.nt</B>, <B>.ntx86</B>, and <B>.ntia64</B> extensions, see <A HREF="create-inf_9xpj.htm">Creating INF Files for Multiple Platforms and Operating Systems</A>. </P>

<P>Any <I>DDInstall</I><B>.HW</B> section either must have an <B>AddReg</B> directive or must <B>Include</B> another INF file and reference a section in the corresponding <B>Needs</B> entry that sets up the necessary registry information. </P>

<P>Each directive in a <I>DDInstall</I><B>.HW</B> section can reference more than one INF-writer-defined section, but each additional named section must be separated from the next with a comma (<B>,</B>). Each such section name must be unique within the INF and must follow the general rules for defining section names. These rules are described in <A HREF="inf-format_7soi.htm">General Syntax Rules for INF Files</A>.</P>

<P>For more information about installing multifunction devices, <A HREF="JavaScript:hhobj_2.Click()">Supporting Multifunction Devices</A>. </P>

<H4>Example</H4>

<P>This example shows how the CD-ROM device class installer uses <I>DDInstall</I><B>.HW</B> sections and <I>DDInstall</I><B>.Services</B> sections to support both CD audio and changer functionality by creating the appropriate registry sections, and setting these up as PnP upper filter drivers.</P>

<PRE>;;
;; Installation section for cdaudio. Sets cdrom as the service 
;; and adds cdaudio as a PnP upper filter driver. 
;;
[cdaudio_install]
CopyFiles=cdaudio_copyfiles,cdrom_copyfiles
 
[cdaudio_install.HW]
AddReg=nosync_addreg,cdaudio_addreg
 ; cdaudio_addreg required to register this as a PnP filter driver
 
[cdaudio_install.Services]
AddService=cdrom,0x00000002,cdrom_ServiceInstallSection
AddService=cdaudio,,cdaudio_ServiceInstallSection
 
[changer_install]
CopyFiles=changer_copyfiles,cdrom_copyfiles
 
[changer_install.HW]
AddReg=changer_addreg
 
; ... changer_install.Services section similar to cdaudio's
 
; ... some similar cdrom_install(.HW)/addreg sections omitted 
 
[cdaudio_addreg] ; changer_addreg section has similar entry
HKR,,"UpperFilters",0x00010000,"cdaudio" ; REG_MULTI_SZ value 
 
;
; Use next section to disable synchronous transfers to this device. 
; Sync transfers will always be turned off by default in this INF 
; for any cdrom-type device.
;
[nosync_addreg]
HKR,,"DefaultRequestFlags",0x00010001,8
 
[autorun_addreg]
HKLM,"System\CurrentControlSet\Services\cdrom","AutoRun",0x00010003,1
;;
;; service-install sections for cdrom, cdaudio, and changer
;;
[cdrom_ServiceInstallSection]
DisplayName    = %cdrom_ServiceDesc%
ServiceType    = 1
StartType      = 1
ErrorControl   = 1
ServiceBinary  = %12%\cdrom.sys
LoadOrderGroup = SCSI CDROM Class
AddReg         = autorun_addreg
 
[cdaudio_ServiceInstallSection]
DisplayName    = %cdaudio_ServiceDesc%
ServiceType    = 1
StartType      = 1
ErrorControl   = 1
ServiceBinary  = %12%\cdaudio.sys
 
; ... changer_ServiceInstallSection similar to cdaudio's</PRE>

<H4>See Also</H4>

<P><A HREF="inf-format_2v02.htm"><B>AddReg</B></A>, <A HREF="inf-format_4sj6.htm"><B>BitReg</B></A>, <A HREF="inf-format_2k8i.htm"><I>DDInstall</I></A>, <A HREF="inf-format_6nle.htm"><I>DDInstall</I><B>.Services</B></A>, <A HREF="inf-format_21de.htm"><B>DelReg</B></A> </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: INF%20DDInstall.HW%20Section"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
