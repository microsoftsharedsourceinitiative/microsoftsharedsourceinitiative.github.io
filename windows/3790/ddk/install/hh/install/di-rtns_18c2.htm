<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>SetupDiSetDeviceRegistryProperty</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="SetupDiSetDeviceRegistryProperty">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Device&nbsp;Installation:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_setupdisetdeviceregistryproperty_dr"></A>SetupDiSetDeviceRegistryProperty</H1>

<P>The <B>SetupDiSetDeviceRegistryProperty</B> function sets the specified Plug and Play device property.</P>

<PRE class=syntax><B>WINSETUPAPI BOOL WINAPI</B>
  <B>SetupDiSetDeviceRegistryProperty(</B>
    <B>IN HDEVINFO</B>  <I>DeviceInfoSet</I><B>,</B>
    <B>IN OUT PSP_DEVINFO_DATA</B>  <I>DeviceInfoData</I><B>,</B>
    <B>IN DWORD</B>  <I>Property</I><B>,</B>
    <B>IN CONST BYTE</B>  <B>*</B><I>PropertyBuffer</I><B>,</B>
    <B>IN DWORD</B>  <I>PropertyBufferSize</I>
    <B>);</B></PRE>

<H4>Parameters</H4>

<DL>
<DT><I>DeviceInfoSet</I></DT>

<DD>Supplies a handle to the <A HREF="setup-cls_2h9j.htm">device information set</A> containing information about the device instance whose Plug and Play property is to be modified.</DD>

<DT><I>DeviceInfoData</I></DT>

<DD>Supplies a pointer to an <A HREF="di-struct_7nqq.htm">SP_DEVINFO_DATA</A> structure indicating the device instance whose Plug and Play property is to be modified. If the ClassGUID property is being set, this structure is updated upon return to reflect the device's new class.</DD>

<DT><I>Property</I></DT>

<DD>Supplies one of the following ordinal values, which identifies the property to be set. For descriptions of these values, see <A HREF="di-rtns_4x2q.htm"><B>SetupDiGetDeviceRegistryProperty</B></A>. 

<P>SPDRP_CHARACTERISTICS <BR>
SPDRP_COMPATIBLEIDS <BR>
SPDRP_CONFIGFLAGS <BR>
SPDRP_DEVTYPE <BR>
SPDRP_EXCLUSIVE <BR>
SPDRP_FRIENDLYNAME <BR>
SPDRP_HARDWAREID <BR>
SPDRP_LOCATION_INFORMATION <BR>
SPDRP_LOWERFILTERS <BR>
SPDRP_REMOVAL_POLICY_OVERRIDE (<I>Windows&nbsp;XP and later</I>)<BR>
SPDRP_SECURITY <BR>
SPDRP_SECURITY_SDS <BR>
SPDRP_SERVICE <BR>
SPDRP_UI_NUMBER_DESC_FORMAT <BR>
SPDRP_UPPERFILTERS 


<P>Do not set the following values:


<P>SPDRP_ADDRESS <BR>
SPDRP_BUSNUMBER <BR>
SPDRP_BUSTYPEGUID <BR>
SPDRP_CAPABILITIES <BR>
SPDRP_CLASS <BR>
SPDRP_CLASSGUID <BR>
SPDRP_DEVICE_POWER_DATA <BR>
SPDRP_DEVICEDESC <BR>
SPDRP_DRIVER <BR>
SPDRP_ENUMERATOR_NAME <BR>
SPDRP_LEGACYBUSTYPE <BR>
SPDRP_MFG <BR>
SPDRP_PHYSICAL_DEVICE_OBJECT_NAME <BR>
SPDRP_REMOVAL_POLICY <BR>
SPDRP_REMOVAL_POLICY_HW_DEFAULT <BR>
SPDRP_UI_NUMBER 
</DD>

<DT><I>PropertyBuffer</I></DT>

<DD>The address of a buffer that contains the new data for the property. If the property is being cleared, then this pointer should be NULL and <I>PropertyBufferSize</I> must be zero.</DD>

<DT><I>PropertyBufferSize</I></DT>

<DD>Supplies the size, in bytes, of <I>PropertyBuffer</I>. If <I>PropertyBuffer</I> is NULL, then this field must be zero.
</DD>
</DL>

<H4>Return Value</H4>

<P>The function returns TRUE if it is successful. Otherwise, it returns FALSE and the logged error can be retrieved with a call to <B>GetLastError</B>.</P>

<H4>Headers</H4>

<P>Declared in <I>setupapi.h</I>. Include <I>setupapi.h</I>. </P>

<H4>Comments</H4>

<P>The caller of this function must be a member of the Administrators group.</P>

<P>The class name property cannot be set because it is based on the corresponding class GUID and is automatically updated when that property is changed. When the ClassGUID property changes, <B>SetupDiSetDeviceRegistryProperty</B> automatically cleans up any software keys associated with the device.</P>

<H4>See Also</H4>

<P><A HREF="di-rtns_6tiq.htm"><B>SetupDiGetClassRegistryProperty</B></A> <BR>
<A HREF="di-rtns_6rg2.htm"><B>SetupDiSetClassRegistryProperty</B></A> <B><BR>
<A HREF="di-rtns_4x2q.htm">SetupDiGetDeviceRegistryProperty</A></B> </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: SetupDiSetDeviceRegistryProperty"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
