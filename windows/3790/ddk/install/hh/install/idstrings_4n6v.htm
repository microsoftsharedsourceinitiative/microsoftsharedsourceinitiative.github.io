<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Identifiers Generated by USBSTOR.SYS</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Identifiers Generated by USBSTOR.SYS">
</HEAD>
<BODY TOPMARGIN="0">
<DIV STYLE="display:none;">
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_device_object_example_for_a_usb_mass_storage_device_kg">
</OBJECT>
</DIV>


<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Device&nbsp;Installation:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="ddk_identifiers_generated_by_usbstor.sys_dg"></A>Identifiers Generated by USBSTOR.SYS</H3>

<P>Microsoft® Windows® 2000 and later operating systems, as well as Windows Millennium Edition (Windows Me), contain native support for a large number of USB mass storage devices. The <I>usbstor.inf</I> installation file contains device IDs for those devices that are explicitly supported. If the USB hub driver enumerates one of these devices, the system will automatically load the USB storage port driver, <I>usbstor.sys</I>. </P>

<P>The device IDs for USB mass storage devices listed in <I>usbstor.inf</I> take the usual form for USB device IDs composed using information in the USB device’s device descriptor:</P>

<P class=indent1>USB\VID_<I>v(4)</I>&amp;PID_<I>d(4)</I>&amp;REV_<I>r(4)</I></P>

<P>where <I>v(4)</I> is the 4-digit vendor code that the USB committee assigns to the vendor, <I>d(4)</I> is the 4-digit product code that the vendor assigns to the device, and <I>r(4)</I> is the revision code. </P>

<P>In addition to these device IDs, <I>usbstor.inf</I> contains compatible IDs for class 8 ATAPI CD-ROM and removable media devices that support bulk-only transport: </P>

<P class=indent1>USB\CLASS_08&amp;SUBCLASS_02&amp;PROT_50</P>

<P class=indent1>USB\CLASS_08&amp;SUBCLASS_05&amp;PROT_50</P>

<P class=indent1>USB\CLASS_08&amp;SUBCLASS_06&amp;PROT_50</P>

<P>where </P>

<P class=indent1>class 08h = mass storage devices</P>

<P class=indent1>subclass 02h = SFF-8020i ATAPI CD-ROM devices</P>

<P class=indent1>subclass 05h = SFF-8070i ATAPI removable media</P>

<P class=indent1>subclass 06h = generic SCSI media, and</P>

<P class=indent1>protocol 50h = the bulk-only transport protocol. </P>

<P>If the data retrieved from the device's device descriptor matches any of these compatible IDs, the system will load <I>usbstor.sys</I>. </P>

<P>Once loaded, the USB storage port driver creates a new PDO for each of the device's logical units. For more information, see the example device stack created by <I>usbstor.sys</I> illustrated in <A HREF="JavaScript:hhobj_1.Click()">Device Object Example for a USB Mass Storage Device</A>. </P>

<P>When the PnP manager queries for the device identification strings of the newly created PDOs, the USB storage port driver fabricates a new set of device, hardware and compatible IDs derived from the device's SCSI inquiry data. The device ID format is:</P>

<P class=indent1>USBSTOR\<I>v(8)p(16)r(4)</I></P>

<P>where <I>v(8)</I> is an 8-character vendor identifier, <I>p(16)</I> is a 16-character product identifier, and <I>r(4)</I> is a 4-character revision level value. </P>

<P>An example of a device ID for a disk drive would be:</P>

<P class=indent1>USBSTOR\SEAGATE_ST39102LW_______0004</P>

<P>The hardware IDs that the USB storage port driver generates are as follows:</P>

<P class=indent1>USBSTOR\<I>t*v(8)p(16)r(4)</I></P>

<P class=indent1>USBSTOR\<I>t*v(8)p(16)</I></P>

<P class=indent1>USBSTOR\<I>t*v(8)</I></P>

<P class=indent1>USBSTOR\<I>v(8)p(16)r(1)</I></P>

<P class=indent1><I>v(8)p(16)r(1)</I></P>

<P class=indent1>USBSTOR\<I>GenericTypeString</I></P>

<P class=indent1><I>GenericTypeString</I></P>

<P>where <I>t*</I> is a SCSI device type code of variable length, <I>v(8)</I> is an 8-character vendor identifier, <I>p(16)</I> is a 16-character product identifier, and <I>r(4)</I> is a 4-character revision level value, and in the fourth and fifth of these additional identifiers, <I>r(1)</I> represents just the first character of the revision identifier.</P>

<P>The following table contains the SCSI device type codes used by the USB storage port driver to generate identifier strings:</P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=59%>SCSI Type Code</TH>
<TH align=left width=18%>Device Type</TH>
<TH align=left width=23%>Generic Type</TH>
</TR>

<TR VALIGN="top">
<TD width=59%>DIRECT_ACCESS_DEVICE (0)</TD>
<TD width=18%>Disk or SFloppy</TD>
<TD width=23%>GenDisk or GenSFloppy</TD>
</TR>

<TR VALIGN="top">
<TD width=59%>SEQUENTIAL_ACCESS_DEVICE (1)</TD>
<TD width=18%>Sequential</TD>
<TD width=23%>GenSequential</TD>
</TR>

<TR VALIGN="top">
<TD width=59%>WRITE_ONCE_READ_MULTIPLE_DEVICE (4)</TD>
<TD width=18%>Worm</TD>
<TD width=23%>GenWorm</TD>
</TR>

<TR VALIGN="top">
<TD width=59%>READ_ONLY_DIRECT_ACCESS_DEVICE (5)</TD>
<TD width=18%>CdRom</TD>
<TD width=23%>GenCdRom</TD>
</TR>

<TR VALIGN="top">
<TD width=59%>OPTICAL_DEVICE (7)</TD>
<TD width=18%>Optical</TD>
<TD width=23%>GenOptical</TD>
</TR>

<TR VALIGN="top">
<TD width=59%>MEDIUM_CHANGER (8)</TD>
<TD width=18%>Changer</TD>
<TD width=23%>GenChanger</TD>
</TR>

<TR VALIGN="top">
<TD width=59%>Default Type (all values not listed above)</TD>
<TD width=18%>Other</TD>
<TD width=23%>UsbstorOther</TD>
</TR>
</TABLE><BR>

<P>These examples illustrate the hardware IDs generated by the USB storage port driver: </P>

<P class=indent1>USBSTOR\DiskSEAGATE_ST39102LW_______0004</P>

<P class=indent1>USBSTOR\DiskSEAGATE_ST39102LW_______</P>

<P class=indent1>USBSTOR\DiskSEAGATE_</P>

<P class=indent1>USBSTOR\SEAGATE_ST39102LW_______0</P>

<P class=indent1>SEAGATE_ST39102LW_______0</P>

<P class=indent1>USBSTOR\GenDisk</P>

<P class=indent1>GenDisk</P>

<P>The USB storage port driver generates two compatible IDs.</P>

<P class=indent1>USBSTOR\<I>t*</I></P>

<P class=indent1>USBSTOR\RAW</P>

<P>where <I>t*</I> is a SCSI device type code of variable length. </P>

<P>The compatible IDs generated by the USB storage port driver are illustrated by the following examples:</P>

<P class=indent1>USBSTOR\Disk</P>

<P class=indent1>USBSTOR\RAW</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Identifiers%20Generated%20by%20USBSTOR.SYS"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
