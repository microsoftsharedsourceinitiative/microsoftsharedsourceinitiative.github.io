<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Using Safe String Functions</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Using Safe String Functions">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Kernel-Mode&nbsp;Driver&nbsp;Architecture:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_using_safe_string_functions_kg"></A>Using Safe String Functions</H1>

<P>Many system security problems are caused by poor buffer handling and the resulting buffer overruns.  Poor buffer handling is often associated with string manipulation operations. The standard string manipulation functions that are supplied by C/C++ language runtime libraries (<B>strcat</B>, <B>strcpy</B>, <B>sprintf</B>, and so on) do not prevent writing beyond the end of buffers.</P>

<P>Two new sets of string manipulation functions, called <I>safe string functions</I>, provide additional processing for proper buffer handling in your code. These safe string functions are available for Microsoft® Windows® XP SP1 and later versions of the Windows DDK and Platform SDK.   They are intended to replace their built-in C/C++ counterparts and similar routines that are supplied by Microsoft Windows.</P>

<P>One set of safe string functions are for use in kernel-mode code. These functions are prototyped in a header file named <I>ntstrsafe.h</I>. This header file and an associated library are available in the Windows DDK.</P>

<P>The other set of safe string functions are for use in user-mode applications. A corresponding header file, <I>strsafe.h</I>, contains prototypes for these functions. That file and an associated library are available in the Platform SDK. For more information about <I>strsafe.h</I>, see the <A HREF="http://go.microsoft.com/fwlink/?linkid=8714&clcid=0x409" target="_blank">Microsoft Developer Network (MSDN)</A> Web site.</P>

<P>The kernel-mode safe string functions provide the following features:

<UL>
	<LI>Each function receives the size of the destination buffer as input. The function can thus ensure that it does not write past the end of the buffer. </LI>

	<LI>The functions null-terminate all output strings, even if the operation truncates the intended result. </LI>

	<LI>All functions return an NTSTATUS value, with only one possible success code (STATUS_SUCCESS). </LI>

	<LI>Each function is available in both a byte-counted and a character-counted version. For example, <A HREF="safestrings_5dte.htm"><B>RtlStringCbCatW</B></A> and <A HREF="safestrings_1t82.htm"><B>RtlStringCchCatW</B></A>.</LI>

	<LI>Each function is available in both a <B>W</B>-suffixed version that supports double-byte Unicode characters and an <B>A</B>-suffixed version that supports single-byte ANSI characters. For example, <A HREF="safestrings_5dte.htm"><B>RtlStringCbCatW</B></A> and <A HREF="safestrings_5dte.htm"><B>RtlStringCbCatA</B></A>.</LI>

	<LI>Most functions are available in an extended, <B>Ex</B>-suffixed version that provides advanced functionality. For example, <A HREF="safestrings_5dte.htm"><B>RtlStringCbCatW</B></A> and <A HREF="safestrings_12ya.htm"><B>RtlStringCbCatExW</B></A>.</LI>
</UL>

<P>This section includes the following topics:</P>

<P class=indent1><A HREF="other_9bqf.htm">Summary of Kernel-Mode Safe String Functions</A> </P>

<P class=indent1><A HREF="other_0vfr.htm">Importing Kernel-Mode Safe String Functions</A> </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Using%20Safe%20String%20Functions"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
