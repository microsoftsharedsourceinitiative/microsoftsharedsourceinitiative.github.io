<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Using wmimofck.exe</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Using wmimofck.exe">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Kernel-Mode&nbsp;Driver&nbsp;Architecture:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_using_wmimofck.exe_kg"></A>Using <I>wmimofck.exe</I></H1>

<P>Included with the DDK is the <I>wmimofck.exe</I> utility. This application takes as input a binary MOF file (a .<I>bmf</I> file), which was generated by the MOF compiler (<I>mofcomp.exe</I>). <I>Wmimofck.exe</I> will check that the classes, properties, methods and events specified in the .<I>bmf</I> file are valid for WMI use. <I>Wmimofck.exe</I> is also capable of generating the following files:

<UL>
	<LI>C language header file (.<I>h</I> file) that can then be used to keep header file in sync with MOF definitions.</LI>

	<LI>C language source file which contains stubs for WMI driver code. </LI>

	<LI>Hex version of .<I>bmf</I> data which can be included in the driver source for supplying dynamic MOF data at runtime.</LI>

	<LI>Test application templates in VBScript or HTML.</LI>
</UL>

<P>To run the <I>wmimofck</I> utility, use the following syntax:</P>

<P><B>wmimofck</B>  [<B>-h</B><I>filename</I>] [<B>-c</B><I>filename</I>] [<B>-x</B><I>filename</I>] [<B>-t</B><I>filename</I>] [<B>-w</B><I>directory</I>]  [<I><B>-y</B>filename</I>]<I> </I>[<I><B>-z</B>filename</I>]</P>

<P>If the <B>-h</B> parameter is specified, a C language header file is created that defines the GUIDs, data structures, and method indices specified in the MOF file.  If the caller specifies the <B>-m</B> flag as well, then the header file will include structure definitions for the input and output of each WMI method.  By default, <I>wmimofck</I> does not generate member definitions for WMI classes that contain variable length properties.  If the caller specifies <B>-u</B>, then <I>wmimofck</I> will generate member definitions for every property that has a fixed size, including string properties that specify a <B>MaxLen</B> qualifier.  If the <B>-t</B> parameter is specified, a VBScript program is created that will query all data blocks and properties specified in the MOF file.</P>

<P>If the <B>-x</B> parameter is specified a text file is created that contains the text representation of the binary MOF data. This can be included in the source of the driver if the driver supports reporting the binary MOF via a WMI query rather than a resource on the driver image file.</P>

<P>If the <B>-c</B> parameter is specified, a C language source file is generated that contains a template for implementing WMI code in a device driver.</P>

<P>If the <B>-w</B> parameter is specified, a set of HTML files are generated that create a rudimentary UI that can be used to access the WMI data blocks.</P>

<P>The <B>-y</B> and <B>-z</B> flags can only be used together.  The <B>-y</B> specifies a file containing language-independent WMI class declarations, and <B>-z</B> specifies the class amendments for a particular language.  The command <I>wmimofck</I> <I>localizedfile</I> <B>-y</B><I>mof</I> <B>-z</B><I>mfl</I> merges the <I>mof</I> and <I>mfl</I> files to form the complete localized version of MOF file.  See <A HREF="wmi_2fjb.htm">Building and Deploying the Localized MOF File</A> for details.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Using%20wmimofck.exe"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
