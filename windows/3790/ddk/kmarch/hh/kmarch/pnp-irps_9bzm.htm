<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Plug and Play Minor IRPs</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Plug and Play Minor IRPs">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Kernel-Mode&nbsp;Driver&nbsp;Architecture:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_plug_and_play_minor_irps_dr"></A>Plug and Play Minor IRPs</H1>

<P>This section describes the PnP IRPs that are sent to drivers. All PnP IRPs have the major function code <A HREF="k113_8ur6.htm">IRP_MJ_PNP</A> and a minor function code indicating the particular PnP request. </P>

<P>This section provides reference information for the individual IRPs. See <A HREF="plugplay_15t3.htm">Plug and Play</A> for a description of the order in which the IRPs are sent, a discussion of how to handle IRPs in <A HREF="drvcomps_7jjb.htm"><I>DispatchPnp</I> routines</A>, and a general discussion of PnP concepts and terminology.</P>

<P>For each IRP and each kind of driver, a driver is either <I>required</I> to handle the IRP, can <I>optionally</I> handle the IRP, or <I>must not</I> handle the IRP. Consult the table below to identify which IRPs your driver will handle and then consult the reference pages for information on the individual IRPs. The IRPs are listed in functional order in the table and in alphabetical order in the IRP reference pages.</P>

<P>If an IRP is marked "No" in the table for a particular driver, that driver must not handle the IRP. The driver must pass the IRP to the next driver in the device stack as described in the reference page for the IRP.</P>

<P>The PnP Manager sends these IRPs. PnP drivers can send some of these IRPs, but only those so noted in this section. </P>

<P>The following are the minor function codes for PnP IRPs, and the driver types that handle them:</P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=47%>PnP IRP Minor Function Code</TH>
<TH align=left width=17%>Function or Filter Driver<BR>
for Nonbus Device </TH>
<TH align=left width=17%>Function Driver for Bus<BR>
Device (for bus FDO)</TH>
<TH align=left width=19%>Bus Driver or Bus Filter<BR>
Driver (for child PDOs)</TH>
</TR>

<TR VALIGN="top">
<TD width=47%><A HREF="pnp-irps_1gqa.htm">IRP_MN_START_DEVICE</A> </TD>
<TD width=17%>Required</TD>
<TD width=17%>Required</TD>
<TD width=19%>Required</TD>
</TR>

<TR VALIGN="top">
<TD width=47%><A HREF="pnp-irps_6d4i.htm">IRP_MN_QUERY_STOP_DEVICE</A> </TD>
<TD width=17%>Required</TD>
<TD width=17%>Required</TD>
<TD width=19%>Required</TD>
</TR>

<TR VALIGN="top">
<TD width=47%><A HREF="pnp-irps_3n5e.htm">IRP_MN_STOP_DEVICE</A> </TD>
<TD width=17%>Required</TD>
<TD width=17%>Required</TD>
<TD width=19%>Required</TD>
</TR>

<TR VALIGN="top">
<TD width=47%><A HREF="pnp-irps_4tpu.htm">IRP_MN_CANCEL_STOP_DEVICE</A> </TD>
<TD width=17%>Required</TD>
<TD width=17%>Required</TD>
<TD width=19%>Required</TD>
</TR>

<TR VALIGN="top">
<TD width=47%><A HREF="pnp-irps_22k2.htm">IRP_MN_QUERY_REMOVE_DEVICE</A> </TD>
<TD width=17%>Required</TD>
<TD width=17%>Required</TD>
<TD width=19%>Required</TD>
</TR>

<TR VALIGN="top">
<TD width=47%><A HREF="pnp-irps_4noy.htm">IRP_MN_REMOVE_DEVICE</A> </TD>
<TD width=17%>Required</TD>
<TD width=17%>Required</TD>
<TD width=19%>Required</TD>
</TR>

<TR VALIGN="top">
<TD width=47%><A HREF="pnp-irps_7xte.htm">IRP_MN_CANCEL_REMOVE_DEVICE</A> </TD>
<TD width=17%>Required</TD>
<TD width=17%>Required</TD>
<TD width=19%>Required</TD>
</TR>

<TR VALIGN="top">
<TD width=47%><A HREF="pnp-irps_8e42.htm">IRP_MN_SURPRISE_REMOVAL</A> </TD>
<TD width=17%>Required</TD>
<TD width=17%>Required</TD>
<TD width=19%>Required</TD>
</TR>

<TR VALIGN="top">
<TD width=47%><A HREF="pnp-irps_9unm.htm">IRP_MN_QUERY_CAPABILITIES</A> </TD>
<TD width=17%>Optional</TD>
<TD width=17%>Optional</TD>
<TD width=19%>Required</TD>
</TR>

<TR VALIGN="top">
<TD width=47%><A HREF="pnp-irps_6acy.htm">IRP_MN_QUERY_PNP_DEVICE_STATE</A> </TD>
<TD width=17%>Optional</TD>
<TD width=17%>Optional</TD>
<TD width=19%>Optional</TD>
</TR>

<TR VALIGN="top">
<TD width=47%><A HREF="pnp-irps_15o2.htm">IRP_MN_FILTER_RESOURCE_REQUIREMENTS</A> </TD>
<TD width=17%>Optional <SUP>(1)</SUP></TD>
<TD width=17%>Optional <SUP>(1)</SUP></TD>
<TD width=19%>No</TD>
</TR>

<TR VALIGN="top">
<TD width=47%><A HREF="pnp-irps_1wmq.htm">IRP_MN_DEVICE_USAGE_NOTIFICATION</A> </TD>
<TD width=17%>Required <SUP>(1)</SUP></TD>
<TD width=17%>Required <SUP>(1)</SUP></TD>
<TD width=19%>Required <SUP>(1)</SUP> </TD>
</TR>

<TR VALIGN="top">
<TD width=47%><A HREF="pnp-irps_5aia.htm">IRP_MN_QUERY_DEVICE_RELATIONS</A> </TD>
<TD width=17%>&nbsp;</TD>
<TD width=17%>&nbsp;</TD>
<TD width=19%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=47%><B>&nbsp;&nbsp;&nbsp;&nbsp;BusRelations</B></TD>
<TD width=17%>Optional <SUP>(1)</SUP></TD>
<TD width=17%>Required</TD>
<TD width=19%>No <SUP>(2)</SUP></TD>
</TR>

<TR VALIGN="top">
<TD width=47%><B>&nbsp;&nbsp;&nbsp;&nbsp;EjectionRelations</B></TD>
<TD width=17%>No</TD>
<TD width=17%>No</TD>
<TD width=19%>Optional</TD>
</TR>

<TR VALIGN="top">
<TD width=47%><B>&nbsp;&nbsp;&nbsp;&nbsp;RemovalRelations</B></TD>
<TD width=17%>Optional</TD>
<TD width=17%>Optional</TD>
<TD width=19%>No</TD>
</TR>

<TR VALIGN="top">
<TD width=47%><B>&nbsp;&nbsp;&nbsp;&nbsp;TargetDeviceRelation</B></TD>
<TD width=17%>No</TD>
<TD width=17%>No</TD>
<TD width=19%>Required</TD>
</TR>

<TR VALIGN="top">
<TD width=47%><A HREF="pnp-irps_3kdu.htm">IRP_MN_QUERY_RESOURCES</A> </TD>
<TD width=17%>No</TD>
<TD width=17%>No</TD>
<TD width=19%>Required <SUP>(1)</SUP></TD>
</TR>

<TR VALIGN="top">
<TD width=47%><A HREF="pnp-irps_9jhu.htm">IRP_MN_QUERY_RESOURCE_REQUIREMENTS</A> </TD>
<TD width=17%>No</TD>
<TD width=17%>No</TD>
<TD width=19%>Required <SUP>(1)</SUP></TD>
</TR>

<TR VALIGN="top">
<TD width=47%><A HREF="pnp-irps_60vm.htm">IRP_MN_QUERY_ID</A> </TD>
<TD width=17%>&nbsp;</TD>
<TD width=17%>&nbsp;</TD>
<TD width=19%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=47%><B>&nbsp;&nbsp;&nbsp;&nbsp;BusQueryDeviceID</B></TD>
<TD width=17%>No</TD>
<TD width=17%>No</TD>
<TD width=19%>Required</TD>
</TR>

<TR VALIGN="top">
<TD width=47%><B>&nbsp;&nbsp;&nbsp;&nbsp;BusQueryHardwareIDs</B></TD>
<TD width=17%>No</TD>
<TD width=17%>No</TD>
<TD width=19%>Optional</TD>
</TR>

<TR VALIGN="top">
<TD width=47%><B>&nbsp;&nbsp;&nbsp;&nbsp;BusQueryCompatibleIDs</B></TD>
<TD width=17%>No</TD>
<TD width=17%>No</TD>
<TD width=19%>Optional</TD>
</TR>

<TR VALIGN="top">
<TD width=47%><B>&nbsp;&nbsp;&nbsp;&nbsp;BusQueryInstanceID</B></TD>
<TD width=17%>No</TD>
<TD width=17%>No</TD>
<TD width=19%>Optional</TD>
</TR>

<TR VALIGN="top">
<TD width=47%><A HREF="pnp-irps_5raq.htm">IRP_MN_QUERY_DEVICE_TEXT</A> </TD>
<TD width=17%>No</TD>
<TD width=17%>No</TD>
<TD width=19%>Required <SUP>(1)</SUP></TD>
</TR>

<TR VALIGN="top">
<TD width=47%><A HREF="pnp-irps_2i2a.htm">IRP_MN_QUERY_BUS_INFORMATION</A> </TD>
<TD width=17%>No</TD>
<TD width=17%>No</TD>
<TD width=19%>Required <SUP>(1)</SUP></TD>
</TR>

<TR VALIGN="top">
<TD width=47%><A HREF="pnp-irps_9k36.htm">IRP_MN_QUERY_INTERFACE</A> </TD>
<TD width=17%>Optional</TD>
<TD width=17%>Optional</TD>
<TD width=19%>Required <SUP>(1)</SUP></TD>
</TR>

<TR VALIGN="top">
<TD width=47%><A HREF="pnp-irps_9ipe.htm">IRP_MN_READ_CONFIG</A> </TD>
<TD width=17%>No</TD>
<TD width=17%>No</TD>
<TD width=19%>Required <SUP>(1)</SUP></TD>
</TR>

<TR VALIGN="top">
<TD width=47%><A HREF="pnp-irps_0rjm.htm">IRP_MN_WRITE_CONFIG</A> </TD>
<TD width=17%>No</TD>
<TD width=17%>No</TD>
<TD width=19%>Required <SUP>(1)</SUP></TD>
</TR>

<TR VALIGN="top">
<TD width=47%><A HREF="pnp-irps_7fxu.htm">IRP_MN_EJECT</A> </TD>
<TD width=17%>No</TD>
<TD width=17%>No</TD>
<TD width=19%>Required <SUP>(1)</SUP></TD>
</TR>

<TR VALIGN="top">
<TD width=47%><A HREF="pnp-irps_1ieq.htm">IRP_MN_SET_LOCK</A> </TD>
<TD width=17%>No</TD>
<TD width=17%>No</TD>
<TD width=19%>Required <SUP>(1)</SUP></TD>
</TR>

<TR VALIGN="top">
<TD colspan=4 width=100%>(1) Required or Optional in certain situations. See the reference page for the IRP for more details.
<P>(2) Bus filter drivers might handle a query for <B>BusRelations</B>.</P>
</TD>
</TR>
</TABLE><BR>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Plug%20and%20Play%20Minor%20IRPs"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
