<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>WMI Class Qualifiers</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="WMI Class Qualifiers">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Kernel-Mode&nbsp;Driver&nbsp;Architecture:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="ddk_wmi_class_qualifiers_kg"></A>WMI Class Qualifiers</H2>

<P>The following table lists the required and optional MOF class qualifiers that can be used to describe a driver's WMI data blocks and event blocks. </P>

<P>An <I>embedded class</I>, which is a class used solely as a data item in another class and not exposed as a WMI data block, requires only the <B>WMI</B> and <B>Guid</B> qualifiers. The other qualifiers are irrelevant to embedded classes and are ignored. For more information about embedded classes, see <A HREF="wmi_0753.htm">Driver-Defined WMI Data Items</A>.</P>

<P><B>Dynamic</B> and <B>Static</B> are standard MOF qualifiers. For information about other standard MOF qualifiers, see the Platform SDK<I>.</I></P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=20%>Qualifier</TH>
<TH align=left width=80%>Description</TH>
</TR>

<TR VALIGN="top">
<TD width=20%><B>Dynamic</B></TD>
<TD width=80%>Indicates that the data provider supplies instances of the data block at run time, rather than providing instances of static data in the MOF file. All data and event blocks that a driver registers with WMI must be defined with the <B>Dynamic</B> qualifier. </TD>
</TR>

<TR VALIGN="top">
<TD width=20%><B>Static</B></TD>
<TD width=80%>Indicates that the data provider supplies instances of static data in the MOF file, rather than supplying instances of the data block at run time. The class definition of such a static instance must also include the <B>InstanceOf</B> qualifier. A driver does not register static data blocks with WMI, because the static data resides in the WMI database. Classes marked as <B>Static</B> in the MOF file should not be registered by the driver's <A HREF="k901_4omq.htm">IRP_MN_REGINFO</A> or <A HREF="k901_9d4i.htm">IRP_MN_REGINFO_EX</A> handlers.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><B>Provider("WMIProv")</B></TD>
</TR>

<TR VALIGN="top">
<TD width=20%>&nbsp;</TD>
<TD width=80%>(Required) Indicates that the provider of the class is a WMI provider. </TD>
</TR>

<TR VALIGN="top">
<TD width=20%><B>WMI</B></TD>
<TD width=80%>(Required) Indicates that the class is a WMI class. </TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><B>Description("</B><I>description-string</I><B>")</B></TD>
</TR>

<TR VALIGN="top">
<TD width=20%>&nbsp;</TD>
<TD width=80%>(Optional) Specifies a description of the block for the locale specified by the <B>Locale</B> qualifier. If defined, WMI clients can display the description string to users. A driver writer can use <B>Description</B> to document a class.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><B>Guid("</B><I>guid-string</I><B>")</B></TD>
</TR>

<TR VALIGN="top">
<TD width=20%>&nbsp;</TD>
<TD width=80%>(Required) Specifies the GUID, in string format, that uniquely identifies the block to WMI. A driver writer should generate a GUID for each data block in the driver's MOF file, using either <I>guidgen.exe</I> or <I>uuidgen.exe</I>. A driver passes this value in GUID format to WMI when the driver registers its blocks. WMI then uses the GUID to look up the block's definition in the driver's MOF resource. </TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><B>Locale("MS\\</B><I>locale-identifier</I><B>")</B></TD>
</TR>

<TR VALIGN="top">
<TD width=20%>&nbsp;</TD>
<TD width=80%>(Optional) Specifies the language identifier and locale for the string specified by <B>Description</B>. For example, a <I>locale-identifier</I> of 0x409 specifies American English. A single MOF file can contain blocks with different locales, but typically all of the blocks in a MOF file have the same locale. </TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%><B>WmiExpense(</B><I>expense-value</I><B>)</B></TD>
</TR>

<TR VALIGN="top">
<TD width=20%>&nbsp;</TD>
<TD width=80%>(Optional) Specifies the average number of CPU cycles needed to collect data for the data block. For example, a WMI client might check a data block's <B>WmiExpense</B> value to determine how often to query for its data. If <B>WmiExpense</B> is omitted, <I>expense-value</I> is assumed to be 0. <B>WmiExpense</B> is unrelated to registering a data block as expensive to collect. </TD>
</TR>
</TABLE><BR>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: WMI%20Class%20Qualifiers"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
