<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>MOF Syntax for WMI Data and Event Blocks</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="MOF Syntax for WMI Data and Event Blocks">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Kernel-Mode&nbsp;Driver&nbsp;Architecture:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_mof_syntax_for_wmi_data_and_event_blocks_kg"></A>MOF Syntax for WMI Data and Event Blocks</H1>

<P>A driver's WMI schema describes its data blocks, which define the information that a driver can provide and the methods it can execute in response to WMI requests. A driver's schema also describes its event blocks, which are data blocks that the driver sends to WMI when a driver-determined event occurs for which a WMI client user has requested notification. </P>

<P>A driver writer defines a driver's schema in Managed Object Format (MOF). MOF is a compiled language created by the Desktop Management Task force (DMTF) and based on Interface Definition language (IDL). A driver's MOF file contains a MOF class definition for each data block and event block the driver exposes to WMI. </P>

<P>A MOF class definition for a WMI data block follows this syntax: </P>

<P><B>[</B> <I>Required and optional class qualifiers </I><B>]</B></P>

<P><B>class</B> <I>ClassName</I> : <I>OptionalBaseClass</I><BR>
<B>{<BR>
    [key, read]<BR>
    string InstanceName;<BR>
    [read] <BR>
    boolean Active;<BR>
<BR>
    [</B> <I>Required and optional property qualifiers </I><B>]</B><BR>
<B>    </B><I>datatype</I>   <I>itemname1</I><B>;<BR>
<BR>
    [</B> <I>Required and optional property qualifiers</I><B> ]</B><BR>
<B>    </B><I>datatype</I>   <I>itemnameN</I><B>;<BR>
};</B></P>

<P>The following topics describe the syntax elements shown above:</P>

<P class=indent1><A HREF="wmi_3uef.htm">WMI Class Qualifiers</A> </P>

<P class=indent1><A HREF="wmi_77dz.htm">WMI Class Names and Base Classes</A> </P>

<P class=indent1><A HREF="wmi_2947.htm">Required Items in WMI Classes</A> </P>

<P class=indent1><A HREF="wmi_01ev.htm">WMI Property Qualifiers</A> </P>

<P class=indent1><A HREF="wmi_0753.htm">Driver-defined WMI Data Items</A> </P>

<P class=indent1><A HREF="wmi_109z.htm">WMI Class Examples</A> </P>

<P>For a general discussion of MOF syntax as it pertains to WMI clients and other kinds of applications, see the Platform SDK. </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: MOF%20Syntax%20for%20WMI%20Data%20and%20Event%20Blocks"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
