<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>UPSWaitForStateChange</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="UPSWaitForStateChange">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Battery&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_upswaitforstatechange_kr"></A>UPSWaitForStateChange</H1>

<P>The <B>UPSWaitForStateChange</B> function waits until a specified UPS state changes, or until a time-out interval elapses.</P>

<PRE class=syntax><B>void
  UPSWaitForStateChange(
    DWORD  </B><I>aCurrentState</I><B>,</B>
<B>    DWORD  </B><I>anInterval</I>
<B>    );</B></PRE>

<H4>Parameters</H4>

<DL>
<DT><I>aCurrentState</I></DT>

<DD>Specifies the UPS state on which to wait. When the state of the UPS system changes from the specified state to any other state, the function returns. The specified value can be one of the following:

<DL>
<DT>UPS_ONLINE </DT>

<DD>Utility-supplied power is normal.</DD>

<DT>UPS_ONBATTERY</DT>

<DD>Utility-supplied power is inadequate, and the UPS batteries are discharging.</DD>

<DT>UPS_LOWBATTERY</DT>

<DD>Utility-supplied power is inadequate, and the UPS batteries are critically low.</DD>

<DT>UPS_NOCOMM</DT>

<DD>Communication with the UPS is not currently established.</DD>
</DL>
</DD>

<DT><I>anInterval</I></DT>

<DD>Specifies a time-out interval, in milliseconds, for the function. If the UPS state has not changed from the specified state when the interval elapses, the function returns. A value of INFINITE means the interval never elapses.</DD>
</DL>

<H4>Return Value</H4>

<P>None</P>

<H4>Headers</H4>

<P>Declared in <I>upssvc.h</I>. Include <I>upssvc.h</I>.</P>

<H4>Comments</H4>

<P>The <B>UPSWaitForStateChange</B> function must wait until either the state of the UPS changes from the value specified by <I>aCurrentState</I>, or until the time specified by <I>aTimeout</I> has elapsed, whichever occurs first. </P>

<P>A call to <A HREF="ups_fns_2n8y.htm"><B>UPSCancelWait</B></A> interrupts <B>UPSWaitForStateChange</B> and causes it to return. </P>

<H4>See Also</H4>

<P><A HREF="ups_fns_2n8y.htm"><B>UPSCancelWait</B></A><B> </B></P>

<P></P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: UPSWaitForStateChange"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
