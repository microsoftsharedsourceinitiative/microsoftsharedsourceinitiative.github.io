<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Writing UPS Minidrivers</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Writing UPS Minidrivers">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Battery&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_writing_ups_minidrivers_kg"></A>Writing UPS Minidrivers</H1>

<P>If an uninterruptible power supply (UPS) is connected to a Windows&nbsp;2000 or later system, the <B>UPS</B> tab for <B>Power Options</B> in Control Panel provides information about the UPS. A system-supplied UPS service provides support for UPS units that are connected to COM ports and that support "simple signaling," which provides very limited control capabilities and status information. </P>

<P>If your UPS model supports "smart signaling," which provides enhanced control capabilities and status information, you should provide a UPS minidriver. This minidriver, which is a user-mode DLL called by the system's UPS service, has the following responsibilities:

<UL>
	<LI>Initializing the communication path to the UPS.</LI>

	<LI>Updating registry entries that <B>Power Options</B> uses to obtain model-specific information to display.</LI>

	<LI>Turning off the UPS power upon request.</LI>

	<LI>Monitoring the UPS unit for state changes.</LI>
</UL>

<P>This section provides the following topics:</P>

<P class=indent1><A HREF="ups_mini_0giv.htm">UPS Minidriver Functionality</A> </P>

<P class=indent1><A HREF="ups_mini_04h3.htm">UPS Registry Entries</A> </P>

<P class=indent1><A HREF="ups_mini_5y93.htm">Sample UPS Minidriver</A> </P>

<P class=indent1><A HREF="ups_mini_65uv.htm">Installing UPS Minidrivers</A> </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Writing%20UPS%20Minidrivers"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
