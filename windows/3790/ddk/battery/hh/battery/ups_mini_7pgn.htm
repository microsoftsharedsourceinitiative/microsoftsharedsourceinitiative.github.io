<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>UPS\ServiceProviders Registry Entries</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="UPS\ServiceProviders Registry Entries">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Battery&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="ddk_ups_serviceproviders_registry_entries_kg"></A>UPS\ServiceProviders Registry Entries</H3>

<P>Under the <B>UPS\ServiceProviders</B> registry key, a UPS vendor should create a vendor-specific subkey. Under this subkey, the vendor should create an entry for each UPS model. Vendors must create these registry entries while <A HREF="ups_mini_65uv.htm">installing UPS minidrivers</A>.</P>

<P>Each model-specific entry consists of a value name and a value. The value name should be the name of the UPS model. The value associated with this name is a string consisting of two parts:

<UL>
	<LI>The first part of the value string represents a hexadecimal bit mask identifying the model's capabilities. Bit values are defined in the following table.
<TABLE>

<TR VALIGN="top">
<TH align=left width=29%>Bit Value</TH>
<TH align=left width=71%>Description</TH>
</TR>

<TR VALIGN="top">
<TD width=29%>0x00000001</TD>
<TD width=71%>The UPS is installed.</TD>
</TR>

<TR VALIGN="top">
<TD width=29%>0x00000002</TD>
<TD width=71%>The UPS supports power failure notification.</TD>
</TR>

<TR VALIGN="top">
<TD width=29%>0x00000004</TD>
<TD width=71%>The UPS supports notification of low battery power.</TD>
</TR>

<TR VALIGN="top">
<TD width=29%>0x00000008</TD>
<TD width=71%>The UPS can be turned off using the serial port.</TD>
</TR>

<TR VALIGN="top">
<TD width=29%>0x00000010</TD>
<TD width=71%>Power failure notification is indicated by a positive signal.</TD>
</TR>

<TR VALIGN="top">
<TD width=29%>0x00000020</TD>
<TD width=71%>Low battery notification is indicated by a positive signal.</TD>
</TR>

<TR VALIGN="top">
<TD width=29%>0x00000040</TD>
<TD width=71%>The UPS is turned off by a positive signal.</TD>
</TR>

<TR VALIGN="top">
<TD width=29%>0x00000080</TD>
<TD width=71%>Reserved. Do not use.</TD>
</TR>
</TABLE><BR>
</LI>

	<LI>The second part of the string is optional. It represents the path and name of the UPS minidriver. If this path and name is supplied, it must be preceded by a semicolon (;). If only the name is supplied, a default path of <B>%SystemRoot%\system32</B> is used.</LI>
</UL>

<P>After a UPS minidriver has been installed, and after a system administrator has enabled the UPS using <B>Power Options</B>, the system's UPS service copies model-specific <B>UPS\ServiceProviders</B> values to other, system-controlled registry locations.</P>

<P>Following is an example of one vendor subkey, with value names and values for two UPS models, under <B>UPS\ServiceProviders</B>: </P>

<P class=indent1><B>UPS\ServiceProviders</B></P>

<P class=indent1><B>&nbsp;&nbsp;&nbsp;&nbsp;American Power Conversion</B></P>

<P class=indent1><B>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Back-UPS "0x7f"</B></P>

<P class=indent1><B>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Smart-UPS "0x1;apcups.dll"</B></P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: UPS%5CServiceProviders%20Registry%20Entries"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
