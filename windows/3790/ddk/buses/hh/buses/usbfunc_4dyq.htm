<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>USBD_ParseConfigurationDescriptorEx</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="USBD_ParseConfigurationDescriptorEx">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>System&nbsp;Support&nbsp;for&nbsp;Buses:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_usbd_parseconfigurationdescriptorex_kr"></A>USBD_ParseConfigurationDescriptorEx</H1>

<P><B>USBD_ParseConfigurationDescriptorEx</B> searches a given configuration descriptor and returns a pointer to an interface that matches the given search criteria.</P>

<PRE class=syntax><B>PUSB_INTERFACE_DESCRIPTOR
</B>  <B>USBD_ParseConfigurationDescriptorEx(</B>
    <B>IN PUSB_CONFIGURATION_DESCRIPTOR  </B><I>ConfigurationDescriptor</I><B>,</B>
    <B>IN PVOID  </B><I>StartPosition</I><B>,</B>
    <B>IN LONG  </B><I>InterfaceNumber</I><B>,</B>
    <B>IN LONG  </B><I>AlternateSetting</I><B>,</B>
    <B>IN LONG  </B><I>InterfaceClass</I><B>,</B>
    <B>IN LONG  </B><I>InterfaceSubClass</I><B>,</B>
    <B>IN LONG  </B><I>InterfaceProtocol</I>
    <B>);</B></PRE>

<H4>Parameters</H4>

<DL>
<DT><I>ConfigurationDescriptor</I></DT>

<DD>Pointer to a USB configuration descriptor that contains the interface for which to search.</DD>

<DT><I>StartPosition</I></DT>

<DD>Pointer to the address within the configuration descriptor, provided at <I>ConfigurationDescriptor,</I> to begin searching from. To search from the beginning of the configuration descriptor, the parameters <I>ConfigurationDescriptor </I>and <I>StartPosition</I> must be the same address.</DD>

<DT><I>InterfaceNumber</I></DT>

<DD>Specifies the device-defined index of the interface to be retrieved. This should be set to -1 if it should not be a search criterion.</DD>

<DT><I>AlternateSetting</I></DT>

<DD>Specifies the device-defined alternate-setting index of the interface to be retrieved. If the caller does not wish the alternate setting value to be a search criterion, this parameter should be set to -1.</DD>

<DT><I>InterfaceClass</I></DT>

<DD>Specifies the device- or USB-defined identifier for the interface class of the interface to be retrieved. If the caller does not wish the interface class value to be a search criterion, this parameter should be set to -1.</DD>

<DT><I>InterfaceSubClass</I></DT>

<DD>Specifies the device- or USB-defined identifier for the interface subclass of the interface to be retrieved. If the caller does not wish the interface subclass value to be a search criterion, this parameter should be set to -1.</DD>

<DT><I>InterfaceProtocol</I></DT>

<DD>Specifies the device- or USB-defined identifier for the interface protocol of the interface to be retrieved. If the caller does not wish the interface protocol value to be a search criterion, this parameter should be set to -1.
</DD>
</DL>

<H4>Return Value</H4>

<P><B>USBD_ParseConfigurationDescriptorEx</B> returns a pointer to the first interface descriptor that matches the given search criteria. If no interface matches the search criteria, it returns NULL.</P>

<H4>Headers</H4>

<P>Declared in <I>usbdlib.h</I>. Include <I>usbdlib.h</I>.</P>

<H4>Comments</H4>

<P>Callers can specify more than one of the search criteria (<I>InterfaceNumber, AlternateSetting, InterfaceClass, InterfaceSubClass, </I>and <I>InterfaceProtocol) </I>when using this routine to find an interface within a configuration descriptor.</P>

<P>When this routine parses the configuration descriptor looking for the interface descriptor that matches the search criteria, it returns the first match, terminating the search. Callers should specify as many search criteria as are necessary to find the desired interface.</P>

<P>Callers of this routine must be running at IRQL &lt; DISPATCH_LEVEL.</P>

<H4>See Also</H4>

<P><A HREF="usbstrct_3iuq.htm">USB_CONFIGURATION_DESCRIPTOR</A> </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: USBD_ParseConfigurationDescriptorEx"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
