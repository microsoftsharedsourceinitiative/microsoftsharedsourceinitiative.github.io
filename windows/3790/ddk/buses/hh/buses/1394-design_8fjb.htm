<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Sample IEEE 1394 Device Drivers</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Sample IEEE 1394 Device Drivers">
</HEAD>
<BODY TOPMARGIN="0">
<DIV STYLE="display:none;">
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_supp_1394api_dll">
</OBJECT>
</DIV>


<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>System&nbsp;Support&nbsp;for&nbsp;Buses:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_sample_ieee_1394_device_drivers_kg"></A>Sample IEEE 1394 Device Drivers</H1>

<P>The Microsoft® Windows® DDK includes <I>1394diag.sys,</I> a sample 1394 client driver. The source code for the sample driver is located in the <I>\src\wdm </I>directory of the Windows DDK. </P>

<P>The sample illustrates how a client driver interacts with the upper edge of the IEEE 1394 stack by performing operations such as:

<UL>
	<LI>Making asynchronous and isochronous data transfers</LI>

	<LI>Handling Plug and Play I/O request packets (IRPs)</LI>

	<LI>Handling power management IRPs</LI>
</UL>

<P>The sample driver collects diagnostic data from 1394 devices.</P>

<P>Note that in Windows XP and later operating systems the 1394 bus driver checks the <B>RequestorMode</B> member of every IRP it receives and disallows IRPs generated in user mode. Therefore, the version of <I>1394diag.sys</I> shipped with the Windows 2000 DDK does not work in Windows XP. The Windows XP version of <I>1394diag.sys </I>has been modified so that it does not pass user mode IRPs down to the 1394 bus driver. </P>

<P>Likewise, the version of <I>1394diag.sys</I> shipped with the Windows XP DDK does not work in Windows 2000 because the XP sample requires virtual 1394 device support, and Windows 2000 does not support virtual devices. For more information on virtual devices in Windows XP, see the reference page for <A HREF="1394irp_06ya.htm">IOCTL_IEEE1394_API_REQUEST</A>.</P>

<P>The Windows DDK also provides source code for the <I>1394api.dll</I> application. See <A HREF="JavaScript:hhobj_1.Click()">1394API.DLL</A> for an explanation of how to use this application. The source code for <I>1394api.dll </I>illustrates how to access the 1394 DDI from a user-mode application. User-mode applications can gain access to the 1394 DDI by linking to <I>1394api.dll</I>. The <I>1394api.dll</I> application also provides mechanisms for implementing loopback routines on both asynchronous and isochronous data.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Sample%20IEEE%201394%20Device%20Drivers"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
