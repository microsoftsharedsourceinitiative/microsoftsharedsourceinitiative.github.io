<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>STROBJ</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="STROBJ">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Display&nbsp;and&nbsp;Print&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_strobj_gg"></A>STROBJ</H1>

<P>The STROBJ class, or text string object, contains an enumeration of glyph handles and positions for the device driver.</P>

<PRE class=syntax>class _STROBJ {
  ULONG  cGlyphs;
  FLONG  flAccel;
  ULONG  ulCharInc;
  RECTL  rclBkGround;
  GLYPHPOS  *pgp;
  LPWSTR  pwszOrg;
} STROBJ;</PRE>

<H4>Members</H4>

<DL>
<DT><B>cGlyphs</B></DT>

<DD>Specifies the number of glyphs in the STROBJ.</DD>

<DT><B>flAccel</B></DT>

<DD>Accelerator flags. This member can be any of the following values:

<TABLE>

<TR VALIGN="top">
<TH align=left width=16%>Flag</TH>
<TH align=left width=84%>Meaning</TH>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%>SO_BREAK_EXTRA</TD>
</TR>

<TR VALIGN="top">
<TD width=16%>&nbsp;</TD>
<TD width=84%>Fixed-width spacing is added to every break character.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%>SO_CHARACTER_EXTRA</TD>
</TR>

<TR VALIGN="top">
<TD width=16%>&nbsp;</TD>
<TD width=84%>Fixed-width spacing is added between each pair of consecutive glyphs. </TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%>SO_CHAR_INC_EQUAL_BM_BASE</TD>
</TR>

<TR VALIGN="top">
<TD width=16%>&nbsp;</TD>
<TD width=84%>Spacing is determined by bitmap sizes. In this context, bitmap base is defined as cx for horizontal case, cy for vertical case. This bit is set means that every glyph in a font the bitmap (supplied in GLYPHBITS structure by GDI) will have a base equal to the advance width for that glyph. This does not mean that this is a fixed pitch font. (Not used for PATHOBJs.)</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%>SO_DO_NOT_SUBSTITUTE_DEVICE_FONT</TD>
</TR>

<TR VALIGN="top">
<TD width=16%>&nbsp;</TD>
<TD width=84%>A printer driver should not substitute one of its printer fonts for GDI's font choice.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%>SO_DXDY</TD>
</TR>

<TR VALIGN="top">
<TD width=16%>&nbsp;</TD>
<TD width=84%>Glyphs are to be rendered at random positions.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%>SO_ESC_NOT_ORIENT</TD>
</TR>

<TR VALIGN="top">
<TD width=16%>&nbsp;</TD>
<TD width=84%>A glyph's orientation is different from the escapement direction. Escapement is the angle the text direction makes with the horizontal. Orientation is the angle between the glyph's baseline and the escapement direction.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%>SO_FLAG_DEFAULT_PLACEMENT</TD>
</TR>

<TR VALIGN="top">
<TD width=16%>&nbsp;</TD>
<TD width=84%>Default increment vectors are used to position the characters.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%>SO_GLYPHINDEX_TEXTOUT</TD>
</TR>

<TR VALIGN="top">
<TD width=16%>&nbsp;</TD>
<TD width=84%><B>pwszOrg</B> points to an array of glyph indexes, rather than a Unicode array.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%>SO_HORIZONTAL</TD>
</TR>

<TR VALIGN="top">
<TD width=16%>&nbsp;</TD>
<TD width=84%>Text is horizontal; left-to-right or right-to-left, depending on SO_REVERSED. The y&nbsp;coordinate is only supplied for the first glyph in the string.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%>SO_MAXEXT_EQUAL_BM_SIDE</TD>
</TR>

<TR VALIGN="top">
<TD width=16%>&nbsp;</TD>
<TD width=84%>Bitmaps have the same widths. In this context, bitmap side is defined as cy for horizontal case and cx for vertical case. This flag guarantees that all glyphs in the font will have the same side equal to the sum of ascender and descender. However, this bit indicates more than just a constant side. For horizontal case, this bit also indicates that the vertical distance between the top of the glyph's bitmap and its character origin is equal to the ascender for all glyphs. For vertical case, this bit indicates that the horizontal distance between the glyph's origin and "top" of the glyph's bitmap (which is really right or left, depending on whether you are writing in the direction of positive or negative y axis) is equal to the ascender. In either case, the tops and bottoms of all glyph bitmaps lay on the same line in the direction of writing. (Not used for PATHOBJs.)</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%>SO_REVERSED</TD>
</TR>

<TR VALIGN="top">
<TD width=16%>&nbsp;</TD>
<TD width=84%>Set if horizontal is right-to-left or vertical is bottom-to-top.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%>SO_VERTICAL</TD>
</TR>

<TR VALIGN="top">
<TD width=16%>&nbsp;</TD>
<TD width=84%>Text is vertical; top-to-bottom or bottom-to-top, depending on SO_REVERSED. The x&nbsp;coordinate is only supplied for the first glyph in the string.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%>SO_ZERO_BEARINGS</TD>
</TR>

<TR VALIGN="top">
<TD width=16%>&nbsp;</TD>
<TD width=84%>All glyphs have zero A and zero C spacing. This bit guarantees that glyph's black boxes do not overlap.</TD>
</TR>
</TABLE><BR>

</DD>

<DT><B>ulCharInc</B></DT>

<DD>Specifies whether the font is a fixed-pitch (monospace) font. If it is, this member is equal to the advance width of glyphs in pels; otherwise, it is zero. When this member is nonzero, GDI supplies a valid coordinate for only the first character in the string. All other character positions must be generated by the driver by successively adding the value of this member along the writing direction.</DD>

<DT><B>rclBkGround</B></DT>

<DD>Specifies a <A HREF="grstrcts_2wpz.htm">RECTL</A> structure that describes the bounding box for the string.</DD>

<DT><B>pgp</B></DT>

<DD>Pointer to the <A HREF="grstrcts_010n.htm">GLYPHPOS</A> array for the whole string. Can be NULL (see the following <B>Comments</B> section).</DD>

<DT><B>pwszOrg</B></DT>

<DD>Pointer to the original Unicode string or <B>cGlyphs</B> characters. Contrary to its name, this string is not usually zero-terminated. Also, this string is not always valid, such as in journalling with printer fonts, in which case this parameter will be NULL.
</DD>
</DL>

<H4>Headers</H4>

<P>Declared in <I>winddi.h</I>. Include <I>winddi.h</I>.</P>

<H4>Comments</H4>

<P>A driver can call <A HREF="gdifncs_32uf.htm"><B>STROBJ_vEnumStart</B></A> and <A HREF="gdifncs_65uv.htm"><B>STROBJ_bEnum</B></A> to obtain identities and positions of glyphs in the string. If <I>pgp</I> is not NULL, it points to a GLYPHPOS array describing the whole string and only a single call to <B>STROBJ_bEnum</B> is required. If <I>pgp</I> is NULL, <B>STROBJ_bEnum</B> will have to be called repeatedly in a loop to obtain all the string's glyph positions.</P>

<H4>See Also</H4>

<P><A HREF="ddifncs_1hrb.htm"><I>DrvGetGlyphMode</I></A>, <A HREF="ddifncs_4kkn.htm"><I>DrvTextOut</I></A> </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: STROBJ"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
