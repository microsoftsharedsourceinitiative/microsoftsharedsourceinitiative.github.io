<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Dynamically Generated Printer Commands</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Dynamically Generated Printer Commands">
</HEAD>
<BODY TOPMARGIN="0">
<DIV STYLE="display:none;">
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_gpd_gg_gly">
</OBJECT>
</DIV>


<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Display&nbsp;and&nbsp;Print&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="ddk_dynamically_generated_printer_commands_gg"></A>Dynamically Generated Printer Commands</H3>

<P>Each time you specify a <A HREF="nt5gpd_7cpz.htm">printer command</A> in a <A HREF="JavaScript:hhobj_1.Click()">generic printer description (GPD)</A> file for a Unidrv minidriver, you can use one of two methods:

<UL>
	<LI>Place the command string in the GPD file.
<P>When you place the command string in a GPD file, Unidrv sends the command to the print spooler at appropriate times. These command strings can include standard variables, which Unidrv evaluates before sending the command.
</LI>

	<LI>Provide a callback function.
<P>If you provide a callback function, Unidrv calls the function when it is time to send the command, and the function is responsible for sending the command to the print spooler. This enables you to include code that dynamically generates a command string and then sends it to the printer.
</LI>
</UL>

<P>To place a command string in a GPD file, you need to include a <A HREF="nt5gpd_557r.htm#ddk__cmd_gg">*<B>Cmd</B></A> attribute within the command's <A HREF="nt5gpd_7civ.htm#ddk__command_gg">*<B>Command</B></A> entry.</P>

<P>To provide code that dynamically generates a command string, you must do the following:

<UL>
	<LI>Provide a rendering plug-in that implements the <A HREF="drvrfnc_4bs7.htm"><B>IPrintOemUni::CommandCallback</B></A> method.</LI>

	<LI>Include a <A HREF="nt5gpd_557r.htm#ddk__callbackid_gg">*<B>CallbackID</B></A> command attribute and, optionally, a <A HREF="nt5gpd_557r.htm#ddk__params_gg">*<B>Params</B></A> attribute, within the command's *<B>Command</B> entry in the GPD file. </LI>
</UL>

<P>When Unidrv is ready to issue a printer command, it checks the minidriver database to determine if the command has been specified with a <A HREF="nt5gpd_557r.htm#ddk__cmd_gg">*<B>Cmd</B></A> attribute or with a <A HREF="nt5gpd_557r.htm#ddk__callbackid_gg">*<B>CallbackID</B></A> attribute. In the former case, Unidrv sends the command string to the print spooler. In the latter case, Unidrv calls the <B>IPrintOemUni::CommandCallback</B> method, passing the *<B>CallbackID</B> and *<B>Params</B> values as input arguments.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Dynamically%20Generated%20Printer%20Commands"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
