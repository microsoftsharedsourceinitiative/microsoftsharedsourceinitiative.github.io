<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Texture Coordinate Transformations</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Texture Coordinate Transformations">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Display&nbsp;and&nbsp;Print&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H3><A NAME="ddk_texture_coordinate_transformations_gg"></A>Texture Coordinate Transformations</H3>

<P>Texture coordinate transformations are enabled for the latest Direct X release.</P>

<P>Texture transforms are vertex-level transformation operations. These operations can be performed by any transform and lighting-enabled HAL driver and by any HAL device type. </P>

<P>Texture transforms are enabled by defining 4X4 matrices associated with each texture stage. All of the key state and data structures used by the software implementation of the geometry pipeline are available at the DDI level.</P>

<P>Using texture transformations, texture coordinates can be moved, relative to the vertices they are being drawn from. The texture transform describes how the texture coordinates are moved inside the texture map. Every time a texture transform is applied, the matrix changes the coordinates of the texture. The standard world matrix is used in these transformations.  </P>

<P>At the API level, the <B>IDirect3DDevice7::SetTransform</B> method (described in the Direct3D SDK documentation) defines the texture transform matrix associated with the texture currently bound to the <I>i</I><B>-</B><I>th</I> texture stage. This matrix should be applied to the texture coordinates of that texture during rendering. Note that the same vertex-level texture coordinate set can be used at different stages with a separate texture transform matrix that may apply different textures.  </P>

<P>The operation of the texture transform is controlled by the <B>IDirect3DDevice7::SetTextureStageState</B> method (described in the Direct3D SDK documentation) using the D3DTSS_TEXTURETRANSFORMFLAGS flag. </P>

<P>The D3DTEXTURETRANSFORMFLAGS enumerated type, described in the DirectX SDK documentation, is used to control the dimension of the texture coordinate set that is generated by the texture coordinate transformation operation, and to control whether any perspective division should be applied to it.  </P>

<P>D3DTTFF_DISABLE indicates that the texture coordinates are passed directly to the hardware.  </P>

<P>The number of the D3DTTFF_COUNT<I>n</I> flag signals how many texture coordinates are going to be present. Note that this does not necessarily equate to the dimension of the textures themselves, if projected textures are used.</P>

<P>If projected textures are used, the D3DTTFF_PROJECTED flag is set to indicate that the texture coordinates are to be divided by the last (COUNT<I>th</I>) element of the texture coordinate set. Thus, for a 2D projected texture, the count is three, because the first two elements are divided by the third, resulting in two floats for a 2D texture lookup. That is, both D3DTTFF_COUNT2 and D3DTTFF_COUNT3 | D3DTTFF_PROJECTED refer to a 2D texture. </P>

<P>For nonprojected textures:

<UL>
	<LI>D3DTTFF_COUNT1 indicates that the rasterizer should expect 1D texture coordinates. </LI>

	<LI>D3DTTFF_COUNT2 indicates that the rasterizer should expect 2D texture coordinates. </LI>

	<LI>D3DTTFF_COUNT3 indicates that the rasterizer should expect 3D texture coordinates. </LI>

	<LI>D3DTTFF_COUNT4 indicates the rasterizer should expect 4D texture coordinates.</LI>
</UL>

<P>The first byte encodes a count of texture coordinates expected to be used by the texture at a particular stage. Setting this to zero causes no texture transformation to be applied even if one was defined by the <B>IDirect3DDevice7::SetTransform</B> method. This is the number that is output from the texture coordinate transform stage.</P>

<P>The number of texture coordinates passed into the texture transform is defined by the Direct3D API <A HREF="d3d_449z.htm">FVF</A> code.</P>

<P>D3DTSS_TEXTURETRANSFORMFLAGS defaults to D3DTFF_DISABLED with no D3DTTFF_PROJECTED flag set. The texture transform matrices default to 4X4 identity matrices.</P>

<P>On nontransform-and-lighting HAL devices (that is, those that require transformation operations on the host processor), the output vertices are provided to the driver with the appropriate DDI-level FVF code that may differ from the one specified at the API level. Devices that do not support hardware-accelerated transform and lighting may still do projected textures, and therefore the drivers must still respond to the D3DTSS_TEXTURETRANSFORMFLAGS.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Texture%20Coordinate%20Transformations"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
