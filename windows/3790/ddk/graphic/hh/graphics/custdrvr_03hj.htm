<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Interface Identifiers for Printer Drivers</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Interface Identifiers for Printer Drivers">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Display&nbsp;and&nbsp;Print&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="ddk_interface_identifiers_for_printer_drivers_gg"></A>Interface Identifiers for Printer Drivers</H2>

<P>A set of GUIDs is defined in <I>prcomoem.h</I>. Each of these GUIDs is an interface identifier for one of the COM interfaces used for communication between the printer drivers (Unidrv and Pscript5) and plug-ins.</P>

<P>For Windows®&nbsp;2000 and Windows®&nbsp;XP, the following GUIDs are defined: </P>

<P><B>IID_IPrintOemUI<BR>
IID_IPrintOemUI2</B> (Pscript5 UI plug-ins on Windows XP and later)<B><BR>
IID_IPrintOemDriverUI<BR>
IID_IPrintCoreUI2</B> (Pscript5 UI plug-ins on Windows XP and later)<BR>
<B>IID_IPrintOemUni<BR>
IID_IPrintOemUni2</B> (Unidrv render plug-ins on Windows XP and later)<B><BR>
IID_IPrintOemDriverUni<BR>
IID_IPrintOemPS<BR>
IID_IPrintOemPS2</B> (Pscript5 render plug-ins on Windows XP and later)<B><BR>
IID_IPrintOemDriverPS<BR>
IID_IPrintCorePS2</B> (Pscript5 render plug-ins on Windows XP and later)</P>

<P>Each GUID identifies one version of one interface. If a new version of an interface is defined, a new GUID will be added to the list.</P>

<P>User interface plug-ins and rendering plug-ins must identify the interface versions they support. The printer driver (Unidrv or Pscript5) calls a plug-in's <B>IUnknown::QueryInterface</B> method (described in the Platform SDK documentation), specifying an interface identifier as input. If the plug-in supports the specified version, the method must return a pointer to the interface along with a return status of S_OK. Otherwise, it must return E_NOINTERFACE. The driver starts with the interface identifier for the most recent version and continues to call <B>QueryInterface</B> with earlier version identifiers until the method returns S_OK or the driver exhausts the list of version identifiers.</P>

<P>Likewise, Unidrv and Pscript5 provide <B>IUnknown::QueryInterface</B> methods for the <A HREF="custdrvr_0srr.htm"><B>IPrintOemDriverUI</B></A>, <A HREF="custdrvr_6uuf.htm"><B>IPrintCoreUI2</B></A>, <A HREF="custdrvr_69bb.htm"><B>IPrintOemDriverUni</B></A>, <A HREF="custdrvr_8ecn.htm"><B>IPrintOemDriverPS</B></A>, or <A HREF="custdrvr_37zb.htm"><B>IPrintCorePS2</B></A> COM interfaces. Plug-ins should call the appropriate interface's <B>QueryInterface</B> method to determine the driver's supported interface version and to receive an interface pointer.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Interface%20Identifiers%20for%20Printer%20Drivers"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
