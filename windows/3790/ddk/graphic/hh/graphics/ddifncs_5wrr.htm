<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>DrvQueryTrueTypeOutline</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="DrvQueryTrueTypeOutline">
</HEAD>
<BODY TOPMARGIN="0">
<DIV STYLE="display:none;">
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink,MENU">
	<PARAM NAME="DefaultTopic" VALUE="../notopic_0pk4.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="ddk_pdev_gg_gly">
</OBJECT>
</DIV>


<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Display&nbsp;and&nbsp;Print&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_drvquerytruetypeoutline_gg"></A><I>DrvQueryTrueTypeOutline</I></H1>

<P>The <I>DrvQueryTrueTypeOutline</I> function retrieves glyph outlines in native TrueType format.</P>

<PRE class=syntax><B>LONG
  </B><I>DrvQueryTrueTypeOutline</I><B>(</B>
    <B>IN DHPDEV</B>  <I>dhpdev</I><B>,</B>
    <B>IN FONTOBJ</B>  <I>*pfo</I><B>,</B>
    <B>IN HGLYPH</B>  <I>hglyph</I><B>,</B>
    <B>IN BOOL</B>  <I>bMetricsOnly</I><B>,</B>
    <B>IN GLYPHDATA</B>  <I>*pgldt</I><B>,</B>
    <B>IN ULONG</B>  <I>cjBuf</I><B>,</B>
    <B>OUT TTPOLYGONHEADER</B>  <I>*ppoly</I>
<B>    );</B></PRE>

<H4>Parameters</H4>

<DL>
<DT><I>dhpdev</I></DT>

<DD>Handle to a physical device's <A HREF="JavaScript:hhobj_1.Click()">PDEV</A> structure returned from a call to <A HREF="ddifncs_0zzb.htm"><I>DrvEnablePDEV</I></A>.</DD>

<DT><I>pfo</I></DT>

<DD>Pointer to a <A HREF="grstrcts_3w9z.htm">FONTOBJ</A> structure. Details of the font realization can be queried from this structure.</DD>

<DT><I>hglyph</I></DT>

<DD>Handle to the glyph for which the outline is being queried.</DD>

<DT><I>bMetricsOnly</I></DT>

<DD>Specifies that font metrics (only) should be returned, or that TrueType outlines should be returned in cubic Bezier format, or that the TrueType outlines should be returned unhinted. This value can be one of the following:

<TABLE>

<TR VALIGN="top">
<TH align=left width=48%>Flag</TH>
<TH align=left width=52%>Meaning</TH>
</TR>

<TR VALIGN="top">
<TD width=48%>TTO_METRICS_ONLY</TD>
<TD width=52%>Only font metrics are to be returned. Font data (either outlines or bitmaps) will not be returned.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>TTO_QUBICS</TD>
<TD width=52%>Outlines are to be returned in cubic Bezier format.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>TTO_UNHINTED</TD>
<TD width=52%>Outlines are to be returned unhinted.</TD>
</TR>
</TABLE><BR>

</DD>

<DT><I>pgldt</I></DT>

<DD>Pointer to the buffer where the <A HREF="grstrcts_37on.htm">GLYPHDATA</A> structure for this glyph should be written. If <I>pgldt</I> is NULL, no data is written to the GLYPHDATA structure.</DD>

<DT><I>cjBuf</I></DT>

<DD>Specifies the size, in bytes, of the buffer that receives the TrueType outline.</DD>

<DT><I>ppoly</I></DT>

<DD>Pointer to the buffer where the TrueType outline should be written. The format of the data is in native TrueType format, stored in a TTPOLYGONHEADER structure. See the Platform SDK documentation for more information about the TTPOLYGONHEADER structure.
</DD>
</DL>

<H4>Return Value</H4>

<P>The return value is the size, in bytes, required for the <I>ppoly</I> buffer if <I>pgldt</I> is NULL. If <I>pgldt</I> is not NULL, the return value is the number of bytes copied into the <I>ppoly</I> buffer. If an error occurs, the return value is FD_ERROR.</P>

<H4>Headers</H4>

<P>Declared in <I>winddi.h</I>. Include <I>winddi.h</I>.</P>

<H4>Comments</H4>

<P><I>DrvQueryTrueTypeOutline</I> is required for TrueType font drivers.</P>

<H4>See Also</H4>

<P><A HREF="ddifncs_0zzb.htm"><I>DrvEnablePDEV</I></A>, <A HREF="grstrcts_3w9z.htm">FONTOBJ</A> </P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: DrvQueryTrueTypeOutline"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
