<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Windows XP Visual Style</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Windows XP Visual Style">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Display&nbsp;and&nbsp;Print&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_windows_xp_visual_style_gg"></A>Windows XP Visual Style</H1>

<P>The visual style in Windows&nbsp;XP is the result of changes in the Shell Common Controls (<I>comctl32.dll</I>, version 6.0). This version is almost fully backward compatible with version 5.0. However, some problems can occur with drivers that were written for version 5.0 that are running under version 6.0. To avoid such problems, the print system does not force drivers to use <I>comctl32.dll</I> version 6.0. If you add a manifest to your driver, you can ensure that user interface elements in your driver match the Windows&nbsp;XP visual style. For a sample manifest, see <I>src\print\oemdll\ThemeUI\ThemeUI.Manifest</I> in this DDK.</P>

<P>If you add a manifest to your driver that specifies dependency on version 6 of <I>comctl32.dll</I>, it will work properly on Windows&nbsp;XP and later operating system versions, as well as on Windows&nbsp;2000. Windows&nbsp;2000 ignores the manifest; therefore any use of the activation context fails gracefully. Note that because <I>comctl32.dll</I> version 5.0 is not contained in the <I>global assembly cache</I> (GAC), a manifest that specifies a dependency on this version of the DLL breaks the component. In this case, the call to the Win32 API <B>LoadLibrary</B> fails while trying to load comctl32.dll.  </P>

<P>An application can have a global (or application) manifest. If this global manifest contains a redirection to use <I>comctl32.dll</I> version 6.0, this forces all of the UI that the application creates to use the same theme. One result of this is that printer drivers launched from an application with a global manifest might be forced to use <I>comctl32.dll</I> version 6.0, regardless of any <I>comctl32.dll</I> redirection in the driver manifest. </P>

<P>For more information about manifests and assemblies, activation contexts, isolated applications and side-by-side assembly sharing, see the Platform SDK documentation.</P>

<P></P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Windows%20XP%20Visual%20Style"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
