<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>CPSFUNC_SET_FUSION_CONTEXT</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="CPSFUNC_SET_FUSION_CONTEXT">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Display&nbsp;and&nbsp;Print&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_cpsfunc_set_fusion_context_gg"></A>CPSFUNC_SET_FUSION_CONTEXT</H1>

<P>The CPSFUNC_SET_FUSION_CONTEXT sets a Fusion activation context for the specified page.</P>

<H4>ComPropSheet Parameters</H4>

<DL>
<DT><I>lParam1</I></DT>

<DD>Specifies the handle to the Fusion context. <I>Compstui.dll</I> duplicates the handle attaching it to its internal structures, so the caller is not obligated to retain the handle. <I>Compstui.dll </I>releases the passed-in context handle when the <I>compstui.dll</I> handle is deleted.</DD>

<DT><I>lParam2</I></DT>

<DD>Is not used.
</DD>
</DL>

<H4>ComPropSheet Return Value</H4>

<P>If the operation succeeds, <A HREF="cpsuifnc_15pj.htm"><B>ComPropSheet</B></A> returns a value greater than zero. Otherwise, <B>ComPropSheet</B> returns a value that is less than or equal to zero. For information about the error, use <B>GetLastError</B>, which is described in the Platform SDK documentation.</P>

<H4>Headers</H4>

<P>Declared in <I>compstui.h</I>. Include <I>compstui.h</I>.</P>

<H4>Comments</H4>

<P>When a page is about to be created or inserted and it does not specify an activation context in its PROPSHEETPAGE structure (described in the Platform SDK documentation), it will be created in the parent's page activation context. If the parent's activation context is not set, then <I>compstui.dll</I> looks up the parent's parent, continuing until the top level parent is reached or until it finds a parent with an activation context properly set. If none of the parents has an activation context set, then <I>compstui.dll</I> will not specify an activation context in the PROPSHEETPAGE structure. This means that the page will be created in the activation context of the caller of the <B>PropertySheet</B> API (described in the Platform SDK documentation).</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: CPSFUNC_SET_FUSION_CONTEXT"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
