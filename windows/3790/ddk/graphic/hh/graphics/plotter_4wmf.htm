<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>PCD Source File Format</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="PCD Source File Format">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Display&nbsp;and&nbsp;Print&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H2><A NAME="ddk_pcd_source_file_format_gg"></A>PCD Source File Format</H2>

<P>All plotter device characteristics are specified using the following format:</P>

<P class=indent1><I>keyword</I> <B>{</B><I>value</I><B>}</B></P>

<P>where <I>keyword</I> is one of the PCD source file keywords and <I>value</I> is a quoted string or numeric value. For example, the following statement specifies that the plotter supports color:</P>

<PRE>ColorCap {1}</PRE>

<P>Keywords are described in the following table.</P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=13%>Key-<BR>
word</TH>
<TH align=left width=37%>Value Definition</TH>
<TH align=left width=50%>Default Value</TH>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%><B>BezierCap</B></TD>
</TR>

<TR VALIGN="top">
<TD width=13%>&nbsp;</TD>
<TD width=37%>1=Device supports HPGL2 Beziers extension.
<P>0=No support.</P>
</TD>
<TD width=50%>0</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%><B>ColorCap</B></TD>
</TR>

<TR VALIGN="top">
<TD width=13%>&nbsp;</TD>
<TD width=37%>1=Color device<BR>
0=Monochrome device</TD>
<TD width=50%>0</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%><B>COLORINFO</B></TD>
</TR>

<TR VALIGN="top">
<TD width=13%>&nbsp;</TD>
<TD width=37%>Thirty DWORD-sized values representing the contents of a <A HREF="grstrcts_157r.htm">COLORINFO</A> structure.</TD>
<TD width=50%>{<BR>
{6810,3050,0}, // xr, yr, Yr<BR>
{2260,6550,0}, // xg, yg, Yg<BR>
{1810,500,0}, // xb, yb, Yb<BR>
{2000,2450,0}, // xc, yc, Yc<BR>
{5210,2100,0}, // xm, ym, Ym<BR>
{4750,5100,0}, // xy, yy, Yy<BR>
{3324,3474,10000}, // xw, yw, Yw<BR>
10000,10000,10000, // RGB gamma<BR>
1422,952,         // M/C, Y/C<BR>
787,495,           // C/M, Y/M<BR>
324,248            // C/Y, M/Y<BR>
}</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%><B>DeviceMargin</B></TD>
</TR>

<TR VALIGN="top">
<TD width=13%>&nbsp;</TD>
<TD width=37%>Four DWORD-sized values representing the left, top, right, and bottom paper margins, in 1/1000 mm units.</TD>
<TD width=50%>{5000,<BR>
5000,<BR>
5000,<BR>
36000}</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%><B>DeviceName</B></TD>
</TR>

<TR VALIGN="top">
<TD width=13%>&nbsp;</TD>
<TD width=37%>Quoted string representing a displayable device name (31 characters max.)</TD>
<TD width=50%>"HPGL/2 Plotter"</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%><B>DevicePelsDPI</B></TD>
</TR>

<TR VALIGN="top">
<TD width=13%>&nbsp;</TD>
<TD width=37%>One DWORD-sized value representing the device's effective DPI. For more information see the <B>upDevicePelsDPI</B> member of <A HREF="grstrcts_2k9z.htm">GDIINFO</A>.</TD>
<TD width=50%>The default is zero, causing GDI to calculate a value.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%><B>DeviceSize</B></TD>
</TR>

<TR VALIGN="top">
<TD width=13%>&nbsp;</TD>
<TD width=37%>Two DWORD-sized values representing maximum paper size, in <I>x</I> and <I>y</I> coordinates of 1/1000 mm units.
<P>A <I>y</I> value of 25400 (1 inch) or less indicates the device accepts variable paper lengths.</P>
</TD>
<TD width=50%>{215900,<BR>
279400}</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%><B>FormInfo</B></TD>
</TR>

<TR VALIGN="top">
<TD width=13%>&nbsp;</TD>
<TD width=37%>A <A HREF="#ddk_form_descriptions_gg">form description</A> for each form supported by the plotter.</TD>
<TD width=50%>None.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%><B>HTPatternSize</B></TD>
</TR>

<TR VALIGN="top">
<TD width=13%>&nbsp;</TD>
<TD width=37%>One of the HT_PATSIZE_-prefixed constants that identify standard halftoning patterns.</TD>
<TD width=50%>0xffffffff</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%><B>InitString</B></TD>
</TR>

<TR VALIGN="top">
<TD width=13%>&nbsp;</TD>
<TD width=37%>Quoted C-language string representing commands sent to the printer by the driver's <A HREF="ddifncs_6t5z.htm"><I>DrvStartPage</I></A> function.</TD>
<TD width=50%>NULL string.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%><B>MaxCopies</B></TD>
</TR>

<TR VALIGN="top">
<TD width=13%>&nbsp;</TD>
<TD width=37%>Maximum number of copies per page that the device can render.</TD>
<TD width=50%>1</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%><B>MaxPens</B></TD>
</TR>

<TR VALIGN="top">
<TD width=13%>&nbsp;</TD>
<TD width=37%>Number of pens (32 max.)</TD>
<TD width=50%>8</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%><B>MaxPolygonPts</B></TD>
</TR>

<TR VALIGN="top">
<TD width=13%>&nbsp;</TD>
<TD width=37%>Maximum number of points to define a polygon to be stroked or filled.</TD>
<TD width=50%>128</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%><B>MaxQuality</B></TD>
</TR>

<TR VALIGN="top">
<TD width=13%>&nbsp;</TD>
<TD width=37%>Number of quality levels (4 max.)</TD>
<TD width=50%>4</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%><B>MaxScale</B></TD>
</TR>

<TR VALIGN="top">
<TD width=13%>&nbsp;</TD>
<TD width=37%>Maximum scale size. 0-10000 (100 is 100%)</TD>
<TD width=50%>100</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%><B>NoBitmapFont</B></TD>
</TR>

<TR VALIGN="top">
<TD width=13%>&nbsp;</TD>
<TD width=37%>1=Device does not support bitmap fonts.
<P>0=Bitmap fonts are supported.</P>
</TD>
<TD width=50%>0</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%><B>PaperTrayCap</B></TD>
</TR>

<TR VALIGN="top">
<TD width=13%>&nbsp;</TD>
<TD width=37%>1=Device has paper tray source.
<P>0=No support.</P>
</TD>
<TD width=50%>0</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%><B>PaperTraySize</B></TD>
</TR>

<TR VALIGN="top">
<TD width=13%>&nbsp;</TD>
<TD width=37%>Two DWORD-sized values representing the paper tray width and height, in 1/1000 mm units.</TD>
<TD width=50%>{-1,<BR>
-1}</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%><B>PlotDPI</B></TD>
</TR>

<TR VALIGN="top">
<TD width=13%>&nbsp;</TD>
<TD width=37%>Two DWORD-sized values representing a pen plotter's <I>x</I> and <I>y</I> resolution, in dots per inch.</TD>
<TD width=50%>{1016,<BR>
1016}</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%><B>PlotPenData</B></TD>
</TR>

<TR VALIGN="top">
<TD width=13%>&nbsp;</TD>
<TD width=37%>A <A HREF="#ddk_pen_descriptions_gg">pen description</A> for each pen.</TD>
<TD width=50%>None.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%><B>PushPopPal</B></TD>
</TR>

<TR VALIGN="top">
<TD width=13%>&nbsp;</TD>
<TD width=37%>1=Driver must push/pop palette when switching between RTL and HPGL2.
<P>0=Push/pop is not required.</P>
</TD>
<TD width=50%>0</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%><B>RasterByteAlign</B></TD>
</TR>

<TR VALIGN="top">
<TD width=13%>&nbsp;</TD>
<TD width=37%>1=Device must receive all raster data on byte-aligned x coordinates.
<P>0=Byte alignment is not required.</P>
</TD>
<TD width=50%>0</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%><B>RasterCap</B></TD>
</TR>

<TR VALIGN="top">
<TD width=13%>&nbsp;</TD>
<TD width=37%>1=Raster device<BR>
0=Pen device</TD>
<TD width=50%>0</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%><B>RasterDPI</B></TD>
</TR>

<TR VALIGN="top">
<TD width=13%>&nbsp;</TD>
<TD width=37%>Two DWORD-sized values representing <I>x</I> and <I>y</I> resolution, in dots per inch.
<P>For raster plotters, this is the raster resolution.</P>

<P>For pen plotters, this is the ideal resolution the GDI supplies to an application.</P>
</TD>
<TD width=50%>{300,<BR>
300}</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%><B>RollFeedCap</B></TD>
</TR>

<TR VALIGN="top">
<TD width=13%>&nbsp;</TD>
<TD width=37%>1=Device has roll paper source.
<P>0=No support.</P>
</TD>
<TD width=50%>0</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%><B>ROPLevel</B></TD>
</TR>

<TR VALIGN="top">
<TD width=13%>&nbsp;</TD>
<TD width=37%>ROP_LEVEL_0 = No RasterOp support.
<P>ROP_LEVEL_1 = Rop1 support.</P>

<P>ROP_LEVEL_2 = Rop2 support.</P>

<P>ROP_LEVEL_3 = Rop3 support.</P>
</TD>
<TD width=50%>ROP_LEVEL_0</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%><B>RTLMonoEncode5</B></TD>
</TR>

<TR VALIGN="top">
<TD width=13%>&nbsp;</TD>
<TD width=37%>1=HP Raster Transfer Language (RTL) Monochrome Compression Mode 5 is supported.
<P>0=No support.</P>
</TD>
<TD width=50%>0</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%><B>RTLMonoFixPal</B></TD>
</TR>

<TR VALIGN="top">
<TD width=13%>&nbsp;</TD>
<TD width=37%>RTL Monochrome palette only.
<P>0=White, 1=Black</P>
</TD>
<TD width=50%>0</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%><B>RTLMonoNoCID</B></TD>
</TR>

<TR VALIGN="top">
<TD width=13%>&nbsp;</TD>
<TD width=37%>1=In RTL Mono mode, CID commands are not required.
<P>0=In RTL Mono mode, CID commands are required.</P>
</TD>
<TD width=50%>0</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%><B>RTLNoDPIxy</B></TD>
</TR>

<TR VALIGN="top">
<TD width=13%>&nbsp;</TD>
<TD width=37%>1=RTL DPI X,Y move commands are not supported.
<P>0=These commands are supported.</P>
</TD>
<TD width=50%>0</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%><B>TransparentCap</B></TD>
</TR>

<TR VALIGN="top">
<TD width=13%>&nbsp;</TD>
<TD width=37%>1=Device supports transparent mode.
<P>0=No support.</P>
</TD>
<TD width=50%>0</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%><B>WindingFillCap</B></TD>
</TR>

<TR VALIGN="top">
<TD width=13%>&nbsp;</TD>
<TD width=37%>1=Device supports winding fills.
<P>0=No support.</P>
</TD>
<TD width=50%>0</TD>
</TR>
</TABLE><BR>



<H4><A NAME="ddk_pen_descriptions_gg"></A>Pen Descriptions</H4>

<P>Each pen description must have the following format:</P>

<P class=indent1><B>PlotPenData {</B><I>Pen Number</I><B>,</B> <I>Color</I><B>}</B></P>

<P>where <I>Pen Number </I>identifies the pen's slot number and <I>Color</I> is a PC_IDX_-prefixed color identifier. Following are example pen descriptions:</P>

<PRE>PlotPenData {1, PC_IDX_WHITE}
PlotPenData {2, PC_IDX_BLACK}
PlotPenData {3, PC_IDX_RED}</PRE>



<H4><A NAME="ddk_form_descriptions_gg"></A>Form Descriptions</H4>

<P>Each form description must have the following format:</P>

<P class=indent1><B>FormInfo {"</B><I>Form Description</I><B>",</B> <I>Width</I><B>,</B> <I>Length</I><B>,</B> <I>Left Margin</I><B>,</B> <I>Top Margin</I><B>,</B> <I>Right Margin</I><B>,</B> <I>Bottom Margin</I><B>}</B></P>

<P>where <I>Form Description</I> is a string describing the form, <I>Width</I> and <I>Length</I> specify the form size in 1/1000 mm units, and the margins are also specified in 1/1000 mm units. Following are three examples:</P>

<PRE>FormInfo {"Roll Paper 24 in",    609600,      0, 0, 0, 0, 0}
FormInfo {"ANSI A 8.5 x 11 in",  215900, 279400, 0, 0, 0, 0}
FormInfo {"ISO A4 210 x 297 mm", 210000, 297000, 0, 0, 0, 0}</PRE>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: PCD%20Source%20File%20Format"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
