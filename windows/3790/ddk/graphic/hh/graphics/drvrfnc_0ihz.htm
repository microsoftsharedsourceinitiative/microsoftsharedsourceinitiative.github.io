<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>DrvDevicePropertySheets</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="DrvDevicePropertySheets">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Display&nbsp;and&nbsp;Print&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_drvdevicepropertysheets_gg"></A>DrvDevicePropertySheets</H1>

<P>A printer interface DLL's <B>DrvDevicePropertySheets</B> function is responsible for creating property sheet pages that describe a printer's properties.</P>

<PRE class=syntax><B>LONG
  DrvDevicePropertySheets(
    PPROPSHEETUI_INFO  </B><I>pPSUIInfo</I><B>,</B>
    <B>LPARAM  </B><I>lParam</I>
    <B>);</B></PRE>

<H4>Parameters</H4>

<DL>
<DT><I>pPSUIInfo</I></DT>

<DD>Caller-supplied pointer to a <A HREF="cpsuifnc_78yv.htm">PROPSHEETUI_INFO</A> structure.</DD>

<DT><I>lParam</I></DT>

<DD>Caller-supplied integer value that is dependent on the contents of the <B>Reason</B> member of the PROPSHEETUI_INFO structure, as listed in the following table.

<TABLE>

<TR VALIGN="top">
<TH align=left width=23%>Reason Value</TH>
<TH align=left width=77%>Definition of <I>lParam</I></TH>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%>PROPSHEETUI_REASON_INIT</TD>
</TR>

<TR VALIGN="top">
<TD width=23%>&nbsp;</TD>
<TD width=77%>Pointer to a <A HREF="drvrfnc_57hj.htm">DEVICEPROPERTYHEADER</A> structure.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=2 width=100%>All other reason values</TD>
</TR>

<TR VALIGN="top">
<TD width=23%>&nbsp;</TD>
<TD width=77%>See the description of the <I>lParam</I> parameter for the <A HREF="cpsuifnc_6qp3.htm">PFNPROPSHEETUI</A> function type.
<P>(The <A HREF="drvrfnc_57hj.htm">DEVICEPROPERTYHEADER</A> structure's address is contained in the <B>lParamInit</B> member of the <A HREF="cpsuifnc_78yv.htm">PROPSHEETUI_INFO</A> structure.)</P>
</TD>
</TR>
</TABLE><BR>

</DD>
</DL>

<H4>Return Value</H4>

<P>See the <B>Return</B> <B>Value</B> section in the description of the <A HREF="cpsuifnc_6qp3.htm">PFNPROPSHEETUI</A> function type.</P>

<H4>Headers</H4>

<P>Declared in <I>winddiui.h</I>. Include <I>winddiui.h</I>.</P>

<H4>Comments</H4>

<P>All <A HREF="drvarch_29pj.htm">printer interface DLLs</A> must provide a <B>DrvDevicePropertySheets</B> function, which is defined using the <A HREF="cpsuifnc_6qp3.htm">PFNPROPSHEETUI</A> function type. The function's purpose is to call the <A HREF="cpsuifnc_15pj.htm"><B>ComPropSheet</B></A> function, provided by <A HREF="cpsui_2q3r.htm">CPSUI</A>, to specify a property sheet page containing user-modifiable properties for the printer.</P>

<P>The function should perform operations as described for the <A HREF="cpsuifnc_6qp3.htm">PFNPROPSHEETUI</A> function type. The function should create the printer's <B>Device</B> <B>Settings</B> property sheet page (see the <B>pDlgPage</B> member of the <A HREF="cpsuifnc_7bc7.htm">COMPROPSHEETUI</A> structure).</P>

<P>Printer device settings should be stored in the registry. If a user with administrator privilege modifies options on the <B>Device</B> <B>Settings</B> page, the <B>DrvDevicePropertySheets</B> function should write the updated values to the registry by calling <B>SetPrinterData</B> (described in the Platform SDK documentation).</P>

<H4>See Also</H4>

<P><A HREF="drvrfnc_30yv.htm"><B>DrvDocumentPropertySheets</B></A>, <A HREF="drvrfnc_1n6v.htm"><B>IPrintOemUI::DevicePropertySheets</B></A><B> </B></P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: DrvDevicePropertySheets"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
