<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>GdiGetPageCount</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="GdiGetPageCount">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Display&nbsp;and&nbsp;Print&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_gdigetpagecount_gg"></A>GdiGetPageCount</H1>

<P>The <B>GdiGetPageCount</B> function returns the number of pages in a print job.</P>

<PRE class=syntax><B>DWORD WINAPI
  GdiGetPageCount(
    HANDLE  </B><I>SpoolFileHandle</I><B>
    );</B></PRE>

<H4>Parameters</H4>

<DL>
<DT><I>SpoolFileHandle</I></DT>

<DD>Caller-supplied spool file handle, obtained by a previous call to <A HREF="gdifnc_9ehz.htm"><B>GdiGetSpoolFilehandle</B></A>.
</DD>
</DL>

<H4>Return Value</H4>

<P>If the operation succeeds, the function returns the number of pages in the current print job. Otherwise the function returns zero.</P>

<H4>Headers</H4>

<P>Declared in <I>winppi.h</I>. Include <I>winppi.h</I>.</P>

<H4>Comments</H4>

<P>The <B>GdiGetPageCount</B> function is exported by <I>gdi32.dll</I> for use within a print processor's <A HREF="spoolfnc_6v8n.htm"><B>PrintDocumentOnPrintProcessor</B></A> function.</P>

<P class=note><B>Note</B>&nbsp;&nbsp;The <B>GdiGetPageCount</B> function does not return until all pages have been spooled, even if the print server administrator has specified that print jobs should be printed during spooling. Therefore, this function should not be used unless it is necessary to obtain the total page count before document processing can begin, such as for printing pages in reverse order.</P>

<P class=note>Usually, a better method for determining the page count is to count the number of calls made to <A HREF="gdifnc_3auf.htm"><B>GdiGetPageHandle</B></A>.</P>

<P>For additional information about this set of functions, see <A HREF="provider_60iv.htm">Using GDI Functions in Print Processors</A>.</P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: GdiGetPageCount"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
